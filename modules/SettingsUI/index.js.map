{"version":3,"sources":["modules/SettingsUI/index.js"],"names":["DEFAULT_REGION_SETTINGS_URL","DEFAULT_CALLING_SETTINGS_URL","DEFAULT_AUDIO_SETTINGS_URL","DEFAULT_FEEDBACK_SETTINGS_URL","SettingsUI","name","deps","dep","optional","phone","accountInfo","auth","brand","extensionInfo","locale","localeSettings","regionSettings","callingSettings","version","extensionFeatures","presence","userGuide","showRegion","showCalling","showAudio","showFeedback","showUserGuide","showPresenceSettings","showQuickAccess","params","loginNumber","loggedIn","loginStatus","ready","mainCompanyNumber","extensionNumber","phoneNumber","join","countryCode","areaCode","showSpinner","isCallingEnabled","code","showReginSetting","currentLocale","brandId","id","ringoutEnabled","isRingOutEnabled","outboundSMS","hasOutboundSMSPermission","hasInternalSMSPermission","isCallQueueMember","dndStatus","userStatus","openPresenceSettings","features","EditPresenceStatus","available","supportedLocales","savedLocale","hasPermission","regionSettingsUrl","callingSettingsUrl","audioSettingsUrl","feedbackSettingsUrl","routerInteraction","quickAccess","onLogoutButtonClick","logout","onRegionSettingsLinkClick","push","onCallingSettingsLinkClick","onAudioSettingsLinkClick","onFeedbackSettingsLinkClick","onUserGuideClick","start","onQuickAccessLinkClick","enter","setAvailable","setBusy","setDoNotDisturb","setInvisible","toggleAcceptCallQueueCalls","saveLocale","RcUIModule"],"mappings":"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","sourcesContent":["import { Module } from 'ringcentral-integration/lib/di';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport loginStatus from 'ringcentral-integration/modules/Auth/loginStatus';\nimport RcUIModule from '../../lib/RcUIModule';\n\nconst DEFAULT_REGION_SETTINGS_URL = '/settings/region';\nconst DEFAULT_CALLING_SETTINGS_URL = '/settings/calling';\nconst DEFAULT_AUDIO_SETTINGS_URL = '/settings/audio';\nconst DEFAULT_FEEDBACK_SETTINGS_URL = '/settings/feedback';\n\n@Module({\n  name: 'SettingsUI',\n  deps: [\n    'Auth',\n    'Brand',\n    'Locale',\n    {\n      dep: 'Version',\n      optional: true,\n    },\n    {\n      dep: 'Presence',\n      optional: true,\n    },\n    'AccountInfo',\n    'ExtensionInfo',\n    'RegionSettings',\n    'ExtensionFeatures',\n    'RouterInteraction',\n    {\n      dep: 'CallingSettings',\n      optional: true,\n    },\n    {\n      dep: 'LocaleSettings',\n      optional: true,\n    },\n    {\n      dep: 'QuickAccess',\n      optional: true,\n    },\n    {\n      dep: 'UserGuide',\n      optional: true,\n    },\n    {\n      dep: 'SettingsUIOptions',\n      optional: true,\n    },\n  ],\n})\nexport default class SettingsUI extends RcUIModule {\n  getUIProps({\n    phone: {\n      accountInfo,\n      auth,\n      brand,\n      extensionInfo,\n      locale,\n      localeSettings,\n      regionSettings,\n      callingSettings,\n      version,\n      extensionFeatures,\n      presence,\n      userGuide,\n    },\n    showRegion = true,\n    showCalling = true,\n    showAudio = true,\n    showFeedback = true,\n    showUserGuide = true,\n    showPresenceSettings = true,\n    showQuickAccess = false,\n    params,\n  }) {\n    let loginNumber = brand.name;\n    const loggedIn = auth.loginStatus === loginStatus.loggedIn;\n    if (\n      loggedIn &&\n      accountInfo.ready &&\n      extensionInfo.ready &&\n      accountInfo.mainCompanyNumber\n    ) {\n      // If no extensionNumber, extensionNumber field needs to be omitted\n      const extensionNumber =\n        extensionInfo.extensionNumber && extensionInfo.extensionNumber !== '0'\n          ? extensionInfo.extensionNumber\n          : null;\n      const phoneNumber = [accountInfo.mainCompanyNumber, extensionNumber].join(\n        '*',\n      );\n      loginNumber = formatNumber({\n        phoneNumber,\n        countryCode: regionSettings.countryCode,\n        areaCode: regionSettings.areaCode,\n      });\n    }\n    return {\n      version,\n      loginNumber,\n      showFeedback,\n      showQuickAccess,\n      showSpinner: !(\n        accountInfo.ready &&\n        auth.ready &&\n        loggedIn &&\n        extensionInfo.ready &&\n        locale.ready &&\n        regionSettings.ready &&\n        (!callingSettings || callingSettings.ready) &&\n        extensionFeatures.ready &&\n        (!presence || presence.ready) &&\n        (!localeSettings || localeSettings.ready)\n      ),\n      showCalling:\n        showCalling && callingSettings && extensionFeatures.isCallingEnabled,\n      showAudio: showAudio && extensionFeatures.isCallingEnabled,\n      showRegion:\n        loggedIn &&\n        brand.code === 'rc' &&\n        regionSettings.showReginSetting &&\n        extensionFeatures.isCallingEnabled &&\n        showRegion,\n      currentLocale: locale.currentLocale,\n      brandId: brand.id,\n      ringoutEnabled: extensionFeatures.isRingOutEnabled,\n      outboundSMS:\n        !!extensionFeatures.hasOutboundSMSPermission ||\n        !!extensionFeatures.hasInternalSMSPermission,\n      isCallQueueMember: extensionInfo.isCallQueueMember,\n      dndStatus: presence && presence.dndStatus,\n      userStatus: presence && presence.userStatus,\n      openPresenceSettings: !!(\n        presence &&\n        params &&\n        params.showPresenceSettings\n      ),\n      showPresenceSettings:\n        showPresenceSettings &&\n        !!extensionFeatures.features?.EditPresenceStatus?.available,\n      supportedLocales: localeSettings && localeSettings.supportedLocales,\n      savedLocale: localeSettings && localeSettings.savedLocale,\n      showUserGuide: showUserGuide && !!userGuide?.hasPermission,\n    };\n  }\n\n  getUIFunctions({\n    regionSettingsUrl = DEFAULT_REGION_SETTINGS_URL,\n    callingSettingsUrl = DEFAULT_CALLING_SETTINGS_URL,\n    audioSettingsUrl = DEFAULT_AUDIO_SETTINGS_URL,\n    feedbackSettingsUrl = DEFAULT_FEEDBACK_SETTINGS_URL,\n    phone: {\n      auth,\n      presence,\n      routerInteraction,\n      localeSettings,\n      userGuide,\n      quickAccess,\n    },\n  }) {\n    return {\n      async onLogoutButtonClick() {\n        await auth.logout();\n      },\n      onRegionSettingsLinkClick() {\n        routerInteraction.push(regionSettingsUrl);\n      },\n      onCallingSettingsLinkClick() {\n        routerInteraction.push(callingSettingsUrl);\n      },\n      onAudioSettingsLinkClick() {\n        routerInteraction.push(audioSettingsUrl);\n      },\n      onFeedbackSettingsLinkClick() {\n        routerInteraction.push(feedbackSettingsUrl);\n      },\n      onUserGuideClick() {\n        userGuide.start();\n      },\n      onQuickAccessLinkClick() {\n        quickAccess.enter();\n      },\n\n      setAvailable: (...args) => presence && presence.setAvailable(...args),\n      setBusy: (...args) => presence && presence.setBusy(...args),\n      setDoNotDisturb: (...args) =>\n        presence && presence.setDoNotDisturb(...args),\n      setInvisible: (...args) => presence && presence.setInvisible(...args),\n      toggleAcceptCallQueueCalls: (...args) =>\n        presence && presence.toggleAcceptCallQueueCalls(...args),\n      saveLocale:\n        localeSettings && ((locale) => localeSettings.saveLocale(locale)),\n    };\n  }\n}\n"],"file":"index.js"}