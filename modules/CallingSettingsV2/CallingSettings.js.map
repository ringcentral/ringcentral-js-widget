{"version":3,"sources":["modules/CallingSettingsV2/CallingSettings.ts"],"names":["LOCATION_NUMBER_ORDER","CallingSettings","name","deps","dep","optional","that","_deps","extensionPhoneNumber","directNumbers","mainCompanyNumber","extensionInfo","extensionNumber","forwardingNumber","flipNumbers","callerIdNumbers","rolesAndPermissions","ringoutEnabled","webphoneEnabled","otherPhoneNumbers","length","numbers","myPhoneNumbers","availableNumbers","enableCache","storageKey","_myPhoneNumbers","_onFirstLogin","_ringoutEnabled","_otherPhoneNumbers","_webphoneEnabled","initRingoutPrompt","_showCallWithJupiter","_emergencyCallAvailable","_availableNumbers","callingSettingsOptions","onFirstLogin","defaultRingoutPrompt","showCallWithJupiter","emergencyCallAvailable","storage","migrationMapping","callWith","ringoutPrompt","myLocation","timestamp","isCustomLocation","data","number","fromNumber","phoneNumber","_updateFromNumber","_shouldReset","_shouldInit","_shouldValidate","_validateSettings","ready","_init","resetSuccess","callingEnabled","defaultCallWith","callWithOptions","setDataAction","Date","now","_warningEmergencyCallingNotAvailable","deprecatedCallingOptions","myphone","otherphone","customphone","callingOptions","ringout","_initFromNumber","browser","alert","info","message","callingSettingsMessages","emergencyCallingNotAvailable","ttl","_hasWebphonePermissionRemoved","_setSoftPhoneToCallWith","danger","webphonePermissionRemoved","_hasPermissionChanged","permissionChanged","_hasPhoneNumberChanged","phoneNumberChanged","softphone","webphone","indexOf","devices","extensionDevice","mainPhoneNumber","registedWithDevice","forEach","device","phoneLines","find","phoneLine","phoneInfo","isFlipNumber","flipNumber","label","defaultCallerId","fromNumbers","callerId","ringOut","type","defaultPhoneNumber","defaultEntry","item","updateFromNumber","withPrompt","saveSuccessWithSoftphone","jupiter","saveSuccessWithJupiter","saveSuccess","map","push","filterMapping","filter","sort","a","b","hasExtensionPhoneNumber","brand","code","brandConfig","brandCode","sortedPhoneNumbers","firstItem","lastItem","usageType","concat","result","locationLabel","_getLocationLabel","value","callingMode","callingModes","driver","RcModuleV2","state","action","proxify"],"mappings":"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","sourcesContent":["import {\n  state,\n  action,\n  storage,\n  computed,\n  RcModuleV2,\n} from '@ringcentral-integration/core';\nimport { Deps } from './CallingSettings.interface';\nimport { Module } from '../../lib/di';\nimport { callingModes } from './callingModes';\nimport { CallingOptionsType, callingOptions } from './callingOptions';\nimport proxify from '../../lib/proxy/proxify';\nimport { mapOptionToMode } from './mapOptionToMode';\nimport { callingSettingsMessages } from './callingSettingsMessages';\nimport { deprecatedCallingOptions } from './deprecatedCallingOptions';\n\nconst LOCATION_NUMBER_ORDER = ['Other', 'Main'];\n/**\n * @class\n * @description Call setting managing module\n */\n@Module({\n  name: 'CallingSettings',\n  deps: [\n    'Alert',\n    'Brand',\n    'Storage',\n    'ExtensionInfo',\n    'ExtensionDevice',\n    'ForwardingNumber',\n    'RolesAndPermissions',\n    'ExtensionPhoneNumber',\n    { dep: 'CallerId', optional: true },\n    { dep: 'Webphone', optional: true },\n    { dep: 'TabManager', optional: true },\n    { dep: 'CallingSettingsOptions', optional: true },\n  ],\n})\nclass CallingSettings extends RcModuleV2<Deps> {\n  _myPhoneNumbers: string[];\n  _onFirstLogin?: () => {};\n  _ringoutEnabled: boolean;\n  _otherPhoneNumbers: string[];\n  _webphoneEnabled: boolean;\n  initRingoutPrompt?: boolean;\n  _showCallWithJupiter?: boolean;\n  _emergencyCallAvailable?: boolean;\n  _availableNumbers: string[];\n\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Alert} params.alert - alert module instance\n   * @param {Brand} params.brand - brand module instance\n   * @param {ExtensionInfo} params.extensionInfo - extensionInfo module instance\n   * @param {ExtensionPhoneNumber} params.extensionPhoneNumber - extensionPhoneNumber module instance\n   * @param {ForwardingNumber} params.forwardingNumber - forwardingNumber module instance\n   * @param {Storage} params.storage - storage module instance\n   * @param {RolesAndPermissions} params.rolesAndPermissions - rolesAndPermissions module instance\n   * @param {TabManager} params.tabManager - tabManager module instance\n   * @param {Webphone} params.webphone - webphone module instance\n   * @param {Function} params.onFirstLogin - func on first login\n   */\n\n  constructor(deps: Deps) {\n    super({\n      deps,\n      enableCache: true,\n      storageKey: 'CallingSettings',\n    });\n    this._onFirstLogin = this._deps.callingSettingsOptions?.onFirstLogin;\n    this.initRingoutPrompt = this._deps.callingSettingsOptions?.defaultRingoutPrompt;\n    this._showCallWithJupiter =\n      this._deps.callingSettingsOptions?.showCallWithJupiter ?? true;\n    this._emergencyCallAvailable =\n      this._deps.callingSettingsOptions?.emergencyCallAvailable ?? false;\n    /* migration storage v1 to v2 */\n    if (this._deps.storage) {\n      this._deps.storage.migrationMapping =\n        this._deps.storage.migrationMapping ?? {};\n      this._deps.storage.migrationMapping['CallingSettings-data'] =\n        'callingSettingsData';\n    }\n    /* migration storage v1 to v2 */\n  }\n\n  get callWith() {\n    return this.data.callWith;\n  }\n\n  get ringoutPrompt() {\n    return this.data.ringoutPrompt;\n  }\n\n  get myLocation() {\n    return this.data.myLocation;\n  }\n\n  get fromNumber() {\n    return this.data.fromNumber;\n  }\n\n  get timestamp() {\n    return this.data.timestamp;\n  }\n\n  get isCustomLocation() {\n    return this.data.isCustomLocation;\n  }\n\n  @storage\n  @state\n  data: {\n    callWith: string;\n    ringoutPrompt: boolean;\n    myLocation: string;\n    fromNumber: string;\n    timestamp: number;\n    isCustomLocation: boolean;\n  } = {\n    callWith: null,\n    ringoutPrompt: true,\n    myLocation: '',\n    fromNumber: null,\n    timestamp: null,\n    isCustomLocation: false,\n  };\n\n  @action\n  setDataAction({\n    callWith = this.callWith,\n    ringoutPrompt = this.ringoutPrompt,\n    myLocation = this.myLocation,\n    timestamp = this.timestamp,\n    isCustomLocation = this.isCustomLocation,\n  }: {\n    callWith?: CallingOptionsType;\n    ringoutPrompt?: boolean;\n    myLocation?: string;\n    timestamp?: number;\n    isCustomLocation?: boolean;\n  }) {\n    this.data.callWith = callWith;\n    this.data.ringoutPrompt = ringoutPrompt;\n    this.data.myLocation = myLocation;\n    this.data.timestamp = timestamp;\n    this.data.isCustomLocation = isCustomLocation;\n  }\n\n  @action\n  _updateFromNumber(number: { phoneNumber?: string }) {\n    this.data.fromNumber = number && number?.phoneNumber;\n  }\n\n  @proxify\n  async updateFromNumber(number: { phoneNumber?: string }) {\n    this._updateFromNumber(number);\n  }\n\n  @action\n  resetSuccess() {\n    this.data.fromNumber = null;\n  }\n\n  async onStateChange() {\n    if (!this._shouldReset() && !this._shouldInit() && this._shouldValidate()) {\n      this._ringoutEnabled = this._deps.rolesAndPermissions.ringoutEnabled;\n      this._webphoneEnabled = this._deps.rolesAndPermissions.webphoneEnabled;\n      this._myPhoneNumbers = this.myPhoneNumbers;\n      this._otherPhoneNumbers = this.otherPhoneNumbers;\n      await this._validateSettings();\n    }\n  }\n\n  _shouldValidate() {\n    return (\n      this.ready &&\n      (this._ringoutEnabled !== this._deps.rolesAndPermissions.ringoutEnabled ||\n        this._webphoneEnabled !==\n          this._deps.rolesAndPermissions.webphoneEnabled ||\n        this._myPhoneNumbers !== this.myPhoneNumbers ||\n        this._otherPhoneNumbers !== this.otherPhoneNumbers)\n    );\n  }\n\n  async onInit() {\n    await this._init();\n  }\n\n  onReset() {\n    this.resetSuccess();\n  }\n\n  async _init() {\n    if (!this._deps.rolesAndPermissions.callingEnabled) return;\n    this._myPhoneNumbers = this.myPhoneNumbers;\n    this._otherPhoneNumbers = this.otherPhoneNumbers;\n    this._availableNumbers = this.availableNumbers;\n    this._ringoutEnabled = this._deps.rolesAndPermissions.ringoutEnabled;\n    this._webphoneEnabled = this._deps.rolesAndPermissions.webphoneEnabled;\n    if (!this.timestamp) {\n      // first time login\n      const defaultCallWith = this.callWithOptions && this.callWithOptions[0];\n      this.setDataAction({ callWith: defaultCallWith, timestamp: Date.now() });\n      if (!this._emergencyCallAvailable) {\n        this._warningEmergencyCallingNotAvailable();\n      }\n      if (typeof this._onFirstLogin === 'function') {\n        this._onFirstLogin();\n      }\n    }\n    if (\n      this.callWith === deprecatedCallingOptions.myphone ||\n      this.callWith === deprecatedCallingOptions.otherphone ||\n      this.callWith === deprecatedCallingOptions.customphone\n    ) {\n      this.setDataAction({\n        callWith: callingOptions.ringout,\n        isCustomLocation:\n          this.callWith === deprecatedCallingOptions.customphone,\n      });\n    }\n    await this._validateSettings();\n    await this._initFromNumber();\n  }\n\n  @proxify\n  async _warningEmergencyCallingNotAvailable() {\n    if (this.callWith === callingOptions.browser) {\n      this._deps.alert.info({\n        message: callingSettingsMessages.emergencyCallingNotAvailable,\n        ttl: 0,\n      });\n    }\n  }\n\n  @proxify\n  async _validateSettings() {\n    if (this._hasWebphonePermissionRemoved()) {\n      await this._setSoftPhoneToCallWith();\n      this._deps.alert.danger({\n        message: callingSettingsMessages.webphonePermissionRemoved,\n        ttl: 0,\n      });\n    } else if (this._hasPermissionChanged()) {\n      await this._setSoftPhoneToCallWith();\n      this._deps.alert.danger({\n        message: callingSettingsMessages.permissionChanged,\n        ttl: 0,\n      });\n    } else if (this._hasPhoneNumberChanged()) {\n      this.setDataAction({\n        callWith: callingOptions.ringout,\n        myLocation: this._myPhoneNumbers[0],\n        timestamp: Date.now(),\n      });\n      this._deps.alert.danger({\n        message: callingSettingsMessages.phoneNumberChanged,\n        ttl: 0,\n      });\n    }\n  }\n\n  @proxify\n  async _setSoftPhoneToCallWith() {\n    this.setDataAction({\n      callWith: callingOptions.softphone,\n      timestamp: Date.now(),\n    });\n  }\n\n  _hasWebphonePermissionRemoved() {\n    return (\n      !(this._webphoneEnabled && this._deps.webphone) &&\n      this.callWith === callingOptions.browser\n    );\n  }\n\n  _hasPermissionChanged() {\n    return !this._ringoutEnabled && this.callWith === callingOptions.ringout;\n  }\n\n  _hasPhoneNumberChanged() {\n    return (\n      this.callWith === callingOptions.ringout &&\n      !this.isCustomLocation &&\n      this._availableNumbers.indexOf(this.myLocation) === -1\n    );\n  }\n\n  _getLocationLabel(phoneNumber: string) {\n    const { devices } = this._deps.extensionDevice;\n    const { flipNumbers } = this._deps.forwardingNumber;\n    const { mainCompanyNumber } = this._deps.extensionPhoneNumber;\n    const { extensionNumber } = this._deps.extensionInfo;\n    const mainPhoneNumber = `${mainCompanyNumber.phoneNumber}*${extensionNumber}`;\n    let name = null;\n    if (devices.length) {\n      let registedWithDevice = false;\n      devices.forEach((device) => {\n        const { phoneLines } = device;\n        if (phoneLines.length) {\n          registedWithDevice = phoneLines.find((phoneLine) => {\n            return phoneLine.phoneInfo.phoneNumber === phoneNumber;\n          });\n          if (registedWithDevice) {\n            name = device.name;\n          }\n        }\n      });\n      if (name) return name;\n    }\n    if (flipNumbers.length) {\n      const isFlipNumber = flipNumbers.find(\n        (flipNumber) => flipNumber.phoneNumber === phoneNumber,\n      );\n      if (isFlipNumber) {\n        return isFlipNumber.label || 'Other';\n      }\n    }\n\n    if (phoneNumber === mainPhoneNumber) {\n      return 'Main';\n    }\n    return 'Other';\n  }\n\n  @proxify\n  async _initFromNumber() {\n    const fromNumber = this.fromNumber;\n    if (!fromNumber) {\n      let defaultCallerId = this.fromNumbers[0];\n      if (this._deps.callerId?.ringOut) {\n        if (this._deps.callerId.ringOut.type === 'Blocked') {\n          defaultCallerId = { phoneNumber: 'anonymous' };\n        } else if (this._deps.callerId.ringOut.type === 'PhoneNumber') {\n          const defaultPhoneNumber = this._deps.callerId?.ringOut.phoneInfo\n            ?.phoneNumber;\n          const defaultEntry = this.fromNumbers.find(\n            (item) => item.phoneNumber === defaultPhoneNumber,\n          );\n          if (defaultEntry) {\n            defaultCallerId = defaultEntry;\n          }\n        }\n      }\n      await this.updateFromNumber(defaultCallerId);\n    }\n  }\n\n  @proxify\n  async setData(\n    {\n      callWith,\n      myLocation,\n      ringoutPrompt,\n      isCustomLocation,\n    }: {\n      callWith: CallingOptionsType;\n      myLocation: string;\n      ringoutPrompt: boolean;\n      isCustomLocation: boolean;\n    },\n    withPrompt: boolean,\n  ) {\n    // TODO validate myLocation\n    this.setDataAction({\n      callWith,\n      myLocation,\n      ringoutPrompt,\n      timestamp: Date.now(),\n      isCustomLocation,\n    });\n    if (withPrompt) {\n      if (this.callWith === callingOptions.softphone) {\n        this._deps.alert.info({\n          message: callingSettingsMessages.saveSuccessWithSoftphone,\n        });\n      } else if (this.callWith === callingOptions.jupiter) {\n        this._deps.alert.info({\n          message: callingSettingsMessages.saveSuccessWithJupiter,\n        });\n      } else {\n        this._deps.alert.info({\n          message: callingSettingsMessages.saveSuccess,\n        });\n        if (!this._emergencyCallAvailable) {\n          this._warningEmergencyCallingNotAvailable();\n        }\n      }\n    }\n  }\n\n  @computed((that: CallingSettings) => [\n    that._deps.extensionPhoneNumber.directNumbers,\n    that._deps.extensionPhoneNumber.mainCompanyNumber,\n    that._deps.extensionInfo.extensionNumber,\n  ])\n  get myPhoneNumbers() {\n    const {\n      directNumbers,\n      mainCompanyNumber,\n    } = this._deps.extensionPhoneNumber;\n    const { extensionNumber } = this._deps.extensionInfo;\n    const myPhoneNumbers = directNumbers.map((item) => item.phoneNumber);\n    if (mainCompanyNumber && extensionNumber) {\n      myPhoneNumbers.push(\n        `${mainCompanyNumber.phoneNumber}*${extensionNumber}`,\n      );\n    }\n    return myPhoneNumbers;\n  }\n\n  @computed((that: CallingSettings) => [\n    that._deps.forwardingNumber.flipNumbers,\n    that._deps.extensionPhoneNumber.callerIdNumbers,\n    that._deps.extensionPhoneNumber.directNumbers,\n  ])\n  get otherPhoneNumbers() {\n    const { flipNumbers } = this._deps.forwardingNumber;\n    const { callerIdNumbers, directNumbers } = this._deps.extensionPhoneNumber;\n    const filterMapping: { [k: string]: boolean } = {};\n    callerIdNumbers.forEach((item) => {\n      filterMapping[item.phoneNumber] = true;\n    });\n    directNumbers.forEach((item) => {\n      filterMapping[item.phoneNumber] = true;\n    });\n    return flipNumbers\n      .filter((item) => !filterMapping[item.phoneNumber])\n      .sort((a, b) => (a.label === 'Mobile' && a.label !== b.label ? -1 : 1))\n      .map((item) => item.phoneNumber);\n  }\n\n  @computed((that: CallingSettings) => [\n    that._deps.rolesAndPermissions.ringoutEnabled,\n    that._deps.rolesAndPermissions.webphoneEnabled,\n    that.otherPhoneNumbers.length,\n    that._deps.extensionPhoneNumber.numbers.length,\n  ])\n  get callWithOptions() {\n    const { ringoutEnabled, webphoneEnabled } = this._deps.rolesAndPermissions;\n    const hasExtensionPhoneNumber =\n      this._deps.extensionPhoneNumber.numbers.length > 0;\n    if (!hasExtensionPhoneNumber) {\n      return [callingOptions.softphone];\n    }\n    const callWithOptions = [];\n    if (this._deps.webphone && webphoneEnabled) {\n      callWithOptions.push(callingOptions.browser);\n    }\n    // only rc brand support call with RingCentral App\n    if (\n      this._deps.brand &&\n      (this._deps.brand.code === 'rc' ||\n        (this._deps.brand.brandConfig &&\n          this._deps.brand.brandConfig.brandCode === 'rc')) &&\n      this._showCallWithJupiter\n    ) {\n      callWithOptions.push(callingOptions.jupiter);\n    }\n\n    callWithOptions.push(callingOptions.softphone);\n    if (ringoutEnabled) {\n      callWithOptions.push(callingOptions.ringout);\n    }\n    return callWithOptions;\n  }\n\n  @computed((that: CallingSettings) => [\n    that._deps.extensionPhoneNumber.callerIdNumbers,\n  ])\n  get fromNumbers() {\n    const { callerIdNumbers } = this._deps.extensionPhoneNumber;\n    const sortedPhoneNumbers = callerIdNumbers.sort((firstItem, lastItem) => {\n      if (firstItem.usageType === 'DirectNumber') return -1;\n      if (lastItem.usageType === 'DirectNumber') return 1;\n      if (firstItem.usageType === 'MainCompanyNumber') return -1;\n      if (lastItem.usageType === 'MainCompanyNumber') return 1;\n      if (firstItem.usageType < lastItem.usageType) return -1;\n      if (firstItem.usageType > lastItem.usageType) return 1;\n      return 0;\n    });\n    return sortedPhoneNumbers;\n  }\n\n  @computed((that: CallingSettings) => [\n    that.myPhoneNumbers,\n    that.otherPhoneNumbers,\n  ])\n  get availableNumbers() {\n    return this.myPhoneNumbers.concat(this.otherPhoneNumbers);\n  }\n\n  @computed((that: CallingSettings) => [that.availableNumbers])\n  get availableNumbersWithLabel() {\n    const { availableNumbers } = this;\n    const result: { label: string; value: string }[] = [];\n    if (availableNumbers.length) {\n      availableNumbers.forEach((phoneNumber) => {\n        const locationLabel = this._getLocationLabel(phoneNumber);\n        result.push({\n          label: locationLabel,\n          value: phoneNumber,\n        });\n      });\n    }\n    result.sort(\n      (a, b) =>\n        LOCATION_NUMBER_ORDER.indexOf(a.label) -\n        LOCATION_NUMBER_ORDER.indexOf(b.label),\n    );\n    return result;\n  }\n\n  get callingMode() {\n    return mapOptionToMode(this.callWith);\n  }\n\n  get defaultRingoutPrompt() {\n    return this.initRingoutPrompt;\n  }\n\n  get isWebphoneMode() {\n    return this.callingMode === callingModes.webphone;\n  }\n\n  /* ringtone */\n  get isChangeRingToneAllowed() {\n    return (\n      this._deps.webphone &&\n      (this._deps.storage.driver === 'INDEXEDDB' ||\n        this._deps.storage.driver === 'WEBSQL')\n    );\n  }\n}\nexport { CallingSettings };\n"],"file":"CallingSettings.js"}