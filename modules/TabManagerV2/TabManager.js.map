{"version":3,"sources":["modules/TabManagerV2/TabManager.ts"],"names":["TabManager","name","deps","dep","optional","_tabbie","active","event","args","Tabbie","prefix","_deps","brand","enabled","checkIsMain","_setActive","on","events","mainTabIdChanged","_setEvent","send","id","checkTabAliveById","hasMultipleTabs","tabs","isFirstTab","RcModuleV2","state","action"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAOaA,U,WAJZ,gBAAO;AACNC,EAAAA,IAAI,EAAE,YADA;AAENC,EAAAA,IAAI,EAAE,CAAC,OAAD,EAAU;AAAEC,IAAAA,GAAG,EAAE,mBAAP;AAA4BC,IAAAA,QAAQ,EAAE;AAAtC,GAAV;AAFA,CAAP,C;;;;;AAMC,sBAAYF,IAAZ,EAAwB;AAAA;;AAAA;;AACtB,8BAAM;AACJA,MAAAA,IAAI,EAAJA;AADI,KAAN;AADsB,UADdG,OACc,GADI,IACJ;;AAAA;;AAAA;;AAAA;AAIvB;AAED;;;;;;;;+BAQqBC,M,EAAiB;AACpC,WAAKA,MAAL,GAAcA,MAAd;AACD;;;8BAMmBC,K,EAAeC,I,EAAa;AAC9C,WAAKD,KAAL,GAAa;AACXN,QAAAA,IAAI,EAAEM,KADK;AAEXC,QAAAA,IAAI,EAAJA;AAFW,OAAb;AAID;;;;;;;;;;;AAGC,qBAAKH,OAAL,GAAe,IAAII,cAAJ,CAAW;AACxBC,kBAAAA,MAAM,EAAE,KAAKC,KAAL,CAAWC,KAAX,CAAiBF;AADD,iBAAX,CAAf;;qBAGI,KAAKL,OAAL,CAAaQ,O;;;;;+BACf,I;;uBAAsB,KAAKR,OAAL,CAAaS,WAAb,E;;;;;6BAAjBC,U;;AACL,qBAAKV,OAAL,CAAaW,EAAb,CAAgB,KAAKX,OAAL,CAAaY,MAAb,CAAoBC,gBAApC,uEAAsD;AAAA;AAAA;AAAA;AAAA;AAAA,wCACpD,MADoD;AAAA;AAAA,iCAC9B,MAAI,CAACb,OAAL,CAAaS,WAAb,EAD8B;;AAAA;AAAA;;AAAA,sCAC/CC,UAD+C;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAtD;;AAGA,qBAAKV,OAAL,CAAaW,EAAb,CACE,KAAKX,OAAL,CAAaY,MAAb,CAAoBV,KADtB,EAEE,UAACA,KAAD,EAAmC;AAAA,oDAAhBC,IAAgB;AAAhBA,oBAAAA,IAAgB;AAAA;;AACjC,kBAAA,MAAI,CAACW,SAAL,CAAeZ,KAAf,EAAsBC,IAAtB;AACD,iBAJH;;;;;;;;;;;;;;;;;;yBASCD,K,EAA+B;AAAA;;AAAA,yCAAbC,IAAa;AAAbA,QAAAA,IAAa;AAAA;;AAClC,4BAAKH,OAAL,EAAae,IAAb,uBAAkBb,KAAlB,SAA4BC,IAA5B;AACD;;;;;;;;;kDAGQ,KAAKH,OAAL,CAAaS,WAAb,E;;;;;;;;;;;;;;;;;;sCAGSO,E,EAAY;AAC5B,aAAO,KAAKhB,OAAL,CAAaiB,iBAAb,CAA+BD,EAA/B,CAAP;AACD;;;wBAEQ;AACP,aAAO,KAAKhB,OAAL,CAAagB,EAApB;AACD;;;wBAEqB;AACpB,aAAO,KAAKhB,OAAL,CAAakB,eAApB;AACD;;;wBAEU;AACT,aAAO,KAAKlB,OAAL,CAAamB,IAApB;AACD;;;wBAEgB;AACf,aAAO,KAAKnB,OAAL,CAAaoB,UAApB;AACD;;;;EA3E6BC,gB,kFAY7BC,W;;;;;WACQ,I;;gEAERC,Y,+JAKAD,W;;;;;WACiB,I;;+DAEjBC,Y","sourcesContent":["import { action, RcModuleV2, state } from '@ringcentral-integration/core';\n\nimport { Module } from '../../lib/di';\nimport { Tabbie } from '../../lib/Tabbie';\nimport { Deps, TabEvent } from './TabManager.interface';\n\n@Module({\n  name: 'TabManager',\n  deps: ['Brand', { dep: 'TabManagerOptions', optional: true }],\n})\nexport class TabManager extends RcModuleV2<Deps> {\n  protected _tabbie: Tabbie = null;\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  /**\n   * Default to true. If tabbie cannot be enabled due to env, the runtime\n   * should assume active.\n   */\n  @state\n  active = true;\n\n  @action\n  protected _setActive(active: boolean) {\n    this.active = active;\n  }\n\n  @state\n  event: TabEvent = null;\n\n  @action\n  protected _setEvent(event: string, args: any[]) {\n    this.event = {\n      name: event,\n      args,\n    };\n  }\n\n  async onInit() {\n    this._tabbie = new Tabbie({\n      prefix: this._deps.brand.prefix,\n    });\n    if (this._tabbie.enabled) {\n      this._setActive(await this._tabbie.checkIsMain());\n      this._tabbie.on(this._tabbie.events.mainTabIdChanged, async () => {\n        this._setActive(await this._tabbie.checkIsMain());\n      });\n      this._tabbie.on(\n        this._tabbie.events.event,\n        (event: string, ...args: any[]) => {\n          this._setEvent(event, args);\n        },\n      );\n    }\n  }\n\n  send(event: string, ...args: any[]) {\n    this._tabbie.send(event, ...args);\n  }\n\n  async checkIsMain() {\n    return this._tabbie.checkIsMain();\n  }\n\n  checkTabAliveById(id: string) {\n    return this._tabbie.checkTabAliveById(id);\n  }\n\n  get id() {\n    return this._tabbie.id;\n  }\n\n  get hasMultipleTabs() {\n    return this._tabbie.hasMultipleTabs;\n  }\n\n  get tabs() {\n    return this._tabbie.tabs;\n  }\n\n  get isFirstTab() {\n    return this._tabbie.isFirstTab;\n  }\n}\n"],"file":"TabManager.js"}