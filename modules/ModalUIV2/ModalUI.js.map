{"version":3,"sources":["modules/ModalUIV2/ModalUI.tsx"],"names":["ModalUI","name","deps","_modals","currentLocale","_deps","locale","_rendererRegister","Map","_handlerRegister","_promises","registerRenderer","defaultOKRendererID","defaultOKRenderer","defaultCancelRendererID","defaultCancelRenderer","infoTitleRendererID","infoTitleRenderer","modalState","push","idx","item","id","Error","handlerID","args","get","loading","useLoadingOverlay","loadingOverlay","onConfirm","_setLoading","handler","resolve","close","_removeModal","onCancel","set","renderer","props","handlerIDs","oldProps","key","Object","prototype","hasOwnProperty","call","findIndex","_removeHandler","splice","result","oldID","_registerHandler","_genericHandler","oldState","titleProps","contentProps","footerProps","slice","dehydratedState","_dehydrateFunctions","undefined","usePromise","disableBackdropClick","fullScreen","_getDehydratedState","open","_addModal","resolveFn","promise","Promise","updatedState","_updateModal","confirmButtonText","cancelButtonText","variant","modals","title","content","footer","rest","uiProps","_onConfirm","onExited","_onExited","_onCancel","renderedTitle","_rehydrateFunctions","TitleProps","disableTypography","display","space","children","RcUIModuleV2","state","action","proxify","background"],"mappings":"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","sourcesContent":["import {\n  action,\n  computed,\n  RcUIModuleV2,\n  state,\n} from '@ringcentral-integration/core';\nimport { filter, find, findIndex, map } from 'ramda';\nimport background from 'ringcentral-integration/lib/background';\nimport { Module } from 'ringcentral-integration/lib/di';\nimport proxify from 'ringcentral-integration/lib/proxy/proxify';\nimport { v4 } from 'uuid';\n\nimport {\n  ModalProps,\n  ModalV2UIFunctions,\n  ModalV2UIProps,\n} from '../../components/ModalV2/interface';\nimport {\n  AlertModalOptions,\n  ConfirmModalOptions,\n  CustomRenderer,\n  CustomRendererProps,\n  DehydratedModalState,\n  Deps,\n  HandlerFunction,\n  InfoModalOptions,\n  ModalOptions,\n} from './ModalUI.interface';\nimport {\n  defaultCancelRenderer,\n  defaultCancelRendererID,\n  defaultOKRenderer,\n  defaultOKRendererID,\n  infoTitleRenderer,\n  infoTitleRendererID,\n} from './utils';\n\n@Module({\n  name: 'ModalUI',\n  deps: ['Locale'],\n})\nexport class ModalUI extends RcUIModuleV2<Deps> {\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n    this.registerRenderer(defaultOKRendererID, defaultOKRenderer);\n    this.registerRenderer(defaultCancelRendererID, defaultCancelRenderer);\n    this.registerRenderer(infoTitleRendererID, infoTitleRenderer);\n  }\n\n  @state\n  private _modals: DehydratedModalState[] = [];\n\n  @action\n  private _addModal(modalState: DehydratedModalState) {\n    this._modals.push(modalState);\n  }\n\n  @action\n  private _updateModal(modalState: DehydratedModalState) {\n    const idx = findIndex((item) => item.id === modalState.id, this._modals);\n    if (idx === -1) {\n      throw new Error(`modal id \"${modalState.id} not found`);\n    }\n    this._modals[idx] = modalState;\n  }\n\n  @action\n  private _removeModal(id: string) {\n    this._modals = filter((item) => item.id !== id, this._modals);\n  }\n\n  private _rendererRegister = new Map<string, CustomRenderer<any>>();\n  private _handlerRegister = new Map<string, Map<string, HandlerFunction>>();\n  private _promises = new Map<\n    string,\n    { promise: Promise<boolean>; resolve: (ok: boolean) => void }\n  >();\n\n  @proxify\n  private async _genericHandler(id: string, handlerID: string, ...args: any) {\n    return this._handlerRegister.get(id)?.get(handlerID)?.(...args);\n  }\n\n  @action\n  private _setLoading(id: string, loading: boolean) {\n    const idx = findIndex((item) => item.id === id, this._modals);\n    if (this._modals[idx].useLoadingOverlay) {\n      this._modals[idx].loadingOverlay = loading;\n    } else {\n      this._modals[idx].loading = loading;\n    }\n  }\n\n  @proxify\n  private async _onConfirm(id: string, onConfirm?: string) {\n    // here we assume the handler is async and set the loading status\n    // detecting whether the handler is async or not is unreliable and can be dangerous\n    // for most non-async functions the loading status will occur too briefly\n    // so that the UI will not really render the loading status at all\n    this._setLoading(id, true);\n    const handler = this._handlerRegister.get(id).get(onConfirm);\n\n    if (handler && (await handler()) === false) {\n      this._setLoading(id, false);\n      return;\n    }\n\n    this._promises.get(id).resolve(true);\n    this._promises.delete(id);\n    this.close(id);\n  }\n\n  @proxify\n  private async _onExited(id: string) {\n    this._promises.get(id)?.resolve(false);\n    this._promises.delete(id);\n    this._removeModal(id);\n    this._handlerRegister.delete(id);\n  }\n\n  @proxify\n  private async _onCancel(id: string, onCancel?: string) {\n    this._handlerRegister.get(id).get(onCancel)?.();\n    this.close(id);\n  }\n\n  private _registerHandler(id: string, handler: HandlerFunction) {\n    const handlerID = v4();\n    this._handlerRegister.get(id).set(handlerID, handler);\n    return handlerID;\n  }\n\n  private _removeHandler(id: string, handlerID: string) {\n    this._handlerRegister.get(id).delete(handlerID);\n  }\n\n  /**\n   * register render method for custom render if you want\n   *\n   * @example\n   *\n   * ```tsx\n   * const defaultOKRenderer: CustomRenderer = ({ currentLocale }) =>\n   *  <span>{i18n.getString('ok', currentLocale)}</span>\n   * ```\n   */\n  registerRenderer<T extends CustomRendererProps = CustomRendererProps>(\n    id: string,\n    renderer: CustomRenderer<T>,\n  ) {\n    this._rendererRegister.set(id, renderer);\n  }\n\n  private _dehydrateFunctions(\n    id: string,\n    props: any,\n    handlerIDs: string[],\n    oldProps?: any,\n  ): any {\n    if (props === null) {\n      // check oldProps for existing handlers and remove them\n      if (oldProps) {\n        for (const key in oldProps) {\n          if (Object.prototype.hasOwnProperty.call(oldProps, key)) {\n            const idx = handlerIDs.findIndex((id) => id === oldProps[key]);\n            if (idx > -1) {\n              this._removeHandler(id, oldProps[key]);\n              handlerIDs.splice(idx, 1);\n            }\n          }\n        }\n      }\n      return null;\n    }\n    const result = { ...oldProps, ...props };\n    for (const key in props) {\n      if (Object.prototype.hasOwnProperty.call(props, key)) {\n        if (typeof props[key] === 'function') {\n          // check if old handler exist\n          const oldID =\n            oldProps &&\n            oldProps[key] &&\n            find((id) => id === oldProps[key], handlerIDs);\n          if (oldID) {\n            // replace oldHandler\n            this._handlerRegister.get(id).set(oldID, props[key]);\n          } else {\n            const handlerID = this._registerHandler(id, props[key]);\n            handlerIDs.push(handlerID);\n            result[key] = handlerID;\n          }\n        } else if (\n          oldProps &&\n          Object.prototype.hasOwnProperty.call(oldProps, key)\n        ) {\n          const idx = handlerIDs.findIndex((id) => id === oldProps[key]);\n          if (idx > -1) {\n            this._removeHandler(id, oldProps[key]);\n            handlerIDs.splice(idx, 1);\n          }\n        }\n      }\n    }\n    return result;\n  }\n\n  private _rehydrateFunctions(id: string, props: any, handlerIDs: string[]) {\n    const result = { ...props };\n    for (const key in props) {\n      if (\n        Object.prototype.hasOwnProperty.call(props, key) &&\n        findIndex((id) => id === props[key], handlerIDs) > -1\n      ) {\n        result[key] = (...args: any) =>\n          this._genericHandler(id, props[key], ...args);\n      }\n    }\n    return result;\n  }\n\n  private _getDehydratedState(\n    {\n      titleProps,\n      contentProps,\n      footerProps,\n      ...props\n    }: Partial<ModalOptions> & {\n      id: string;\n      open?: boolean;\n    },\n    oldState?: DehydratedModalState,\n  ): DehydratedModalState {\n    const handlerIDs = oldState?.handlerIDs?.slice() ?? [];\n    const dehydratedState: DehydratedModalState = {\n      ...this._dehydrateFunctions(props.id, props, handlerIDs, oldState),\n      handlerIDs,\n    };\n\n    if (titleProps !== undefined) {\n      dehydratedState.titleProps = this._dehydrateFunctions(\n        props.id,\n        titleProps,\n        handlerIDs,\n        oldState?.titleProps,\n      );\n    }\n\n    if (contentProps !== undefined) {\n      dehydratedState.contentProps = this._dehydrateFunctions(\n        props.id,\n        contentProps,\n        handlerIDs,\n        oldState?.contentProps,\n      );\n    }\n\n    if (footerProps !== undefined) {\n      dehydratedState.footerProps = this._dehydrateFunctions(\n        props.id,\n        footerProps,\n        handlerIDs,\n        oldState?.footerProps,\n      );\n    }\n\n    return dehydratedState;\n  }\n\n  public open(props: ModalOptions): string;\n  public open(props: ModalOptions, usePromise: true): Promise<boolean>;\n  @background\n  open(\n    { disableBackdropClick = true, fullScreen = false, ...props }: ModalOptions,\n    usePromise?: boolean,\n  ) {\n    const id = v4();\n    this._handlerRegister.set(id, new Map<string, HandlerFunction>());\n    const dehydratedState = this._getDehydratedState({\n      ...props,\n      id,\n      disableBackdropClick,\n      fullScreen,\n      open: true,\n    });\n\n    this._addModal(dehydratedState);\n\n    let resolveFn;\n\n    const promise = new Promise<boolean>((resolve) => {\n      resolveFn = resolve;\n    });\n\n    this._promises.set(id, {\n      promise,\n      resolve: resolveFn,\n    });\n\n    return usePromise ? promise : id;\n  }\n\n  /**\n   *\n   * @returns Whether the update is successful.\n   */\n  @background\n  update(props: Partial<ModalOptions> & { id: string }) {\n    const oldState = find((item) => item.id === props.id, this._modals);\n    if (!oldState) {\n      return false;\n    }\n    const updatedState = this._getDehydratedState(props, oldState);\n    this._updateModal(updatedState);\n    return true;\n  }\n\n  @background\n  close(id: string) {\n    const dehydratedState = find((item) => item.id === id, this._modals);\n    if (!dehydratedState) {\n      return false;\n    }\n    const updatedState = {\n      ...dehydratedState,\n      open: false,\n    };\n    this._updateModal(updatedState);\n    return true;\n  }\n\n  public confirm(props: ConfirmModalOptions): string;\n  public confirm(\n    props: ConfirmModalOptions,\n    usePromise: true,\n  ): Promise<boolean>;\n  @background\n  confirm(props: ConfirmModalOptions = {}, usePromise?: true) {\n    return this.open(\n      {\n        confirmButtonText: defaultOKRendererID,\n        cancelButtonText: defaultCancelRendererID,\n        ...props,\n        variant: 'confirm',\n      },\n      usePromise,\n    ) as any;\n  }\n\n  public alert(props: AlertModalOptions): string;\n  public alert(props: AlertModalOptions, usePromise: true): Promise<boolean>;\n  @background\n  alert(props: AlertModalOptions = {}, usePromise?: true) {\n    return this.open(\n      {\n        confirmButtonText: defaultOKRendererID,\n        ...props,\n        variant: 'alert',\n      },\n      usePromise,\n    ) as any;\n  }\n\n  public info(props: InfoModalOptions): string;\n  public info(props: InfoModalOptions, usePromise: true): Promise<boolean>;\n  @background\n  info(props: InfoModalOptions, usePromise?: true) {\n    return this.open(\n      {\n        ...props,\n        variant: 'info',\n      },\n      usePromise,\n    ) as any;\n  }\n\n  @computed(({ _modals, _deps: { locale: { currentLocale } } }: ModalUI) => [\n    _modals,\n    currentLocale,\n  ])\n  get modals() {\n    const currentLocale = this._deps.locale.currentLocale;\n    return map(\n      ({\n        id,\n        onConfirm,\n        onCancel,\n        title,\n        content,\n        footer,\n        confirmButtonText,\n        cancelButtonText,\n        titleProps = {},\n        contentProps = {},\n        footerProps = {},\n        variant,\n        handlerIDs,\n        // * just pick this field out of rest\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        useLoadingOverlay,\n        ...rest\n      }) => {\n        const uiProps: ModalProps = {\n          ...rest,\n          key: id,\n          onConfirm: () => this._onConfirm(id, onConfirm),\n          onExited: () => this._onExited(id),\n        };\n\n        if (onCancel || cancelButtonText) {\n          uiProps.onCancel = () => this._onCancel(id, onCancel);\n        }\n\n        const renderedTitle =\n          this._rendererRegister.get(title)?.({\n            currentLocale,\n            ...this._rehydrateFunctions(id, titleProps, handlerIDs),\n            onConfirm: uiProps.onConfirm,\n            onCancel: uiProps.onCancel,\n          }) ?? title;\n\n        if (variant === 'info') {\n          uiProps.title = this._rendererRegister.get(infoTitleRendererID)({\n            title: renderedTitle,\n            onConfirm: uiProps.onConfirm,\n            currentLocale,\n          });\n          uiProps.TitleProps = {\n            disableTypography: true,\n            display: 'flex',\n            space: [0, 6],\n          };\n        } else {\n          uiProps.title = renderedTitle;\n        }\n\n        uiProps.children =\n          this._rendererRegister.get(content)?.({\n            currentLocale,\n            ...this._rehydrateFunctions(id, contentProps, handlerIDs),\n            onConfirm: uiProps.onConfirm,\n            onCancel: uiProps.onCancel,\n          }) ?? content;\n\n        uiProps.footer =\n          variant === 'info'\n            ? null\n            : this._rendererRegister.get(footer)?.({\n                currentLocale,\n                ...this._rehydrateFunctions(id, footerProps, handlerIDs),\n                onConfirm: uiProps.onConfirm,\n                onCancel: uiProps.onCancel,\n              }) ?? footer;\n\n        uiProps.confirmButtonText =\n          (this._rendererRegister.get(confirmButtonText)?.({\n            currentLocale,\n            onConfirm: uiProps.onConfirm,\n            onCancel: uiProps.onCancel,\n          }) as string) ?? confirmButtonText;\n\n        uiProps.cancelButtonText =\n          (this._rendererRegister.get(cancelButtonText)?.({\n            currentLocale,\n            onConfirm: uiProps.onConfirm,\n            onCancel: uiProps.onCancel,\n          }) as string) ?? cancelButtonText;\n\n        return uiProps;\n      },\n      this._modals,\n    );\n  }\n\n  @background\n  getPromise(id: string) {\n    return this._promises.get(id).promise;\n  }\n\n  getUIFunctions(): ModalV2UIFunctions {\n    return {};\n  }\n\n  getUIProps(): ModalV2UIProps {\n    return {\n      modals: this.modals,\n    };\n  }\n}\n"],"file":"ModalUI.js"}