{"version":3,"sources":["modules/CallLogUI/CallLogUI.tsx"],"names":["CallLogUI","name","deps","dep","optional","options","_deps","locale","callLogger","rateLimiter","regionSettings","dateTimeFormat","callLogSection","routerInteraction","activeCallControl","environmentOptions","rolesAndPermissions","connectivityMonitor","callingSettings","forwardingNumber","currentNotificationIdentify","currentIdentify","isInTransferPage","currentPath","match","currentLocale","header","showSpinner","ready","disableLinks","connectivity","throttling","currentSession","getActiveSession","sessionIdToTelephonySessionIdMapping","activeSession","isWebRTC","callWith","callingOptions","browser","forwardingNumbers","formatPhone","phoneNumber","areaCode","countryCode","goBack","closeLogSection","renderCallLogCallControl","currentTelephonySessionId","isWide","isCurrentDeviceCall","onSaveNotification","saveAndHandleNotification","onDiscardNotification","discardAndHandleNotification","onCloseNotification","closeLogNotification","onExpandNotification","expandLogNotification","onReject","sessionId","telephonySessionId","reject","onHangup","hangUp","onIgnore","ignore","onForward","push","forward","endAndAnswer","answerAndEnd","holdAndAnswer","answerAndHold","toVoicemail","answer","RcUIModuleV2"],"mappings":"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","sourcesContent":["import { RcUIModuleV2 } from '@ringcentral-integration/core';\nimport { Module } from 'ringcentral-integration/lib/di';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport { callingOptions } from 'ringcentral-integration/modules/CallingSettingsV2/callingOptions';\nimport React from 'react';\nimport {\n  CallLogUIInterface,\n  Deps,\n  CallLogUIProps,\n  CallLogUIFunctions,\n} from './CallLogUI.interface';\n\nimport CallLogCallCtrlContainer from '../../containers/CallLogCallCtrlContainer';\n\n@Module({\n  name: 'CallLogUI',\n  deps: [\n    'Locale',\n    'CallLogger',\n    'RateLimiter',\n    'RegionSettings',\n    'DateTimeFormat',\n    'CallLogSection',\n    'RouterInteraction',\n    'ActiveCallControl',\n    'EnvironmentOptions',\n    'RolesAndPermissions',\n    'ConnectivityMonitor',\n    'CallingSettings',\n    'ForwardingNumber',\n    { dep: 'CallLogUIOptions', optional: true },\n  ],\n})\nclass CallLogUI<T = {}>\n  extends RcUIModuleV2<Deps & T>\n  implements CallLogUIInterface {\n  constructor({ deps = {}, ...options }: Deps & { deps: Record<string, any> }) {\n    super({\n      deps: {\n        ...options,\n        ...deps,\n      },\n    });\n  }\n\n  getUIProps(): CallLogUIProps {\n    const {\n      locale,\n      callLogger,\n      rateLimiter,\n      regionSettings,\n      dateTimeFormat,\n      callLogSection,\n      routerInteraction,\n      activeCallControl,\n      environmentOptions,\n      rolesAndPermissions,\n      connectivityMonitor,\n      callingSettings,\n      forwardingNumber,\n    } = this._deps;\n    const { currentNotificationIdentify, currentIdentify } = callLogSection;\n    const isInTransferPage =\n      routerInteraction.currentPath.match('^/transfer/') !== null;\n\n    return {\n      currentLocale: locale.currentLocale,\n      header: true,\n      showSpinner: !(\n        locale.ready &&\n        regionSettings.ready &&\n        dateTimeFormat.ready &&\n        (!rolesAndPermissions || rolesAndPermissions.ready) &&\n        (!callLogger || callLogger.ready)\n      ),\n      isInTransferPage,\n      disableLinks: !connectivityMonitor.connectivity || rateLimiter.throttling,\n      currentIdentify,\n      // notification props\n      currentNotificationIdentify,\n      currentSession: activeCallControl.getActiveSession(\n        activeCallControl.sessionIdToTelephonySessionIdMapping[\n          currentNotificationIdentify\n        ],\n      ),\n      activeSession: activeCallControl.activeSession,\n      isWebRTC: callingSettings.callWith === callingOptions.browser,\n      forwardingNumbers: forwardingNumber.forwardingNumbers,\n    };\n  }\n\n  getUIFunctions(): CallLogUIFunctions {\n    const {\n      regionSettings,\n      callLogSection,\n      locale,\n      activeCallControl,\n      routerInteraction,\n    } = this._deps;\n    return {\n      formatPhone: (phoneNumber: string) =>\n        formatNumber({\n          phoneNumber,\n          areaCode: regionSettings.areaCode,\n          countryCode: regionSettings.countryCode,\n        }) || 'Unknown',\n      goBack: () => callLogSection.closeLogSection(),\n      renderCallLogCallControl: (\n        currentTelephonySessionId,\n        isWide,\n        isCurrentDeviceCall,\n      ) => (\n        <CallLogCallCtrlContainer\n          currentLocale={locale.currentLocale}\n          telephonySessionId={currentTelephonySessionId}\n          isCurrentDeviceCall={isCurrentDeviceCall}\n          isWide={isWide}\n        />\n      ),\n      // notification props\n      onSaveNotification: () => callLogSection.saveAndHandleNotification(),\n      onDiscardNotification: () =>\n        callLogSection.discardAndHandleNotification(),\n      onCloseNotification: () => callLogSection.closeLogNotification(),\n      onExpandNotification: () => callLogSection.expandLogNotification(),\n      onReject(sessionId) {\n        const telephonySessionId =\n          activeCallControl.sessionIdToTelephonySessionIdMapping[sessionId];\n        return activeCallControl.reject(telephonySessionId);\n      },\n      onHangup(sessionId) {\n        const telephonySessionId =\n          activeCallControl.sessionIdToTelephonySessionIdMapping[sessionId];\n        return activeCallControl.hangUp(telephonySessionId);\n      },\n      onIgnore: (telephonySessionId: string) => {\n        callLogSection.closeLogNotification();\n        activeCallControl.ignore?.(telephonySessionId);\n      },\n      onForward: (phoneNumber: string, telephonySessionId: string) => {\n        if (phoneNumber === 'custom') {\n          routerInteraction.push(`/forward/${telephonySessionId}`);\n        } else {\n          callLogSection.closeLogNotification();\n          activeCallControl.forward?.(phoneNumber, telephonySessionId);\n        }\n      },\n      endAndAnswer: (telephonySessionId: string) => {\n        callLogSection.discardAndHandleNotification();\n        activeCallControl.answerAndEnd?.(telephonySessionId);\n      },\n      holdAndAnswer: (telephonySessionId: string) => {\n        callLogSection.discardAndHandleNotification();\n        activeCallControl.answerAndHold?.(telephonySessionId);\n      },\n      toVoicemail: (telephonySessionId: string) => {\n        callLogSection.closeLogNotification();\n        activeCallControl.reject(telephonySessionId);\n      },\n      answer: (telephonySessionId: string) => {\n        callLogSection.discardAndHandleNotification();\n        activeCallControl.answer?.(telephonySessionId);\n      },\n    };\n  }\n}\n\nexport { CallLogUI };\n"],"file":"CallLogUI.js"}