{"version":3,"sources":["modules/CallLogUI/CallLogUI.tsx"],"names":["CallLogUI","name","deps","dep","optional","options","_deps","locale","callLogger","rateLimiter","regionSettings","dateTimeFormat","callLogSection","routerInteraction","activeCallControl","rolesAndPermissions","connectivityMonitor","callingSettings","forwardingNumber","currentNotificationIdentify","currentIdentify","isInTransferPage","currentPath","match","currentLocale","header","showSpinner","ready","disableLinks","connectivity","throttling","currentSession","getActiveSession","sessionIdToTelephonySessionIdMapping","activeSession","isWebRTC","callWith","callingOptions","browser","forwardingNumbers","formatPhone","phoneNumber","areaCode","countryCode","goBack","closeLogSection","renderCallLogCallControl","currentTelephonySessionId","isWide","isCurrentDeviceCall","onSaveNotification","saveAndHandleNotification","onDiscardNotification","discardAndHandleNotification","onCloseNotification","closeLogNotification","onExpandNotification","expandLogNotification","onReject","sessionId","telephonySessionId","reject","onHangup","hangUp","onIgnore","ignore","onForward","push","forward","endAndAnswer","answerAndEnd","holdAndAnswer","answerAndHold","toVoicemail","answer","clickForwardTrack","RcUIModuleV2"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AAQA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAoBMA,S,WAlBL,gBAAO;AACNC,EAAAA,IAAI,EAAE,WADA;AAENC,EAAAA,IAAI,EAAE,CACJ,QADI,EAEJ,YAFI,EAGJ,aAHI,EAIJ,gBAJI,EAKJ,gBALI,EAMJ,gBANI,EAOJ,mBAPI,EAQJ,mBARI,EASJ,qBATI,EAUJ,qBAVI,EAWJ,iBAXI,EAYJ,kBAZI,EAaJ;AAAEC,IAAAA,GAAG,EAAE,kBAAP;AAA2BC,IAAAA,QAAQ,EAAE;AAArC,GAbI;AAFA,CAAP,C;;;;;AAqBC,2BAA6E;AAAA,yBAA/DF,IAA+D;AAAA,QAA/DA,IAA+D,0BAAxD,EAAwD;AAAA,QAAjDG,OAAiD;;AAAA;;AAAA,6BACrE;AACJH,MAAAA,IAAI,kCACCG,OADD,GAECH,IAFD;AADA,KADqE;AAO5E;;;;iCAE4B;AAAA,wBAcvB,KAAKI,KAdkB;AAAA,UAEzBC,MAFyB,eAEzBA,MAFyB;AAAA,UAGzBC,UAHyB,eAGzBA,UAHyB;AAAA,UAIzBC,WAJyB,eAIzBA,WAJyB;AAAA,UAKzBC,cALyB,eAKzBA,cALyB;AAAA,UAMzBC,cANyB,eAMzBA,cANyB;AAAA,UAOzBC,cAPyB,eAOzBA,cAPyB;AAAA,UAQzBC,iBARyB,eAQzBA,iBARyB;AAAA,UASzBC,iBATyB,eASzBA,iBATyB;AAAA,UAUzBC,mBAVyB,eAUzBA,mBAVyB;AAAA,UAWzBC,mBAXyB,eAWzBA,mBAXyB;AAAA,UAYzBC,eAZyB,eAYzBA,eAZyB;AAAA,UAazBC,gBAbyB,eAazBA,gBAbyB;AAAA,UAenBC,2BAfmB,GAe8BP,cAf9B,CAenBO,2BAfmB;AAAA,UAeUC,eAfV,GAe8BR,cAf9B,CAeUQ,eAfV;AAgB3B,UAAMC,gBAAgB,GACpBR,iBAAiB,CAACS,WAAlB,CAA8BC,KAA9B,CAAoC,aAApC,MAAuD,IADzD;AAGA,aAAO;AACLC,QAAAA,aAAa,EAAEjB,MAAM,CAACiB,aADjB;AAELC,QAAAA,MAAM,EAAE,IAFH;AAGLC,QAAAA,WAAW,EAAE,EACXnB,MAAM,CAACoB,KAAP,IACAjB,cAAc,CAACiB,KADf,IAEAhB,cAAc,CAACgB,KAFf,KAGC,CAACZ,mBAAD,IAAwBA,mBAAmB,CAACY,KAH7C,MAIC,CAACnB,UAAD,IAAeA,UAAU,CAACmB,KAJ3B,CADW,CAHR;AAULN,QAAAA,gBAAgB,EAAhBA,gBAVK;AAWLO,QAAAA,YAAY,EAAE,CAACZ,mBAAmB,CAACa,YAArB,IAAqCpB,WAAW,CAACqB,UAX1D;AAYLV,QAAAA,eAAe,EAAfA,eAZK;AAaL;AACAD,QAAAA,2BAA2B,EAA3BA,2BAdK;AAeLY,QAAAA,cAAc,EAAEjB,iBAAiB,CAACkB,gBAAlB,CACdlB,iBAAiB,CAACmB,oCAAlB,CACEd,2BADF,CADc,CAfX;AAoBLe,QAAAA,aAAa,EAAEpB,iBAAiB,CAACoB,aApB5B;AAqBLC,QAAAA,QAAQ,EAAElB,eAAe,CAACmB,QAAhB,KAA6BC,+BAAeC,OArBjD;AAsBLC,QAAAA,iBAAiB,EAAErB,gBAAgB,CAACqB;AAtB/B,OAAP;AAwBD;;;qCAEoC;AAAA,yBAO/B,KAAKjC,KAP0B;AAAA,UAEjCI,cAFiC,gBAEjCA,cAFiC;AAAA,UAGjCE,cAHiC,gBAGjCA,cAHiC;AAAA,UAIjCL,MAJiC,gBAIjCA,MAJiC;AAAA,UAKjCO,iBALiC,gBAKjCA,iBALiC;AAAA,UAMjCD,iBANiC,gBAMjCA,iBANiC;AAQnC,aAAO;AACL2B,QAAAA,WAAW,EAAE,qBAACC,WAAD;AAAA,iBACX,8BAAa;AACXA,YAAAA,WAAW,EAAXA,WADW;AAEXC,YAAAA,QAAQ,EAAEhC,cAAc,CAACgC,QAFd;AAGXC,YAAAA,WAAW,EAAEjC,cAAc,CAACiC;AAHjB,WAAb,KAIM,SALK;AAAA,SADR;AAOLC,QAAAA,MAAM,EAAE;AAAA,iBAAMhC,cAAc,CAACiC,eAAf,EAAN;AAAA,SAPH;AAQLC,QAAAA,wBAAwB,EAAE,kCACxBC,yBADwB,EAExBC,MAFwB,EAGxBC,mBAHwB;AAAA,8BAKxB,gCAAC,oCAAD;AACE,YAAA,aAAa,EAAE1C,MAAM,CAACiB,aADxB;AAEE,YAAA,kBAAkB,EAAEuB,yBAFtB;AAGE,YAAA,mBAAmB,EAAEE,mBAHvB;AAIE,YAAA,MAAM,EAAED;AAJV,YALwB;AAAA,SARrB;AAoBL;AACAE,QAAAA,kBAAkB,EAAE;AAAA,iBAAMtC,cAAc,CAACuC,yBAAf,EAAN;AAAA,SArBf;AAsBLC,QAAAA,qBAAqB,EAAE;AAAA,iBACrBxC,cAAc,CAACyC,4BAAf,EADqB;AAAA,SAtBlB;AAwBLC,QAAAA,mBAAmB,EAAE;AAAA,iBAAM1C,cAAc,CAAC2C,oBAAf,EAAN;AAAA,SAxBhB;AAyBLC,QAAAA,oBAAoB,EAAE;AAAA,iBAAM5C,cAAc,CAAC6C,qBAAf,EAAN;AAAA,SAzBjB;AA0BLC,QAAAA,QA1BK,oBA0BIC,SA1BJ,EA0Be;AAClB,cAAMC,kBAAkB,GACtB9C,iBAAiB,CAACmB,oCAAlB,CAAuD0B,SAAvD,CADF;AAEA,iBAAO7C,iBAAiB,CAAC+C,MAAlB,CAAyBD,kBAAzB,CAAP;AACD,SA9BI;AA+BLE,QAAAA,QA/BK,oBA+BIH,SA/BJ,EA+Be;AAClB,cAAMC,kBAAkB,GACtB9C,iBAAiB,CAACmB,oCAAlB,CAAuD0B,SAAvD,CADF;AAEA,iBAAO7C,iBAAiB,CAACiD,MAAlB,CAAyBH,kBAAzB,CAAP;AACD,SAnCI;AAoCLI,QAAAA,QAAQ,EAAE,kBAACJ,kBAAD,EAAgC;AAAA;;AACxC,mCAAA9C,iBAAiB,CAACmD,MAAlB,qFAAAnD,iBAAiB,EAAU8C,kBAAV,CAAjB;AACAhD,UAAAA,cAAc,CAAC2C,oBAAf;AACD,SAvCI;AAwCLW,QAAAA,SAAS,EAAE,mBAACzB,WAAD,EAAsBmB,kBAAtB,EAAqD;AAC9D,cAAInB,WAAW,KAAK,QAApB,EAA8B;AAC5B5B,YAAAA,iBAAiB,CAACsD,IAAlB,oBAAmCP,kBAAnC;AACD,WAFD,MAEO;AAAA;;AACL,qCAAA9C,iBAAiB,CAACsD,OAAlB,qFAAAtD,iBAAiB,EAAW2B,WAAX,EAAwBmB,kBAAxB,CAAjB;AACAhD,YAAAA,cAAc,CAAC2C,oBAAf;AACD;AACF,SA/CI;AAgDLc,QAAAA,YAAY,EAAE,sBAACT,kBAAD,EAAgC;AAAA;;AAC5C,mCAAA9C,iBAAiB,CAACwD,YAAlB,qFAAAxD,iBAAiB,EAAgB8C,kBAAhB,CAAjB;AACAhD,UAAAA,cAAc,CAACyC,4BAAf;AACD,SAnDI;AAoDLkB,QAAAA,aAAa,EAAE,uBAACX,kBAAD,EAAgC;AAAA;;AAC7C,oCAAA9C,iBAAiB,CAAC0D,aAAlB,uFAAA1D,iBAAiB,EAAiB8C,kBAAjB,CAAjB;AACAhD,UAAAA,cAAc,CAACyC,4BAAf;AACD,SAvDI;AAwDLoB,QAAAA,WAAW,EAAE,qBAACb,kBAAD,EAAgC;AAC3C9C,UAAAA,iBAAiB,CAAC+C,MAAlB,CAAyBD,kBAAzB;AACAhD,UAAAA,cAAc,CAAC2C,oBAAf;AACD,SA3DI;AA4DLmB,QAAAA,MAAM,EAAE,gBAACd,kBAAD,EAAgC;AAAA;;AACtC,oCAAA9C,iBAAiB,CAAC4D,MAAlB,uFAAA5D,iBAAiB,EAAU8C,kBAAV,CAAjB;AACAhD,UAAAA,cAAc,CAACyC,4BAAf;AACD,SA/DI;AAgELsB,QAAAA,iBAAiB,EAAE;AAAA;;AAAA,0CAAM7D,iBAAiB,CAAC6D,iBAAxB,0DAAM,2BAAA7D,iBAAiB,CAAvB;AAAA;AAhEd,OAAP;AAkED;;;;EAlIO8D,kB","sourcesContent":["import { RcUIModuleV2 } from '@ringcentral-integration/core';\nimport { Module } from 'ringcentral-integration/lib/di';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport { callingOptions } from 'ringcentral-integration/modules/CallingSettingsV2/callingOptions';\nimport React from 'react';\nimport {\n  CallLogUIInterface,\n  Deps,\n  CallLogUIProps,\n  CallLogUIFunctions,\n} from './CallLogUI.interface';\n\nimport CallLogCallCtrlContainer from '../../containers/CallLogCallCtrlContainer';\n\n@Module({\n  name: 'CallLogUI',\n  deps: [\n    'Locale',\n    'CallLogger',\n    'RateLimiter',\n    'RegionSettings',\n    'DateTimeFormat',\n    'CallLogSection',\n    'RouterInteraction',\n    'ActiveCallControl',\n    'RolesAndPermissions',\n    'ConnectivityMonitor',\n    'CallingSettings',\n    'ForwardingNumber',\n    { dep: 'CallLogUIOptions', optional: true },\n  ],\n})\nclass CallLogUI<T = {}>\n  extends RcUIModuleV2<Deps & T>\n  implements CallLogUIInterface {\n  constructor({ deps = {}, ...options }: Deps & { deps: Record<string, any> }) {\n    super({\n      deps: {\n        ...options,\n        ...deps,\n      },\n    });\n  }\n\n  getUIProps(): CallLogUIProps {\n    const {\n      locale,\n      callLogger,\n      rateLimiter,\n      regionSettings,\n      dateTimeFormat,\n      callLogSection,\n      routerInteraction,\n      activeCallControl,\n      rolesAndPermissions,\n      connectivityMonitor,\n      callingSettings,\n      forwardingNumber,\n    } = this._deps;\n    const { currentNotificationIdentify, currentIdentify } = callLogSection;\n    const isInTransferPage =\n      routerInteraction.currentPath.match('^/transfer/') !== null;\n\n    return {\n      currentLocale: locale.currentLocale,\n      header: true,\n      showSpinner: !(\n        locale.ready &&\n        regionSettings.ready &&\n        dateTimeFormat.ready &&\n        (!rolesAndPermissions || rolesAndPermissions.ready) &&\n        (!callLogger || callLogger.ready)\n      ),\n      isInTransferPage,\n      disableLinks: !connectivityMonitor.connectivity || rateLimiter.throttling,\n      currentIdentify,\n      // notification props\n      currentNotificationIdentify,\n      currentSession: activeCallControl.getActiveSession(\n        activeCallControl.sessionIdToTelephonySessionIdMapping[\n          currentNotificationIdentify\n        ],\n      ),\n      activeSession: activeCallControl.activeSession,\n      isWebRTC: callingSettings.callWith === callingOptions.browser,\n      forwardingNumbers: forwardingNumber.forwardingNumbers,\n    };\n  }\n\n  getUIFunctions(): CallLogUIFunctions {\n    const {\n      regionSettings,\n      callLogSection,\n      locale,\n      activeCallControl,\n      routerInteraction,\n    } = this._deps;\n    return {\n      formatPhone: (phoneNumber: string) =>\n        formatNumber({\n          phoneNumber,\n          areaCode: regionSettings.areaCode,\n          countryCode: regionSettings.countryCode,\n        }) || 'Unknown',\n      goBack: () => callLogSection.closeLogSection(),\n      renderCallLogCallControl: (\n        currentTelephonySessionId,\n        isWide,\n        isCurrentDeviceCall,\n      ) => (\n        <CallLogCallCtrlContainer\n          currentLocale={locale.currentLocale}\n          telephonySessionId={currentTelephonySessionId}\n          isCurrentDeviceCall={isCurrentDeviceCall}\n          isWide={isWide}\n        />\n      ),\n      // notification props\n      onSaveNotification: () => callLogSection.saveAndHandleNotification(),\n      onDiscardNotification: () =>\n        callLogSection.discardAndHandleNotification(),\n      onCloseNotification: () => callLogSection.closeLogNotification(),\n      onExpandNotification: () => callLogSection.expandLogNotification(),\n      onReject(sessionId) {\n        const telephonySessionId =\n          activeCallControl.sessionIdToTelephonySessionIdMapping[sessionId];\n        return activeCallControl.reject(telephonySessionId);\n      },\n      onHangup(sessionId) {\n        const telephonySessionId =\n          activeCallControl.sessionIdToTelephonySessionIdMapping[sessionId];\n        return activeCallControl.hangUp(telephonySessionId);\n      },\n      onIgnore: (telephonySessionId: string) => {\n        activeCallControl.ignore?.(telephonySessionId);\n        callLogSection.closeLogNotification();\n      },\n      onForward: (phoneNumber: string, telephonySessionId: string) => {\n        if (phoneNumber === 'custom') {\n          routerInteraction.push(`/forward/${telephonySessionId}`);\n        } else {\n          activeCallControl.forward?.(phoneNumber, telephonySessionId);\n          callLogSection.closeLogNotification();\n        }\n      },\n      endAndAnswer: (telephonySessionId: string) => {\n        activeCallControl.answerAndEnd?.(telephonySessionId);\n        callLogSection.discardAndHandleNotification();\n      },\n      holdAndAnswer: (telephonySessionId: string) => {\n        activeCallControl.answerAndHold?.(telephonySessionId);\n        callLogSection.discardAndHandleNotification();\n      },\n      toVoicemail: (telephonySessionId: string) => {\n        activeCallControl.reject(telephonySessionId);\n        callLogSection.closeLogNotification();\n      },\n      answer: (telephonySessionId: string) => {\n        activeCallControl.answer?.(telephonySessionId);\n        callLogSection.discardAndHandleNotification();\n      },\n      clickForwardTrack: () => activeCallControl.clickForwardTrack?.(),\n    };\n  }\n}\n\nexport { CallLogUI };\n"],"file":"CallLogUI.js"}