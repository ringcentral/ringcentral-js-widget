{"version":3,"sources":["modules/EvSettingsUI/EvSettingsUI.ts"],"names":["LOGIN_TYPE","RC_PHONE","RC_SOFTPHONE","RC_EXTERNAL","EvSettingsUI","name","deps","that","_deps","locale","currentLocale","evAuth","agentSettings","loginDTS","loginType","dialDest","inboundSettings","skillProfile","routerInteraction","push","version","agentName","userName","agent","agentConfig","username","sessionInfo","showEditSessionButton","evCallMonitor","isOnCall","onLogout","logout","goToSessionUpdatePage","split","phoneNumber","type","formatedPhoneNumber","loginTime","format","getLocalString","i18n","getString","profileName","label","value","firstName","lastName","RcUIModuleV2"],"mappings":"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","sourcesContent":["import { computed, RcUIModuleV2 } from '@ringcentral-integration/core';\nimport moment from 'moment';\nimport { Module } from 'ringcentral-integration/lib/di';\n\nimport {\n  EvSettingsUIFunctions,\n  EvSettingsUIProps,\n  SessionInfo,\n} from '../../interfaces/EvSettingsUI.interface';\nimport { formatPhoneNumber } from '../../lib/FormatPhoneNumber';\nimport { Deps, SettingsUI } from './EvSettingsUI.interface';\nimport i18n from './i18n';\n\nconst LOGIN_TYPE = {\n  RC_PHONE: 'ringCentralPhone',\n  RC_SOFTPHONE: 'integratedPhone',\n  RC_EXTERNAL: 'externalPhone',\n};\n\ntype LoginType = keyof typeof LOGIN_TYPE;\n\n@Module({\n  name: 'EvSettingsUI',\n  deps: [\n    'EvClient',\n    'Locale',\n    'RouterInteraction',\n    'EvAuth',\n    'EvSettings',\n    'Version',\n    'EvCallMonitor',\n  ],\n})\nclass EvSettingsUI extends RcUIModuleV2<Deps> implements SettingsUI {\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  @computed((that: EvSettingsUI) => [\n    that._deps.locale.currentLocale,\n    that._deps.evAuth.agentSettings.loginDTS,\n    that._deps.evAuth.agentSettings.loginType,\n    that._deps.evAuth.agentSettings.dialDest,\n    that._deps.evAuth.inboundSettings.skillProfile,\n  ])\n  get sessionInfo(): SessionInfo {\n    const { loginDTS, loginType, dialDest } = this._deps.evAuth.agentSettings;\n\n    const [phoneNumber, type = 'RC_EXTERNAL'] = dialDest.split('@');\n\n    // TODO: find that why reponse empty phoneNumber by accident\n    const formatedPhoneNumber = formatPhoneNumber({\n      phoneNumber,\n      currentLocale: this._deps.locale.currentLocale,\n    });\n\n    const loginTime = moment(loginDTS).format('M/DD/YY h:mm A');\n\n    const getLocalString = (name: string) =>\n      i18n.getString(name, this._deps.locale.currentLocale);\n\n    const profileName =\n      this._deps.evAuth.inboundSettings.skillProfile?.profileName ??\n      getLocalString('noneSkillProfile');\n\n    return [\n      {\n        label: getLocalString(LOGIN_TYPE[type as LoginType]),\n        value: formatedPhoneNumber,\n      },\n      {\n        label: getLocalString('loginStyle'),\n        value: loginType,\n      },\n      {\n        label: getLocalString('loginTime'),\n        value: loginTime,\n      },\n      {\n        label: getLocalString('skillProfile'),\n        value: profileName,\n      },\n    ];\n  }\n\n  goToSessionUpdatePage() {\n    this._deps.routerInteraction.push('/sessionUpdate');\n  }\n\n  get agentName() {\n    const {\n      firstName,\n      lastName,\n    } = this._deps.evAuth.agent.agentConfig.agentSettings;\n    if (!firstName && !lastName) {\n      return null;\n    }\n    return `${firstName} ${lastName}`;\n  }\n\n  getUIProps(): EvSettingsUIProps {\n    return {\n      currentLocale: this._deps.locale.currentLocale,\n      version: this._deps.version,\n      agentName: this.agentName,\n      userName: this._deps.evAuth.agent.agentConfig.agentSettings.username,\n      sessionInfo: this.sessionInfo,\n      showEditSessionButton: !this._deps.evCallMonitor.isOnCall,\n    };\n  }\n\n  getUIFunctions(): EvSettingsUIFunctions {\n    return {\n      onLogout: () => this._deps.evAuth.logout(),\n      goToSessionUpdatePage: () => this.goToSessionUpdatePage(),\n    };\n  }\n}\nexport { EvSettingsUI };\n"],"file":"EvSettingsUI.js"}