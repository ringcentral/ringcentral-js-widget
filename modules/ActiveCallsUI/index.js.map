{"version":3,"sources":["modules/ActiveCallsUI/index.js"],"names":["ActiveCallsUI","name","deps","dep","optional","brand","callLogger","callMonitor","locale","regionSettings","rolesAndPermissions","conferenceCall","callingSettings","connectivityMonitor","rateLimiter","activeCallControl","webphone","routerInteraction","composeText","contactSearch","contactMatcher","contactDetailsUI","options","_brand","_callLogger","_callMonitor","_locale","_regionSettings","_rolesAndPermissions","_conferenceCall","_callingSettings","_connectivityMonitor","_rateLimiter","_activeCallControl","_webphone","_routerInteraction","_composeText","_contactSearch","_contactMatcher","_contactDetailsUI","showContactDisplayPlaceholder","showRingoutCallControl","showSwitchCall","useV2","isWebRTC","callingMode","callingModes","controlBusy","busy","currentLocale","activeRingCalls","activeOnHoldCalls","activeCurrentCalls","otherDeviceCalls","areaCode","countryCode","outboundSmsPermission","permissions","OutboundSMS","internalSmsPermission","InternalSMS","showSpinner","isMerging","fullName","connected","autoLog","conferenceCallParties","partyProfiles","disableLinks","connectivity","throttling","composeTextRoute","callCtrlRoute","onCreateContact","onLogCall","isLoggedContact","onCallsEmpty","onViewContact","showViewContact","getAvatarUrl","formatPhone","phoneNumber","webphoneAnswer","sessionId","session","sessions","find","id","direction","callDirections","inbound","closeMergingPair","answer","webphoneToVoicemail","toVoiceMail","webphoneReject","reject","webphoneHangup","allCallsClickHangupTrack","hangup","webphoneResume","resume","currentPath","push","webphoneHold","allCallsClickHoldTrack","hold","webphoneSwitchCall","activeCall","switchCall","homeCountryId","ringoutHangup","hangUp","ringoutTransfer","ringoutReject","allCallsClickRejectTrack","contact","type","showContactDetails","direct","onClickToSms","isDummyContact","clean","updateTypingToNumber","search","searchString","addToRecipients","undefined","entityType","hasMatchNumber","ignoreCache","forceMatchNumber","call","redirect","logCall","length","isSessionAConferenceCall","isConferenceSession","onCallItemClick","webphoneSession","telephonySessionId","callItemClickTrack","toggleMinimized","updateSessionMatchedContact","RcUIModule"],"mappings":"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","sourcesContent":["import { Module } from 'ringcentral-integration/lib/di';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport { isRingingInboundCall } from 'ringcentral-integration/lib/callLogHelpers';\nimport callingModes from 'ringcentral-integration/modules/CallingSettings/callingModes';\nimport RcUIModule from '../../lib/RcUIModule';\n\n@Module({\n  name: 'ActiveCallsUI',\n  deps: [\n    'Brand',\n    { dep: 'CallLogger', optional: true },\n    { dep: 'ContactDetailsUI', optional: true },\n    'CallMonitor',\n    'Locale',\n    'RegionSettings',\n    'RolesAndPermissions',\n    { dep: 'ConferenceCall', optional: true },\n    'CallingSettings',\n    'ConnectivityMonitor',\n    'RateLimiter',\n    { dep: 'ActiveCallControl', optional: true },\n    { dep: 'Webphone', optional: true },\n    'RouterInteraction',\n    { dep: 'ComposeText', optional: true },\n    'ContactSearch',\n    'ContactMatcher',\n  ],\n})\nexport default class ActiveCallsUI extends RcUIModule {\n  constructor({\n    brand,\n    callLogger,\n    callMonitor,\n    locale,\n    regionSettings,\n    rolesAndPermissions,\n    conferenceCall,\n    callingSettings,\n    connectivityMonitor,\n    rateLimiter,\n    activeCallControl,\n    webphone,\n    routerInteraction,\n    composeText,\n    contactSearch,\n    contactMatcher,\n    contactDetailsUI,\n    ...options\n  }) {\n    super({\n      ...options,\n    });\n    this._brand = brand;\n    this._callLogger = callLogger;\n    this._callMonitor = callMonitor;\n    this._locale = locale;\n    this._regionSettings = regionSettings;\n    this._rolesAndPermissions = rolesAndPermissions;\n    this._conferenceCall = conferenceCall;\n    this._callingSettings = callingSettings;\n    this._connectivityMonitor = connectivityMonitor;\n    this._rateLimiter = rateLimiter;\n    this._activeCallControl = activeCallControl;\n    this._webphone = webphone;\n    this._routerInteraction = routerInteraction;\n    this._composeText = composeText;\n    this._contactSearch = contactSearch;\n    this._contactMatcher = contactMatcher;\n    this._contactDetailsUI = contactDetailsUI;\n  }\n\n  getUIProps({\n    showContactDisplayPlaceholder = false,\n    showRingoutCallControl = false,\n    showSwitchCall = false,\n    useV2,\n  }) {\n    const isWebRTC =\n      this._callingSettings.callingMode === callingModes.webphone;\n    const controlBusy =\n      (this._activeCallControl && this._activeCallControl.busy) || false;\n\n    return {\n      currentLocale: this._locale.currentLocale,\n      activeRingCalls: this._callMonitor.activeRingCalls,\n      activeOnHoldCalls: this._callMonitor.activeOnHoldCalls,\n      activeCurrentCalls: this._callMonitor.activeCurrentCalls,\n      otherDeviceCalls: this._callMonitor.otherDeviceCalls,\n      areaCode: this._regionSettings.areaCode,\n      countryCode: this._regionSettings.countryCode,\n      outboundSmsPermission: !!(\n        this._rolesAndPermissions.permissions &&\n        this._rolesAndPermissions.permissions.OutboundSMS\n      ),\n      internalSmsPermission: !!(\n        this._rolesAndPermissions.permissions &&\n        this._rolesAndPermissions.permissions.InternalSMS\n      ),\n      showSpinner: !!(this._conferenceCall && this._conferenceCall.isMerging),\n      brand: this._brand.fullName,\n      showContactDisplayPlaceholder,\n      showRingoutCallControl,\n      showSwitchCall:\n        showSwitchCall &&\n        isWebRTC &&\n        this._webphone &&\n        this._webphone.connected,\n      autoLog: !!(this._callLogger && this._callLogger.autoLog),\n      isWebRTC,\n      conferenceCallParties: this._conferenceCall\n        ? this._conferenceCall.partyProfiles\n        : null,\n      useV2,\n      disableLinks:\n        !this._connectivityMonitor.connectivity ||\n        this._rateLimiter.throttling ||\n        controlBusy,\n    };\n  }\n\n  getUIFunctions({\n    composeTextRoute = '/composeText',\n    callCtrlRoute = '/calls/active',\n    onCreateContact,\n    onLogCall,\n    isLoggedContact,\n    onCallsEmpty,\n    onViewContact,\n    showViewContact = true,\n    getAvatarUrl,\n    useV2,\n  }) {\n    return {\n      formatPhone: (phoneNumber) =>\n        formatNumber({\n          phoneNumber,\n          areaCode: this._regionSettings.areaCode,\n          countryCode: this._regionSettings.countryCode,\n        }),\n      webphoneAnswer: async (sessionId) => {\n        if (!this._webphone) {\n          return;\n        }\n\n        const session = this._webphone.sessions.find(\n          (session) => session.id === sessionId,\n        );\n        if (\n          this._conferenceCall &&\n          session &&\n          session.direction === callDirections.inbound\n        ) {\n          this._conferenceCall.closeMergingPair();\n        }\n\n        this._webphone.answer(sessionId);\n      },\n      webphoneToVoicemail: async (...args) =>\n        this._webphone && this._webphone.toVoiceMail(...args),\n      webphoneReject: async (...args) =>\n        this._webphone && this._webphone.reject(...args),\n      webphoneHangup: async (...args) => {\n        // user action track\n        this._callMonitor.allCallsClickHangupTrack();\n        return this._webphone && this._webphone.hangup(...args);\n      },\n      webphoneResume: async (...args) => {\n        if (!this._webphone) {\n          return;\n        }\n        await this._webphone.resume(...args);\n        if (this._routerInteraction.currentPath !== callCtrlRoute && !useV2) {\n          this._routerInteraction.push(callCtrlRoute);\n        }\n      },\n      webphoneHold: async (...args) => {\n        // user action track\n        this._callMonitor.allCallsClickHoldTrack();\n        return this._webphone && this._webphone.hold(...args);\n      },\n      webphoneSwitchCall: async (activeCall) => {\n        if (!this._webphone) {\n          return;\n        }\n        const session = await this._webphone.switchCall(\n          activeCall,\n          this._regionSettings.homeCountryId,\n        );\n        return session;\n      },\n      ringoutHangup: async (...args) => {\n        // user action track\n        this._callMonitor.allCallsClickHangupTrack();\n        return (\n          this._activeCallControl && this._activeCallControl.hangUp(...args)\n        );\n      },\n      ringoutTransfer: async (sessionId) => {\n        this._routerInteraction.push(`/transfer/${sessionId}/active`);\n      },\n      ringoutReject: async (sessionId) => {\n        // user action track\n        this._callMonitor.allCallsClickRejectTrack();\n        return (\n          this._activeCallControl && this._activeCallControl.reject(sessionId)\n        );\n      },\n      onViewContact: showViewContact\n        ? onViewContact ||\n          (({ contact }) => {\n            const { id, type } = contact;\n            if (this._contactDetailsUI) {\n              this._contactDetailsUI.showContactDetails({\n                type,\n                id,\n                direct: true,\n              });\n            }\n          })\n        : null,\n      onClickToSms: this._composeText\n        ? async (contact, isDummyContact = false) => {\n            if (this._routerInteraction) {\n              this._routerInteraction.push(composeTextRoute);\n            }\n            this._composeText.clean();\n            if (contact.name && contact.phoneNumber && isDummyContact) {\n              this._composeText.updateTypingToNumber(contact.name);\n              this._contactSearch.search({ searchString: contact.name });\n            } else {\n              this._composeText.addToRecipients(contact);\n            }\n          }\n        : undefined,\n      onCreateContact: onCreateContact\n        ? async ({ phoneNumber, name, entityType }) => {\n            const hasMatchNumber = await this._contactMatcher.hasMatchNumber({\n              phoneNumber,\n              ignoreCache: true,\n            });\n            if (!hasMatchNumber) {\n              await onCreateContact({ phoneNumber, name, entityType });\n              await this._contactMatcher.forceMatchNumber({ phoneNumber });\n            }\n          }\n        : undefined,\n      isLoggedContact,\n      onLogCall:\n        onLogCall ||\n        (this._callLogger &&\n          (async ({ call, contact, redirect = true }) => {\n            await this._callLogger.logCall({\n              call,\n              contact,\n              redirect,\n            });\n          })),\n      onCallsEmpty:\n        onCallsEmpty ||\n        (() => {\n          const isWebRTC =\n            this._callingSettings.callingMode === callingModes.webphone;\n\n          if (isWebRTC && !this._webphone.sessions.length) {\n            this._routerInteraction.push('/dialer');\n          }\n        }),\n      isSessionAConferenceCall: (sessionId) =>\n        !!(\n          this._conferenceCall &&\n          this._conferenceCall.isConferenceSession(sessionId)\n        ),\n      onCallItemClick: (call) => {\n        if (!call.webphoneSession) {\n          // For ringout call\n          if (isRingingInboundCall(call)) {\n            return;\n          }\n\n          const { telephonySessionId } = call;\n          // to track the call item be clicked.\n          this._callMonitor.callItemClickTrack();\n          this._routerInteraction.push(\n            `/simplifycallctrl/${telephonySessionId}`,\n          );\n        } else {\n          // For webphone call\n          // show the ring call modal when click a ringing call.\n          if (isRingingInboundCall(call)) {\n            this._webphone.toggleMinimized(call.webphoneSession.id);\n            return;\n          }\n          if (call.webphoneSession && call.webphoneSession.id) {\n            // to track the call item be clicked.\n            this._callMonitor.callItemClickTrack();\n            this._routerInteraction.push(\n              `${callCtrlRoute}/${call.webphoneSession.id}`,\n            );\n          }\n        }\n      },\n      getAvatarUrl,\n      updateSessionMatchedContact: (sessionId, contact) =>\n        this._webphone.updateSessionMatchedContact(sessionId, contact),\n    };\n  }\n}\n"],"file":"index.js"}