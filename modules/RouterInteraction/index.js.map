{"version":3,"sources":["modules/RouterInteraction/index.js"],"names":["getDefaultHistory","createMemoryHistory","RouterInteraction","deps","dep","optional","spread","history","options","_reducer","routerReducer","_history","store","selectLocationState","state","push","replace","goBack","go","locationBeforeTransitions","pathname","moduleStatuses","ready","locationChange","LOCATION_CHANGE","RcModule","proxify"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AAKA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAASA,iBAAT,GAA6B;AAC3B,SAAO,mCAAiBC,gCAAjB,GAAP;AACD;AAED;;;;;;;IAQqBC,iB,WAHpB,gBAAO;AACNC,EAAAA,IAAI,EAAE,CAAC;AAAEC,IAAAA,GAAG,EAAE,0BAAP;AAAmCC,IAAAA,QAAQ,EAAE,IAA7C;AAAmDC,IAAAA,MAAM,EAAE;AAA3D,GAAD;AADA,CAAP,C;;;;;AAIC,mCAA2D;AAAA;;AAAA,4BAA7CC,OAA6C;AAAA,QAA7CA,OAA6C,6BAAnCP,iBAAiB,EAAkB;AAAA,QAAXQ,OAAW;;AAAA;;AACzD,6GAAWA,OAAX;AACA,UAAKC,QAAL,GAAgBC,+BAAhB;AACA,UAAKC,QAAL,GAAgBJ,OAAhB;AAHyD;AAI1D;;;;iCAEY;AAAA;;AACX,WAAKI,QAAL,GAAgB,4CAAqB,KAAKA,QAA1B,EAAoC,KAAKC,KAAzC,EAAgD;AAC9DC,QAAAA,mBAAmB,EAAE;AAAA,iBAAM,MAAI,CAACC,KAAX;AAAA;AADyC,OAAhD,CAAhB;AAGD;;;sCAEiB;AAAA;;AAChB,WAAKH,QAAL,GAAgB,4CAAqB,KAAKA,QAA1B,EAAoC,KAAKC,KAAzC,EAAgD;AAC9DC,QAAAA,mBAAmB,EAAE;AAAA,iBAAM,MAAI,CAACC,KAAX;AAAA;AADyC,OAAhD,CAAhB;AAGD;;;qCAOgB;AACf;AACD;;;;;;;;;;;AAgBC,qCAAKH,QAAL,EAAcI,IAAd;;;;;;;;;;;;;;;;;;;AAKA,sCAAKJ,QAAL,EAAcK,OAAd;;;;;;;;;;;;;;;;;;;AAKA,sCAAKL,QAAL,EAAcM,MAAd;;;;;;;;;;;;;;;;;;;AAKA,sCAAKN,QAAL,EAAcO,EAAd;;;;;;;;;;;wBAtCiB;AACjB;AACA,aAAO,IAAP;AACD;;;wBAMa;AACZ,aAAO,KAAKP,QAAZ;AACD;;;wBAEiB;AAChB,aAAO,KAAKG,KAAL,CAAWK,yBAAX,CAAqCC,QAA5C;AACD;;;wBAEY;AACX,aAAOC,2BAAeC,KAAtB;AACD;;;wBAsBiB;AAChB,aAAO;AACLC,QAAAA,cAAc,EAAEC;AADX,OAAP;AAGD;;;;EAhE4CC,qB,0DAwC5CC,mB,4IAKAA,mB,8IAKAA,mB,yIAKAA,mB","sourcesContent":["import RcModule from 'ringcentral-integration/lib/RcModule';\nimport { Module } from 'ringcentral-integration/lib/di';\nimport { useRouterHistory, createMemoryHistory } from 'react-router';\nimport {\n  syncHistoryWithStore,\n  routerReducer,\n  LOCATION_CHANGE,\n} from 'react-router-redux';\nimport proxify from 'ringcentral-integration/lib/proxy/proxify';\nimport moduleStatuses from 'ringcentral-integration/enums/moduleStatuses';\n\nfunction getDefaultHistory() {\n  return useRouterHistory(createMemoryHistory)();\n}\n\n/**\n * Known issues for browser history:\n * https://github.com/reactjs/react-router-redux/issues/570\n * https://github.com/ReactTraining/history/issues/427\n */\n@Module({\n  deps: [{ dep: 'RouterInteractionOptions', optional: true, spread: true }],\n})\nexport default class RouterInteraction extends RcModule {\n  constructor({ history = getDefaultHistory(), ...options }) {\n    super({ ...options });\n    this._reducer = routerReducer;\n    this._history = history;\n  }\n\n  initialize() {\n    this._history = syncHistoryWithStore(this._history, this.store, {\n      selectLocationState: () => this.state,\n    });\n  }\n\n  initializeProxy() {\n    this._history = syncHistoryWithStore(this._history, this.store, {\n      selectLocationState: () => this.state,\n    });\n  }\n\n  get _actionTypes() {\n    /* no action types */\n    return null;\n  }\n\n  _onStateChange() {\n    /* do nothing */\n  }\n\n  get history() {\n    return this._history;\n  }\n\n  get currentPath() {\n    return this.state.locationBeforeTransitions.pathname;\n  }\n\n  get status() {\n    return moduleStatuses.ready;\n  }\n\n  @proxify\n  async push(...args) {\n    this._history.push(...args);\n  }\n\n  @proxify\n  async replace(...args) {\n    this._history.replace(...args);\n  }\n\n  @proxify\n  async goBack(...args) {\n    this._history.goBack(...args);\n  }\n\n  @proxify\n  async go(...args) {\n    this._history.go(...args);\n  }\n\n  get actionTypes() {\n    return {\n      locationChange: LOCATION_CHANGE,\n    };\n  }\n}\n"],"file":"index.js"}