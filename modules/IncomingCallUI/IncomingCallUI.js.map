{"version":3,"sources":["modules/IncomingCallUI/IncomingCallUI.ts"],"names":["IncomingCallUI","name","deps","dep","optional","showContactDisplayPlaceholder","showCallQueueName","sourceIcons","_deps","webphone","locale","contactMatcher","contactSearch","regionSettings","forwardingNumber","brand","currentSession","ringingCallOnView","contactMapping","dataMapping","fromMatches","from","toMatches","to","nameMatches","direction","callDirections","outbound","fullName","currentLocale","session","activeSessionId","areaCode","countryCode","forwardingNumbers","searchContactList","sortedResult","phoneTypeRenderer","phoneSourceNameRenderer","getAvatarUrl","extensionInfo","conferenceCall","formatPhone","phoneNumber","siteCode","site","code","isMultipleSiteEnabled","answer","sessionId","closeMergingPair","reject","toVoiceMail","onForward","forwardNumber","forward","replyWithMessage","message","toggleMinimized","updateSessionMatchedContact","contact","hangup","onHold","hold","searchContact","pattern","debouncedSearch","searchString","RcUIModuleV2"],"mappings":"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","sourcesContent":["import {\n  RcUIModuleV2,\n  UIProps,\n  UIFunctions,\n} from '@ringcentral-integration/core';\nimport { Module } from '@ringcentral-integration/commons/lib/di';\nimport formatNumber from '@ringcentral-integration/commons/lib/formatNumber';\nimport callDirections from '@ringcentral-integration/commons/enums/callDirections';\nimport { NormalizedSession } from '@ringcentral-integration/commons/interfaces/Webphone.interface';\nimport {\n  Deps,\n  IncomingCallContainerProps,\n  IncomingCallUIPanelProps,\n} from './IncomingCallUI.interface';\n\n@Module({\n  name: 'IncomingCallUI',\n  deps: [\n    'Webphone',\n    'Locale',\n    'ContactSearch',\n    'RegionSettings',\n    'ForwardingNumber',\n    'Brand',\n    'ExtensionInfo',\n    { dep: 'ConferenceCall', optional: true },\n    { dep: 'ContactMatcher', optional: true },\n    { dep: 'IncomingCallUIOptions', optional: true },\n  ],\n})\nclass IncomingCallUI extends RcUIModuleV2<Deps> {\n  constructor(deps: Deps) {\n    super({\n      deps,\n    });\n  }\n\n  getUIProps({\n    showContactDisplayPlaceholder = false,\n    showCallQueueName,\n    sourceIcons,\n  }: IncomingCallContainerProps): UIProps<IncomingCallUIPanelProps> {\n    const {\n      webphone,\n      locale,\n      contactMatcher,\n      contactSearch,\n      regionSettings,\n      forwardingNumber,\n      brand,\n    } = this._deps;\n    const currentSession: Partial<NormalizedSession> =\n      webphone.ringingCallOnView || {};\n    const contactMapping = contactMatcher && contactMatcher.dataMapping;\n    const fromMatches =\n      (contactMapping && contactMapping[currentSession.from]) || [];\n    const toMatches =\n      (contactMapping && contactMapping[currentSession.to]) || [];\n    const nameMatches =\n      currentSession.direction === callDirections.outbound\n        ? toMatches\n        : fromMatches;\n    return {\n      sourceIcons,\n      brand: brand.fullName,\n      nameMatches,\n      currentLocale: locale.currentLocale,\n      session: currentSession,\n      activeSessionId: webphone.activeSessionId,\n      areaCode: regionSettings.areaCode,\n      countryCode: regionSettings.countryCode,\n      forwardingNumbers: forwardingNumber.forwardingNumbers,\n      showContactDisplayPlaceholder,\n      searchContactList: contactSearch.sortedResult,\n      showCallQueueName,\n    };\n  }\n\n  getUIFunctions({\n    phoneTypeRenderer,\n    phoneSourceNameRenderer,\n    getAvatarUrl = () => null,\n  }: IncomingCallContainerProps): UIFunctions<IncomingCallUIPanelProps> {\n    const {\n      webphone,\n      regionSettings,\n      contactSearch,\n      extensionInfo,\n      conferenceCall,\n    } = this._deps;\n    return {\n      phoneTypeRenderer,\n      phoneSourceNameRenderer,\n      formatPhone: (phoneNumber) =>\n        formatNumber({\n          phoneNumber,\n          areaCode: regionSettings.areaCode,\n          countryCode: regionSettings.countryCode,\n          siteCode: extensionInfo?.site?.code ?? '',\n          isMultipleSiteEnabled: extensionInfo?.isMultipleSiteEnabled ?? false,\n        }),\n      answer(sessionId) {\n        conferenceCall?.closeMergingPair();\n        webphone.answer(sessionId);\n      },\n      reject: (sessionId) => webphone.reject(sessionId),\n      toVoiceMail: (sessionId) => webphone.toVoiceMail(sessionId),\n      onForward: (sessionId, forwardNumber) =>\n        webphone.forward(sessionId, forwardNumber),\n      replyWithMessage: (sessionId, message) =>\n        webphone.replyWithMessage(sessionId, message),\n      toggleMinimized: (sessionId) => webphone.toggleMinimized(sessionId),\n      updateSessionMatchedContact: (sessionId, contact) =>\n        webphone.updateSessionMatchedContact(sessionId, contact),\n      getAvatarUrl,\n      hangup: (sessionId) => webphone.hangup(sessionId),\n      onHold: (sessionId) => webphone.hold(sessionId),\n      searchContact: (pattern) =>\n        contactSearch.debouncedSearch({ searchString: pattern }),\n    };\n  }\n}\n\nexport { IncomingCallUI };\n"],"file":"IncomingCallUI.js"}