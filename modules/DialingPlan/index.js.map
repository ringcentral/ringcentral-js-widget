{"version":3,"sources":["modules/DialingPlan/index.js"],"names":["DialingPlan","deps","dep","optional","client","rolesAndPermissions","options","polling","fetchFunction","params","platform","service","get","response","json","map","p","id","isoCode","callingCode","readyCheckFn","_rolesAndPermissions","ready","ensureExist","call","state","status","moduleStatuses","permissions","ReadCompanyInfo","DataFetcher","selector","data"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAaqBA,W;AAXrB;;;;OAIC,gBAAO;AACNC,EAAAA,IAAI,EAAE,CACJ,QADI,EAEJ,qBAFI,EAGJ;AAAEC,IAAAA,GAAG,EAAE,oBAAP;AAA6BC,IAAAA,QAAQ,EAAE;AAAvC,GAHI;AADA,CAAP,C;;;;;AAQC;;;;;AAKA,6BAAyD;AAAA;;AAAA,QAA3CC,MAA2C,QAA3CA,MAA2C;AAAA,QAAnCC,mBAAmC,QAAnCA,mBAAmC;AAAA,QAAXC,OAAW;;AAAA;;AACvD;AACEF,MAAAA,MAAM,EAANA,MADF;AAEEG,MAAAA,OAAO,EAAE,IAFX;AAGEC,MAAAA,aAAa;AAAA,qFAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAEL;AAAA,wFAAU,iBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACRC,8BAAAA,QADQ,GACGN,MAAM,CAACO,OAAP,CAAeD,QAAf,EADH;AAAA;AAAA,qCAESA,QAAQ,CAACE,GAAT,CACrB,sCADqB,EAErBH,MAFqB,CAFT;;AAAA;AAERI,8BAAAA,QAFQ;AAAA,+DAMPA,QAAQ,CAACC,IAAT,EANO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAV;;AAAA;AAAA;AAAA;AAAA,sBAFK;;AAAA;AAAA,mEAUXC,GAVW,CAUP,UAACC,CAAD;AAAA,2BAAQ;AACZC,sBAAAA,EAAE,EAAED,CAAC,CAACC,EADM;AAEZC,sBAAAA,OAAO,EAAEF,CAAC,CAACE,OAFC;AAGZC,sBAAAA,WAAW,EAAEH,CAAC,CAACG;AAHH,qBAAR;AAAA,mBAVO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SAHf;AAkBEC,MAAAA,YAAY,EAAE;AAAA,eAAM,MAAKC,oBAAL,CAA0BC,KAAhC;AAAA;AAlBhB,OAmBKhB,OAnBL;;AADuD;;AAuBvD,UAAKe,oBAAL,GAA4BE,wBAAYC,IAAZ,gCAE1BnB,mBAF0B,EAG1B,qBAH0B,CAA5B;AAvBuD;AA4BxD;;;;wBAEW;AACV,aAAO,aAAP;AACD;;;wBAKY;AACX,aAAO,KAAKoB,KAAL,CAAWC,MAAlB;AACD;;;wBAEW;AACV,aAAO,KAAKD,KAAL,CAAWC,MAAX,KAAsBC,2BAAeL,KAA5C;AACD;;;wBAEoB;AACnB,aAAO,CAAC,CAAC,KAAKD,oBAAL,CAA0BO,WAA1B,CAAsCC,eAA/C;AACD;;;;EArDsCC,wB,iFAwCtCC,kB;;;;;;;WACO,CAAC;AAAA,aAAM,MAAI,CAACC,IAAX;AAAA,KAAD,EAAkB,UAACA,IAAD;AAAA,aAAUA,IAAI,IAAI,EAAlB;AAAA,KAAlB,C","sourcesContent":["import { Module } from '../../lib/di';\nimport fetchList from '../../lib/fetchList';\nimport DataFetcher from '../../lib/DataFetcher';\nimport moduleStatuses from '../../enums/moduleStatuses';\nimport ensureExist from '../../lib/ensureExist';\nimport { selector } from '../../lib/selector';\n\n/**\n * @class\n * @description Dial plan list managing module\n */\n@Module({\n  deps: [\n    'Client',\n    'RolesAndPermissions',\n    { dep: 'DialingPlanOptions', optional: true },\n  ],\n})\nexport default class DialingPlan extends DataFetcher {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Client} params.client - client module instance\n   */\n  constructor({ client, rolesAndPermissions, ...options }) {\n    super({\n      client,\n      polling: true,\n      fetchFunction: async () =>\n        (\n          await fetchList(async (params) => {\n            const platform = client.service.platform();\n            const response = await platform.get(\n              '/restapi/v1.0/account/~/dialing-plan',\n              params,\n            );\n            return response.json();\n          })\n        ).map((p) => ({\n          id: p.id,\n          isoCode: p.isoCode,\n          callingCode: p.callingCode,\n        })),\n      readyCheckFn: () => this._rolesAndPermissions.ready,\n      ...options,\n    });\n\n    this._rolesAndPermissions = ensureExist.call(\n      this,\n      rolesAndPermissions,\n      'rolesAndPermissions',\n    );\n  }\n\n  get _name() {\n    return 'dialingPlan';\n  }\n\n  @selector\n  plans = [() => this.data, (data) => data || []];\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get _hasPermission() {\n    return !!this._rolesAndPermissions.permissions.ReadCompanyInfo;\n  }\n}\n"],"file":"index.js"}