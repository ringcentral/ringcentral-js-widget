{"version":3,"sources":["modules/DialingPlan/index.js"],"names":["DialingPlan","deps","dep","optional","client","rolesAndPermissions","options","polling","fetchFunction","params","platform","service","get","response","json","map","p","id","isoCode","callingCode","readyCheckFn","_rolesAndPermissions","ready","ensureExist","state","status","moduleStatuses","permissions","ReadCompanyInfo","DataFetcher","selector","data"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAaqBA,W;AAXrB;;;;OAIC,gBAAO;AACNC,EAAAA,IAAI,EAAE,CACJ,QADI,EAEJ,qBAFI,EAGJ;AAAEC,IAAAA,GAAG,EAAE,oBAAP;AAA6BC,IAAAA,QAAQ,EAAE;AAAvC,GAHI;AADA,CAAP,C;;;;;AAQC;;;;;AAKA,6BAAyD;AAAA;;AAAA;;AAAA,QAA3CC,MAA2C,QAA3CA,MAA2C;AAAA,QAAnCC,mBAAmC,QAAnCA,mBAAmC;AAAA,QAAXC,OAAW;;AAAA;;AACvD;AACEF,MAAAA,MAAM,EAANA,MADF;AAEEG,MAAAA,OAAO,EAAE,IAFX;AAGEC,MAAAA,aAAa;AAAA,qFAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACN;AAAA,wFAAU,iBAAOC,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACTC,8BAAAA,QADS,GACEN,MAAM,CAACO,OAAP,CAAeD,QAAf,EADF;AAAA;AAAA,qCAEQA,QAAQ,CAACE,GAAT,CACrB,yBADqB,EAErBH,MAFqB,CAFR;;AAAA;AAETI,8BAAAA,QAFS;AAAA,+DAMRA,QAAQ,CAACC,IAAT,EANQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAV;;AAAA;AAAA;AAAA;AAAA,sBADM;;AAAA;AAAA,mEAQTC,GARS,CAQL,UAACC,CAAD;AAAA,2BAAQ;AACdC,sBAAAA,EAAE,EAAED,CAAC,CAACC,EADQ;AAEdC,sBAAAA,OAAO,EAAEF,CAAC,CAACE,OAFG;AAGdC,sBAAAA,WAAW,EAAEH,CAAC,CAACG;AAHD,qBAAR;AAAA,mBARK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SAHf;AAgBEC,MAAAA,YAAY,EAAE;AAAA,eAAM,MAAKC,oBAAL,CAA0BC,KAAhC;AAAA;AAhBhB,OAiBKhB,OAjBL;;AADuD;;AAqBvD,UAAKe,oBAAL,GAA4B,4CAAME,uBAAN,kBAC1BlB,mBAD0B,EAE1B,qBAF0B,CAA5B;AArBuD;AAyBxD;;;;wBAEW;AACV,aAAO,aAAP;AACD;;;wBAKY;AACX,aAAO,KAAKmB,KAAL,CAAWC,MAAlB;AACD;;;wBAEW;AACV,aAAO,KAAKD,KAAL,CAAWC,MAAX,KAAsBC,2BAAeJ,KAA5C;AACD;;;wBAEoB;AACnB,aAAO,CAAC,CAAC,KAAKD,oBAAL,CAA0BM,WAA1B,CAAsCC,eAA/C;AACD;;;;EAlDsCC,wB,iFAqCtCC,kB;;;;;;;WACO,CAAC;AAAA,aAAM,MAAI,CAACC,IAAX;AAAA,KAAD,EAAkB,UAACA,IAAD;AAAA,aAAUA,IAAI,IAAI,EAAlB;AAAA,KAAlB,C","sourcesContent":["import { Module } from '../../lib/di';\nimport fetchList from '../../lib/fetchList';\nimport DataFetcher from '../../lib/DataFetcher';\nimport moduleStatuses from '../../enums/moduleStatuses';\nimport ensureExist from '../../lib/ensureExist';\nimport { selector } from '../../lib/selector';\n\n/**\n * @class\n * @description Dial plan list managing module\n */\n@Module({\n  deps: [\n    'Client',\n    'RolesAndPermissions',\n    { dep: 'DialingPlanOptions', optional: true },\n  ],\n})\nexport default class DialingPlan extends DataFetcher {\n  /**\n   * @constructor\n   * @param {Object} params - params object\n   * @param {Client} params.client - client module instance\n   */\n  constructor({ client, rolesAndPermissions, ...options }) {\n    super({\n      client,\n      polling: true,\n      fetchFunction: async () =>\n        (await fetchList(async (params) => {\n          const platform = client.service.platform();\n          const response = await platform.get(\n            '/account/~/dialing-plan',\n            params,\n          );\n          return response.json();\n        })).map((p) => ({\n          id: p.id,\n          isoCode: p.isoCode,\n          callingCode: p.callingCode,\n        })),\n      readyCheckFn: () => this._rolesAndPermissions.ready,\n      ...options,\n    });\n\n    this._rolesAndPermissions = this::ensureExist(\n      rolesAndPermissions,\n      'rolesAndPermissions',\n    );\n  }\n\n  get _name() {\n    return 'dialingPlan';\n  }\n\n  @selector\n  plans = [() => this.data, (data) => data || []];\n\n  get status() {\n    return this.state.status;\n  }\n\n  get ready() {\n    return this.state.status === moduleStatuses.ready;\n  }\n\n  get _hasPermission() {\n    return !!this._rolesAndPermissions.permissions.ReadCompanyInfo;\n  }\n}\n"],"file":"index.js"}