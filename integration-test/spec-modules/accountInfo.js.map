{"version":3,"sources":["integration-test/spec-modules/accountInfo.js"],"names":["authzProfileBody","require","auth","client","accountInfo","account","alert","describe","timeout","mock","mockClient","isLoginSuccess","clientHistoryRequest","ClientHistoryRequest","Map","afterEach","loggedIn","logout","it","restore","mockForLogin","console","error","skip","retries","expect","info","id","equal","mockAuthzProfile","authzProfile","permissions","filter","p","permission","login","state","messages","permissionsMessages","insufficientPrivilege","to","not","undefined"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,gBAAgB,GAAGC,OAAO,CAAC,2BAAD,CAAhC;;eAEe,kBAACC,IAAD,EAAOC,MAAP,EAAeC,WAAf,EAA4BC,OAA5B,EAAqCC,KAArC,EAA+C;AAC5DC,EAAAA,QAAQ,CAAC,cAAD,EAAiB,YAAM;AAC7B,IAAA,KAAI,CAACC,OAAL,CAAa,KAAb;;AACAC,IAAAA,IAAI,CAACC,UAAL,CAAgBP,MAAhB;AAEA,QAAIQ,cAAJ;AACA,QAAMC,oBAAoB,GAAG,IAAIC,gCAAJ,CAAyB,IAAIC,GAAJ,EAAzB,EAAoCX,MAApC,CAA7B;AAEAY,IAAAA,SAAS,uEAAC;AAAA;AAAA;AAAA;AAAA;AAAA,mBACJb,IAAI,CAACc,QADD;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAEAd,IAAI,CAACe,MAAL,EAFA;;AAAA;AAAA;AAAA,qBAIF,6BAAc,CAAd,CAJE;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD,GAAT;AAOAC,IAAAA,EAAE,CAAC,+BAAD,uEAAkC;AAAA;AAAA;AAAA;AAAA;AAClCT,cAAAA,IAAI,CAACU,OAAL;AACAV,cAAAA,IAAI,CAACW,YAAL;AAFkC;AAAA,qBAGX,2BAAYlB,IAAZ,EAAkBG,OAAlB,CAHW;;AAAA;AAGlCM,cAAAA,cAHkC;;AAIlC,kBAAI,CAACA,cAAL,EAAqB;AACnBU,gBAAAA,OAAO,CAACC,KAAR,CACE,oDADF,EAEEjB,OAFF;;AAIA,gBAAA,KAAI,CAACkB,IAAL;AACD;;AACD,cAAA,KAAI,CAACC,OAAL,CAAa,CAAb;;AAXkC;AAAA,qBAY5B,6BAAc,CAAd,CAZ4B;;AAAA;AAalCC,cAAAA,MAAM,CAACrB,WAAW,CAACsB,IAAZ,CAAiBC,EAAlB,CAAN,CAA4BC,KAA5B,CAAkC,SAAlC;;AAbkC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAlC,GAAF;AAgBAV,IAAAA,EAAE,CAAC,2DAAD,uEAA8D;AAAA;AAAA;AAAA;AAAA;AAC9DT,cAAAA,IAAI,CAACU,OAAL;AACAV,cAAAA,IAAI,CAACW,YAAL,CAAkB;AAAES,gBAAAA,gBAAgB,EAAE;AAApB,eAAlB;AACApB,cAAAA,IAAI,CAACqB,YAAL,CAAkB;AAChBC,gBAAAA,WAAW,EAAE/B,gBAAgB,CAAC+B,WAAjB,CAA6BC,MAA7B,CACX,UAACC,CAAD;AAAA,yBAAOA,CAAC,CAACC,UAAF,CAAaP,EAAb,KAAoB,iBAA3B;AAAA,iBADW;AADG,eAAlB;AAH8D;AAAA,qBAQxDzB,IAAI,CAACiC,KAAL,mBACD9B,OADC,EARwD;;AAAA;AAAA;AAAA,qBAWxD,6BAAc,CAAd,CAXwD;;AAAA;AAY9DoB,cAAAA,MAAM,CAACvB,IAAI,CAACc,QAAN,CAAN,CAAsBY,KAAtB,CAA4B,KAA5B;AACAH,cAAAA,MAAM,CACJ,oCACEnB,KAAK,CAAC8B,KAAN,CAAYC,QADd,EAEEC,gCAAoBC,qBAFtB,CADI,CAAN,CAKEC,EALF,CAKKC,GALL,CAKSb,KALT,CAKec,SALf;;AAb8D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAA9D,GAAF;AAoBD,GAlDO,CAAR;AAmDD,C","sourcesContent":["import { ensureLogin, containsErrorMessage } from '../utils/HelpUtil';\nimport { waitInSeconds } from '../utils/WaitUtil';\nimport ClientHistoryRequest from '../utils/ClientHistoryRequest';\nimport * as mock from '../mock';\nimport permissionsMessages from '../../modules/RolesAndPermissions/permissionsMessages';\n\nconst authzProfileBody = require('../mock/data/authzProfile');\n\nexport default (auth, client, accountInfo, account, alert) => {\n  describe('AccountInfo:', () => {\n    this.timeout(20000);\n    mock.mockClient(client);\n\n    let isLoginSuccess;\n    const clientHistoryRequest = new ClientHistoryRequest(new Map(), client);\n\n    afterEach(async () => {\n      if (auth.loggedIn) {\n        await auth.logout();\n      }\n      await waitInSeconds(1);\n    });\n\n    it('Should load info successfully', async () => {\n      mock.restore();\n      mock.mockForLogin();\n      isLoginSuccess = await ensureLogin(auth, account);\n      if (!isLoginSuccess) {\n        console.error(\n          'Skip test case as failed to login with credential ',\n          account,\n        );\n        this.skip();\n      }\n      this.retries(2);\n      await waitInSeconds(1);\n      expect(accountInfo.info.id).equal(208594004);\n    });\n\n    it('Should show insufficientPrivilege when no ReadCompanyInfo', async () => {\n      mock.restore();\n      mock.mockForLogin({ mockAuthzProfile: false });\n      mock.authzProfile({\n        permissions: authzProfileBody.permissions.filter(\n          (p) => p.permission.id !== 'ReadCompanyInfo',\n        ),\n      });\n      await auth.login({\n        ...account,\n      });\n      await waitInSeconds(5);\n      expect(auth.loggedIn).equal(false);\n      expect(\n        containsErrorMessage(\n          alert.state.messages,\n          permissionsMessages.insufficientPrivilege,\n        ),\n      ).to.not.equal(undefined);\n    });\n  });\n};\n"],"file":"accountInfo.js"}