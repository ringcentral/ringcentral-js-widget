{"version":3,"sources":["lib/proxy/handleProxyAction.ts"],"names":["dropStates","action","states","actionRest","Array","isArray","type","patches","pushStates","target","__name__","state"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;AAUO,IAAMA,UAAU,GAAG,SAAbA,UAAa,CAACC,MAAD,EAAyB;AAAA,MACzCC,MADyC,GACfD,MADe,CACzCC,MADyC;AAAA,MAC9BC,UAD8B,4BACfF,MADe;;AAEjD,MAAIG,KAAK,CAACC,OAAN,CAAcJ,MAAM,CAACK,IAArB,KAA8BF,KAAK,CAACC,OAAN,CAAcJ,MAAM,CAACM,OAArB,CAAlC,EAAiE;AAC/D;AACA,WAAOJ,UAAP;AACD;;AACD,SAAOF,MAAP;AACD,CAPM;;;;AASA,IAAMO,UAAU,GAAG,SAAbA,UAAa,CACxBC,MADwB,EAExBR,MAFwB,EAGrB;AACH,MACEG,KAAK,CAACC,OAAN,CAAcJ,MAAM,CAACK,IAArB,KACAF,KAAK,CAACC,OAAN,CAAcJ,MAAM,CAACM,OAArB,CADA,IAEA,OAAON,MAAM,CAACS,QAAd,KAA2B,QAH7B,EAIE;AACA;AACA,QAAMR,MAAM,GAAG,wBAAaO,MAAM,CAACR,MAAM,CAACS,QAAR,CAAN,CAAwBC,KAArC,EAA4CV,MAAM,CAACM,OAAnD,CAAf;AACA,2CACKN,MADL;AAEEC,MAAAA,MAAM,EAANA;AAFF;AAID;;AACD,SAAOD,MAAP;AACD,CAjBM","sourcesContent":["import { applyPatches, RcModuleV2 } from '@ringcentral-integration/core';\nimport { Action } from 'redux';\nimport RcModule from '../RcModule';\n\ninterface ProxyAction extends Action<string | string[]> {\n  states: Record<string, any>;\n  patches: any[];\n  __name__: string;\n}\n\nexport const dropStates = (action: ProxyAction) => {\n  const { states, ...actionRest } = action;\n  if (Array.isArray(action.type) && Array.isArray(action.patches)) {\n    // drop states for reduction of serialized data\n    return actionRest;\n  }\n  return action;\n};\n\nexport const pushStates = (\n  target: Record<string, RcModule | RcModuleV2>,\n  action: ProxyAction,\n) => {\n  if (\n    Array.isArray(action.type) &&\n    Array.isArray(action.patches) &&\n    typeof action.__name__ === 'string'\n  ) {\n    // restore changes states for reduction of serialized data from `patches`\n    const states = applyPatches(target[action.__name__].state, action.patches);\n    return {\n      ...action,\n      states,\n    };\n  }\n  return action;\n};\n"],"file":"handleProxyAction.js"}