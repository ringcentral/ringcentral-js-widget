{"version":3,"sources":["lib/usm/utils/enum.ts"],"names":["hasOwnProperty","Object","prototype","entries","keys","defineProperties","defineProperty","Enum","prefix","properties","value","configurable","enumerable","writable","forEach","item","setPrefix","window","Proxy","Reflect","freeze","Error","property","call","length","prefixCache","prefixEnum","enumMap","base","cache","assign","createEnum","values"],"mappings":"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","sourcesContent":["import freeze from './freeze';\n\nconst {\n  prototype: { hasOwnProperty },\n  entries,\n  keys,\n  defineProperties,\n  defineProperty,\n} = Object;\n\nexport type Prefix = string;\nexport type PropertyKey = string;\nexport type PropertyKeys = PropertyKey[];\n\ntype Properties<T> = {\n  [P in PropertyKey]?: T;\n};\n\ninterface Enum {\n  prefix: Prefix;\n  [key: string]: any;\n}\n\nclass Enum {\n  constructor(keys: PropertyKeys = [], prefix: Prefix) {\n    const properties: PropertyDescriptorMap = {\n      prefix: {\n        value: prefix,\n        configurable: false,\n        enumerable: false,\n        writable: false,\n      },\n    };\n    keys.forEach((item) => {\n      properties[item] = Enum.setPrefix(item, prefix);\n    });\n    defineProperties(this, properties);\n    if (typeof window !== 'undefined' && window.Proxy && window.Reflect) {\n      return freeze(this);\n    }\n    Object.freeze(this);\n  }\n\n  static setPrefix(item: PropertyKey, prefix: Prefix) {\n    const value = prefix ? `${prefix}-${item}` : item;\n    return {\n      value,\n      configurable: true,\n      enumerable: true,\n      writable: true,\n    };\n  }\n\n  get size() {\n    return entries(this).length;\n  }\n\n  add(item: PropertyKey) {\n    if (this[item]) {\n      throw new Error(\n        `'${item}' enumeration property already exists for this instance`,\n      );\n    }\n    const property = Enum.setPrefix(item, this.prefix);\n    defineProperty(this, item, property);\n  }\n\n  remove(item: PropertyKey) {\n    if (!hasOwnProperty.call(this, item)) {\n      throw new Error(\n        `'${item}' enumeration property does not exist for this instance`,\n      );\n    }\n    delete this[item];\n  }\n}\n\ninterface PrefixEnum {\n  enumMap: Enum;\n  prefix: Prefix;\n  base?: Enum;\n}\n\nconst prefixCache: Properties<Properties<Properties<string>>> = {};\n\nfunction prefixEnum({ enumMap, prefix, base = enumMap }: PrefixEnum) {\n  if (!prefix || prefix === '') return base;\n  if (\n    prefixCache[prefix] === null ||\n    typeof prefixCache[prefix] === 'undefined'\n  ) {\n    prefixCache[prefix] = {};\n  }\n  const cache = prefixCache[prefix];\n  if (cache && !cache[base.prefix]) {\n    Object.assign(cache, {\n      [base.prefix]: new Enum(keys(enumMap), `${prefix}-${enumMap.prefix}`),\n    });\n  }\n  return cache && cache[base.prefix];\n}\n\nfunction createEnum<V extends string>(\n  values: V[],\n  prefix: string,\n): { [K in V]: string };\n\nfunction createEnum(values: string[], prefix: string): Enum {\n  return new Enum(values, prefix);\n}\n\nexport { Enum as default, prefixCache, prefixEnum, createEnum };\n"],"file":"enum.js"}