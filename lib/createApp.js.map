{"version":3,"sources":["lib/createApp.ts"],"names":["createApp","Root","root","Injector","bootstrap","reducers","_getReducers","actionTypes","Object","entries","_modules","key","value","RcModuleV2","parentModule","__key__","reducer","defineProperties","get","_setStore","store","_initialized","initModule"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACO,IAAMA,SAAS,GAAG,SAAZA,SAAY,CAAsCC,IAAtC,EAAkD;AACzE,MAAMC,IAAgB,GAAGC,aAASC,SAAT,CAAmBH,IAAnB,CAAzB;;AACA,MAAMI,QAA2B,GAAGH,IAAI,CAACI,YAAL,CAAkBJ,IAAI,CAACK,WAAvB,CAApC;;AACA,qCAA2BC,MAAM,CAACC,OAAP,CAAeP,IAAI,CAACQ,QAApB,CAA3B,qCAA0D;AAAA;AAAA,QAA9CC,GAA8C;AAAA,QAAzCC,KAAyC;;AACxD,QAAIA,KAAK,YAAYC,gBAAjB,IAA+B,CAACR,QAAQ,CAACM,GAAD,CAA5C,EAAmD;AACjDC,MAAAA,KAAK,CAACE,YAAN,GAAqBZ,IAArB;AACAU,MAAAA,KAAK,CAACG,OAAN,GAAgBJ,GAAhB;AACAN,MAAAA,QAAQ,CAACM,GAAD,CAAR,GAAgBC,KAAK,CAACI,OAAtB;AACD;AACF;;AACDR,EAAAA,MAAM,CAACS,gBAAP,CAAwBf,IAAxB,EAA8B;AAC5Bc,IAAAA,OAAO,EAAE;AACPE,MAAAA,GAAG,EAAE;AAAA,eAAM,4BAAgBb,QAAhB,CAAN;AAAA;AADE,KADmB;AAI5Bc,IAAAA,SAAS,EAAE;AACTP,MAAAA,KADS,iBACHQ,KADG,EACW;AAClB,YAAI,OAAO,KAAKN,YAAZ,KAA6B,WAAjC,EAA8C;AAC5C,eAAKA,YAAL,GAAoB;AAClBM,YAAAA,KAAK,EAALA;AADkB,WAApB;AAGD;;AACDlB,QAAAA,IAAI,CAACmB,YAAL,GAAoB,IAApB;AACAnB,QAAAA,IAAI,CAACoB,UAAL;AACD;AATQ;AAJiB,GAA9B;AAgBA,SAAOpB,IAAP;AACD,CA3BM","sourcesContent":["import { RcModuleV2 } from '@ringcentral-integration/core';\nimport { ReducersMapObject, combineReducers, Store } from 'redux';\nimport { Injector } from './di';\n\n/**\n * Create app with FactoryModule based on RcModuleV2.\n * Please ensure that all dependency injection modules are based on the RcModuleV2 module.\n */\nexport const createApp = <T extends new (...args: any) => any>(Root: T) => {\n  const root: RcModuleV2 = Injector.bootstrap(Root);\n  const reducers: ReducersMapObject = root._getReducers(root.actionTypes);\n  for (const [key, value] of Object.entries(root._modules)) {\n    if (value instanceof RcModuleV2 && !reducers[key]) {\n      value.parentModule = root;\n      value.__key__ = key;\n      reducers[key] = value.reducer;\n    }\n  }\n  Object.defineProperties(root, {\n    reducer: {\n      get: () => combineReducers(reducers),\n    },\n    _setStore: {\n      value(store: Store) {\n        if (typeof this.parentModule === 'undefined') {\n          this.parentModule = {\n            store,\n          } as RcModuleV2;\n        }\n        root._initialized = true;\n        root.initModule();\n      },\n    },\n  });\n  return root as InstanceType<T>;\n};\n"],"file":"createApp.js"}