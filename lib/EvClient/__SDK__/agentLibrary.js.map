{"version":3,"sources":["lib/EvClient/__SDK__/agentLibrary.js"],"names":["C","STATUS_NULL","STATUS_NEW","STATUS_CONNECTING","STATUS_CONNECTED","STATUS_COMPLETED","CFSimpleSip","options","media","remote","video","audio","Error","browserUa","window","navigator","userAgent","toLowerCase","isSafari","isFirefox","indexOf","sessionDescriptionHandlerFactoryOptions","peerConnectionOptions","iceCheckingTimeout","rtcConfiguration","iceServers","urls","modifiers","SIP","Web","Modifiers","stripG722","alwaysAcquireMediaFirst","addMidLines","ua","uri","anonymous","UA","authorizationUser","password","displayName","userAgentString","USER_AGENT","register","registerExpires","transportOptions","traceSip","wsServers","maxReconnectionAttempts","dtmfType","RTP","state","logger","getLogger","on","emit","bind","session","warn","reject","setupSession","message","prototype","Object","create","EventEmitter","call","destination","checkRegistration","autoplay","local","volume","invite","sessionDescriptionHandlerOptions","constraints","answer","accept","hangup","cancel","bye","hold","local_hold","mute","log","unhold","unmute","toggleMute","sendDTMF","tone","dtmf","_message","isRegistered","setupRemoteMedia","pc","sessionDescriptionHandler","peerConnection","remoteStream","getReceivers","MediaStream","forEach","receiver","track","addTrack","getRemoteStreams","srcObject","play","setupLocalMedia","localStream","getSenders","sender","kind","getLocalStreams","cleanupMedia","pause","onProgress","onAccepted","onEnded","onFailed","destroyMedia","close","enabled","stream","getAudioTracks","getVideoTracks","global","AddSessionNotification","processResponse","notification","model","UIModel","getInstance","notif","ui_notification","sessionAgentId","utils","getText","incrementTotalCalls","agentSettings","agentId","currentCall","sessionId","monitorAgentId","sessionType","allowControl","uii","isMonitoring","monitoringType","isBargeInMonitor","notCurrentAgent","notSessionOne","shouldTrackSession","transferSessions","session_id","onCall","formattedResponse","buildDefaultResponse","status","phone","sessionLabel","monitoring","recordingUrl","AdminDebugEmailNotification","emailTo","requestedBy","DialGroupChangeNotification","origLoginType","loginRequest","loginType","newDgId","dialGroupChangeNotification","dialGroupId","detail","dialGroupName","dialGroupDesc","DialGroupChangePendingNotification","pendingDialGroupChange","parseInt","update_from_adminui","updateDGFromAdminUI","updateFromAdminUI","DirectAgentTransferNotification","ani","dnis","sourceType","sourceId","sourceName","voicemailUrl","DropSessionNotification","sessionUII","transfer","console","logMessage","LOG_LEVELS","DEBUG","transferEnd","EarlyUiiNotification","EndCallNotification","libInstance","endCallNotification","duration","termParty","termReason","callState","onManualOutdial","loginAgent","queueIds","configRequest","chatIds","skillProfileId","dialDest","outdialDispositions","dispositions","length","surveyPopType","pingIntervalId","setInterval","sendPingCallMessage","callDts","dispositionTimeout","GatesChangeNotification","newAssignedGates","availableQueues","inboundSettings","assignedGateIds","split","a","id","foundGate","findObjById","push","gate","gateId","gateName","gateDesc","defaultDestOverride","isAgentSelectable","queues","JSON","parse","stringify","GenericNotification","messageCode","NewCallNotification","newCall","queueDts","queueTime","callType","appUrl","allowHold","allowTransfer","allowManualInternationalTransfer","allowDirectAgentTransfer","allowHangup","allowRequeue","allowEndCallForEveryone","scriptId","scriptVersion","surveyId","requeueType","hangupOnDisposition","callerName","queue","processResponseCollection","agentRecording","requeueShortcuts","baggage","surveyResponse","scriptResponse","transferPhoneBook","lead","extra_data","extraDatas","extraData","key","e","customLabels","notifLabels","result","savedModel","script_result","results","keys","idx","value","err","entrys","disposition","isCampaign","d","disp","isComplete","requireNote","saveSurvey","xfer","isDefault","callTokens","buildCallTokenMap","auxPhone","transferNumber","agentDailyStats","currCallTime","tokens","generic_key_value_pairs","keyValuePairs","keyValuePairsStr","parseKeyValuePairsFromString","keyValue","number","name","description","any","error","firstName","lastName","externalAgentId","agentType","email","username","PendingChatDispNotification","PendingDispNotification","PreviewLeadStateNotification","messageId","requestId","leadState","callback","ReverseMatchNotification","TcpaSafeLeadStateNotification","AckRequest","audioType","response","resp","ui_response","type","WARN","AgentStateRequest","agentState","agentAuxState","toUpperCase","formatJSON","msg","ui_request","MESSAGE_TYPES","AGENT_STATE","getMessageId","response_to","agent_id","agent_aux_state","prevState","currState","prevAuxState","currAuxState","previousState","currentState","previousAuxState","currentAuxState","prevStateStr","currStateStr","currentStateLabel","agentStatePacket","AuthenticateRequest","config","platformId","rcAccessToken","tokenType","engageAccessToken","authType","sendHttpRequest","authenticateRequest","AUTHENTICATE_TYPES","USERNAME_PASSWORD","_buildHttpRequest","RC_TOKEN","rcTokenType","ENGAGE_TOKEN","authenticatePacket","accessToken","refreshToken","socketUrl","iqUrl","socketPort","port","agents","agentDetails","mainAccountId","path","queryParams","baseUrl","authHost","baseAuthUri","params","headers","errorMsg","HttpService","httpPost","then","authenticateResponse","fireCallback","libraryInstance","CALLBACK_TYPES","AUTHENTICATE","errResponse","errMsg","toString","httpGet","BargeInRequest","BARGE_IN","audio_state","monitor_agent_id","CallNotesRequest","notes","CALL_NOTES","CallbackCancelRequest","leadId","CALLBACK_CANCEL","lead_id","CallbacksPendingRequest","CALLBACK_PENDING","leadsRaw","leads","Array","isArray","l","leadRaw","parseLead","pendingCallbacks","auxData1","auxData2","auxData3","auxData4","auxData5","dialTime","externId","midName","sufix","title","address1","address2","city","zip","gateKeeper","CampaignDispositionsRequest","campaignId","CAMPAIGN_DISPOSITIONS","campaign_id","outboundSettings","campaignDispositions","ChatStateRequest","chatState","CHAT_STATE","currentChatState","chatStatePacket","XferColdRequest","callerId","sipHeaders","countryId","fields","i","fieldObj","XFER_COLD","dial_dest","caller_id","country_id","xfer_header","DirectAgentTransfer","targetAgentId","transferType","DIRECT_AGENT_TRANSFER","target_agent_id","transfer_type","DirectAgentTransferList","DIRECT_AGENT_TRANSFER_LIST","DispositionRequest","dispId","callbackDTS","contactForwardNumber","survey","OUTDIAL_DISPOSITION","disposition_id","call_back","call_back_DTS","contact_forwarding","outbound_externid","pending_request_id","INBOUND_DISPOSITION","obj","leadField","DispositionManualPassRequest","manual_disp","request_key","extern_id","ExtensionPresenceRequest","getExtensionPresenceInfo","extensionIds","_getExtensionPresenceInfo","extensionPresenceResponse","baseApiUri","extensionPresenceRequest","EXTENSION_PRESENCE","HangupRequest","resetPendingDisp","HANGUP","cancel_pending_disp","HoldRequest","holdState","HOLD","hold_state","currUII","onHold","LeadHistoryRequest","LEAD_HISTORY","histResponse","history","leadHistory","LeadInsertRequest","dataObj","agent_reserved","dialable","LEAD_INSERT","lead_phone","call_back_dts","callback_dts","first_name","mid_name","last_name","suffix","gate_keeper","aux_data1","aux_data2","aux_data3","aux_data4","aux_data5","LeadUpdateRequest","leadPhone","_formatBaggage","LEAD_UPDATE","bag","LoginRequest","isForce","updateLogin","checkExistingIds","chatSettings","availableChatQueues","availableSkillProfiles","availableOutdialGroups","isLoggedIn","validateDest","LOGIN","access_token","hash_code","connectionSettings","hashCode","allow_multisocket","applicationSettings","allowMultiSocket","login_type","update_login","outdial_group_id","skill_profile_id","agent_platform_id","is_force","gates","gate_id","chat_queues","chat_queue_id","Lib","isReconnect","updateLoginMode","INFO","loginPacket","loginDTS","Date","reconnect","agentPermissions","allowLeadSearch","accountId","corporateDirectory","consultCall","isMultiSocket","broadcastChannelHelper","init","setDialGroupSettings","setGateSettings","setChatQueueSettings","setSkillProfileSettings","requireFetchedLeadsCalled","allowPreviewLeadFilters","activeCallUii","isPendingDisp","mockEndCallPacket","term_reason","processNotification","isOffhook","offHookTermPacket","agentProcessOffhookCallback","offhookTerm","waitingForAddSession","pendingDisp","activeAgentUiSessions","getTransferSessions","activeAgentSessions","active_call_sessions","call_session_id","map","sessionObj","transferSession","guid","dataStore","save","scriptSettings","outdialGroups","outdialGroup","g","group","progressiveEnabled","skillProfile","skillProfiles","s","profile","responseId","profileId","selectedGateIds","selectedGates","gateIds","gIdx","chatQueues","selectedChatQueueIds","selectedChatQueues","cQueues","chatQueueIds","c","cIdx","chatQueue","chatQueueId","LoginPhase1Request","LOGIN_PHASE_1","isLoggedInIS","loginPhase1Packet","isSso","isFlr","isTcpaSafeMode","pciEnabled","enableCallContactHistory","alias","maxBreakTime","maxLunchTime","realAgentType","defaultLoginDest","altDefaultLoginDest","initLoginState","initLoginStateLabel","outboundManualDefaultRingtime","isOutboundPrepay","phoneLoginPin","agentPassword","allowCallControl","allowChat","enableChat","showLeadHistory","allowManualOutboundGates","allowOffHook","allowManualCalls","allowManualPass","allowManualIntlCalls","allowLoginUpdates","allowInbound","allowOutbound","allowBlended","allowLoginControl","allowCrossQueueRequeue","disableSupervisorMonitoring","allowAutoAnswer","defaultAutoAnswerOn","allowHistoricalDialing","allowAgentStats","allowCampaignStats","allowGateStats","allowChatStats","enableFolderMode","enableTaskMode","defaultDialGroup","allow_lead_inserts","insert_campaigns","campaign","allowLeadInserts","availableCampaigns","_processCampaigns","_processChatQueueDnis","availableChatRequeueQueues","availableRequeueQueues","availableChatRooms","availableScripts","callerIds","availableAgentStates","availableCountries","insertCampaigns","dialGroups","dg","hciType","hciEnabled","hciClicker","campaigns","campaignsRaw","_processCampaign","campaignRaw","allowLeadUpdates","allowLeadUpdatesByCampaign","labelArray","p","label","replace","campaignName","surveyName","rawQueues","login_chat_queues","chat_queue","rawQueue","j","rq","LogoutRequest","LOGOUT","MultiSocketRequest","LOGIN_MULTISOCKET","get","OffhookInitRequest","OFFHOOK_INIT","offhookInitPacket","softphoneSettings","attemptingSoftphoneReconnect","OffhookTermRequest","OFFHOOK_TERM","data","wasMonitoring","offhookTermPacket","startDts","endDts","OneToOneOutdialRequest","ringTime","ONE_TO_ONE_OUTDIAL","ring_time","OneToOneOutdialCancelRequest","ONE_TO_ONE_OUTDIAL_CANCEL","PauseRecordRequest","record","pauseTime","PAUSE_RECORD","PingCallRequest","PING_CALL","PreviewDialRequest","action","searchFields","PREVIEW_DIAL","search_fields","dialer_request","requestKey","destinations","notifLead","filter","destLead","callbacks","isInsert","previewDialLeads","RecordRequest","RECORD","RequeueRequest","queueId","skillId","maintain","REQUEUE","gate_number","skill_id","maintain_agent","ScriptConfigRequest","version","SCRIPT_CONFIG","script_id","json","loadedScripts","ScriptResultRequest","jsonResult","SCRIPT_RESULT","json_result","SearchDirectoryRequest","searchDirectory","searchString","searchDirectoryRequest","_searchDirectory","filteredDirectory","searchDirResponse","SEARCH_DIR","StatsRequest","STATS","TcpaSafeRequest","TCPA_SAFE","callbackLead","tcpaSafeLeads","UpdateDialDestinationRequest","isSoftphoneError","UPDATE_DIAL_DESTINATION","log_softphone_error","XferWarmRequest","XFER_WARM","XferWarmCancelRequest","XFER_WARM_CANCEL","WebRTCRequest","getSipRegistrationInfo","_getSipRegistrationInfo","ssoLogin","sipInfo","webRTCResponse","lastSipFetchTime","now","WEBRTC_INFO","ChatAgentEndRequest","CHAT_AGENT_END","operation_id","generateOpId","ChatAliasRequest","CHAT_ALIAS","ChatDispositionRequest","dispositionId","sendAcknowlegement","CHAT_DISPOSITION","do_ack","ChatListRequest","CHAT_LIST","chatListResponse","chatList","ChatMessageRequest","whisper","CHAT_MESSAGE","dts","trim","dtsDate","from","dequeueAgentId","mediaLinks","ChatPresentedResponseRequest","responseReason","CHAT_PRESENTED_RESPONSE","response_reason","ChatRequeueRequest","maintainAgent","CHAT_REQUEUE","ChatRoomRequest","roomType","roomId","agentOne","agentTwo","CHAT_ROOM","agent_one","agent_two","room_id","ChatRoomStateRequest","chatAlias","ChatSendRequest","CHAT_SEND","senderId","roomName","dynamicCreate","ChatTypingRequest","CHAT_TYPING","LeaveChatRequest","LEAVE_CHAT","ChatManualSmsRequest","CHAT_MANUAL_SMS","MonitorChatRequest","MONITOR_CHAT","StopMonitorChatRequest","STOP_MONITOR_CHAT","monitoredAgentId","SupervisorListRequest","SUPERVISOR_LIST","tempList","supervisors","sup","fname","lname","uname","ChatClientReconnectNotification","AddChatSessionNotification","transcript","ChatActiveNotification","ChatAgentAssignFailureNotification","agentAssignFailure","taskId","ChatCancelledNotification","ChatInactiveNotification","ChatPresentedNotification","edSourceId","edLanguageId","edCategoryIds","edSourceName","edSourceColor","edLanguage","edCategories","processedResponse","instance","cachedSourceList","edSources","cachedLanguageList","edLanguages","cachedCategoryList","sourceCache","_getEdValue","languageCache","categoryCache","_getMultiEdValues","edProxyPath","isCached","refreshAccessToken","authToken","sourceErrorMsg","languageErrorMsg","categoriesErrorMsg","sourcePromise","languagePromise","categoriesPromise","color","_buildEtrHttpRequest","names","sourceResponse","sourceList","currentSource","languageResponse","languageList","categoryResponse","categoryList","Promise","all","_buildPresentedResponse","CHAT_PRESENTED","authorizationToken","baseEtrUri","Authorization","list","returnObj","searchList","ids","idIndex","edValue","channelType","chatQueueName","allowAccept","edAuthorScreenName","edCreatedAt","sourceColor","ChatTypingNotification","pendingMessage","LoadMediaNotification","newTask","chatRequeueType","idleTimeout","chatDispositions","isSuccess","buildTaskTokenMap","NewChatNotification","newChat","preChatData","messages","ERROR","t","buildChatTokenMap","prop","hasOwnProperty","AgentStats","stats","ui_stats","agent","agentStats","agentLoginType","avgTalkTime","calls","isDequeueAgent","defaultRoute","queueDesc","queueName","loginDuration","offHook","pendingDispTime","presented","rna","stateDuration","skillProfileName","totalTalkTime","utilization","callDuration","AgentDailyStats","totalLoginSessions","totalChatsHandled","totalCallsHandled","totalPreviewDials","totalManualDials","totalRna","totalSuccessDispositions","totalLoginTime","totalOffhookTime","CampaignStats","totals","campRaw","active","abandon","available","busy","complete","fax","intercept","machine","noanswer","pending","ready","staffed","totalConnects","campaignStats","ChatQueueStats","chatQueueStats","QueueStats","gateRaw","asa","avgAbandon","avgQueue","avgTalk","deflected","inQueue","longCall","longestInQueue","routing","shortAbandon","shortCall","sla","slaPass","slaFail","tAbandonTime","tQueueTime","tSpeedOfAnswer","queueStats","pendingNewCallSessions","statsIntervalId","pingStatIntervalId","agentDailyIntervalId","reconnectIntervalId","location","origin","socketProtocol","chatAliasRequest","chatRoomRequest","chatSendRequest","supervisorListRequest","chatRoomStateRequest","multiSocketRequest","LocalStorageService","chatCancelledNotification","chatActiveNotification","chatInactiveNotification","chatDispositionRequest","chatMessageRequest","chatPresentedNotification","chatPresentedRequest","chatRequeueRequest","chatTypingNotification","chatTypingRequest","newChatNotification","loadMediaNotification","chatAgentAssignFailureNotification","chatClientReconnectNotification","agentStateRequest","chatStateRequest","ackRequest","bargeInRequest","callNotesRequest","callbacksPendingRequest","campaignDispositionsRequest","coldXferRequest","dispositionRequest","dispositionManualPassRequest","hangupRequest","holdRequest","leadHistoryRequest","leadInsertRequest","leadUpdateRequest","logoutRequest","loginPhase1Request","offhookInitRequest","offhookTermRequest","oneToOneOutdialRequest","oneToOneOutdialCancelRequest","pauseRecordRequest","pingCallRequest","previewDialRequest","reconnectRequest","recordRequest","requeueRequest","statsRequest","tcpaSafeRequest","warmXferRequest","warmXferCancelRequest","chatListRequest","directAgentTransferListRequest","directAgentTransferRequest","webRTCRequest","currentCallPacket","addSessionNotification","dialGroupChangePendingNotification","dropSessionNotification","earlyUiiNotification","gatesChangeNotification","genericNotification","newCallNotification","agentStatsPacket","agentDailyStatsPacket","queueStatsPacket","campaignStatsPacket","chatQueueStatsPacket","socketConnected","socketDest","dialDestType","totalCalls","webRtc","muteActive","registerPending","maintainOH","autoStartOH","sipPassword","sipDialDest","rcAccountId","records","resetInstance","localStorage","prefix","setItem","getItem","remove","removeItem","requestChannel","responseChannel","currentCallMessageId","currentCallRequestCallback","self","BroadcastChannel","onmessage","_sendCurrentCall","_processCurrentCallResponse","destroy","requestCurrentCall","fn","Math","random","postMessage","apiBase","XMLHttpRequest","encodeURIComponent","that","resolve","req","_getUriEncodedParams","open","_addHeaders","_addCompletionListeners","send","_getUriEncodedBody","_isObj","setRequestHeader","addEventListener","responseText","contentType","body","join","NewCallUtils","setupAddSessionCallback","sessionUii","_delayedAddSessionCallback","processSessionsForCall","delayedSessions","addSessionNotif","addResponse","ADD_SESSION","logLevel","_db","transaction","store","objectStore","request","add","sendMessage","msgObj","socket","readyState","_requests","shift","_queuedMsgs","dest","slice","ON_MESSAGE","current_state","stateChangeResponse","responseTo","findRequestById","audioState","SILENT_MONITOR","COACH_CALL","campaignDispsResposne","callNotes","insert","update","loginPhase1Response","loginResponse","offhook","initResponse","pauseRequest","pauseRec","requeue","supervisorList","script","scriptConfigRequest","coldXfer","warmXfer","warmXferCancel","ACK","ack","chatStateResponse","agentList","agentListResponse","agentXfer","agentXferResponse","DIAL_GROUP_CHANGE","dgChangeNotif","changeResponse","DIAL_GROUP_CHANGE_PENDING","dgChangePendNotif","pendResponse","DROP_SESSION","dropSesNotif","dropSesResponse","EARLY_UII","earlyUiiNotif","earlyUiiResponse","END_CALL","endCallNotif","endCallResponse","GATES_CHANGE","gateChangeNotif","gateChangeResponse","GENERIC","genericNotif","generic","callbackFnName","findCallbackBasedOnMessageType","GENERIC_NOTIFICATION","clearInterval","NEW_CALL","newCallNotif","newCallResponse","termResponse","PREVIEW_LEAD_STATE","leadStateNotif","leadStateResponse","PENDING_DISP","pendingDispNotif","pendingDispResponse","PENDING_CHAT_DISP","pendingChatDispNotif","pendingChatDispResponse","REVERSE_MATCH","reverseMatchNotif","reverseMatchResponse","TCPA_SAFE_LEAD_STATE","leadStateTcpaNotif","leadStateTcpaResponse","CHAT_ACTIVE","activeNotif","activeResponse","CHAT_INACTIVE","inactiveNotif","inactiveResponse","CHAT_CLIENT_RECONNECT","reconnectNotif","reconnectResponse","presentedNotif","typingNotif","typingResponse","CHAT_NEW","newChatNotif","newChatResponse","chatMessage","chatMessageResponse","CHAT_CANCELLED","chatCancelled","chatCancelledResponse","CHAT_ADD_SESSION","addChatSession","addChatSessionResponse","stopChatMonitor","stopChatMonitorResponse","CHAT_STOP_MONITOR","DIRECT_AGENT_ROUTE","directAgentTransfer","directAgentTransferResponse","DIRECT_AGENT_TRANSFER_NOTIF","AGENT_DEBUG_EMAIL","emailNotif","emailNotifResp","AGENT_DEBUG_EMAIL_NOTIF","CHAT_LOAD_MEDIA","loadMediaNotif","loadMediaResp","CHAT_AGENT_ASSIGN_FAILURE","chatAgentAssignFailureNotif","chatAgentAssignFailureResp","logoutNotification","logoutNotifResponse","closeSocket","processDialerResponse","PREVIEW_DIAL_ID","pdRequest","dialResponse","LEAD_SEARCH","PREVIEW_FETCH","TCPA_SAFE_ID","tcpaRequest","tcpaResponse","SAFE_MODE_SEARCH","SAFE_MODE_FETCH","processRequest","chatSendResponse","CHAT","CHAT_ROOM_STATE","chatRoomStateResponse","processStats","STATS_AGENT","STATS_AGENT_DAILY","onAgentDailyStats","STATS_CAMPAIGN","STATS_QUEUE","STATS_CHAT","chatStats","STATS_CHAT_QUEUE","groupProp","itemProp","textName","itemsRaw","_processItems","escapeSoftphoneUsername","str","_processItem","itemRaw","_tryConvertValueToBoolean","item","formattedKey","_convertToFormattedKey","_convertKeyForCollection","match","substr","setCallback","s4","floor","substring","objArray","idArray","idProperty","availIds","removeIds","o","r","splice","propName","isValid","isNum","test","messageType","includeOpId","operationId","det","stat","opId","returnMsg","val","getAttribute","outerDelimiter","innerDelimiter","arr","reduce","dict","pair","sendStatsRequestMessage","sendPingRequestMessage","curLoginTime","Number","curOffhookTime","curTalkTime","curCallTime","getDialDestination","currentServer","domain","loginHashcode","CHARACTERS","round","CLOSE_SOCKET","CONFIG","GENERIC_RESPONSE","LOG_CONSOLE_RESULTS","LOG_RESULTS","OPEN_SOCKET","SIP_CONNECTED","SIP_DIAL_DEST_CHANGED","SIP_ENDED","SIP_MUTE","SIP_REGISTERED","SIP_REGISTRATION_FAILED","SIP_RINGING","SIP_SWITCH_REGISTRAR","SIP_UNMUTE","SIP_UNREGISTERED","ROTATE_WEBRTC_SERVER","SETUP_WEB_RTC_SERVER","SIP_INIT","SIP_ANSWER","SIP_REJECT","SIP_REGISTER","SIP_HANGUP","SIP_SEND_DTMF","SIP_TOGGLE_MUTE","SOFTPHONE_RESET_SESSION","SWITCH_SOFTPHONE_REGISTRAR","initAgentLibraryCore","context","AgentLibrary","_isReconnect","openLogger","openConsoleLogger","isSecureSocket","setCallbacks","callbackMap","property","getCallbacks","getCallback","getSocket","getAuthenticateRequest","getLoginRequest","getMultiSocketRequest","getAgentConfigRequest","getLogoutRequest","getAgentDailyStats","getCallTokens","getAgentStateRequest","getOffhookInitRequest","getOffhookTermRequest","getHangupRequest","getPreviewDialRequest","getTcpaSafeRequest","getManualOutdialRequest","getManualOutdialCancelRequest","getCallNotesRequest","getCampaignDispositionsRequest","getDispositionRequest","getDispositionManualPassRequest","getWarmTransferRequest","getColdTransferRequest","getWarmTransferCancelRequest","getRequeueRequest","getBargeInRequest","getHoldRequest","getPauseRecordRequest","getRecordRequest","getChatPresentedRequest","getChatDispositionRequest","getChatMessageRequest","getChatRequeueRequest","getChatTypingRequest","getAgentStatsPacket","getAgentDailyStatsPacket","getQueueStatsPacket","getChatQueueStatsPacket","getCampaignStatsPacket","getAgentConfigPacket","getLoginPacket","getAgentStatePacket","getCurrentCallPacket","getOffhookInitPacket","getOffhookTermPacket","getChatAgentEnd","chatAgentEnd","getWebRTCRequest","getChatListRequest","getSearchDirectoryRequest","getDialGroupChangeNotification","getDialGroupChangePendingNotification","getEndCallNotification","getGatesChangeNotification","getGenericNotification","getNewCallNotification","getCurrentCall","getAddSessionNotification","getDropSessionNotification","getEarlyUiiNotification","getChatActiveNotification","getChatInactiveNotification","getChatClientReconnectNotification","getChatPresentedNotification","getChatTypingNotification","getNewChatNotification","getLoadMediaNotification","getChatAgentAssignFailureNotification","getChatCancelledNotification","getApplicationSettings","getSoftphoneSettings","getChatSettings","getConnectionSettings","getInboundSettings","getOutboundSettings","getAgentSettings","getPendingSessions","getAgentPermissions","getAgentStats","getQueueStats","getChatQueueStats","getCampaignStats","getFilteredDirectory","getExtensionPresenceResponse","getExtensionPresenceRequest","_utils","_NewCallUtils","_HttpService","_getUIModel","initAgentLibrarySocket","openSocket","_getNewAccessToken","_buildSocketDest","_initSocket","socketOpened","currDts","threeMins","queuedMsg","unshift","getTime","WebSocket","onopen","onerror","evt","onclose","initAgentLibraryAgent","authenticateAgentWithUsernamePassword","authenticateAgentWithRcAccessToken","authenticateAgentWithEngageAccessToken","getAgentConfig","getWebRtcInfo","_setUpAndSendLogin","multiLoginRequest","logoutAgent","requestLogoutAgent","agentToLogout","requestMessage","isSupervisor","setAgentState","offhookInit","getPendingCallbacks","cancelCallback","callbackCancelRequest","requestStats","_terminatePing","terminateStats","_requestPing","updateDialDestination","updateDialDestinationRequest","getRefreshedToken","initAgentLibraryCall","bargeIn","coach","internationalColdXfer","dispositionCall","dispositionManualPass","getCampaignDispositions","holdSession","manualOutdial","manualOutdialCancel","pauseRecord","previewDial","previewFetch","searchLeads","setCallNotes","monitor","requeueCall","safeModeCall","safeModeFetch","safeSearchLeads","internationalWarmXfer","corporateDirWarmXfer","corporateDirColdXfer","getScript","savedScript","saveScriptResult","scriptResultRequest","directAgentXferList","warmDirectAgentXfer","coldDirectAgentXfer","cancelDirectAgentXfer","voicemailDirectAgentXfer","rejectDirectAgentXfer","initAgentLibraryLead","leadInsert","leadUpdate","initAgentLibraryChat","setChatAlias","publicChatRoom","privateChatRoom","sendChat","getSupervisors","chatPresentedResponse","chatWhisper","chatDisposition","chatRequeue","chatTyping","monitorAgentChats","monitorChatRequest","stopMonitoringChatsByAgent","stopMonitorChatRequest","stopMonitoringAllAgentChats","leaveChat","leaveChatRequest","setChatState","sendManualOutboundSms","chatManualSms","initAgentLibraryLogger","dbRequest","indexedDB","event","onsuccess","target","purgeLog","errorCode","onupgradeneeded","objectStoreNames","contains","createObjectStore","autoIncrement","createIndex","unique","keyPath","db","dateIndex","index","endDate","setDate","getDate","range","IDBKeyRange","upperBound","openCursor","cursor","primaryKey","clearLog","objectStoreRequest","clear","deleteDB","dbName","DBDeleteRequest","deleteDatabase","getLogRecords","startDate","maxRows","objStore","limit","lowerBound","bound","levelAndDateReturn","idxLevelAndDate","logLevelReturn","idxLogLevel","dtsNoStatsReturn","idxDTSNoStats","noStatsReturn","idxNoStats","dtsReturn","idxDTS","allValsReturn","idxAll","initAgentLibraryMultisocket","loadCurrentCall","initAgentLibraryConsoleLogger","_consoleDb","_overrideConsole","getConsoleLogRecords","only","count","browserConsole","assign","defaultConsole","_getRecord","args","arg","agentName","_saveRecord","apply","arguments","info","initAgentLibrarySoftphoneService","sipInit","SoftphoneService","setupWebRtcServer","_getSipConfig","_connected","_ended","_registered","_unregistered","_registrationFailed","_ringing","_mute","_unmute","setTimeout","_handleNoRegisterResponse","sipTerminate","opts","unregister","removeAllListeners","stop","sipAnswer","sipReject","sipRegister","webkitNotifications","checkPermission","requestPermission","sipHangUp","sipSendDTMF","sipToggleMute","switchSoftphoneRegistrar","maintainOffhook","autoStartOffhook","_updateOHFlags","resetSoftphoneSession","offhookParams","_rotateWebRtcServer","_getCurrentWebRtcServerInfo","webRtcServer","transport","outboundProxy","authorizationId","remoteAudioElement","document","getElementById","_registerHasResponse","clearTimeout","timeSinceLastFetch","responseObj","usingRcPhone","rcHeader","rcHeaderValue","raw","initAgentLibrary"],"mappings":"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BAAiB,CAAC7F,OAAlB,GAA4B,qCAA5B;AACA6F,MAAAA,iBAAiB,CAACkF,MAAlB,GAA2BhB,gBAA3B;AAEA,aAAOlE,iBAAP;AACD,KAzCD;;AA2CA,QAAIsF,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAY,CAAE,CAAxC;AAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIA,IAAAA,mBAAmB,CAAClL,SAApB,CAA8BgE,eAA9B,GAAgD,UAAUC,YAAV,EAAwB;AACtE,UAAI2B,iBAAiB,GAAGpB,KAAK,CAACqB,oBAAN,CAA2B5B,YAA3B,CAAxB,CADsE,CAGtE;;AACA2B,MAAAA,iBAAiB,CAACuF,WAAlB,GAAgC3G,KAAK,CAACC,OAAN,CAC9BR,YAAY,CAACK,eADiB,EAE9B,cAF8B,CAAhC;AAKA,aAAOsB,iBAAP;AACD,KAVD;;AAYA,QAAIwF,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAY,CAAE,CAAxC;AAEA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIA,IAAAA,mBAAmB,CAACpL,SAApB,CAA8BgE,eAA9B,GAAgD,UAAUC,YAAV,EAAwB;AACtE,UAAIC,KAAK,GAAGC,OAAO,CAACC,WAAR,EAAZ;AACA,UAAIC,KAAK,GAA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AAtB,CAAyCsB,SADlC;AADA,WALD;AAUVlO,UAAAA,QAAQ,EAAE;AACR,qBAASnN,KAAK,CAAC4Q,QAAN,CACPjR,OAAO,CAACC,WAAR,GAAsBO,aAAtB,CAAoCC,OAD7B;AADD,WAVA;AAeVyZ,UAAAA,YAAY,EAAE;AACZ,qBAAS7Z,KAAK,CAAC4Q,QAAN,CACPjR,OAAO,CAACC,WAAR,GAAsB6O,mBAAtB,CAA0CQ,WADnC;AADG;AAfJ;AADJ,OAAV;AAwBA,aAAO1I,IAAI,CAACE,SAAL,CAAeoG,GAAf,CAAP;AACD,KA1BD;AA4BA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACIsS,IAAAA,kBAAkB,CAAC3jB,SAAnB,CAA6BgE,eAA7B,GAA+C,UAAU2M,QAAV,EAAoB;AACjE,UAAIC,IAAI,GAAGD,QAAQ,CAACE,WAApB;AACA,UAAI/K,MAAM,GAAGtB,KAAK,CAACC,OAAN,CAAcmM,IAAd,EAAoB,QAApB,CAAb;AACA,UAAI1M,KAAK,GAAGC,OAAO,CAACC,WAAR,EAAZ;AACA,UAAIwB,iBAAiB,G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B,WAAnB;AACE,gBAAIzS,UAAU,GAAGz4B,OAAO,CAACC,WAAR,GAAsBm9B,gBAAtB,CAAuCv9B,eAAvC,CACf4lB,IADe,CAAjB;AAGAplB,YAAAA,KAAK,CAACsQ,YAAN,CACEof,QADF,EAEElf,cAAc,CAACq6B,WAFjB,EAGEzS,UAHF;AAKA;;AACF,eAAKrrB,aAAa,CAAC+9B,UAAnB;AACE,gBAAIC,SAAS,GAAGprC,OAAO,CAACC,WAAR,GAAsBq9B,oBAAtB,CAA2Cz9B,eAA3C,CACd4lB,IADc,CAAhB;AAGAplB,YAAAA,KAAK,CAACsQ,YAAN,CACEof,QADF,EAEElf,cAAc,CAACw6B,gBAFjB,EAGED,SAHF;AAKA;AA3DJ;AA6DD,OAnxBS;;AAqxBV;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEM/iC,MAAAA,yBAAyB,EAAE,mCACzBmE,QADyB,EAEzB8+B,SAFyB,EAGzBC,QAHyB,EAIzBC,QAJyB,EAKzB;AACAA,QAAAA,QAAQ,GAAGA,QAAQ,IAAI,MAAvB;;AAEA,YACEh/B,QAAQ,CAAC8+B,SAAD,CAAR,IACA,OAAO9+B,QAAQ,CAAC8+B,SAAD,CAAR,CAAoBC,QAApB,CAAP,KAAyC,WAF3C,EAGE;AACA,cAAIE,QAAQ,GAAGj/B,QAA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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACMu2B,MAAAA,YAAY,CAACl1C,SAAb,CAAuBu1C,YAAvB,GAAsC,UAAUC,WAAV,EAAuB;AAC3D,aAAK,IAAIC,QAAT,IAAqBD,WAArB,EAAkC;AAChC,eAAKhqB,SAAL,CAAeiqB,QAAf,IAA2BD,WAAW,CAACC,QAAD,CAAtC;AACD;AACF,OAJD;AAMA;AACN;AACA;AACA;AACA;AACA;;;AACMP,MAAAA,YAAY,CAACl1C,SAAb,CAAuBywC,WAAvB,GAAqC,UAAU3/B,IAAV,EAAgBR,QAAhB,EAA0B;AAC7D,aAAKkb,SAAL,CAAe1a,IAAf,IAAuBR,QAAvB;AACD,OAFD;AAIA;AACN;AACA;AACA;AACA;;;AACM4kC,MAAAA,YAAY,CAACl1C,SAAb,CAAuB01C,YAAvB,GAAsC,YAAY;AAChD,eAAO,KAAKlqB,SAAZ;AACD,OAFD;AAIA;AACN;AACA;AACA;AACA;;;AACM0pB,MAAAA,YAAY,CAACl1C,SAAb,CAAuB21C,WAAvB,GAAqC,UAAU7kC,IAAV,EAAgB;AACnD,eAAO,KAAK0a,SAAL,CAAe1a,IAAf,CAAP;AACD,OAFD;AAIA;AACN;AACA;AACA;AACA;;;AACMokC,MAAAA,YAAY,CAACl1C,SAAb,CAAuB41C,SAAvB,GAAmC,UAAU9kC,IAAV,EAAgB;AACjD,eAAO,KAAKo1B,MAAZ;AACD,OAFD;AAIA;AACN;AACA;AACA;AAEM;AACA;AACA;;AACA;AACN;AACA;AACA;AACA;;;AACMgP,MAAAA,YAAY,CAACl1C,SAAb,CAAuB61C,sBAAvB,GAAgD,YAAY;AAC1D,eAAO1xC,OAAO,CAACC,WAAR,GAAsB6O,mBAA7B;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","sourcesContent":["/* eslint-disable */\nimport SIP from 'sip.js';\n\n(function () {\n  'use strict';\n  /**\n   * @fileoverview CFSimpleSip\n   */\n\n  /*\n   * @param {Object} options\n   */\n\n  var C = {\n    STATUS_NULL: 0,\n    STATUS_NEW: 1,\n    STATUS_CONNECTING: 2,\n    STATUS_CONNECTED: 3,\n    STATUS_COMPLETED: 4,\n  };\n  /**\n   * @property {Class} CFSimpleSip it is use for interacting to sip.js\n   * @param {Object} options\n   */\n\n  var CFSimpleSip = function (options) {\n    /*\n     *  {\n     *    media: {\n     *      remote: {\n     *        audio: <DOM element>,\n     *        video: <DOM element>\n     *      },\n     *      local: {\n     *        video: <DOM element>\n     *      }\n     *    },\n     *    ua: {\n     *       <UA Configuration Options>\n     *    }\n     *  }\n     */\n    if (options.media.remote.video) {\n      this.video = true;\n    } else {\n      this.video = false;\n    }\n\n    if (options.media.remote.audio) {\n      this.audio = true;\n    } else {\n      this.audio = false;\n    }\n\n    if (!this.audio && !this.video) {\n      // Need to do at least audio or video\n      // Error\n      throw new Error(\n        'At least one remote audio or video element is required for CFSimpleSip.',\n      );\n    }\n\n    this.options = options; // https://stackoverflow.com/questions/7944460/detect-safari-browser\n\n    var browserUa = window.navigator.userAgent.toLowerCase();\n    var isSafari = false;\n    var isFirefox = false;\n\n    if (browserUa.indexOf('safari') > -1 && browserUa.indexOf('chrome') < 0) {\n      isSafari = true;\n    } else if (\n      browserUa.indexOf('firefox') > -1 &&\n      browserUa.indexOf('chrome') < 0\n    ) {\n      isFirefox = true;\n    }\n\n    var sessionDescriptionHandlerFactoryOptions = {\n      peerConnectionOptions: {\n        iceCheckingTimeout: 500,\n        rtcConfiguration: {\n          iceServers: [\n            {\n              urls: 'stun:stun.l.google.com:19302',\n            },\n            {\n              urls: 'stun:stun.vacd.biz:19302',\n            },\n            {\n              urls: 'stun:stun.virtualacd.biz:3478',\n            },\n          ],\n        },\n      },\n    };\n\n    if (isSafari) {\n      sessionDescriptionHandlerFactoryOptions.modifiers = [\n        SIP.Web.Modifiers.stripG722,\n      ];\n    }\n\n    if (isFirefox) {\n      sessionDescriptionHandlerFactoryOptions.alwaysAcquireMediaFirst = true;\n      sessionDescriptionHandlerFactoryOptions.modifiers = [\n        SIP.Web.Modifiers.addMidLines,\n      ];\n    }\n\n    if (!this.options.ua.uri) {\n      this.anonymous = true;\n    }\n\n    this.ua = new SIP.UA({\n      // User Configurable Options\n      uri: this.options.ua.uri,\n      authorizationUser: this.options.ua.authorizationUser,\n      password: this.options.ua.password,\n      displayName: this.options.ua.displayName,\n      // Undocumented \"Advanced\" Options\n      userAgentString: SIP.C.USER_AGENT + ';' + browserUa,\n      // Fixed Options\n      register: true,\n      registerExpires: this.options.ua.registerExpires || 600,\n      sessionDescriptionHandlerFactoryOptions: sessionDescriptionHandlerFactoryOptions,\n      transportOptions: {\n        traceSip: this.options.ua.traceSip,\n        wsServers: this.options.ua.wsServers,\n        maxReconnectionAttempts: 2,\n      },\n      dtmfType: SIP.C.dtmfType.RTP,\n    });\n    this.state = C.STATUS_NULL;\n    this.logger = this.ua.getLogger('sip.simple');\n    this.ua.on(\n      'registered',\n      function () {\n        this.emit('registered', this.ua);\n      }.bind(this),\n    );\n    this.ua.on(\n      'unregistered',\n      function () {\n        this.emit('unregistered', this.ua);\n      }.bind(this),\n    );\n    this.ua.on(\n      'failed',\n      function () {\n        this.emit('unregistered', this.ua);\n      }.bind(this),\n    );\n    this.ua.on(\n      'invite',\n      function (session) {\n        // If there is already an active session reject the incoming session\n        if (this.state !== C.STATUS_NULL && this.state !== C.STATUS_COMPLETED) {\n          this.logger.warn(\n            'Rejecting incoming call. CFSimpleSip only supports 1 call at a time',\n          );\n          session.reject();\n          return;\n        }\n\n        this.session = session;\n        this.setupSession();\n        this.emit('ringing', this.session);\n      }.bind(this),\n    );\n    this.ua.on(\n      'message',\n      function (message) {\n        this.emit('message', message);\n      }.bind(this),\n    );\n    return this;\n  };\n\n  /**\n   * @property {Method} call\n   * @param {destination}\n   */\n\n  CFSimpleSip.prototype = Object.create(SIP.EventEmitter.prototype);\n  CFSimpleSip.C = C;\n\n  CFSimpleSip.prototype.call = function (destination) {\n    if (!this.ua || !this.checkRegistration()) {\n      this.logger.warn('A registered UA is required for calling');\n      return;\n    }\n\n    if (this.state !== C.STATUS_NULL && this.state !== C.STATUS_COMPLETED) {\n      this.logger.warn('Cannot make more than a single call with CFSimpleSip');\n      return;\n    } // Safari hack, because you cannot call .play() from a non user action\n\n    if (this.options.media.remote.audio) {\n      this.options.media.remote.audio.autoplay = true;\n    }\n\n    if (this.options.media.remote.video) {\n      this.options.media.remote.video.autoplay = true;\n    }\n\n    if (this.options.media.local && this.options.media.local.video) {\n      this.options.media.local.video.autoplay = true;\n      this.options.media.local.video.volume = 0;\n    }\n\n    this.session = this.ua.invite(destination, {\n      sessionDescriptionHandlerOptions: {\n        constraints: {\n          audio: this.audio,\n          video: this.video,\n        },\n      },\n    });\n    this.setupSession();\n    return this.session;\n  };\n  /**\n   * @property {Method} answer\n   */\n\n  CFSimpleSip.prototype.answer = function () {\n    if (this.state !== C.STATUS_NEW && this.state !== C.STATUS_CONNECTING) {\n      this.logger.warn('No call to answer');\n      return;\n    } // Safari hack, because you cannot call .play() from a non user action\n\n    if (this.options.media.remote.audio) {\n      this.options.media.remote.audio.autoplay = true;\n    }\n\n    if (this.options.media.remote.video) {\n      this.options.media.remote.video.autoplay = true;\n    }\n\n    return this.session.accept({\n      sessionDescriptionHandlerOptions: {\n        constraints: {\n          audio: this.audio,\n          video: this.video,\n        },\n      },\n    }); // emit call is active\n  };\n  /**\n   * @property {Method} reject\n   */\n\n  CFSimpleSip.prototype.reject = function () {\n    if (this.state !== C.STATUS_NEW && this.state !== C.STATUS_CONNECTING) {\n      this.logger.warn('Call is already answered');\n      return;\n    }\n\n    return this.session.reject();\n  };\n  /**\n   * @property {Method} hangup\n   */\n\n  CFSimpleSip.prototype.hangup = function () {\n    if (\n      this.state !== C.STATUS_CONNECTED &&\n      this.state !== C.STATUS_CONNECTING &&\n      this.state !== C.STATUS_NEW\n    ) {\n      this.logger.warn('No active call to hang up on');\n      return;\n    }\n\n    if (this.state !== C.STATUS_CONNECTED) {\n      return this.session.cancel();\n    } else {\n      return this.session.bye();\n    }\n  };\n  /**\n   * @property {Method} hold\n   */\n\n  CFSimpleSip.prototype.hold = function () {\n    if (this.state !== C.STATUS_CONNECTED || this.session.local_hold) {\n      this.logger.warn('Cannot put call on hold');\n      return;\n    }\n\n    this.mute();\n    this.logger.log('Placing session on hold');\n    return this.session.hold();\n  };\n  /**\n   * @property {Method} unhold\n   */\n\n  CFSimpleSip.prototype.unhold = function () {\n    if (this.state !== C.STATUS_CONNECTED || !this.session.local_hold) {\n      this.logger.warn('Cannot unhold a call that is not on hold');\n      return;\n    }\n\n    this.unmute();\n    this.logger.log('Placing call off hold');\n    return this.session.unhold();\n  };\n  /**\n   * @property {Method} mute\n   */\n\n  CFSimpleSip.prototype.mute = function () {\n    if (this.state !== C.STATUS_CONNECTED) {\n      this.logger.warn('An acitve call is required to mute audio');\n      return;\n    }\n\n    this.logger.log('Muting Audio');\n    this.toggleMute(true);\n    this.emit('mute', this);\n  };\n  /**\n   * @property {Method} unmute\n   */\n\n  CFSimpleSip.prototype.unmute = function () {\n    if (this.state !== C.STATUS_CONNECTED) {\n      this.logger.warn('An active call is required to unmute audio');\n      return;\n    }\n\n    this.logger.log('Unmuting Audio');\n    this.toggleMute(false);\n    this.emit('unmute', this);\n  };\n  /**\n   * @property {Method} message\n   * @param {tone}\n   */\n\n  CFSimpleSip.prototype.sendDTMF = function (tone) {\n    if (this.state !== C.STATUS_CONNECTED) {\n      this.logger.warn('An active call is required to send a DTMF tone');\n      return;\n    }\n\n    this.logger.log('Sending DTMF tone: ' + tone);\n    this.session.dtmf(tone);\n  };\n  /**\n   * @property {Method} message\n   * @param {destination}\n   * @param {message}\n   */\n\n  CFSimpleSip.prototype.message = function (destination, _message) {\n    if (!this.ua || !this.checkRegistration()) {\n      this.logger.warn('A registered UA is required to send a message');\n      return;\n    }\n\n    if (!destination || !_message) {\n      this.logger.warn(\n        'A destination and message are required to send a message',\n      );\n      return;\n    }\n\n    this.ua.message(destination, _message);\n  }; // Private Helpers\n\n  /**\n   * @property {Method} checkRegistration\n   */\n\n  CFSimpleSip.prototype.checkRegistration = function () {\n    return this.anonymous || (this.ua && this.ua.isRegistered());\n  };\n  /**\n   * @property {Method} setupRemoteMedia\n   */\n\n  CFSimpleSip.prototype.setupRemoteMedia = function () {\n    // If there is a video track, it will attach the video and audio to the same element\n    var pc = this.session.sessionDescriptionHandler.peerConnection;\n    var remoteStream;\n\n    if (pc.getReceivers) {\n      remoteStream = new window.window.MediaStream();\n      pc.getReceivers().forEach(function (receiver) {\n        var track = receiver.track;\n\n        if (track) {\n          remoteStream.addTrack(track);\n        }\n      });\n    } else {\n      remoteStream = pc.getRemoteStreams()[0];\n    }\n\n    if (this.video) {\n      this.options.media.remote.video.srcObject = remoteStream;\n      this.options.media.remote.video.play().catch(\n        function () {\n          this.logger.log('play was rejected');\n        }.bind(this),\n      );\n    } else if (this.audio) {\n      this.options.media.remote.audio.srcObject = remoteStream;\n      this.options.media.remote.audio.play().catch(\n        function () {\n          this.logger.log('play was rejected');\n        }.bind(this),\n      );\n    }\n  };\n  /**\n   * @property {Method} setupLocalMedia\n   */\n\n  CFSimpleSip.prototype.setupLocalMedia = function () {\n    if (\n      this.video &&\n      this.options.media.local &&\n      this.options.media.local.video\n    ) {\n      var pc = this.session.sessionDescriptionHandler.peerConnection;\n      var localStream;\n\n      if (pc.getSenders) {\n        localStream = new window.window.MediaStream();\n        pc.getSenders().forEach(function (sender) {\n          var track = sender.track;\n\n          if (track && track.kind === 'video') {\n            localStream.addTrack(track);\n          }\n        });\n      } else {\n        localStream = pc.getLocalStreams()[0];\n      }\n\n      this.options.media.local.video.srcObject = localStream;\n      this.options.media.local.video.volume = 0;\n      this.options.media.local.video.play();\n    }\n  };\n  /**\n   * @property {Method} cleanupMedia\n   */\n\n  CFSimpleSip.prototype.cleanupMedia = function () {\n    if (this.video) {\n      this.options.media.remote.video.srcObject = null;\n      this.options.media.remote.video.pause();\n\n      if (this.options.media.local && this.options.media.local.video) {\n        this.options.media.local.video.srcObject = null;\n        this.options.media.local.video.pause();\n      }\n    }\n\n    if (this.audio) {\n      this.options.media.remote.audio.srcObject = null;\n      this.options.media.remote.audio.pause();\n    }\n  };\n  /**\n   * @property {Method} setupSession\n   */\n\n  CFSimpleSip.prototype.setupSession = function () {\n    this.state = C.STATUS_NEW;\n    this.emit('new', this.session);\n    this.session.on('progress', this.onProgress.bind(this));\n    this.session.on('accepted', this.onAccepted.bind(this));\n    this.session.on('rejected', this.onEnded.bind(this));\n    this.session.on('failed', this.onFailed.bind(this));\n    this.session.on('terminated', this.onEnded.bind(this));\n  };\n  /**\n   * @property {Method} destroyMedia\n   * @param {mute}\n   */\n\n  CFSimpleSip.prototype.destroyMedia = function () {\n    this.session.sessionDescriptionHandler.close();\n  };\n  /**\n   * @property {Method} toggleMute\n   * @param {mute}\n   */\n\n  CFSimpleSip.prototype.toggleMute = function (mute) {\n    var pc = this.session.sessionDescriptionHandler.peerConnection;\n\n    if (pc.getSenders) {\n      pc.getSenders().forEach(function (sender) {\n        if (sender.track) {\n          sender.track.enabled = !mute;\n        }\n      });\n    } else {\n      pc.getLocalStreams().forEach(function (stream) {\n        stream.getAudioTracks().forEach(function (track) {\n          track.enabled = !mute;\n        });\n        stream.getVideoTracks().forEach(function (track) {\n          track.enabled = !mute;\n        });\n      });\n    }\n  };\n  /**\n   * @property {Method} onAccepted\n   */\n\n  CFSimpleSip.prototype.onAccepted = function () {\n    this.state = C.STATUS_CONNECTED;\n    this.emit('connected', this.session);\n    this.setupLocalMedia();\n    this.setupRemoteMedia();\n    this.session.sessionDescriptionHandler.on(\n      'addTrack',\n      function () {\n        this.logger.log(\n          'A track has been added, triggering new remoteMedia setup',\n        );\n        this.setupRemoteMedia();\n      }.bind(this),\n    );\n    this.session.sessionDescriptionHandler.on(\n      'addStream',\n      function () {\n        this.logger.log(\n          'A stream has been added, trigger new remoteMedia setup',\n        );\n        this.setupRemoteMedia();\n      }.bind(this),\n    );\n    this.session.on(\n      'hold',\n      function () {\n        this.emit('hold', this.session);\n      }.bind(this),\n    );\n    this.session.on(\n      'unhold',\n      function () {\n        this.emit('unhold', this.session);\n      }.bind(this),\n    );\n    this.session.on(\n      'dtmf',\n      function (tone) {\n        this.emit('dtmf', tone);\n      }.bind(this),\n    );\n    this.session.on('bye', this.onEnded.bind(this));\n  };\n  /**\n   * @property {Method} onProgress\n   */\n\n  CFSimpleSip.prototype.onProgress = function () {\n    this.state = C.STATUS_CONNECTING;\n    this.emit('connecting', this.session);\n  };\n  /**\n   * @property {Method} onFailed\n   */\n\n  CFSimpleSip.prototype.onFailed = function () {\n    this.onEnded();\n  };\n  /**\n   * @property {Method} onEnded\n   */\n\n  CFSimpleSip.prototype.onEnded = function () {\n    this.state = C.STATUS_COMPLETED;\n    this.emit('ended', this.session);\n    this.cleanupMedia();\n  };\n  window.CFSimpleSip = CFSimpleSip;\n  return CFSimpleSip;\n})();\n\nexport default (function () {\n  /**\n   * @fileOverview Exposed functionality for Contact Center AgentUI.\n   * @namespace AgentLibrary\n   */\n\n  return function (global) {\n    var AddSessionNotification = function () {};\n\n    /*\n     * This class is responsible for handling \"ADD-SESSION\" packets from IntelliQueue.  This is used by\n     * the CallControlForm. Then it will increment the total_calls count.\n     *\n     * {\n     *   \"ui_notification\": {\n     *       \"@message_id\": \"IQ982008082918151403727\",\n     *       \"@response_to\": \"\",\n     *       \"@type\": \"ADD-SESSION\",\n     *       \"session_id\": { \"#text\": \"2\" },\n     *       \"uii\": { \"#text\": \"200808291814560000000900016558\" },\n     *       \"phone\": { \"#text\": \"200808291814370000000900016555\" },\n     *       \"session_type\": { \"#text\": \"AGENT\" },\n     *       \"session_label\": { \"#text\": \"Primary Agents Call Session\" },\n     *       \"allow_control\": { \"#text\": \"TRUE\" },\n     *       \"monitoring\": { \"#text\": \"FALSE\" },\n     *       \"agent_id\": { \"#text\": \"1856\" }\n     *   }\n     *  }\n     */\n    AddSessionNotification.prototype.processResponse = function (notification) {\n      var model = UIModel.getInstance();\n      var notif = notification.ui_notification;\n      var sessionAgentId = utils.getText(notif, 'agent_id');\n\n      if (utils.getText(notif, 'session_type') === 'AGENT') {\n        model.incrementTotalCalls();\n      }\n\n      if (sessionAgentId === model.agentSettings.agentId) {\n        // add the session_id of this leg to the current call packet -\n        // this way we can use it for hangups later.\n        model.currentCall.sessionId = utils.getText(notif, 'session_id');\n      } else if (sessionAgentId != '') {\n        // this is a monitoring session, lets save the monitored agent id for barge-ins\n        model.currentCall.monitorAgentId = sessionAgentId;\n      }\n\n      // Check to see if we have a transfer leg here, if so, register it\n      var sessionType = utils.getText(notif, 'session_type'),\n        allowControl = utils.getText(notif, 'allow_control'),\n        sessionId = utils.getText(notif, 'session_id'),\n        uii = utils.getText(notif, 'uii'),\n        isMonitoring = model.currentCall.isMonitoring,\n        monitoringType = model.currentCall.monitoringType;\n\n      var isBargeInMonitor = isMonitoring && monitoringType === 'FULL',\n        notCurrentAgent = sessionAgentId !== model.agentSettings.agentId,\n        notSessionOne = sessionId !== '1',\n        shouldTrackSession = false;\n\n      if (notSessionOne && notCurrentAgent) {\n        if (isBargeInMonitor) {\n          shouldTrackSession = true;\n        } else if (allowControl) {\n          if (sessionType === 'OUTBOUND' || sessionType === 'AGENT') {\n            shouldTrackSession = true;\n          }\n        }\n      }\n\n      if (shouldTrackSession) {\n        var destination = utils.getText(notif, 'phone');\n\n        if (sessionType === 'AGENT' || sessionAgentId !== '') {\n          destination = utils.getText(notif, 'agent_name');\n        }\n\n        model.transferSessions[sessionId] = {\n          sessionId: sessionId,\n          destination: destination,\n          uii: uii,\n        };\n      }\n\n      // if agent session, set on call status\n      if (notif.session_id === '2') {\n        model.agentSettings.onCall = true;\n      }\n\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.status = 'OK';\n      formattedResponse.message = 'Received ADD-SESSION notification';\n      formattedResponse.sessionId = utils.getText(notif, 'session_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.phone = utils.getText(notif, 'phone');\n      formattedResponse.sessionType = utils.getText(notif, 'session_type');\n      formattedResponse.sessionLabel = utils.getText(notif, 'session_label');\n      formattedResponse.allowControl = utils.getText(notif, 'allow_control');\n      formattedResponse.monitoring = utils.getText(notif, 'monitoring');\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.recordingUrl = utils.getText(notif, 'recording_url');\n      formattedResponse.transferSessions = model.transferSessions;\n\n      return formattedResponse;\n    };\n\n    var AdminDebugEmailNotification = function () {};\n\n    /*\n     * This class is responsible for handling \"AGENT-DEBUG-EMAIL\" packets from IntelliQueue\n     *\n     * {\n     *   \"ui_notification\":{\n     *      \"@message_id\":\"IQD01DEV2018071616521500004\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"AGENT-DEBUG-EMAIL\",\n     *      \"email_to\": {\n     *          \"#text\":\"rmyers@connectfirst.com\"\n     *      }\n     *      \"requested_by\": {\n     *          \"#text\":\"Ross Myers\"\n     *      }\n     *   }\n     * }\n     */\n    AdminDebugEmailNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      var notif = notification.ui_notification;\n\n      formattedResponse.status = 'OK';\n      formattedResponse.message = 'Received AGENT-DEBUG-EMAIL notification';\n      formattedResponse.emailTo = utils.getText(notif, 'email_to');\n      formattedResponse.requestedBy = utils.getText(notif, 'requested_by');\n\n      return formattedResponse;\n    };\n\n    var DialGroupChangeNotification = function () {};\n\n    /*\n     * This class is responsible for handling a DIAL_GROUP_CHANGE notification.\n     * This event is sent from IQ when an agent's dial group is changed in through the AdminUI.\n     *\n     *   {\n     *       \"ui_notification\": {\n     *           \"@message_id\": \"IQ10012016080413085500263\",\n     *           \"@type\": \"DIAL_GROUP_CHANGE\",\n     *           \"agent_id\": { \"#text\": \"1180958\" },\n     *           \"dial_group_id\": { \"#text\": \"50354\" },\n     *           \"dialGroupName\": { \"#text\": \"Preview Dial Mode\" },\n     *           \"dial_group_desc\": {}\n     *       }\n     *   }\n     */\n    DialGroupChangeNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      //Modify loginRequest with new DialGroupId\n      var model = UIModel.getInstance();\n      var notif = notification.ui_notification;\n      var origLoginType = model.loginRequest.loginType;\n      var newDgId = utils.getText(notif, 'dial_group_id');\n\n      model.dialGroupChangeNotification = notification;\n\n      // Calculate type of login - called from AdminUI when assigning agent to new dial group.\n      // Only options should be BLENDED or OUTBOUND here.\n      if (\n        newDgId &&\n        newDgId !== '' &&\n        (origLoginType === 'INBOUND' || origLoginType === 'BLENDED')\n      ) {\n        model.loginRequest.loginType = 'BLENDED';\n      } else if (newDgId && newDgId !== '') {\n        model.loginRequest.loginType = 'OUTBOUND';\n      } else if (origLoginType === 'INBOUND') {\n        model.loginRequest.loginType = 'INBOUND';\n      } else {\n        model.loginRequest.loginType = 'NO-SELECTION';\n      }\n\n      UIModel.getInstance().loginRequest.dialGroupId = newDgId;\n\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.message = 'Dial Group Updated Successfully.';\n      formattedResponse.detail = 'Dial Group changed to [' + newDgId + '].';\n      formattedResponse.dialGroupId = utils.getText(notif, 'dial_group_id');\n      formattedResponse.dialGroupName = utils.getText(notif, 'dialGroupName'); // camel case from server for some reason :/\n      formattedResponse.dialGroupDesc = utils.getText(notif, 'dial_group_desc');\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n\n      return formattedResponse;\n    };\n\n    var DialGroupChangePendingNotification = function () {};\n\n    /*\n     * This class is responsible for handling a DIAL_GROUP_CHANGE_PENDING notification.\n     * This event is sent from IQ when an agent's dial group is changed and the agent is on a call.\n     *\n     * {\n     *     \"ui_notification\": {\n     *         \"@message_id\": \"IQ10012016080515294800318\",\n     *         \"@type\": \"DIAL_GROUP_CHANGE_PENDING\",\n     *         \"agent_id\": { \"#text\": \"1180958\" },\n     *         \"dial_group_id\": { \"#text\": \"50354\" },\n     *         \"update_from_adminui\": { \"#text\": \"TRUE\" }\n     *     }\n     * }\n     */\n    DialGroupChangePendingNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var model = UIModel.getInstance();\n      var notif = notification.ui_notification;\n      model.agentSettings.pendingDialGroupChange = parseInt(\n        utils.getText(notif, 'dial_group_id'),\n        10,\n      );\n\n      // check if request originated with AdminUI\n      if (notif.update_from_adminui) {\n        model.agentSettings.updateDGFromAdminUI =\n          utils.getText(notif, 'update_from_adminui') === true;\n      } else {\n        model.agentSettings.updateDGFromAdminUI = false;\n      }\n\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.message =\n        'Dial Group Change Pending notification received.';\n      formattedResponse.detail =\n        'DialGroup switch for existing session pending until active call ends.';\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.dialGroupId = utils.getText(notif, 'dial_group_id');\n      formattedResponse.updateFromAdminUI = utils.getText(\n        notif,\n        'update_from_adminui',\n      );\n\n      return formattedResponse;\n    };\n\n    var DirectAgentTransferNotification = function () {};\n\n    /*\n     * This class is responsible for handling a DIRECT-AGENT-ROUTE notification.\n     * This event is sent from IQ when an agent is presented a direct transfer, in the case they are not in an\n     * available state to automatically be presented the call.\n     *\n     * {\n     *     \"ui_notification\": {\n     *         \"@message_id\": \"IQ10012016080515294800318\",\n     *         \"@type\": \"DIRECT-AGENT-ROUTE\",\n     *         \"response_to\": { \"#text\": \"\" },\n     *         \"agent_id\": { \"#text\": \"\" },\n     *         \"uii\": { \"#text\": \"\" },\n     *         \"status\": { \"#text\": \"\" },\n     *         \"ani\": { \"#text\": \"\" },\n     *         \"dnis\": { \"#text\": \"\" }\n     *         \"source_type\": { \"#text\": \"\" },\n     *         \"source_id\": { \"#text\": \"\" },\n     *         \"source_name\": { \"#text\": \"\" }\n     *         \"voicemail_url\": { \"#text\": \"\" }\n     *     }\n     * }\n     */\n    DirectAgentTransferNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      var notif = notification.ui_notification;\n\n      formattedResponse.message = 'Received DIRECT-AGENT-ROUTE notification';\n      formattedResponse.status = utils.getText(notif, 'status');\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.ani = utils.getText(notif, 'ani');\n      formattedResponse.dnis = utils.getText(notif, 'dnis');\n      formattedResponse.sourceType = utils.getText(notif, 'source_type');\n      formattedResponse.sourceId = utils.getText(notif, 'source_id');\n      formattedResponse.sourceName = utils.getText(notif, 'source_name');\n      formattedResponse.voicemailUrl = utils.getText(notif, 'voicemail_url');\n\n      return formattedResponse;\n    };\n\n    var DropSessionNotification = function () {};\n\n    /*\n     * This class handles the DROP-SESSION packet from IQ. It doesn't really do anything\n     * besides format a response for the callback notification since there isn't any action needed.\n     *\n     *  {\n     *      \"ui_notification\": {\n     *          \"@message_id\":\"IQ10012016081613222800341\",\n     *          \"@response_to\":\"\",\n     *          \"@type\":\"DROP-SESSION\",\n     *          \"session_id\":{\"#text\":\"3\"},\n     *          \"uii\":{\"#text\":\"201608161322180139000000000124\"}\n     *      }\n     *  }\n     */\n    DropSessionNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      var notif = notification.ui_notification;\n\n      var sessionId = utils.getText(notif, 'session_id');\n      var sessionUII = utils.getText(notif, 'uii');\n      var transfer = UIModel.getInstance().transferSessions[sessionId];\n\n      // Check to see if we just disconnected a transfer session\n      // If so, we need to remove the session from our map\n      if (transfer) {\n        console.log(\n          sessionUII + ' TRANSFER TO ' + transfer.destination + ' TERMINATED',\n        );\n        utils.logMessage(\n          LOG_LEVELS.DEBUG,\n          'Transfer to ' + transfer.destination + ' has terminated',\n          '',\n        );\n        delete UIModel.getInstance().transferSessions[sessionId];\n        formattedResponse.transferEnd = transfer;\n      }\n\n      console.log(sessionUII + ' END SESSION ' + sessionId);\n      formattedResponse.message = 'Received DROP-SESSION Notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.sessionId = utils.getText(notif, 'session_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n\n      return formattedResponse;\n    };\n\n    var EarlyUiiNotification = function () {};\n\n    /*\n     * This class is responsible for handling \"EARLY_UII\" packets from IntelliQueue.\n     * For manual outdials, this gives the uii to cancel a ringing line.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"EARLY_UII\",\n     *          \"agent_id\":{\"#text\":\"1180958\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"}\n     *      }\n     *  }\n     */\n    EarlyUiiNotification.prototype.processResponse = function (notification) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      var notif = notification.ui_notification;\n\n      formattedResponse.message = 'Received EARLY_UII notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n\n      return formattedResponse;\n    };\n\n    var EndCallNotification = function (libInstance) {\n      this.libInstance = libInstance;\n    };\n\n    /*\n     * This class is responsible for handling an END-CALL notification.\n     * Save the packet in the UIModel by appending it to the currentCall packet.\n     * Update the CallState field in the UIModel to \"CALL-ENDED\"\n     *\n     * {\n     *  \"ui_notification\":{\n     *      \"@message_id\":\"IQ982008082910362203349\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"END-CALL\",\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"session_id\":{\"#text\":\"2\"},\n     *      \"call_dts\":{\"#text\":\"2008-08-29 10:36:04\"},\n     *      \"call_duration\":{\"#text\":\"16\"},\n     *      \"term_party\":{\"#text\":\"CALLER\"},\n     *      \"term_reason\":{},\n     *      \"recording_url\":{},\n     *      \"disposition_timeout:{\"#text\":\"60\"}\n     *  }\n     * }\n     */\n    EndCallNotification.prototype.processResponse = function (notification) {\n      var model = UIModel.getInstance();\n      var notif = notification.ui_notification;\n      model.endCallNotification = notification;\n\n      // add callDuration, termParty, and termReason to the current call packet\n      model.currentCall.duration = utils.getText(notif, 'call_duration');\n      model.currentCall.termParty = utils.getText(notif, 'term_party');\n      model.currentCall.termReason = utils.getText(notif, 'term_reason');\n\n      // set call state to \"CALL-ENDED\"\n      model.agentSettings.callState = 'CALL-ENDED';\n      model.agentSettings.onCall = false;\n      model.agentSettings.onManualOutdial = false;\n\n      // Clear out any transfer sessions from the previous call\n      model.transferSessions = {};\n\n      // Check if there is a pending dial group change\n      if (\n        model.agentSettings.pendingDialGroupChange > 0 ||\n        model.agentSettings.pendingDialGroupChange == -1\n      ) {\n        // update dial group id\n        model.loginRequest.dialGroupId =\n          model.agentSettings.pendingDialGroupChange;\n\n        // send login update request\n        this.libInstance.loginAgent(\n          model.loginRequest.queueIds,\n          model.configRequest.chatIds,\n          model.configRequest.skillProfileId,\n          model.configRequest.dialGroupId,\n          model.configRequest.dialDest,\n          model.agentSettings.updateDGFromAdminUI,\n        );\n\n        // reset pending dial group variables\n        model.agentSettings.pendingDialGroupChange = 0;\n        model.agentSettings.updateDGFromAdminUI = false;\n      }\n\n      // start ping call interval timer, sends message every 30 seconds\n      // if this is not a manual outdial and we are not suppressing disposition pop\n      if (\n        model.currentCall.outdialDispositions &&\n        model.currentCall.outdialDispositions.dispositions &&\n        model.currentCall.outdialDispositions.dispositions.length > 0 &&\n        model.currentCall.surveyPopType !== 'SUPPRESS'\n      ) {\n        model.pingIntervalId = setInterval(utils.sendPingCallMessage, 30000);\n      }\n\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.message = 'End Call Notification Received.';\n      formattedResponse.detail = '';\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.sessionId = utils.getText(notif, 'session_id');\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.callDts = utils.getText(notif, 'call_dts');\n      formattedResponse.duration = model.currentCall.duration;\n      formattedResponse.termParty = model.currentCall.termParty;\n      formattedResponse.termReason = model.currentCall.termReason;\n      formattedResponse.recordingUrl = utils.getText(notif, 'recording_url');\n      formattedResponse.dispositionTimeout = utils.getText(\n        notif,\n        'disposition_timeout',\n      );\n\n      return formattedResponse;\n    };\n\n    var GatesChangeNotification = function () {};\n\n    /*\n     * This class is responsible for handling a gates change notification\n     *\n     * {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016080817344100936\",\n     *          \"@type\":\"GATES_CHANGE\",\n     *          \"agent_id\":{\"#text\":\"1180958\"},\n     *          \"gate_ids\":{\"#text\":\"11117,3\"}\n     *      }\n     * }\n     */\n    GatesChangeNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var model = UIModel.getInstance();\n      var notif = notification.ui_notification;\n      var newAssignedGates = [];\n      var availableQueues = model.inboundSettings.availableQueues;\n      var assignedGateIds = utils.getText(notif, 'gate_ids');\n      if (assignedGateIds !== '') {\n        assignedGateIds = assignedGateIds.split(',');\n      }\n\n      for (var a = 0; a < assignedGateIds.length; a++) {\n        // find gate in avail list\n        var id = assignedGateIds[a];\n        var foundGate = utils.findObjById(availableQueues, id, 'gateId');\n        if (foundGate) {\n          newAssignedGates.push(foundGate);\n        } else {\n          // gate not in assigned list, add stub\n          var gate = {\n            gateId: id,\n            gateName: '',\n            gateDesc: '',\n            defaultDestOverride: '',\n            isAgentSelectable: false,\n          };\n          newAssignedGates.push(gate);\n        }\n      }\n\n      model.inboundSettings.queues = JSON.parse(\n        JSON.stringify(newAssignedGates),\n      );\n\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.message = 'Gates Change notification received.';\n      formattedResponse.queues = newAssignedGates;\n\n      return formattedResponse;\n    };\n\n    var GenericNotification = function () {};\n\n    /*\n     * This class is responsible for handling a generic notification\n     *\n     * {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016080317400400011\",\n     *          \"@response_to\":\"1c2fe39f-a31e-aff8-8d23-92a61c88270f\",\n     *          \"@type\":\"GENERIC\",\n     *          \"message_code\":{\"#text\":\"0\"},\n     *          \"message\":{\"#text\":\"OK\"},\n     *          \"detail\":{\"#text\":\"Pending Callback Successfully Cancelled.\"}\n     *      }\n     * }\n     */\n    GenericNotification.prototype.processResponse = function (notification) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n\n      // add message and detail if present\n      formattedResponse.messageCode = utils.getText(\n        notification.ui_notification,\n        'message_code',\n      );\n\n      return formattedResponse;\n    };\n\n    var NewCallNotification = function () {};\n\n    /*\n     * This class processes a \"NEW-CALL\" packet received from Intelliqueue. It will determine\n     * if the call is a regular or monitoring call:\n     * \t\t@Monitoring==true:  set state to ACTIVE-MONITORING, send NewMonitoringCall event\n     * \t\t@Monitoring==false: set state to ACTIVE, send newcall packet and increment total calls\n     *\n     *  {\"ui_notification\":{\n     *      \"@message_id\":\"IQ982010020911335300027\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"NEW-CALL\",\n     *      \"uii\":{\"#text\":\"201002091133350139990000000010\"},\n     *      \"ani\":{\"#text\":\"9548298548\"},\n     *      \"dnis\":{},\n     *      \"dial_dest\":{\"#text\":\"sip:+16789050673@sip.connectfirst.com\"},\n     *      \"call_type\":{\"#text\":\"OUTBOUND\"},\n     *      \"queue_dts\":{\"#text\":\"2010-02-09 11:33:53\"},\n     *      \"queue_time\":{\"#text\":\"-1\"},\n     *      \"agent_id\":{\"#text\":\"657\"},\n     *      \"app_url\":{},\n     *      \"is_monitoring\":{\"#text\":\"FALSE\"},\n     *      \"script_id\":{},\n     *      \"script_version\":{},\n     *      \"survey_id\":{},\n     *      \"survey_pop_type\":{\"#text\":\"SUPPRESS\"},\n     *      \"message\":{},\n     *      \"agent_recording\":{\"@default\":\"ON\",\"@pause\":\"10\",\"#text\":\"TRUE\"},\n     *      \"hangup_on_disposition\":{\"#text\":\"FALSE\"},\n     *      \"gate\":{\n     *          \"@number\":\"17038\",\n     *          \"name\":{\"#text\":\"AM Campaign\"},\n     *          \"description\":{}\n     *      },\n     *      \"outdial_dispositions\":{\n     *          \"@type\":\"CAMPAIGN|GATE\",\n     *          \"disposition\":[\n     *              { \"@contact_forwarding\":\"FALSE\", \"@disposition_id\":\"20556\", \"@is_complete\":\"1\", \"@is_default\"=\"0\", \"@require_note\"=\"0\", \"@save_survey\"=\"1\", \"@xfer\"=\"0\", \"#text\":\"Not Available\"},\n     *              { \"@contact_forwarding\":\"FALSE\", \"@disposition_id\":\"20559\", \"@is_complete\":\"1\", \"@is_default\"=\"1\", \"@require_note\"=\"1\", \"@save_survey\"=\"1\", \"@xfer\"=\"0\", #text\":\"Transfer Not Available\"}\n     *          ]\n     *      },\n     *      \"requeue_shortcuts\":{\n     *          \"requeue_shortcut\":[\n     *              { \"@gate_id\":\"2\", \"@name\":\"test queue\" \"@skill_id\":\"\"}\n     *          ]\n     *      },\n     *      \"baggage\":{\n     *          \"@allow_updates\":\"TRUE\",\n     *          \"@show_lead_passes\":\"TRUE\",\n     *          \"@show_list_name\":\"TRUE\",\n     *          \"aux_phone\":{},\n     *          \"aux_greeting\":{},\n     *          \"aux_external_url\":{},\n     *          \"aux_data1\":{\"#text\":\"BMAK\"},\n     *          \"aux_data2\":{\"#text\":\"BMAK-041653-934\"},\n     *          \"aux_data3\":{\"#text\":\"Call Ctr 1\"},\n     *          \"aux_data4\":{},\n     *          \"aux_data5\":{},\n     *          \"extern_id\":{\"#text\":\"9548298548\"},\n     *          \"lead_id\":{\"#text\":\"64306\"},\n     *          \"lead_passes\":{\"#text\":\"1\"},\n     *          \"first_name\":{\"#text\":\"Ryant\"},\n     *          \"last_name\":{\"#text\":\"Taylor\"},\n     *          \"mid_name\":{},\n     *          \"address1\":{\"#text\":\"8010 Maryland Ave\"},\n     *          \"address2\":{},\n     *          \"city\":{\"#text\":\"Cleveland\"},\n     *          \"state\":{\"#text\":\"OH\"},\n     *          \"zip\":{\"#text\":\"44105\"},\n     *          \"custom_labels\":{\n     *              \"aux_1_label\":{},\n     *              \"aux_2_label\":{},\n     *              \"aux_3_label\":{},\n     *              \"aux_4_label\":{},\n     *              \"aux_5_label\":{}\n     *          }\n     *      },\n     *      \"survey_response\":{\n     *          \"@response_id\":\"24\",\n     *          \"@survey_id\":\"1775\",\n     *          \"details\":{\n     *              \"detail\":[\n     *                  {\"@element_id\":\"9001\",\"@option_id\":\"0\",\"#text\":\"Box 1\"},\n     *                  {\"@element_id\":\"9002\",\"@option_id\":\"0\",\"#text\":\"Area 1\"},\n     *                  {\"@element_id\":\"9003\",\"@option_id\":\"6439\"},\n     *                  {\"@element_id\":\"9004\",\"@option_id\":\"6443\"},\n     *                  {\"@element_id\":\"9004\",\"@option_id\":\"6444\"},\n     *                  {\"@element_id\":\"9005\",\"@option_id\":\"6447\"},\n     *                  {\"@element_id\":\"9006\",\"@option_id\":\"0\",\"#text\":\"11/20/2013\"},\n     *                  {\"@element_id\":\"9015\",\"@option_id\":\"0\",\"#text\":\"Box 2\"},\n     *                  {\"@element_id\":\"9016\",\"@option_id\":\"0\",\"#text\":\"Area 2\"},\n     *                  {\"@element_id\":\"9017\",\"@option_id\":\"6466\"},\n     *                  {\"@element_id\":\"9018\",\"@option_id\":\"6471\"},\n     *                  {\"@element_id\":\"9018\",\"@option_id\":\"6472\"},\n     *                  {\"@element_id\":\"9019\",\"@option_id\":\"6477\"},\n     *                  {\"@element_id\":\"9020\",\"@option_id\":\"0\",\"#text\":\"11/21/2013\"}\n     *             ]\n     *          }\n     *      }\n     *    }\n     *  }\n     */\n    NewCallNotification.prototype.processResponse = function (notification) {\n      var model = UIModel.getInstance();\n      var notif = notification.ui_notification;\n\n      var newCall = utils.buildDefaultResponse(notification);\n      newCall.message = 'Received NEW-CALL notification';\n      newCall.status = 'OK';\n      newCall.uii = utils.getText(notif, 'uii');\n      newCall.agentId = utils.getText(notif, 'agent_id');\n      newCall.dialDest = utils.getText(notif, 'dial_dest');\n      newCall.queueDts = utils.getText(notif, 'queue_dts');\n      newCall.queueTime = utils.getText(notif, 'queue_time');\n      newCall.ani = utils.getText(notif, 'ani');\n      newCall.dnis = utils.getText(notif, 'dnis');\n      newCall.callType = utils.getText(notif, 'call_type');\n      newCall.appUrl = utils.getText(notif, 'app_url');\n      newCall.isMonitoring = utils.getText(notif, 'is_monitoring');\n      newCall.allowHold = utils.getText(notif, 'allow_hold');\n      newCall.allowTransfer = utils.getText(notif, 'allow_transfer');\n      newCall.allowManualInternationalTransfer = utils.getText(\n        notif,\n        'allow_manual_international_transfer',\n      );\n      newCall.allowDirectAgentTransfer = utils.getText(\n        notif,\n        'allow_direct_agent_transfer',\n      );\n      newCall.allowHangup = utils.getText(notif, 'allow_hangup');\n      newCall.allowRequeue = utils.getText(notif, 'allow_requeue');\n      newCall.allowEndCallForEveryone = utils.getText(\n        notif,\n        'allow_endcallforeveryone',\n      );\n      newCall.scriptId = utils.getText(notif, 'script_id');\n      newCall.scriptVersion = utils.getText(notif, 'script_version');\n      newCall.surveyId = utils.getText(notif, 'survey_id');\n      newCall.surveyPopType = utils.getText(notif, 'survey_pop_type');\n      newCall.requeueType = utils.getText(notif, 'requeue_type');\n      newCall.hangupOnDisposition = utils.getText(\n        notif,\n        'hangup_on_disposition',\n      );\n      newCall.callerName = utils.getText(notif, 'caller_name');\n\n      if (newCall.isMonitoring) {\n        newCall.monitoringType = utils.getText(notif, 'monitoring_type'); // FULL, COACHING, MONITOR\n      }\n\n      // set collection values\n      newCall.queue = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'gate',\n      )[0];\n      newCall.agentRecording = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'agent_recording',\n        'agentRecording',\n      )[0];\n      newCall.outdialDispositions = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'outdial_dispositions',\n        'disposition',\n      )[0];\n      newCall.requeueShortcuts =\n        utils.processResponseCollection(\n          notification,\n          'ui_notification',\n          'requeue_shortcuts',\n          'requeueShortcut',\n        )[0] || [];\n      newCall.baggage = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'baggage',\n      )[0];\n      newCall.surveyResponse = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'survey_response',\n        'detail',\n      )[0];\n      newCall.scriptResponse = {};\n      newCall.transferPhoneBook = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'transfer_phone_book',\n      )[0];\n      newCall.lead = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'lead',\n      )[0];\n\n      // parse extra data correctly\n      try {\n        if (notif.lead && notif.lead.extra_data) {\n          delete newCall.lead.extraDatas;\n          newCall.lead.extraData = {};\n          for (var key in notif.lead.extra_data) {\n            newCall.lead.extraData[key] = notif.lead.extra_data[key]['#text'];\n          }\n        }\n      } catch (e) {\n        console.warn('error parsing new call lead extra data: ' + e);\n      }\n\n      if (newCall.baggage) {\n        // process custom labels correctly\n        newCall.baggage.customLabels = {};\n        var notifLabels = notif.baggage['custom_labels'];\n        for (var key in notifLabels) {\n          var result = '';\n          if (notifLabels && notifLabels[key] && notifLabels[key]['#text']) {\n            result = notifLabels[key]['#text'];\n          }\n\n          newCall.baggage.customLabels[key] = result;\n        }\n      }\n\n      // set saved script response if present\n      try {\n        var savedModel = JSON.parse(notif.script_result['#text']).model;\n        var results = {};\n        var keys = Object.keys(savedModel);\n        for (var idx = 0; idx < keys.length; idx++) {\n          var key = keys[idx];\n          var value = savedModel[key].value;\n          results[key] = value;\n        }\n        newCall.scriptResponse = results;\n      } catch (err) {}\n\n      // fix phonebook format\n      if (newCall.transferPhoneBook && newCall.transferPhoneBook.entrys) {\n        newCall.transferPhoneBook = newCall.transferPhoneBook.entrys;\n      }\n\n      // fix requeue shortcuts\n      if (\n        newCall.requeueShortcuts &&\n        newCall.requeueShortcuts.requeueShortcuts\n      ) {\n        newCall.requeueShortcuts = newCall.requeueShortcuts.requeueShortcuts;\n      }\n\n      // if only one disposition, convert to array\n      if (\n        newCall.outdialDispositions &&\n        newCall.outdialDispositions.disposition\n      ) {\n        newCall.outdialDispositions.dispositions = [\n          newCall.outdialDispositions,\n        ];\n      }\n\n      // convert numbers to boolean where applicable\n      newCall.queue.isCampaign = newCall.queue.isCampaign === '1';\n      if (\n        newCall.outdialDispositions &&\n        newCall.outdialDispositions.dispositions\n      ) {\n        for (\n          var d = 0;\n          d < newCall.outdialDispositions.dispositions.length;\n          d++\n        ) {\n          var disp = newCall.outdialDispositions.dispositions[d];\n          disp.isComplete = disp.isComplete === '1';\n          disp.requireNote = disp.requireNote === '1';\n          disp.saveSurvey = disp.saveSurvey === '1';\n          disp.xfer = disp.xfer === '1';\n          disp.isDefault = disp.isDefault === '1';\n        }\n      }\n\n      // Build token map\n      model.callTokens = buildCallTokenMap(notif, newCall);\n      newCall.baggage = model.callTokens; // add all tokens to baggage\n\n      // Is Monitoring Call?\n      if (newCall.isMonitoring) {\n        model.agentSettings.callState = 'ACTIVE-MONITORING';\n      } else {\n        model.agentSettings.callState = 'ACTIVE';\n\n        // check for preloaded transfer number\n        if (newCall.baggage && newCall.baggage.auxPhone != '') {\n          model.transferNumber = newCall.baggage.auxPhone;\n        }\n      }\n\n      // Reset the current call counter for Agent Daily Stats\n      model.agentDailyStats.currCallTime = 0;\n\n      // todo handle scripting??\n\n      model.currentCall = newCall;\n\n      return newCall;\n    };\n\n    function buildCallTokenMap(notif, newCall) {\n      var model = UIModel.getInstance();\n      var tokens = newCall.baggage || {}; // seed with baggage values\n      if (notif.baggage && notif.baggage.generic_key_value_pairs) {\n        var keyValuePairs = [];\n        var keyValuePairsStr = utils.getText(\n          notif.baggage,\n          'generic_key_value_pairs',\n        );\n        if (keyValuePairsStr.length > 0) {\n          keyValuePairs = utils.parseKeyValuePairsFromString(\n            keyValuePairsStr,\n            '|',\n            '::',\n          );\n        }\n\n        for (var keyValue in keyValuePairs) {\n          tokens[keyValue] = keyValuePairs[keyValue];\n        }\n      }\n\n      tokens['ani'] = newCall.ani;\n      tokens['dnis'] = newCall.dnis;\n      tokens['uii'] = newCall.uii;\n\n      try {\n        if (newCall.queue.number) {\n          tokens['sourceId'] = newCall.queue.number || '';\n          tokens['sourceName'] = newCall.queue.name || '';\n          tokens['sourceDesc'] = newCall.queue.description || '';\n\n          if (\n            newCall.queue.isCampaign === '1' ||\n            newCall.queue.isCampaign === true\n          ) {\n            tokens['sourceType'] = 'OUTBOUND';\n          } else {\n            tokens['sourceType'] = 'INBOUND';\n          }\n        } else {\n          tokens['sourceId'] = '0';\n          tokens['sourceType'] = 'MANUAL';\n          tokens['sourceName'] = '';\n          tokens['sourceDesc'] = '';\n        }\n      } catch (any) {\n        console.error(\n          'There was an error processing source tokenization',\n          +any,\n        );\n      }\n\n      try {\n        tokens['agentFirstName'] = model.agentSettings.firstName;\n        tokens['agentLastName'] = model.agentSettings.lastName;\n        tokens['agentExternalId'] = model.agentSettings.externalAgentId;\n        tokens['agentType'] = model.agentSettings.agentType;\n        tokens['agentEmail'] = model.agentSettings.email;\n        tokens['agentUserName'] = model.agentSettings.username;\n      } catch (any) {\n        console.error(\n          'There was an error parsing tokens for agent info. ',\n          any,\n        );\n      }\n\n      return tokens;\n    }\n\n    function isCampaign(gate) {\n      if (gate && gate.isCampaign) {\n        return gate.isCampaign === '1' || gate.isCampaign === true;\n      }\n      return false;\n    }\n\n    var PendingChatDispNotification = function () {};\n\n    /*\n     * This class is responsible for handling a pending chat disposition notification\n     *\n     *  {\n     *       \"ui_notification\":{\n     *           \"@message_id\":\"IQD01DEV2018062912352800014\",\n     *           \"@type\":\"PENDING_CHAT_DISP\",\n     *           \"agent_id\":{ \"#text\":\"1182160\" },\n     *           \"uii\":{ \"#text\":\"201806291234550147950000000000\" },\n     *           \"status\":{ \"#text\":\"false\" }\n     *       }\n     *   }\n     */\n    PendingChatDispNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.message = 'Received PENDING-CHAT-DISP notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.agentId = utils.getText(\n        notification.ui_notification,\n        'agent_id',\n      );\n      formattedResponse.uii = utils.getText(\n        notification.ui_notification,\n        'uii',\n      );\n      formattedResponse.status =\n        utils.getText(notification.ui_notification, 'status') === 'true';\n\n      return formattedResponse;\n    };\n\n    var PendingDispNotification = function () {};\n\n    /*\n     * This class is responsible for handling a generic notification\n     *\n     * {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016080317400400011\",\n     *          \"@type\":\"PENDING_DISP\",\n     *          \"agent_id\":{\"#text\":\"3\"},\n     *          \"status\":{\"#text\":\"false\"}\n     *      }\n     * }\n     */\n    PendingDispNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.message = 'Received PENDING-DISP notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.agentId = utils.getText(\n        notification.ui_notification,\n        'agent_id',\n      );\n      formattedResponse.status = utils.getText(\n        notification.ui_notification,\n        'status',\n      );\n\n      return formattedResponse;\n    };\n\n    var PreviewLeadStateNotification = function () {};\n\n    /*\n     * This class is responsible for processing the lead state packet\n     * received from intelliqueue. It will decide what type of leads are\n     * being processed, and depending on if the callback is true or false, it will\n     * call the appropriate form to update the lead state.\n     *\n     * {\n     *      \"ui_notification\":{\n     *          \"@type\":\"PREVIEW-LEAD-STATE\",\n     *          \"@call_type\":\"MANUAL|PREVIEW\",\n     *          \"@message_id\":\"IQ10012016092715393600184\",\n     *          \"request_id\":{\"#text\":\"IQ10012016092715390900179\"},\n     *          \"lead_state\":{\"#text\":\"ANSWER\"},\n     *          \"callback\":{\"#text\":\"FALSE\"}\n     *      }\n     *   }\n     * }\n     */\n    PreviewLeadStateNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n\n      UIModel.getInstance().agentSettings.onManualOutdial = true;\n\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.callType = notif['@call_type'];\n      formattedResponse.messageId = notif['@message_id'];\n      formattedResponse.requestId = utils.getText(notif, 'request_id');\n      formattedResponse.leadState = utils.getText(notif, 'lead_state');\n      formattedResponse.callback = utils.getText(notif, 'callback');\n\n      return formattedResponse;\n    };\n\n    var ReverseMatchNotification = function () {};\n\n    /*\n     * This class is responsible for processing a REVERSE_MATCH packet from IQ. It\n     * will log the packet was rec'd, save the packet to the UIModel for use by\n     * components like the WhosCallingForm\n     * {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016080317400400011\",\n     *          \"@response_to\":\"1c2fe39f-a31e-aff8-8d23-92a61c88270f\",\n     *          \"@type\":\"REVERSE_MATCH\",\n     *          \"first_name\":{\"#text\":\"\"},\n     *          \"mid_name\":{\"#text\":\"\"},\n     *          \"last_name\":{\"#text\":\"\"},\n     *          \"address1\":{\"#text\":\"\"},\n     *          \"address2\":{\"#text\":\"\"},\n     *          \"city\":{\"#text\":\"\"},\n     *          \"state\":{\"#text\":\"\"},\n     *          \"zip\":{\"#text\":\"\"},\n     *          \"business_name\":{\"#text\":\"\"}\n     *      }\n     * }\n     */\n    ReverseMatchNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var model = UIModel.getInstance();\n\n      model.tokens['first_name'] = utils.getText(notif, 'first_name');\n      model.tokens['mid_name'] = utils.getText(notif, 'mid_name');\n      model.tokens['last_name'] = utils.getText(notif, 'last_name');\n      model.tokens['address1'] = utils.getText(notif, 'address1');\n      model.tokens['address2'] = utils.getText(notif, 'address2');\n      model.tokens['suffix'] = utils.getText(notif, 'suffix');\n      model.tokens['title'] = utils.getText(notif, 'title');\n      model.tokens['city'] = utils.getText(notif, 'city');\n      model.tokens['state'] = utils.getText(notif, 'state');\n      model.tokens['zip'] = utils.getText(notif, 'zip');\n      model.tokens['business_name'] = utils.getText(notif, 'business_name');\n\n      return model.tokens;\n    };\n\n    var TcpaSafeLeadStateNotification = function () {};\n\n    /*\n     * This class is responsible for processing the lead state packet\n     * received from intelliqueue. It will decide what type of leads are\n     * being processed, and depending on if the callback is true or false, it will\n     * call the appropriate form to update the lead state.\n     *\n     * {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016080317400400011\",\n     *          \"@type\":\"TCPA-SAFE-LEAD-STATE\",\n     *          \"@call_type\":\"MANUAL|TCPA-SAFE\",\n     *          \"request_id\":{\"#text\":\"\"},\n     *          \"lead_state\":{\"#text\":\"CALLING\"},\n     *          \"callback\":{\"#text\":\"false\"}\n     *      }\n     * }\n     */\n    TcpaSafeLeadStateNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification);\n      formattedResponse.callType = notif['@call_type'];\n      formattedResponse.messageId = notif['@message_id'];\n      formattedResponse.requestId = utils.getText(notif, 'request_id');\n      formattedResponse.leadState = utils.getText(notif, 'lead_state');\n      formattedResponse.callback = utils.getText(notif, 'callback');\n\n      return formattedResponse;\n    };\n\n    var AckRequest = function (audioType, agentId, uii, monitorAgentId) {\n      this.audioType = audioType || 'FULL';\n      this.agentId = agentId;\n      this.uii = uii;\n      this.monitorAgentId = monitorAgentId;\n    };\n\n    /*\n     * This class processes ACK packets rec'd from IQ.\n     * This is a callback triggered by certain actions like\n     * sending dispositions or script results.\n     * NOTE: uii is added in utils message processing.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008090317393001252\",\n     *      \"@response_to\":\"1112222\",\n     *      \"@type\":\"ACK\",\n     *      \"type\":{\"#text\":\"CHAT-DISPOSITION|INBOUND-DISPOSITION|OUTDIAL-DISPOSITION|SCRIPT-RESULT\"},\n     *      \"status\":{\"#text\":\"OK|FAILURE\"},\n     *      \"message\":{\"#text\":\"\"},\n     *      \"detail\":{}\n     *    }\n     * }\n     */\n    AckRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.type = utils.getText(resp, 'type');\n\n      if (formattedResponse.status === 'OK') {\n        utils.logMessage(LOG_LEVELS.DEBUG, formattedResponse.message, response);\n      } else {\n        utils.logMessage(\n          LOG_LEVELS.WARN,\n          formattedResponse.message + ': ' + formattedResponse.detail,\n          response,\n        );\n      }\n\n      return formattedResponse;\n    };\n\n    var AgentStateRequest = function (agentState, agentAuxState) {\n      if (\n        agentState.toUpperCase() === 'ON-BREAK' &&\n        UIModel.getInstance().agentSettings.onCall === true\n      ) {\n        this.agentState = 'BREAK-AFTER-CALL';\n        this.agentAuxState = '';\n      } else {\n        this.agentState = agentState.toUpperCase() || '';\n        this.agentAuxState = agentAuxState || '';\n      }\n    };\n\n    AgentStateRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.AGENT_STATE,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          state: {\n            '#text': this.agentState,\n          },\n          agent_aux_state: {\n            '#text': this.agentAuxState,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes AGENT-STATE packets rec'd from IQ. It will check the state of the\n     * packet and then set the state on the model. It will also check for deferred surveys,\n     * if one is found it will load it at this point.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082817165103294\",\n     *      \"@type\":\"AGENT-STATE\",\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{},\n     *      \"detail\":{},\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"prev_state\":{\"#text\":\"ENGAGED\"},\n     *      \"current_state\":{\"#text\":\"WORKING\"},\n     *      \"agent_aux_state\":{\"#text\":\"Offhook Work\"},\n     *      \"prev_aux_state\":{}\n     *   }\n     * }\n     */\n    AgentStateRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var status = utils.getText(resp, 'status');\n      var prevState = utils.getText(resp, 'prev_state');\n      var currState = utils.getText(resp, 'current_state');\n      var prevAuxState = utils.getText(resp, 'prev_aux_state');\n      var currAuxState = utils.getText(resp, 'agent_aux_state');\n      var model = UIModel.getInstance();\n\n      // add message and detail if present\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.agentId = response.ui_response.agent_id['#text'] || '';\n      formattedResponse.previousState = prevState;\n      formattedResponse.currentState = currState;\n      formattedResponse.previousAuxState = prevAuxState;\n      formattedResponse.currentAuxState = currAuxState;\n\n      if (status == 'OK') {\n        var prevStateStr = prevState;\n        var currStateStr = currState;\n\n        if (prevAuxState.length > 0) {\n          prevStateStr = prevAuxState;\n        }\n\n        if (currAuxState.length > 0) {\n          currStateStr = currAuxState;\n        }\n\n        // Update the state in the UIModel\n        model.agentSettings.currentState = currState;\n        model.agentSettings.currentStateLabel = currAuxState;\n        model.agentStatePacket = response;\n      } else {\n        if (formattedResponse.message === '') {\n          formattedResponse.message = 'Unable to change agent state';\n        }\n\n        // log message response\n        var message =\n          'Unable to change agent state. ' + formattedResponse.detail;\n        utils.logMessage(LOG_LEVELS.WARN, message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var AuthenticateRequest = function (config) {\n      this.username = config.username;\n      this.password = config.password;\n      this.platformId = config.platformId;\n      this.rcAccessToken = config.rcAccessToken;\n      this.tokenType = config.tokenType;\n      this.engageAccessToken = config.engageAccessToken;\n      this.authType = config.authType;\n    };\n\n    AuthenticateRequest.prototype.sendHttpRequest = function () {\n      UIModel.getInstance().authenticateRequest = this;\n      switch (this.authType) {\n        case AUTHENTICATE_TYPES.USERNAME_PASSWORD:\n          _buildHttpRequest(this.authType, 'login/agent', {\n            username: this.username,\n            password: this.password,\n            platformId: this.platformId,\n          });\n          break;\n        case AUTHENTICATE_TYPES.RC_TOKEN:\n          _buildHttpRequest(this.authType, 'login/rc/accesstoken', {\n            rcAccessToken: this.rcAccessToken,\n            rcTokenType: this.tokenType,\n          });\n          break;\n        case AUTHENTICATE_TYPES.ENGAGE_TOKEN:\n          _buildHttpRequest(this.authType, 'login', {});\n          break;\n      }\n    };\n\n    /*\n     * response:\n     * {\n     *   \"refreshToken\": \"223867e6-ad0f-4af1-bbe7-5090d8259065\",\n     *   \"accessToken\": \"\",\n     *   \"tokenType\": \"Bearer\",\n     *   \"platformId\": \"local\",\n     *   \"iqUrl\": \"d01-dev.vacd.biz\",\n     *   \"port\": 8080,\n     *   \"agentDetails\": [\n     *       {\n     *           \"agentId\": 1,\n     *           \"firstName\": \"D\",\n     *           \"lastName\": \"LB\",\n     *           \"email\": \"dlb@somewhere.com\",\n     *           \"username\": \"dlbooks\"\n     *       }\n     *   ],\n     *   \"adminId\": null,\n     *   \"mainAccountId\": \"99990000\"\n     * }\n     */\n    AuthenticateRequest.prototype.processResponse = function (response) {\n      var model = UIModel.getInstance();\n      model.authenticatePacket = response; // raw response packet\n      model.authenticateRequest.accessToken = response.accessToken; // TODO - dlb - store in local storage\n      model.authenticateRequest.refreshToken = response.refreshToken;\n      model.authenticateRequest.tokenType = response.tokenType;\n      model.authenticateRequest.socketUrl = response.iqUrl;\n      model.authenticateRequest.socketPort = response.port;\n      model.authenticateRequest.agents = response.agentDetails;\n      model.authenticateRequest.platformId = response.platformId;\n      model.authenticateRequest.mainAccountId = response.mainAccountId;\n\n      return model.authenticateRequest;\n    };\n\n    function _buildHttpRequest(authType, path, queryParams) {\n      var model = UIModel.getInstance();\n      var baseUrl = model.authHost + model.baseAuthUri;\n      var params = {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      };\n\n      switch (authType) {\n        case AUTHENTICATE_TYPES.USERNAME_PASSWORD:\n        case AUTHENTICATE_TYPES.RC_TOKEN:\n          params['queryParams'] = queryParams;\n          var errorMsg =\n            'Error on agent authenticate POST to engage-auth. URL: ' +\n            baseUrl +\n            path;\n          new HttpService(baseUrl).httpPost(path, params).then(\n            function (response) {\n              try {\n                response = JSON.parse(response.response);\n\n                var authenticateResponse = UIModel.getInstance().authenticateRequest.processResponse(\n                  response,\n                );\n                utils.fireCallback(\n                  UIModel.getInstance().libraryInstance,\n                  CALLBACK_TYPES.AUTHENTICATE,\n                  authenticateResponse,\n                );\n              } catch (err) {\n                utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n              }\n            },\n            function (err) {\n              var errResponse = {\n                type: 'Authenticate Error',\n                message: errorMsg,\n                err: err,\n              };\n              utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n              utils.fireCallback(\n                UIModel.getInstance().libraryInstance,\n                CALLBACK_TYPES.AUTHENTICATE,\n                errResponse,\n              );\n            },\n          );\n          break;\n        case AUTHENTICATE_TYPES.ENGAGE_TOKEN:\n          var errMsg =\n            'Error on agent authenticate GET to engage-auth. URL: ' +\n            baseUrl +\n            path;\n          params.headers['Authorization'] =\n            'Bearer ' +\n            utils.toString(\n              UIModel.getInstance().authenticateRequest.engageAccessToken,\n            );\n          new HttpService(baseUrl).httpGet(path, params).then(\n            function (response) {\n              try {\n                response = JSON.parse(response.response);\n\n                var authenticateResponse = UIModel.getInstance().authenticateRequest.processResponse(\n                  response,\n                );\n                utils.fireCallback(\n                  UIModel.getInstance().libraryInstance,\n                  CALLBACK_TYPES.AUTHENTICATE,\n                  authenticateResponse,\n                );\n              } catch (err) {\n                utils.logMessage(LOG_LEVELS.WARN, errMsg, err);\n              }\n            },\n            function (err) {\n              utils.logMessage(LOG_LEVELS.WARN, errMsg, err);\n              utils.fireCallback(\n                UIModel.getInstance().libraryInstance,\n                CALLBACK_TYPES.AUTHENTICATE,\n                err,\n              );\n            },\n          );\n          break;\n      }\n    }\n\n    var BargeInRequest = function (audioType, agentId, uii, monitorAgentId) {\n      this.audioType = audioType || 'FULL';\n      this.agentId = agentId;\n      this.uii = uii;\n      this.monitorAgentId = monitorAgentId;\n    };\n\n    /*\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UIV22008931055822\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"BARGE-IN\",\n     *      \"agent_id\":{\"#text\":\"94\"},\n     *      \"uii\":{\"#text\":\"200809031054510000000900020961\"},\n     *      \"audio_state\":{\"#text\":\"FULL\"},\n     *      \"monitor_agent_id\":{\"#text\":\"1856\"}\n     *    }\n     * }\n     */\n    BargeInRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.BARGE_IN,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          audio_state: {\n            '#text': utils.toString(this.audioType),\n          },\n          monitor_agent_id: {\n            '#text': utils.toString(this.monitorAgentId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes BARGE-IN packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008090317393001252\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"BARGE-IN\",\n     *      \"agent_id\":{\"#text\":\"94\"},\n     *      \"uii\":{},\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{\"#text\":\"Barge-In processed successfully!\"},\n     *      \"detail\":{}\n     *    }\n     * }\n     */\n    BargeInRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.agentId = utils.getText(resp, 'agent_id');\n      formattedResponse.uii = utils.getText(resp, 'uii');\n\n      if (formattedResponse.status === 'OK') {\n        utils.logMessage(LOG_LEVELS.DEBUG, formattedResponse.message, response);\n      } else {\n        utils.logMessage(\n          LOG_LEVELS.WARN,\n          'There was an error processing the Barge-In request. ' +\n            formattedResponse.detail,\n          response,\n        );\n      }\n\n      return formattedResponse;\n    };\n\n    var CallNotesRequest = function (notes) {\n      this.notes = notes;\n    };\n\n    /*\n     * This event is responsible for allowing an agent to tag a call with notes\n     */\n    CallNotesRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          '@type': MESSAGE_TYPES.CALL_NOTES,\n          agent_id: {\n            '#text': utils.toString(model.agentSettings.agentId),\n          },\n          uii: {\n            '#text': utils.toString(model.currentCall.uii),\n          },\n          notes: {\n            '#text': utils.toString(this.notes),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class process CALL-NOTES packets rec'd from IntelliQueue.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082817165103294\",\n     *      \"@type\":\"CALL-NOTES\",\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{},\n     *      \"detail\":{}\n     *   }\n     * }\n     */\n    CallNotesRequest.prototype.processResponse = function (response) {\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      if (formattedResponse.status === 'OK') {\n        formattedResponse.message = 'Call notes have been updated.';\n        formattedResponse.type = 'INFO_EVENT';\n      } else {\n        formattedResponse.type = 'ERROR_EVENT';\n        formattedResponse.message = 'Unable to update notes.';\n      }\n\n      return formattedResponse;\n    };\n\n    var CallbackCancelRequest = function (leadId, agentId) {\n      this.agentId = agentId || UIModel.getInstance().agentSettings.agentId;\n      this.leadId = leadId;\n    };\n\n    CallbackCancelRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CALLBACK_CANCEL,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': this.agentId,\n          },\n          lead_id: {\n            '#text': this.leadId,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    // NOTE: cancel callback response sent as a generic notification message\n\n    var CallbacksPendingRequest = function (agentId) {\n      this.agentId = agentId || UIModel.getInstance().agentSettings.agentId;\n    };\n\n    CallbacksPendingRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CALLBACK_PENDING,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': this.agentId,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling an PENDING-CALLBACKS response packet from IntelliQueue.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008091512353000875\",\n     *      \"@response_to\":\"UIV220089151235539\",\n     *      \"@type\":\"PENDING-CALLBACKS\",\n     *      \"lead\":{\n     *          \"@aux_data1\":\"\",\n     *          \"@aux_data2\":\"\",\n     *          \"@aux_data3\":\"\",\n     *          \"@aux_data4\":\"\",\n     *          \"@aux_data5\":\"\",\n     *          \"@destination\":\"5555555555\",\n     *          \"@dial_group_id\":\"\",\n     *          \"@dial_group_name\":\"\",\n     *          \"@dial_time\":\"2016-08-03 10:00\",\n     *          \"@extern_id\":\"\",\n     *          \"@lead_id\":\"\",\n     *          \"lead_id\":{},\n     *          \"extern_id\":{},\n     *          \"extern_id\":{},\n     *          \"first_name\":{},\n     *          \"mid_name\":{},\n     *          \"last_name\":{},\n     *          \"suffix\":{},\n     *          \"title\":{},\n     *          \"address1\":{},\n     *          \"address2\":{},\n     *          \"city\":{},\n     *          \"state\":{},\n     *          \"zip\":{},\n     *          \"gate_keeper\":{}\n     *      }\n     *   }\n     * }\n     */\n    CallbacksPendingRequest.prototype.processResponse = function (response) {\n      var leadsRaw = response.ui_response.lead;\n      var leads = [];\n      if (!Array.isArray(leadsRaw)) {\n        leadsRaw = [leadsRaw];\n      }\n\n      for (var l = 0; l < leadsRaw.length; l++) {\n        var leadRaw = leadsRaw[l];\n        if (leadRaw == null) {\n          continue;\n        }\n\n        leads.push(parseLead(leadRaw));\n      }\n\n      UIModel.getInstance().agentSettings.pendingCallbacks = JSON.parse(\n        JSON.stringify(leads),\n      );\n\n      return UIModel.getInstance().agentSettings.pendingCallbacks;\n    };\n\n    function parseLead(leadRaw) {\n      var lead = {\n        auxData1: leadRaw['@aux_data1'],\n        auxData2: leadRaw['@aux_data2'],\n        auxData3: leadRaw['@aux_data3'],\n        auxData4: leadRaw['@aux_data4'],\n        auxData5: leadRaw['@aux_data5'],\n        destination: leadRaw['@destination'],\n        dialGroupId: leadRaw['@dial_group_id'],\n        dialGroupName: leadRaw['@dial_group_name'],\n        dialTime: leadRaw['@dial_time'],\n        externId: leadRaw['@extern_id'],\n        leadId: leadRaw['@lead_id'],\n        firstName: utils.getText(leadRaw, 'first_name'),\n        midName: utils.getText(leadRaw, 'mid_name'),\n        lastName: utils.getText(leadRaw, 'last_name'),\n        sufix: utils.getText(leadRaw, 'suffix'),\n        title: utils.getText(leadRaw, 'title'),\n        address1: utils.getText(leadRaw, 'address1'),\n        address2: utils.getText(leadRaw, 'address2'),\n        city: utils.getText(leadRaw, 'city'),\n        state: utils.getText(leadRaw, 'state'),\n        zip: utils.getText(leadRaw, 'zip'),\n        gateKeeper: utils.getText(leadRaw, 'gate_keeper'),\n      };\n\n      return lead;\n    }\n\n    /*\n     * This request is used to get the list of dispositions for a given campaign\n     * E.g. in the lead search form for manual passes\n     *\n     */\n    var CampaignDispositionsRequest = function (campaignId) {\n      this.agentId = UIModel.getInstance().agentSettings.agentId;\n      this.campaignId = campaignId;\n    };\n\n    CampaignDispositionsRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CAMPAIGN_DISPOSITIONS,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          campaign_id: {\n            '#text': utils.toString(this.campaignId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling CAMPAIGN-DISPOSITIONS packets received\n     * from IntelliQueue. It will save a copy of it in the UIModel.\n     *\n     * {\"ui_response\":{\n     *      \"@campaign_id\":\"60403\",\n     *      \"@message_id\":\"IQ10012016081813480400006\",\n     *      \"@response_to\":\"0b61c3ca-c4fc-9942-c139-da4978053c9d\",\n     *      \"@type\":\"CAMPAIGN-DISPOSITIONS\",\n     *      \"outdial_dispositions\":{\n     *          \"disposition\":[\n     *              {\"@disposition_id\":\"1\",\"#text\":\"requeue\"},\n     *              {\"@disposition_id\":\"2\",\"#text\":\"complete\"}\n     *          ]\n     *       }\n     *    }\n     * }\n     */\n    CampaignDispositionsRequest.prototype.processResponse = function (\n      response,\n    ) {\n      var resp = response.ui_response;\n      var model = UIModel.getInstance();\n      var dispositions = utils.processResponseCollection(\n        resp,\n        'outdial_dispositions',\n        'disposition',\n        'disposition',\n      );\n\n      model.outboundSettings.campaignDispositions = dispositions;\n      return dispositions;\n    };\n\n    var ChatStateRequest = function (chatState) {\n      this.chatState = (chatState && chatState.toUpperCase()) || '';\n    };\n\n    ChatStateRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_STATE,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          state: {\n            '#text': this.chatState,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes CHAT-STATE packets rec'd from IQ. It will check the state of the\n     * packet and then set the state on the model.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082817165103294\",\n     *      \"@type\":\"AGENT-STATE\",\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{},\n     *      \"detail\":{},\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"prev_state\":{\"#text\":\"CHAT-PRESENTED\"},\n     *      \"current_state\":{\"#text\":\"CHAT-ENGAGED\"}\n     *   }\n     * }\n     */\n    ChatStateRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var status = utils.getText(resp, 'status');\n      var prevState = utils.getText(resp, 'prev_state');\n      var currState = utils.getText(resp, 'current_state');\n      var model = UIModel.getInstance();\n\n      // add message and detail if present\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.agentId = response.ui_response.agent_id['#text'] || '';\n      formattedResponse.previousState = prevState;\n      formattedResponse.currentState = currState;\n\n      if (status == 'OK') {\n        // Update the state in the UIModel\n        model.agentSettings.currentChatState = currState;\n        model.chatStatePacket = response;\n      } else {\n        if (formattedResponse.message === '') {\n          formattedResponse.message = 'Unable to change chat state';\n        }\n\n        // log message response\n        var message =\n          'Unable to change chat state. ' + formattedResponse.detail;\n        utils.logMessage(LOG_LEVELS.WARN, message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var XferColdRequest = function (dialDest, callerId, sipHeaders, countryId) {\n      this.dialDest = dialDest;\n      this.callerId = callerId || '';\n      this.sipHeaders = sipHeaders || [];\n      this.countryId = countryId || '';\n    };\n\n    XferColdRequest.prototype.formatJSON = function () {\n      var fields = [];\n      for (var i = 0; i < this.sipHeaders.length; i++) {\n        var fieldObj = this.sipHeaders[i];\n        fields.push({\n          '@name': utils.toString(fieldObj.name),\n          '@value': utils.toString(fieldObj.value),\n        });\n      }\n\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.XFER_COLD,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          uii: {\n            '#text': UIModel.getInstance().currentCall.uii,\n          },\n          dial_dest: {\n            '#text': utils.toString(this.dialDest),\n          },\n          caller_id: {\n            '#text': utils.toString(this.callerId),\n          },\n          country_id: {\n            '#text': utils.toString(this.countryId),\n          },\n          xfer_header: fields,\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes COLD-XFER packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ10012016082314475000219\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"COLD-XFER\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"uii\":{\"#text\":\"201608231447590139000000000200\"},\n     *      \"session_id\":{\"#text\":\"3\"},\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"dial_dest\":{\"#text\":\"3038593775\"},\n     *      \"message\":{\"#text\":\"OK\"},\n     *      \"detail\":{}\n     *   }\n     * }\n     */\n    XferColdRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.agentId = utils.getText(resp, 'agent_id');\n      formattedResponse.uii = utils.getText(resp, 'uii');\n      formattedResponse.sessionId = utils.getText(resp, 'session_id');\n      formattedResponse.dialDest = utils.getText(resp, 'dial_dest');\n\n      if (formattedResponse.status === 'OK') {\n      } else {\n        // log message response\n        var message =\n          'There was an error processing the Cold Xfer request. ' +\n          formattedResponse.message +\n          ' : ' +\n          formattedResponse.detail;\n        utils.logMessage(LOG_LEVELS.WARN, message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var DirectAgentTransfer = function (targetAgentId, transferType, uii) {\n      this.targetAgentId = targetAgentId;\n      this.transferType = transferType;\n      this.uii = uii || UIModel.getInstance().currentCall.uii;\n    };\n\n    DirectAgentTransfer.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.DIRECT_AGENT_TRANSFER,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(model.agentSettings.agentId),\n          },\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          target_agent_id: {\n            '#text': utils.toString(this.targetAgentId),\n          },\n          transfer_type: {\n            '#text': utils.toString(this.transferType),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes DIRECT-AGENT-TRANSFER packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ10012016082314475000219\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"DIRECT-AGENT-TRANSFER\",\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{\"#text\":\"OK\"},\n     *      \"type\":{\"#text\":\"WARM|COLD|CANCEL\"}\n     *   }\n     * }\n     */\n    DirectAgentTransfer.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n      formattedResponse.type = utils.getText(resp, 'type');\n\n      if (formattedResponse.status !== 'OK') {\n        // log message response\n        var message =\n          'There was an error processing the Direct Agent Transfer request. ' +\n          formattedResponse.message +\n          ' : ' +\n          formattedResponse.detail;\n        utils.logMessage(LOG_LEVELS.WARN, message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var DirectAgentTransferList = function () {};\n\n    DirectAgentTransferList.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.DIRECT_AGENT_TRANSFER_LIST,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes DIRECT-AGENT-TRANSFER-LIST packets rec'd from IQ.\n     *\n     *  {\n     *      \"ui_response\":{\n     *          \"@message_id\":\"IQD01DEV2018052917202600038\",\n     *          \"@response_to\":\"f0b2e8a3-87fe-13ee-4d00-9d145bfe2be8\",\n     *          \"@type\":\"DIRECT-AGENT-TRANSFER-LIST\",\n     *          \"status\":{\n     *              \"#text\":\"true\"\n     *          },\n     *          \"message\":{\n     *              \"#text\":\"OK\"\n     *          },\n     *          \"agents\": [\n     *             {\n     *                 \"@agent_aux_state\":\"AVAILABLE\",\n     *                 \"@agent_id\":\"1184160\",\n     *                 \"@agent_state\":\"AVAILABLE\",\n     *                 \"@available\":\"true\",\n     *                 \"@first_name\":\"ross\",\n     *                 \"@last_name\":\"m\",\n     *                 \"@pending_disp\":\"false\",\n     *                 \"@state_duration\":\"379\",\n     *                 \"@username\":\"rm1\"\n     *             },\n     *             {\n     *                 \"@agent_aux_state\":\"AVAILABLE\",\n     *                 \"@agent_id\":\"1184161\",\n     *                 \"@agent_state\":\"AVAILABLE\",\n     *                 \"@available\":\"true\",\n     *                 \"@first_name\":\"ross\",\n     *                 \"@last_name\":\"m\",\n     *                 \"@pending_disp\":\"false\",\n     *                 \"@state_duration\":\"84\",\n     *                 \"@username\":\"rm2\"\n     *             }\n     *         ]\n     *      }\n     *  }\n     */\n    DirectAgentTransferList.prototype.processResponse = function (response) {\n      var formattedResponse = utils.buildDefaultResponse(response);\n      formattedResponse.agents = utils.processResponseCollection(\n        response,\n        'ui_response',\n        'agents',\n      );\n\n      if (formattedResponse.status !== 'OK') {\n        // log message response\n        var message =\n          'There was an error processing the Direct Agent Transfer List request. ' +\n          formattedResponse.message +\n          ' : ' +\n          formattedResponse.detail;\n        utils.logMessage(LOG_LEVELS.WARN, message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var DispositionRequest = function (\n      uii,\n      dispId,\n      notes,\n      callback,\n      callbackDTS,\n      contactForwardNumber,\n      survey,\n      externId,\n      leadId,\n      requestId,\n    ) {\n      this.uii = uii;\n      this.dispId = dispId;\n      this.notes = notes;\n      this.callback = callback;\n      this.callbackDTS = callbackDTS || '';\n      this.contactForwardNumber = contactForwardNumber || null;\n      this.externId = externId || null; // outbound-disposition only\n      this.leadId = leadId || null; // outbound-disposition only\n      this.requestId = requestId || null; // outbound-disposition only (pipe leads)\n\n      /*\n       * survey = {\n       *      first_name: {\n       *          leadField: \"first_name\"\n       *          value: \"Geoff\"\n       *      },\n       *      last_name: {\n       *          leadField: \"last_name\"\n       *          value: \"Mina\"\n       *      }\n       *      ...\n       * }\n       */\n      this.survey = survey || null;\n    };\n\n    /*\n     * This class is responsible for creating an inbound or outbound disposition packet to\n     * send to intelliqueue. It will grab uii and agent_id directly from packets saved\n     * in the UIModel. Then, using the information passed in, it will\n     * create the remainder of the packet. This class is called from the ExtendedCallForm\n     *\n     * {\"ui_request\":{\n     *      \"@message_id\":\"IQ20160817145840132\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"OUTDIAL-DISPOSITION|INBOUND-DISPOSITION\",\n     *      \"session_id\":{\"#text\":\"2\"},  <-- ONLY WHEN AVAILABLE otherwise the node is left blank. this is the AGENT session_id\n     *      \"uii\":{\"#text\":\"201608171658440139000000000165\"},\n     *      \"agent_id\":{\"#text\":\"1180958\"},\n     *      \"lead_id\":{\"#text\":\"1800\"},                 <-- OUTDIAL-DISPOSITION ONLY\n     *      \"outbound_externid\":{\"#text\":\"3038593775\"}, <-- OUTDIAL-DISPOSITION ONLY\n     *      \"pending_request_id\":{\"#text\":\"\"},          <-- OUTDIAL-DISPOSITION ONLY\n     *      \"disposition_id\":{\"#text\":\"5950\"},\n     *      \"notes\":{\"#text\":\"note here\"},\n     *      \"call_back\":{\"#text\":\"FALSE\"},\n     *      \"call_back_DTS\":{},\n     *      \"contact_forwarding\":{},\n     *      \"survey\":{\n     *          \"response\":[\n     *              {\"@extern_id\":\"text_box\",\"@lead_update_column\":\"\",\"#text\":\"hello\"},\n     *              {\"@extern_id\":\"check_box\",\"@lead_update_column\":\"\",\"#text\":\"20\"},\n     *              {\"@extern_id\":\"radio_save\",\"@lead_update_column\":\"\",\"#text\":\"23\"}\n     *          ]\n     *      }\n     *   }\n     * }\n     */\n    DispositionRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          '@type': MESSAGE_TYPES.OUTDIAL_DISPOSITION,\n          agent_id: {\n            '#text': utils.toString(model.agentSettings.agentId),\n          },\n          session_id: {\n            '#text': '',\n          },\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          disposition_id: {\n            '#text': utils.toString(this.dispId),\n          },\n          notes: {\n            '#text': utils.toString(this.notes),\n          },\n          call_back: {\n            '#text': this.callback === true ? 'TRUE' : 'FALSE',\n          },\n          call_back_DTS: {\n            '#text': utils.toString(this.callbackDTS),\n          },\n          contact_forwarding: {\n            '#text': utils.toString(this.contactForwardNumber),\n          },\n          outbound_externid: {\n            '#text': utils.toString(this.externId),\n          },\n          lead_id: {\n            '#text': utils.toString(this.leadId),\n          },\n          pending_request_id: {\n            '#text': utils.toString(this.requestId),\n          },\n        },\n      };\n\n      if (\n        model.currentCall.outdialDispositions &&\n        model.currentCall.outdialDispositions.type === 'GATE'\n      ) {\n        msg.ui_request['@type'] = MESSAGE_TYPES.INBOUND_DISPOSITION;\n      }\n\n      if (model.currentCall.sessionId) {\n        msg.ui_request.session_id = { '#text': model.currentCall.sessionId };\n      }\n\n      /*\n       * converts survey to this response\n       * survey : {\n       *      response: [\n       *          { \"@extern_id\":\"\", \"@lead_update_column\":\"\", \"#text\":\"\" }\n       *      ]\n       * }\n       */\n      if (this.survey !== null) {\n        var response = [];\n        var keys = Object.keys(this.survey);\n        for (var i = 0; i < keys.length; i++) {\n          var key = keys[i];\n          var obj = {\n            '@extern_id': key,\n            '@lead_update_column': utils.toString(this.survey[key].leadField),\n            '#text': utils.toString(this.survey[key].value),\n          };\n          response.push(obj);\n        }\n        msg.ui_request.survey = { response: response };\n      }\n\n      return JSON.stringify(msg);\n    };\n\n    var DispositionManualPassRequest = function (\n      dispId,\n      notes,\n      callback,\n      callbackDTS,\n      leadId,\n      requestId,\n      externId,\n    ) {\n      this.dispId = dispId;\n      this.notes = notes;\n      this.callback = callback;\n      this.callbackDTS = callbackDTS || '';\n      this.leadId = leadId || null;\n      this.requestId = requestId || null;\n      this.externId = externId || null;\n    };\n\n    /*\n     * Sends an OUTDIAL-DISPOSITION request, just a separate class\n     * specifically for dispositions on manual pass.\n     *\n     * {\"ui_request\":{\n     *      \"@message_id\":\"UIV220089241119416\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"OUTDIAL-DISPOSITION\",\n     *      \"manual_disp\":{\"#text\":\"TRUE\"},\n     *      \"request_key\":{\"#text\":\"IQ10012016081719070100875\"},\n     *      \"session_id\":{},\n     *      \"uii\":{},\n     *      \"agent_id\":{\"#text\":\"1810\"},\n     *      \"lead_id\":{\"#text\":\"213215\"},\n     *      \"outbound_externid\":{\"#text\":\"909809\"},\n     *      \"disposition_id\":{\"#text\":\"126\"},\n     *      \"notes\":{\"#text\":\"here are my notes :)\"},\n     *      \"call_back\":{\"#text\":\"TRUE | FALSE\"},\n     *      \"call_back_DTS\":{\"#text\":\"2008-09-30 22:30:00 | null\"},\n     *      \"contact_forwarding\":{\"#text\":\"null\"}\n     *    }\n     * }\n     */\n    DispositionManualPassRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          '@type': MESSAGE_TYPES.OUTDIAL_DISPOSITION,\n          manual_disp: {\n            '#text': 'TRUE',\n          },\n          agent_id: {\n            '#text': utils.toString(model.agentSettings.agentId),\n          },\n          request_key: {\n            '#text': utils.toString(this.requestId),\n          },\n          disposition_id: {\n            '#text': utils.toString(this.dispId),\n          },\n          notes: {\n            '#text': utils.toString(this.notes),\n          },\n          call_back: {\n            '#text': this.callback === true ? 'TRUE' : 'FALSE',\n          },\n          call_back_DTS: {\n            '#text': utils.toString(this.callbackDTS),\n          },\n          lead_id: {\n            '#text': utils.toString(this.leadId),\n          },\n          extern_id: {\n            '#text': utils.toString(this.externId),\n          },\n          contact_forwarding: {\n            '#text': 'null',\n          },\n          session_id: {},\n          uii: {},\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var ExtensionPresenceRequest = function () {};\n\n    ExtensionPresenceRequest.prototype.getExtensionPresenceInfo = function (\n      extensionIds,\n    ) {\n      UIModel.getInstance().ExtensionPresenceRequest = this;\n      _getExtensionPresenceInfo('rcdirectory/getExtensionPresenceStatus', {\n        extensionIds: extensionIds,\n      });\n    };\n\n    ExtensionPresenceRequest.prototype.processResponse = function (response) {\n      UIModel.getInstance().extensionPresenceResponse = response;\n      return UIModel.getInstance().extensionPresenceResponse;\n    };\n\n    function _getExtensionPresenceInfo(path, queryParams) {\n      var model = UIModel.getInstance();\n      var baseUrl = model.authHost + model.baseApiUri;\n      var engageAccessToken =\n        'Bearer ' +\n        utils.toString(\n          UIModel.getInstance().authenticateRequest.engageAccessToken,\n        );\n      var params = {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      };\n\n      params.headers['Authorization'] = engageAccessToken;\n      params['queryParams'] = queryParams;\n      var errorMsg =\n        'Error while fetching extension presence response. URL: ' +\n        baseUrl +\n        path;\n\n      new HttpService(baseUrl).httpGet(path, params).then(\n        function (response) {\n          try {\n            response = JSON.parse(response.response);\n            var extensionPresenceResponse = UIModel.getInstance().extensionPresenceRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              UIModel.getInstance().libraryInstance,\n              CALLBACK_TYPES.EXTENSION_PRESENCE,\n              extensionPresenceResponse,\n            );\n          } catch (err) {\n            utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n          }\n        },\n        function (err) {\n          var errResponse = {\n            type: 'Error while fetching extension presence response.',\n            message: errorMsg,\n          };\n          utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n\n          // still fire callback on error response\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.EXTENSION_PRESENCE,\n            errResponse,\n          );\n        },\n      );\n    }\n\n    var HangupRequest = function (sessionId, resetPendingDisp) {\n      this.sessionId = sessionId || null;\n      this.resetPendingDisp = resetPendingDisp || false;\n    };\n\n    HangupRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.HANGUP,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          uii: {\n            '#text': utils.toString(UIModel.getInstance().currentCall.uii),\n          },\n          session_id: {\n            '#text': utils.toString(\n              this.sessionId === null\n                ? UIModel.getInstance().currentCall.sessionId\n                : this.sessionId,\n            ),\n          },\n          cancel_pending_disp: {\n            '#text': this.resetPendingDisp === true ? 'TRUE' : 'FALSE',\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var HoldRequest = function (holdState, sessionId) {\n      this.holdState = holdState;\n      this.sessionId = sessionId || '1';\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"HOLD\",\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"session_id\":{\"#text\":\"1\"},\n     *      \"hold_state\":{\"#text\":\"ON\"}\n     *    }\n     * }\n     */\n    HoldRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.HOLD,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(model.currentCall.agentId),\n          },\n          uii: {\n            '#text': utils.toString(model.currentCall.uii),\n          },\n          session_id: {\n            '#text': utils.toString(this.sessionId),\n          },\n          hold_state: {\n            '#text':\n              this.holdState === true || this.holdState === 'true'\n                ? 'ON'\n                : 'OFF',\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes HOLD packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082910361503344\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"HOLD\",\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"session_id\":{\"#text\":\"1\"},\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{},\n     *      \"detail\":{},\n     *      \"hold_state\":{\"#text\":\"ON\"}\n     *    }\n     * }\n     */\n    HoldRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n      var currUII = '';\n      if (UIModel.getInstance().currentCall.uii) {\n        currUII = UIModel.getInstance().currentCall.uii;\n      }\n\n      formattedResponse.holdState = utils.getText(resp, 'hold_state') === 'ON';\n      formattedResponse.sessionId = utils.getText(resp, 'session_id');\n      formattedResponse.uii = utils.getText(resp, 'uii');\n\n      if (formattedResponse.status === 'OK') {\n        // make sure we are talking about the same call\n        if (formattedResponse.uii === currUII) {\n          if (formattedResponse.message === '') {\n            formattedResponse.message =\n              'Broadcasting new hold state of ' + formattedResponse.holdState;\n          }\n          utils.logMessage(\n            LOG_LEVELS.DEBUG,\n            'Broadcasting new hold state of ' + formattedResponse.holdState,\n            response,\n          );\n        } else {\n          utils.logMessage(\n            LOG_LEVELS.DEBUG,\n            'Hold Response is for a different call...discarding',\n            response,\n          );\n        }\n      } else {\n        if (formattedResponse.message === '') {\n          formattedResponse.message =\n            'Error processing HOLD request. ' +\n            +formattedResponse.message +\n            '\\n' +\n            formattedResponse.detail;\n        }\n        utils.logMessage(\n          LOG_LEVELS.WARN,\n          'Error processing HOLD request. ' + formattedResponse.detail,\n          response,\n        );\n      }\n\n      var model = UIModel.getInstance();\n      if (\n        formattedResponse.sessionId !== '1' &&\n        model.transferSessions[formattedResponse.sessionId]\n      ) {\n        // we have a hold for a transfer session\n        model.transferSessions[formattedResponse.sessionId].onHold =\n          formattedResponse.holdState;\n      }\n\n      return formattedResponse;\n    };\n\n    var LeadHistoryRequest = function (leadId) {\n      this.leadId = leadId;\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"LEAD-HISTORY\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"lead_id\":{\"#text\":\"12\"},\n     *    }\n     * }\n     */\n    LeadHistoryRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LEAD_HISTORY,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(model.agentSettings.agentId),\n          },\n          lead_id: {\n            '#text': utils.toString(this.leadId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes LEAD-HISTORY packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@lead_id\":\"2653\",\n     *      \"@message_id\":\"IQ982008091512353000875\",\n     *      \"@response_to\":\"UIV220089151235539\",\n     *      \"@type\":\"LEAD-HISTORY\",\n     *      \"previous_dial\":{\n     *          \"@agent_name\":\"mandy pants (mandy)\",\n     *          \"@duration\":\"\",\n     *          \"@pass_disposition\":\"\",\n     *          \"@pass_dts\":\"2008-09-15 12:35:27\",\n     *          \"@pass_number\":\"\",\n     *          \"@pass_uii\":\"200809151234140000000900021288\",\n     *          \"agent_notes\":{\"#text\":\"This person was incredibly nice and agreed to buy donuts. \"},\n     *          \"agent_disposition\":{\"#text\":\"Incomplete\"}\n     *      }\n     *   }\n     * }\n     *\n     * OR\n     *\n     * {\"ui_response\":{\n     *      \"@lead_id\":\"2653\",\n     *      \"@message_id\":\"IQ982008091512353000875\",\n     *      \"@response_to\":\"UIV220089151235539\",\n     *      \"@type\":\"LEAD-HISTORY\",\n     *      \"previous_dial\":[\n     *        {\n     *          \"@agent_name\":\"mandy pants (mandy)\",\n     *          \"@duration\":\"\",\n     *          \"@pass_disposition\":\"\",\n     *          \"@pass_dts\":\"2008-09-15 12:35:27\",\n     *          \"@pass_number\":\"\",\n     *          \"@pass_uii\":\"200809151234140000000900021288\",\n     *          \"agent_notes\":{\"#text\":\"This person was incredibly nice and agreed to buy donuts. \"},\n     *          \"agent_disposition\":{\"#text\":\"Incomplete\"}\n     *        },\n     *        {\n     *          \"@agent_name\":\"mandy pants (mandy)\",\n     *          \"@duration\":\"\",\n     *          \"@pass_disposition\":\"\",\n     *          \"@pass_dts\":\"2008-09-15 12:35:27\",\n     *          \"@pass_number\":\"\",\n     *          \"@pass_uii\":\"200809151234140000000900021288\",\n     *          \"agent_notes\":{\"#text\":\"This person was incredibly nice and agreed to buy donuts. \"},\n     *          \"agent_disposition\":{\"#text\":\"Incomplete\"}\n     *        }\n     *      ]\n     *   }\n     * }\n     */\n    LeadHistoryRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var histResponse = {\n        leadId: resp['@lead_id'],\n      };\n\n      var history = utils.processResponseCollection(\n        response,\n        'ui_response',\n        'previous_dial',\n      );\n\n      // always return array, even if only one item\n      if (!Array.isArray(history)) {\n        history = [history];\n      }\n      histResponse.leadHistory = history;\n\n      return histResponse;\n    };\n\n    var LeadInsertRequest = function (dataObj) {\n      // handle boolean value conversion\n      if (dataObj.agent_reserved && dataObj.agent_reserved === true) {\n        dataObj.agent_reserved = '1';\n      } else {\n        dataObj.agent_reserved = '0';\n      }\n\n      if (dataObj.dialable && dataObj.dialable === true) {\n        dataObj.dialable = '1';\n      } else {\n        dataObj.dialable = '0';\n      }\n\n      this.dataObj = dataObj;\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"LEAD-INSERT\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"campaign_id\":{\"#text\":\"\"},\n     *      \"lead_phone\":{\"#text\":\"\"},\n     *      \"dialable\":{\"#text\":\"\"},\n     *      \"agent_reserved\":{\"#text\":\"\"},\n     *      \"callback_dts\":{\"#text\":\"\"},\n     *      \"first_name\":{\"#text\":\"\"},\n     *      \"mid_name\":{\"#text\":\"\"},\n     *      \"last_name\":{\"#text\":\"\"},\n     *      \"suffix\":{\"#text\":\"\"},\n     *      \"title\":{\"#text\":\"\"},\n     *      \"address1\":{\"#text\":\"\"},\n     *      \"address2\":{\"#text\":\"\"},\n     *      \"city\":{\"#text\":\"\"},\n     *      \"state\":{\"#text\":\"\"},\n     *      \"zip\":{\"#text\":\"\"},\n     *      \"email\":{\"#text\":\"\"},\n     *      \"gateKeeper\":{\"#text\":\"\"},\n     *      \"aux_data1\":{\"#text\":\"\"},\n     *      \"aux_data2\":{\"#text\":\"\"},\n     *      \"aux_data3\":{\"#text\":\"\"},\n     *      \"aux_data4\":{\"#text\":\"\"},\n     *      \"aux_data5\":{\"#text\":\"\"},\n     *    }\n     * }\n     */\n    LeadInsertRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LEAD_INSERT,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(this.dataObj.agent_id),\n          },\n          campaign_id: {\n            '#text': utils.toString(this.dataObj.campaign_id),\n          },\n          lead_phone: {\n            '#text': utils.toString(this.dataObj.lead_phone),\n          },\n          dialable: {\n            '#text': utils.toString(this.dataObj.dialable),\n          },\n          agent_reserved: {\n            '#text': utils.toString(this.dataObj.agent_reserved),\n          },\n          call_back_dts: {\n            '#text': utils.toString(this.dataObj.callback_dts),\n          },\n          first_name: {\n            '#text': utils.toString(this.dataObj.first_name),\n          },\n          mid_name: {\n            '#text': utils.toString(this.dataObj.mid_name),\n          },\n          last_name: {\n            '#text': utils.toString(this.dataObj.last_name),\n          },\n          suffix: {\n            '#text': utils.toString(this.dataObj.suffix),\n          },\n          title: {\n            '#text': utils.toString(this.dataObj.title),\n          },\n          address1: {\n            '#text': utils.toString(this.dataObj.address1),\n          },\n          address2: {\n            '#text': utils.toString(this.dataObj.address2),\n          },\n          city: {\n            '#text': utils.toString(this.dataObj.city),\n          },\n          state: {\n            '#text': utils.toString(this.dataObj.state),\n          },\n          zip: {\n            '#text': utils.toString(this.dataObj.zip),\n          },\n          email: {\n            '#text': utils.toString(this.dataObj.email),\n          },\n          gate_keeper: {\n            '#text': utils.toString(this.dataObj.gate_keeper),\n          },\n          aux_data1: {\n            '#text': utils.toString(this.dataObj.aux_data1),\n          },\n          aux_data2: {\n            '#text': utils.toString(this.dataObj.aux_data2),\n          },\n          aux_data3: {\n            '#text': utils.toString(this.dataObj.aux_data3),\n          },\n          aux_data4: {\n            '#text': utils.toString(this.dataObj.aux_data4),\n          },\n          aux_data5: {\n            '#text': utils.toString(this.dataObj.aux_data5),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes LEAD-INSERT packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008091512353000875\",\n     *      \"@response_to\":\"UIV220089151235539\",\n     *      \"@type\":\"LEAD-INSERT\",\n     *      \"status\":{\"#text\":\"TRUE|FALSE\"},\n     *      \"msg\":{\"#text\":\"\"},\n     *      \"detail\":{\"#text\":\"\"},\n     *   }\n     * }\n     */\n    LeadInsertRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.message = resp.msg['#text'];\n\n      return formattedResponse;\n    };\n\n    var LeadUpdateRequest = function (leadId, leadPhone, baggage) {\n      this.leadId = leadId;\n      this.leadPhone = leadPhone;\n      this.baggage = baggage;\n      this.agentId = utils.toString(\n        UIModel.getInstance().agentSettings.agentId,\n      );\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"LEAD-UPDATE\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"lead_id\":{\"#text\":\"12\"},\n     *      \"lead_phone\":{\"#text\":\"12\"},\n     *       \"baggage\":{\n     *          \"lead_id\":{\"#text\":\"64306\"},\n     *          \"extern_id\":{\"#text\":\"9548298548\"},\n     *          \"first_name\":{\"#text\":\"Ryant\"},\n     *          \"mid_name\":{},\n     *          \"last_name\":{\"#text\":\"Taylor\"},\n     *          \"state\":{\"#text\":\"OH\"},\n     *          \"aux_data1\":{\"#text\":\"BMAK\"},\n     *          \"aux_data2\":{\"#text\":\"BMAK-041653-934\"},\n     *          \"aux_data3\":{\"#text\":\"Call Ctr 1\"},\n     *          \"aux_data4\":{},\n     *          \"aux_data5\":{},\n     *          \"address1\":{\"#text\":\"8010 Maryland Ave\"},\n     *          \"address2\":{},\n     *          \"city\":{\"#text\":\"Cleveland\"},\n     *          \"zip\":{\"#text\":\"44105\"},\n     *          \"aux_external_url\":{},\n     *          \"aux_greeting\":{},\n     *          \"aux_phone\":{}\n     *      },\n     *    }\n     * }\n     */\n    LeadUpdateRequest.prototype.formatJSON = function () {\n      // make sure required baggage fields are present\n      this.baggage = _formatBaggage(this.baggage);\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LEAD_UPDATE,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': this.agentId,\n          },\n          lead_id: {\n            '#text': utils.toString(this.leadId),\n          },\n          lead_phone: {\n            '#text': utils.toString(this.leadPhone),\n          },\n          baggage: this.baggage,\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes LEAD-UPDATE packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008091512353000875\",\n     *      \"@response_to\":\"UIV220089151235539\",\n     *      \"@type\":\"LEAD-UPDATE\",\n     *      \"status\":{\"#text\":\"TRUE|FALSE\"},\n     *      \"msg\":{\"#text\":\"64306\"},\n     *      \"detail\":{\"#text\":\"64306\"},\n     *   }\n     * }\n     */\n    LeadUpdateRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.message = resp.msg['#text'];\n\n      return formattedResponse;\n    };\n\n    var _formatBaggage = function (baggage) {\n      var bag = {};\n      bag.first_name = { '#text': baggage.first_name || '' };\n      bag.mid_name = { '#text': baggage.mid_name || '' };\n      bag.last_name = { '#text': baggage.last_name || '' };\n      bag.suffix = { '#text': baggage.suffix || '' };\n      bag.title = { '#text': baggage.title || '' };\n      bag.address1 = { '#text': baggage.address1 || '' };\n      bag.address2 = { '#text': baggage.address2 || '' };\n      bag.city = { '#text': baggage.city || '' };\n      bag.state = { '#text': baggage.state || '' };\n      bag.zip = { '#text': baggage.zip || '' };\n      bag.email = { '#text': baggage.email || '' };\n      bag.gate_keeper = { '#text': baggage.gate_keeper || '' };\n      bag.extern_id = { '#text': baggage.extern_id || '' };\n      bag.aux_data1 = { '#text': baggage.aux_data1 || '' };\n      bag.aux_data2 = { '#text': baggage.aux_data2 || '' };\n      bag.aux_data3 = { '#text': baggage.aux_data3 || '' };\n      bag.aux_data4 = { '#text': baggage.aux_data4 || '' };\n      bag.aux_data5 = { '#text': baggage.aux_data5 || '' };\n\n      return bag;\n    };\n\n    var LoginRequest = function (\n      dialDest,\n      queueIds,\n      chatIds,\n      skillProfileId,\n      dialGroupId,\n      updateFromAdminUI,\n      isForce,\n    ) {\n      this.queueIds = queueIds || [];\n      this.chatIds = chatIds || [];\n      this.skillProfileId = skillProfileId || '';\n      this.dialGroupId = dialGroupId || '';\n      this.dialDest = dialDest || '';\n      this.updateFromAdminUI = updateFromAdminUI || false;\n      this.loginType = 'NO-SELECTION';\n      this.updateLogin = false;\n      this.isForce = isForce;\n\n      // Remove any ids agent doesn't have access to\n      var model = UIModel.getInstance();\n      this.queueIds = utils.checkExistingIds(\n        model.inboundSettings.availableQueues,\n        this.queueIds,\n        'gateId',\n      );\n      this.chatIds = utils.checkExistingIds(\n        model.chatSettings.availableChatQueues,\n        this.chatIds,\n        'chatQueueId',\n      );\n      this.skillProfileId =\n        utils.checkExistingIds(\n          model.inboundSettings.availableSkillProfiles,\n          [this.skillProfileId],\n          'profileId',\n        )[0] || '';\n      this.dialGroupId =\n        utils.checkExistingIds(\n          model.outboundSettings.availableOutdialGroups,\n          [this.dialGroupId],\n          'dialGroupId',\n        )[0] || '';\n\n      // Set loginType value\n      if (this.queueIds.length > 0 && this.dialGroupId !== '') {\n        this.loginType = 'BLENDED';\n      } else if (this.queueIds.length > 0) {\n        this.loginType = 'INBOUND';\n      } else if (this.dialGroupId !== '') {\n        this.loginType = 'OUTBOUND';\n      } else if (this.chatIds.length > 0) {\n        this.loginType = 'CHAT';\n      } else {\n        this.loginType = 'NO-SELECTION';\n      }\n\n      // set updateLogin value\n      if (model.agentSettings.isLoggedIn) {\n        this.updateLogin = true;\n        this.dialDest = UIModel.getInstance().agentSettings.dialDest;\n      }\n\n      // validate dialDest is sip or 10-digit num\n      if (!utils.validateDest(this.dialDest)) {\n        utils.logMessage(\n          LOG_LEVELS.WARN,\n          'dialDest [' +\n            this.dialDest +\n            '] must be a valid sip or 10-digit DID',\n          '',\n        );\n      }\n    };\n\n    LoginRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LOGIN,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          access_token: {\n            '#text': UIModel.getInstance().authenticateRequest.accessToken,\n          },\n          hash_code: {\n            '#text': UIModel.getInstance().connectionSettings.hashCode,\n          },\n          allow_multisocket: {\n            '#text': utils.toString(\n              UIModel.getInstance().applicationSettings.allowMultiSocket,\n            ),\n          },\n          dial_dest: {\n            '#text': utils.toString(this.dialDest),\n          },\n          login_type: {\n            '#text': this.loginType,\n          },\n          update_login: {\n            '#text': utils.toString(this.updateLogin),\n          },\n          outdial_group_id: {\n            '#text': utils.toString(this.dialGroupId),\n          },\n          skill_profile_id: {\n            '#text': utils.toString(this.skillProfileId),\n          },\n          update_from_adminui: {\n            '#text': utils.toString(this.updateFromAdminUI),\n          },\n          agent_platform_id: {\n            '#text': utils.toString(2), // Hard-coded platformId for agent-js repo\n          },\n          is_force: {\n            '#text': utils.toString(this.isForce),\n          },\n        },\n      };\n\n      // add arrays\n      var queueIds = [];\n      for (var i = 0; i < this.queueIds.length; i++) {\n        if (this.queueIds[i] !== '') {\n          queueIds.push({ '#text': utils.toString(this.queueIds[i]) });\n        }\n      }\n      if (queueIds.length > 0) {\n        msg.ui_request.gates = { gate_id: queueIds };\n      } else {\n        msg.ui_request.gates = {};\n      }\n\n      var chatIds = [];\n      for (var i = 0; i < this.chatIds.length; i++) {\n        if (this.chatIds[i] !== '') {\n          chatIds.push({ '#text': utils.toString(this.chatIds[i]) });\n        }\n      }\n      if (chatIds.length > 0) {\n        msg.ui_request.chat_queues = { chat_queue_id: chatIds };\n      } else {\n        msg.ui_request.chat_queues = {};\n      }\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This function is responsible for handling the response to Login from IntelliQueue.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ10012016082513212000447\",\n     *      \"@response_to\":\"IQ201608251121200\",\n     *      \"@type\":\"LOGIN\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"status\":{\"#text\":\"SUCCESS\"},\n     *      \"message\":{\"#text\":\"Hello Geoffrey Mina!\"},\n     *      \"detail\":{\"#text\":\"Logon request processed successfully!\"},\n     *      \"hash_code\":{\"#text\":\"404946966\"},\n     *      \"login_type\":{\"#text\":\"BLENDED\"},\n     *      \"outdial_group_id\":{\"#text\":\"50692\"},\n     *      \"skill_profile_id\":{\"#text\":\"1513\"},\n     *      \"gates\":{\n     *          \"gate_id\":[\n     *              {\"#text\":\"11116\"},\n     *              {\"#text\":\"11117\"}\n     *          ]\n     *      },\n     *      \"chat_queues\":{\n     *          \"chat_queue_id\":{\"#text\":\"30\"}\n     *      }\n     *    }\n     * }\n     */\n    LoginRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var status = utils.getText(resp, 'status');\n      var detail = utils.getText(resp, 'detail');\n      var model = UIModel.getInstance();\n      var message = '';\n      var formattedResponse = utils.buildDefaultResponse(response);\n      var Lib = UIModel.getInstance().libraryInstance;\n      var isReconnect = false;\n\n      if (detail === 'Logon Session Configuration Updated!') {\n        // this is an update login packet\n        model.agentSettings.updateLoginMode = true;\n\n        message = 'Logon Session Configuration Updated!';\n        utils.logMessage(LOG_LEVELS.INFO, message, response);\n      }\n\n      if (status === 'SUCCESS') {\n        if (!model.agentSettings.isLoggedIn) {\n          // fresh login, set UI Model properties\n          model.loginPacket = response;\n          model.agentSettings.isLoggedIn = true;\n          model.agentSettings.loginDTS = new Date();\n          model.connectionSettings.reconnect = true;\n          model.agentPermissions.allowLeadSearch = false;\n          model.agentSettings.dialDest = utils.getText(resp, 'dial_dest');\n          model.agentSettings.loginType = utils.getText(resp, 'login_type');\n          model.agentSettings.accountId = utils.getText(resp, 'account_id');\n          model.agentSettings.corporateDirectory = utils.getText(\n            resp,\n            'corporate_dir',\n          );\n          model.agentSettings.consultCall = utils.getText(\n            resp,\n            'is_consultcall',\n          );\n\n          model.connectionSettings.isMultiSocket =\n            utils.getText(resp, 'is_multisocket') === 'true';\n\n          // If we allow multisocket, lets setup a listener for other tabs to request data\n          if (\n            model.applicationSettings.allowMultiSocket === true ||\n            model.connectionSettings.isMultiSocket === true\n          ) {\n            broadcastChannelHelper.init();\n          }\n\n          // Set collection values\n          setDialGroupSettings(response);\n          setGateSettings(response);\n          setChatQueueSettings(response);\n          setSkillProfileSettings(response);\n        } else {\n          if (model.agentSettings.updateLoginMode) {\n            model.agentSettings.dialDest = utils.getText(resp, 'dial_dest');\n            model.agentSettings.loginType = utils.getText(resp, 'login_type');\n            model.agentSettings.accountId = utils.getText(resp, 'account_id');\n\n            // This was an update login request\n            model.agentSettings.updateLoginMode = false;\n\n            // reset to false before updating dial group settings\n            model.agentPermissions.allowLeadSearch = false;\n            model.agentPermissions.requireFetchedLeadsCalled = false;\n            model.agentPermissions.allowPreviewLeadFilters = false;\n\n            // Set collection values\n            setDialGroupSettings(response);\n            setGateSettings(response);\n            setChatQueueSettings(response);\n            setSkillProfileSettings(response);\n          } else {\n            // this was a reconnect\n            isReconnect = true;\n            message = 'Processed a Layer 2 Reconnect Successfully';\n\n            model.agentSettings.onCall = utils.getText(resp, 'is_on_call');\n            model.connectionSettings.activeCallUii = utils.getText(\n              resp,\n              'active_call_uii',\n            );\n            model.connectionSettings.isPendingDisp = utils.getText(\n              resp,\n              'is_pending_disp',\n            );\n\n            if (model.agentSettings.onCall === false) {\n              if (model.currentCall.uii) {\n                var mockEndCallPacket = {\n                  ui_notification: {\n                    '@message_id': '',\n                    '@type': 'END-CALL',\n                    uii: { '#text': model.currentCall.uii },\n                    term_reason: { '#text': 'SOCKET-DISCONNECT' },\n                  },\n                };\n\n                utils.processNotification(Lib, mockEndCallPacket);\n              }\n\n              if (model.agentSettings.isOffhook) {\n                var offHookTermPacket = {\n                  ui_notification: {\n                    agent_id: {\n                      '#text': UIModel.getInstance().agentSettings.agentId,\n                    },\n                    '@type': 'OFF-HOOK-TERM',\n                    '@message_id': '',\n                  },\n                };\n\n                var agentProcessOffhookCallback = utils.processNotification(\n                  Lib,\n                  offHookTermPacket,\n                );\n                Lib.offhookTerm(agentProcessOffhookCallback);\n              }\n            } else if (\n              model.agentSettings.onCall &&\n              (model.currentCall.uii !==\n                model.connectionSettings.activeCallUii ||\n                Lib.waitingForAddSession === true)\n            ) {\n              //if the agent does not know it is on a call, but IQ thinks it is on a call\n              //normally in the case of disconnect during transition\n\n              model.currentCall.uii = model.connectionSettings.activeCallUii;\n              model.currentCall.pendingDisp = false;\n              Lib.hangup(1, true);\n            } else {\n              //agent still is on call and there are transferSessions, verify no transferSession were drop\n              var activeAgentUiSessions = Lib.getTransferSessions();\n              var activeAgentSessions = response.ui_response.active_call_sessions.call_session_id.map(\n                function (sessionObj) {\n                  return sessionObj['#text'];\n                },\n              );\n\n              for (var transferSession in activeAgentUiSessions) {\n                if (activeAgentSessions.indexOf(transferSession) === -1) {\n                  //if the active ui session is no longer active, we need to tell the ui\n                  delete UIModel.getInstance().transferSessions[\n                    transferSession\n                  ];\n                }\n              }\n            }\n\n            utils.logMessage(LOG_LEVELS.INFO, message, response);\n          }\n        }\n\n        // always update guid and agent login hashcode if found\n        model.connectionSettings.hashCode =\n          utils.getText(resp, 'hash_code') || model.connectionSettings.hashCode;\n        model.agentSettings.guid =\n          utils.getText(resp, 'guid') || model.agentSettings.guid;\n        model.dataStore.save('agent_id', utils.getText(resp, 'agent_id'));\n        model.dataStore.save('hash_code', utils.getText(resp, 'hash_code'));\n\n        formattedResponse.agentSettings = model.agentSettings;\n        formattedResponse.agentPermissions = model.agentPermissions;\n        formattedResponse.applicationSettings = model.applicationSettings;\n        formattedResponse.chatSettings = model.chatSettings;\n        formattedResponse.connectionSettings = model.connectionSettings;\n        formattedResponse.inboundSettings = model.inboundSettings;\n        formattedResponse.outboundSettings = model.outboundSettings;\n        formattedResponse.scriptSettings = model.scriptSettings;\n        formattedResponse.isReconnect = isReconnect;\n      } else {\n        // Login failed\n        if (formattedResponse.message === '') {\n          formattedResponse.message =\n            'Agent configuration attempt failed (2nd layer login)';\n        }\n        utils.logMessage(LOG_LEVELS.WARN, formattedResponse.message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    function setDialGroupSettings(response) {\n      var model = UIModel.getInstance();\n      var outdialGroups = model.outboundSettings.availableOutdialGroups;\n      model.outboundSettings.outdialGroup = {}; // reset\n      for (var g = 0; g < outdialGroups.length; g++) {\n        var group = outdialGroups[g];\n        if (\n          group.dialGroupId === response.ui_response.outdial_group_id['#text']\n        ) {\n          model.agentPermissions.allowLeadSearch = group.allowLeadSearch;\n          model.agentPermissions.allowPreviewLeadFilters =\n            group.allowPreviewLeadFilters;\n          model.agentPermissions.progressiveEnabled = group.progressiveEnabled;\n          model.outboundSettings.outdialGroup = JSON.parse(\n            JSON.stringify(group),\n          ); // copy object\n\n          // Only used for Preview or TCPA Safe accounts.\n          // If set to true, only allow fetching new leads when current leads are called or expired\n          model.agentPermissions.requireFetchedLeadsCalled =\n            group.requireFetchedLeadsCalled;\n        }\n      }\n    }\n\n    function setSkillProfileSettings(response) {\n      var model = UIModel.getInstance();\n      model.inboundSettings.skillProfile = {};\n      var skillProfiles = model.inboundSettings.availableSkillProfiles;\n      for (var s = 0; s < skillProfiles.length; s++) {\n        var profile = skillProfiles[s];\n        var responseId = utils.getText(\n          response.ui_response,\n          'skill_profile_id',\n        );\n        if (profile.profileId === responseId) {\n          model.inboundSettings.skillProfile = JSON.parse(\n            JSON.stringify(profile),\n          ); // copy object\n        }\n      }\n    }\n\n    function setGateSettings(response) {\n      var model = UIModel.getInstance();\n      var gates = model.inboundSettings.availableQueues;\n      var selectedGateIds = [];\n      var selectedGates = [];\n      var gateIds = response.ui_response.gates.gate_id || [];\n\n      if (!Array.isArray(gateIds)) {\n        gateIds = [gateIds];\n      }\n\n      for (var s = 0; s < gateIds.length; s++) {\n        var obj = gateIds[s];\n        selectedGateIds.push(obj['#text']);\n      }\n\n      for (var gIdx = 0; gIdx < gates.length; gIdx++) {\n        var gate = gates[gIdx];\n        if (selectedGateIds.indexOf(gate.gateId) > -1) {\n          selectedGates.push(gate);\n        }\n      }\n\n      model.inboundSettings.queues = JSON.parse(JSON.stringify(selectedGates)); // copy array\n    }\n\n    function setChatQueueSettings(response) {\n      var model = UIModel.getInstance();\n      var chatQueues = model.chatSettings.availableChatQueues;\n      var selectedChatQueueIds = [];\n      var selectedChatQueues = [];\n      var cQueues = response.ui_response.chat_queues || {};\n      var chatQueueIds = cQueues.chat_queue_id || [];\n\n      if (!Array.isArray(chatQueueIds)) {\n        chatQueueIds = [chatQueueIds];\n      }\n\n      for (var c = 0; c < chatQueueIds.length; c++) {\n        var obj = chatQueueIds[c];\n        selectedChatQueueIds.push(obj['#text']);\n      }\n\n      for (var cIdx = 0; cIdx < chatQueues.length; cIdx++) {\n        var chatQueue = chatQueues[cIdx];\n        if (selectedChatQueueIds.indexOf(chatQueue.chatQueueId) > -1) {\n          selectedChatQueues.push(chatQueue);\n        }\n      }\n\n      model.chatSettings.chatQueues = JSON.parse(\n        JSON.stringify(selectedChatQueues),\n      ); // copy array\n    }\n\n    var LoginPhase1Request = function () {};\n\n    LoginPhase1Request.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LOGIN_PHASE_1,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          reconnect: {\n            '#text': utils.toString(\n              UIModel.getInstance().connectionSettings.reconnect,\n            ),\n          },\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          access_token: {\n            '#text': utils.toString(\n              UIModel.getInstance().authenticateRequest.accessToken,\n            ),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This function is responsible for handling the login packet received from IntelliServices. It will save\n     * a copy of it in the UIModel as loginPacket, as well as set the isLoggedInIS variable to\n     * true (for reconnect purposes) and the loginDTS with the current date/time.\n     *\n     * {\"ui_response\":{\n     *      \"@type\":\"login\",\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"is_sso:{\"#text\":\"TRUE\"|\"FALSE\"},\n     *      \"agent_id\":{\"#text\":\"1810\"},\n     *      \"agent_pwd\":{\"#text\":\"bound25\"},\n     *      \"first_name\":{\"#text\":\"mandy\"},\n     *      \"last_name\":{\"#text\":\"pants\"},\n     *      \"email\":{\"#text\":\"mandypants@aol.coim\"},\n     *      \"agent_type\":{\"#text\":\"AGENT\"},\n     *      \"external_agent_id\":{\"#text\":\"blahblah\"},\n     *      \"default_login_dest\":{\"#text\":\"9548298548|123\"},\n     *      \"alt_default_login_dest\":{\"#text\":\"9548298548|123\"},\n     *      \"iq_url\":{\"#text\":\"dev.connectfirst.com\"},\n     *      \"iq_port\":{\"#text\":\"1313\"},\n     *      \"iq_ssl_port\":{\"#text\":\"1213\"},\n     *      \"iq_secret_key\":{\"#text\":\"F-OFF\"},\n     *      \"enable_call_contact_history\":{\"#text\":\"TRUE\"|\"FALSE\"},\n     *      \"allow_inbound\":{\"#text\":\"1\"},\n     *      \"allow_outbound\":{\"#text\":\"1\"},\n     *      \"allow_chat\":{\"#text\":\"1\"},\n     *      \"allow_blended\":{\"#text\":\"0\"},\n     *      \"allow_off_hook\":{\"#text\":\"1\"},\n     *      \"allow_call_control\":{\"#text\":\"1\"},\n     *      \"allow_login_control\":{\"#text\":\"1\"},\n     *      \"allow_login_updates\":{\"#text\":\"1\"},\n     *      \"allow_lead_inserts\":{\"#text\":\"1\"},\n     *      \"show_lead_history\":{\"#text\":\"1\"},\n     *      \"allow_cross_gate_requeue\":{\"#text\":\"1\"},\n     *      \"phone_login_dial_group\":{\"#text\":\"44\"},\n     *      \"phone_login_pin\":{\"#text\":\"1234\"},\n     *      \"allow_manual_calls\":{\"#text\":\"1\"},\n     *      \"allow_manual_intl_calls\":{\"#text\":\"0\"},\n     *      \"init_login_state\":{\"#text\":\"ON-BREAK\"},\n     *      \"init_login_state_label\":{\"#text\":\"Morning Break\"},\n     *      \"outbound_prepay\":{\"#text\":\"0\"},\n     *      \"max_break_time\":{\"#text\":\"-1\"},\n     *      \"max_lunch_time\":{\"#text\":\"-1\"},\n     *      \"allow_lead_search\":{\"#text\":\"YES_ALL\"},\n     *      \"tcpa_safe_mode\":{\"#text\":\"1|0\"},\n     *      \"pci_enabled\":{\"#text\":\"1|0\"},\n     *      \"login_gates\":{\n     *          \"gate\":[\n     *              {\"@default_dest_override\":\"\",\"@gate_desc\":\"\",\"@gate_id\":\"37\",\"@gate_name\":\"test\"},\n     *              {\"@default_dest_override\":\"\",\"@gate_desc\":\"\",\"@gate_id\":\"42\",\"@gate_name\":\"test gate two\"},\n     *              {\"@default_dest_override\":\"\",\"@gate_desc\":\"\",\"@gate_id\":\"43\",\"@gate_name\":\"test gate three\"},\n     *              {\"@default_dest_override\":\"\",\"@gate_desc\":\"Amandas Other Gate\",\"@gate_id\":\"46\",\"@gate_name\":\"You know it!\"}\n     *          ]\n     *      },\n     *      \"login_chat_queues\":{\n     *          \"chat_queue\":[\n     *              {\"@chat_queue_description\":\"\",\"@chat_queue_id\":\"\",\"@chat_queue_name\":\"\"},\n     *              {\"@chat_queue_description\":\"\",\"@chat_queue_id\":\"\",\"@chat_queue_name\":\"\"}\n     *          ]\n     *      },\n     *      \"outdial_groups\":{\n     *          \"group\":[\n     *              {\"@billing_key\":\"\",\"@dial_group_desc\":\"\",\"@dial_group_id\":\"44\",\"@dial_group_name\":\"Geoff Dial Test\",\"@dial_mode\":\"PREDICTIVE\"},\n     *              {\"@billing_key\":\"2\",\"@dial_group_desc\":\"AutoDial Configured Dial Group\",\"@dial_group_id\":\"46\",\"@dial_group_name\":\"Phone Only test5\",\"@dial_mode\":\"PREDICTIVE\"},\n     *              {\"@billing_key\":\"\",\"@dial_group_desc\":\"Test\",\"@dial_group_id\":\"200000\",\"@dial_group_name\":\"Test\",\"@dial_mode\":\"PREDICTIVE\"},\n     *              {\"@billing_key\":\"\",\"@dial_group_desc\":\"Test\",\"@dial_group_id\":\"200010\",\"@dial_group_name\":\"Carissa's Test Group\",\"@dial_mode\":\"PREDICTIVE\"}\n     *          ]\n     *      },\"skill_profiles\":{\n     *          \"profile\":[\n     *              {\"@profile_desc\":\"\",\"@profile_id\":\"571\",\"@profile_name\":\"skill1\"},\n     *              {\"@profile_desc\":\"\",\"@profile_id\":\"572\",\"@profile_name\":\"skill2\"}\n     *          ]\n     *      },\n     *      \"requeue_gates\":{\n     *          \"gate_group\":[\n     *              {\n     *                  \"@gate_group_id\":\"18\",\n     *                  \"@group_name\":\"new gate group\",\n     *                  \"gates\":{\n     *                      \"gate\":[\n     *                          {\"@gate_desc\":\"\",\"@gate_id\":\"37\",\"@gate_name\":\"test\"},\n     *                          {\"@gate_desc\":\"\",\"@gate_id\":\"43\",\"@gate_name\":\"test gate three\"},\n     *                          {\"@gate_desc\":\"\",\"@gate_id\":\"42\",\"@gate_name\":\"test gate two\"}\n     *                      ]\n     *                  },\n     *                  \"skills\":{\n     *                      \"skill\":[\n     *                          {\"@skill_desc\":\"\",\"@skill_id\":\"58\",\"@skill_name\":\"one\"},\n     *                          {\"@skill_desc\":\"\",\"@skill_id\":\"59\",\"@skill_name\":\"two\"},\n     *                      ]\n     *                  }\n     *              }\n     *          ]\n     *      },\n     *      \"chat_rooms\":{},\n     *      \"scripts\": {\n     *           \"script\": {\n     *               \"@script_id\": \"15\",\n     *               \"@script_name\": \"Don't Read This Script\"\n     *           }\n     *      },\n     *      \"campaigns\": {\n     *          \"campaign\": {\n     *              \"@allow_lead_updates\": \"\",\n     *              \"@campaign_id\": \"\",\n     *              \"@campaign_name\": \"\",\n     *              \"@survey_id\": \"\",\n     *              \"@survey_name\": \"\",\n     *              \"custom_labels\": {\n     *                  \"@aux_1_label\": \"\",\n     *                  \"@aux_2_label\": \"\",\n     *                  \"@aux_3_label\": \"\",\n     *                  \"@aux_4_label\": \"\",\n     *                  \"@aux_5_label\": \"\"\n     *              },\n     *              \"generic_key_value_pairs\": {}\n     *          }\n     *      },\n     *      \"account_countries\":{\n     *          \"country\":[\n     *              {\"@country_id\":\"BRA\"},{\"@country_id\":\"FRA\"},{\"@country_id\":\"GER\"}\n     *          ]\n     *      }\n     *   }\n     * }\n     */\n    LoginPhase1Request.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var status = utils.getText(resp, 'status');\n      var model = UIModel.getInstance();\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      if (status === 'OK') {\n        if (!model.applicationSettings.isLoggedInIS) {\n          // save login packet properties to UIModel\n          model.loginPhase1Packet = response;\n          model.applicationSettings.isLoggedInIS = true;\n          model.applicationSettings.isSso = utils.getText(resp, 'is_sso');\n          model.applicationSettings.isFlr = utils.getText(resp, 'is_flr');\n          model.applicationSettings.isTcpaSafeMode =\n            utils.getText(resp, 'tcpa_safe_mode') === '1';\n          model.applicationSettings.pciEnabled =\n            utils.getText(resp, 'pci_enabled') === '1';\n          model.applicationSettings.enableCallContactHistory = utils.getText(\n            resp,\n            'enable_call_contact_history',\n          );\n          model.chatSettings.alias =\n            utils.getText(resp, 'first_name') +\n            ' ' +\n            utils.getText(resp, 'last_name');\n\n          model.agentSettings.loginDTS = new Date();\n          model.agentSettings.maxBreakTime = utils.getText(\n            resp,\n            'max_break_time',\n          );\n          model.agentSettings.maxLunchTime = utils.getText(\n            resp,\n            'max_lunch_time',\n          );\n          model.agentSettings.firstName = utils.getText(resp, 'first_name');\n          model.agentSettings.lastName = utils.getText(resp, 'last_name');\n          model.agentSettings.email = utils.getText(resp, 'email');\n          model.agentSettings.agentId = utils.getText(resp, 'agent_id');\n          model.agentSettings.externalAgentId = utils.getText(\n            resp,\n            'external_agent_id',\n          );\n          model.agentSettings.agentType = utils.getText(resp, 'agent_type');\n          model.agentSettings.realAgentType = utils.getText(\n            resp,\n            'real_agent_type',\n          );\n          model.agentSettings.defaultLoginDest = utils.getText(\n            resp,\n            'default_login_dest',\n          );\n          model.agentSettings.altDefaultLoginDest = utils.getText(\n            resp,\n            'alt_default_login_dest',\n          );\n          model.agentSettings.initLoginState = utils.getText(\n            resp,\n            'init_login_state',\n          );\n          model.agentSettings.initLoginStateLabel = utils.getText(\n            resp,\n            'init_login_state_label',\n          );\n          model.agentSettings.outboundManualDefaultRingtime = utils.getText(\n            resp,\n            'outbound_manual_default_ringtime',\n          );\n          model.agentSettings.isOutboundPrepay =\n            utils.getText(resp, 'outbound_prepay') === '1';\n          model.agentSettings.phoneLoginPin = utils.getText(\n            resp,\n            'phone_login_pin',\n          );\n          model.agentSettings.username = utils.getText(resp, 'username');\n          model.agentSettings.agentPassword = utils.getText(resp, 'agent_pwd');\n\n          model.agentPermissions.allowCallControl =\n            utils.getText(resp, 'allow_call_control') === '1';\n          model.agentPermissions.allowChat =\n            utils.getText(resp, 'allow_chat') === '1'; //Agent permission\n          model.agentPermissions.enableChat =\n            utils.getText(resp, 'enable_chat') === '1'; //Account permission\n          model.agentPermissions.showLeadHistory =\n            utils.getText(resp, 'show_lead_history') === '1';\n          model.agentPermissions.allowManualOutboundGates =\n            utils.getText(resp, 'allow_manual_outbound_gates') === '1';\n          model.agentPermissions.allowOffHook =\n            utils.getText(resp, 'allow_off_hook') === '1';\n          model.agentPermissions.allowManualCalls =\n            utils.getText(resp, 'allow_manual_calls') === '1';\n          model.agentPermissions.allowManualPass =\n            utils.getText(resp, 'allow_manual_pass') === '1';\n          model.agentPermissions.allowManualIntlCalls =\n            utils.getText(resp, 'allow_manual_intl_calls') === '1';\n          model.agentPermissions.allowLoginUpdates =\n            utils.getText(resp, 'allow_login_updates') === '1';\n          model.agentPermissions.allowInbound =\n            utils.getText(resp, 'allow_inbound') === '1';\n          model.agentPermissions.allowOutbound =\n            utils.getText(resp, 'allow_outbound') === '1';\n          model.agentPermissions.allowBlended =\n            utils.getText(resp, 'allow_blended') === '1';\n          model.agentPermissions.allowLoginControl =\n            utils.getText(resp, 'allow_login_control') === '1';\n          model.agentPermissions.allowCrossQueueRequeue =\n            utils.getText(resp, 'allow_cross_gate_requeue') === '1';\n          model.agentPermissions.disableSupervisorMonitoring =\n            utils.getText(resp, 'disable_supervisor_monitoring') === '1';\n          model.agentPermissions.allowAutoAnswer =\n            utils.getText(resp, 'allow_auto_answer') === '1';\n          model.agentPermissions.defaultAutoAnswerOn =\n            utils.getText(resp, 'default_auto_answer_on') === '1';\n          model.agentPermissions.allowHistoricalDialing =\n            utils.getText(resp, 'allow_historical_dialing') === '1';\n          model.agentPermissions.allowAgentStats =\n            utils.getText(resp, 'allow_agent_stats') === '1';\n          model.agentPermissions.allowCampaignStats =\n            utils.getText(resp, 'allow_camp_stats') === '1';\n          model.agentPermissions.allowGateStats =\n            utils.getText(resp, 'allow_gate_stats') === '1';\n          model.agentPermissions.allowChatStats =\n            utils.getText(resp, 'allow_chat_stats') === '1';\n          model.agentPermissions.enableFolderMode =\n            utils.getText(resp, 'enable_folder_mode') === '1';\n          model.agentPermissions.enableTaskMode =\n            utils.getText(resp, 'enable_task_mode') === '1';\n\n          model.outboundSettings.defaultDialGroup = utils.getText(\n            resp,\n            'phone_login_dial_group',\n          );\n\n          if (\n            response.ui_response.allow_lead_inserts &&\n            typeof resp.insert_campaigns !== 'undefined' &&\n            response.ui_response.insert_campaigns.campaign\n          ) {\n            model.agentPermissions.allowLeadInserts =\n              utils.getText(resp, 'allow_lead_inserts') === '1';\n          }\n\n          // Set collection values\n          model.outboundSettings.availableCampaigns = _processCampaigns(\n            response,\n          );\n          model.chatSettings.availableChatQueues = utils.processResponseCollection(\n            response.ui_response,\n            'login_chat_queues',\n            'chat_queue',\n          );\n          _processChatQueueDnis(model.chatSettings, response);\n          model.chatSettings.availableChatRequeueQueues = utils.processResponseCollection(\n            response.ui_response,\n            'chat_requeue_queues',\n            'chat_group',\n          );\n          model.inboundSettings.availableQueues = utils.processResponseCollection(\n            response.ui_response,\n            'login_gates',\n            'gate',\n          );\n          model.inboundSettings.availableSkillProfiles = utils.processResponseCollection(\n            response.ui_response,\n            'skill_profiles',\n            'profile',\n          );\n          model.inboundSettings.availableRequeueQueues = utils.processResponseCollection(\n            response.ui_response,\n            'requeue_gates',\n            'gate_group',\n          );\n          model.chatSettings.availableChatRooms = utils.processResponseCollection(\n            response.ui_response,\n            'chat_rooms',\n            'room',\n          );\n          model.scriptSettings.availableScripts = utils.processResponseCollection(\n            response.ui_response,\n            'scripts',\n            'script',\n          );\n          model.agentSettings.callerIds = utils.processResponseCollection(\n            response.ui_response,\n            'caller_ids',\n            'caller_id',\n          );\n          model.agentSettings.availableAgentStates = utils.processResponseCollection(\n            response.ui_response,\n            'agent_states',\n            'agent_state',\n          );\n          model.applicationSettings.availableCountries = utils.processResponseCollection(\n            response.ui_response,\n            'account_countries',\n            'country',\n          );\n          model.outboundSettings.insertCampaigns = utils.processResponseCollection(\n            response.ui_response,\n            'insert_campaigns',\n            'campaign',\n          );\n\n          var dialGroups = utils.processResponseCollection(\n            response.ui_response,\n            'outdial_groups',\n            'group',\n          );\n          // set boolean values\n          for (var dg = 0; dg < dialGroups.length; dg++) {\n            var group = dialGroups[dg];\n            group.allowLeadSearch = group.allowLeadSearch === 'YES';\n            group.allowPreviewLeadFilters =\n              group.allowPreviewLeadFilters === '1';\n            group.progressiveEnabled = group.progressiveEnabled === '1';\n            group.requireFetchedLeadsCalled =\n              group.requireFetchedLeadsCalled === '1';\n            group.hciType = parseInt(group.hciEnabled) || 0;\n            group.hciEnabled =\n              group.hciEnabled === '1' || group.hciEnabled === '2';\n            group.hciClicker = group.hciClicker === '1';\n          }\n          model.outboundSettings.availableOutdialGroups = dialGroups;\n        }\n      }\n\n      formattedResponse.agentSettings = model.agentSettings;\n      formattedResponse.agentPermissions = model.agentPermissions;\n      formattedResponse.applicationSettings = model.applicationSettings;\n      formattedResponse.chatSettings = model.chatSettings;\n      formattedResponse.connectionSettings = model.connectionSettings;\n      formattedResponse.inboundSettings = model.inboundSettings;\n      formattedResponse.outboundSettings = model.outboundSettings;\n      formattedResponse.scriptSettings = model.scriptSettings;\n\n      return formattedResponse;\n    };\n\n    function _processCampaigns(response) {\n      var campaigns = [];\n      var campaignsRaw = null;\n\n      if (typeof response.ui_response.campaigns.campaign !== 'undefined') {\n        campaignsRaw = response.ui_response.campaigns.campaign;\n      }\n\n      if (campaignsRaw) {\n        if (!Array.isArray(campaignsRaw)) {\n          campaignsRaw = [campaignsRaw];\n        }\n\n        for (var c = 0; c < campaignsRaw.length; c++) {\n          campaigns.push(_processCampaign(campaignsRaw[c]));\n        }\n      }\n\n      return campaigns;\n    }\n\n    function _processCampaign(campaignRaw) {\n      // single campaign object\n      var campaignId = campaignRaw['@campaign_id'];\n      var allowLeadUpdates = campaignRaw['@allow_lead_updates']; // 0 = no update, 1 = allow phone update, 2 = don't allow phone update\n      UIModel.getInstance().agentPermissions.allowLeadUpdatesByCampaign[\n        campaignId\n      ] = allowLeadUpdates;\n\n      var customLabels = campaignRaw['custom_labels'];\n      var labelArray = [];\n\n      for (var p in customLabels) {\n        var label = p.replace(/@/, ''); // remove leading '@'\n        var obj = {};\n        obj[label] = customLabels[p];\n\n        labelArray.push(obj);\n      }\n\n      return {\n        campaignId: campaignId,\n        campaignName: campaignRaw['@campaign_name'],\n        surveyId: campaignRaw['@survey_id'],\n        surveyName: campaignRaw['@survey_name'],\n        customLabels: labelArray,\n        allowLeadUpdates: allowLeadUpdates,\n      };\n    }\n\n    /**\n     * example packet\n     *  {\n     *      \"chat_queue\":[\n     *          {\n     *              \"@chat_queue_desc\":\"\",\n     *              \"@chat_queue_id\":\"74\",\n     *              \"@chat_queue_name\":\"Please don't delete\"\n     *          },\n     *          {\n     *              \"@chat_queue_desc\":\"blah\",\n     *              \"@chat_queue_id\":\"131\",\n     *              \"@chat_queue_name\":\"cris chat queue\",\n     *              \"dnis\":[\n     *                  {\"#text\":\"5555551215\"},\n     *                  {\"#text\":\"5555554444\"},\n     *                  {\"#text\":\"8885551212\"},\n     *                  {\"#text\":\"97687\"}\n     *              ]\n     *          }\n     *      ]\n     *   }\n     *\n     *\n     *      This function will format the dnis list and put them back on chatSettings.availableChatQueues\n     **/\n    function _processChatQueueDnis(chatSettings, response) {\n      var queues = chatSettings.availableChatQueues;\n      var rawQueues = response.ui_response.login_chat_queues.chat_queue;\n\n      if (!Array.isArray(rawQueues)) {\n        rawQueues = [rawQueues];\n      }\n\n      for (var i = 0; i < queues.length; i++) {\n        var queue = queues[i];\n\n        var rawQueue = {};\n        for (var j = 0; j < rawQueues.length; j++) {\n          var rq = rawQueues[j];\n          if (rq['@chat_queue_id'] === queue.chatQueueId) {\n            rawQueue = rq;\n            break;\n          }\n        }\n\n        if (rawQueue.dnis) {\n          if (!Array.isArray(rawQueue.dnis)) {\n            rawQueue.dnis = [rawQueue.dnis];\n          }\n\n          // update the dnis array to just be a list\n          queue.dnis = rawQueue.dnis.map(function (d) {\n            return d['#text'];\n          });\n        }\n      }\n    }\n\n    var LogoutRequest = function (agentId, message) {\n      this.agentId = agentId;\n      this.message = message || '';\n    };\n\n    LogoutRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LOGOUT,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': this.agentId,\n          },\n          message: {\n            '#text': this.message,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    LogoutRequest.prototype.processResponse = function (notification) {\n      var formattedResponse = utils.buildDefaultResponse(notification);\n\n      return formattedResponse;\n    };\n    var MultiSocketRequest = function () {};\n\n    MultiSocketRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LOGIN_MULTISOCKET,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': JSON.parse(model.dataStore.get('agent_id')), //fetch agent_id and hash_code from browser's local storage\n          },\n          hash_code: {\n            '#text': JSON.parse(model.dataStore.get('hash_code')),\n          },\n        },\n      };\n      UIModel.getInstance().loginRequest = new LoginRequest(\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n      );\n      return JSON.stringify(msg);\n    };\n\n    var OffhookInitRequest = function () {};\n\n    OffhookInitRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.OFFHOOK_INIT,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          dial_dest: {\n            '#text': UIModel.getInstance().agentSettings.dialDest,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling an off-hook-init response packet from IntelliQueue.\n     * If the offhookinit is successful, it will go into the UIModel and set the isOffhook variable\n     * to true.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"UI2005\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"OFF-HOOK-INIT\",\n     *      \"status\":{\"#text\":\"OK|FAILURE\"},\n     *      \"monitoring\":{\"#text:\"TRUE|FALSE\"},\n     *      \"message\":{},\n     *      \"detail\":{}\n     *    }\n     * }\n     */\n    OffhookInitRequest.prototype.processResponse = function (response) {\n      var status = response.ui_response.status['#text'];\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      if (status === 'OK') {\n        var isMonitoring = utils.getText(response.ui_response, 'monitoring');\n        UIModel.getInstance().offhookInitPacket = response;\n        UIModel.getInstance().agentSettings.isOffhook = true;\n        UIModel.getInstance().agentSettings.isMonitoring = isMonitoring;\n        formattedResponse.monitoring = isMonitoring;\n\n        // make sure to reset softphone reconnect bool\n        UIModel.getInstance().softphoneSettings.attemptingSoftphoneReconnect = false;\n      } else {\n        if (formattedResponse.message === '') {\n          formattedResponse.message = 'Unable to process offhook request';\n        }\n        utils.logMessage(\n          LOG_LEVELS.WARN,\n          formattedResponse.message + ' ' + formattedResponse.detail,\n          response,\n        );\n      }\n\n      return formattedResponse;\n    };\n\n    var OffhookTermRequest = function () {};\n\n    OffhookTermRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.OFFHOOK_TERM,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * Process an OFF-HOOK-TERM packet and update various variables in the UI\n     *\n     * {\"ui_notification\":{\n     *      \"@message_id\":\"IQ10012016080217135001344\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"OFF-HOOK-TERM\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"start_dts\":{\"#text\":\"2016-08-02 17:11:38\"},\n     *      \"end_dts\":{\"#text\":\"2016-08-02 17:14:07\"},\n     *      \"monitoring\":{\"#text\":\"0\"}\n     *    }\n     * }\n     */\n    OffhookTermRequest.prototype.processResponse = function (data) {\n      var notif = data.ui_notification;\n      var monitoring = utils.getText(notif, 'monitoring') === '1';\n      var model = UIModel.getInstance();\n\n      model.agentSettings.wasMonitoring = monitoring;\n      model.offhookTermPacket = data;\n      model.agentSettings.isOffhook = false;\n      model.agentSettings.isMonitoring = false;\n\n      var formattedResponse = {\n        status: 'OK',\n        agentId: utils.getText(notif, 'agent_id'),\n        startDts: utils.getText(notif, 'start_dts'),\n        endDts: utils.getText(notif, 'end_dts'),\n        monitoring: monitoring,\n      };\n\n      return formattedResponse;\n    };\n\n    var OneToOneOutdialRequest = function (\n      destination,\n      callerId,\n      ringTime,\n      countryId,\n      gateId,\n    ) {\n      this.destination = destination;\n      this.callerId = callerId;\n      this.ringTime = ringTime || '60';\n      this.countryId = countryId || 'USA';\n      this.gateId = gateId || '';\n    };\n\n    OneToOneOutdialRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.ONE_TO_ONE_OUTDIAL,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          destination: {\n            '#text': utils.toString(this.destination),\n          },\n          ring_time: {\n            '#text': utils.toString(this.ringTime),\n          },\n          caller_id: {\n            '#text': utils.toString(this.callerId),\n          },\n          country_id: {\n            '#text': utils.toString(this.countryId),\n          },\n          gate_id: {\n            '#text': utils.toString(this.gateId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var OneToOneOutdialCancelRequest = function (uii) {\n      this.uii = uii;\n    };\n\n    /*\n     * This class is responsible for creating a new packet to cancel\n     * an in-progress outbound call.\n     */\n    OneToOneOutdialCancelRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.ONE_TO_ONE_OUTDIAL_CANCEL,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var PauseRecordRequest = function (record) {\n      this.record = record;\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"PAUSE-RECORD\",\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"record\":{\"#text\":\"TRUE | FALSE\"},\n     *      \"pause\":{\"#text\":\"10\"}\n     *    }\n     * }\n     */\n    PauseRecordRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var pauseTime = '10';\n      if (\n        model.currentCall.agentRecording &&\n        model.currentCall.agentRecording.pause\n      ) {\n        pauseTime = model.currentCall.agentRecording.pause;\n      }\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.PAUSE_RECORD,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(model.currentCall.agentId),\n          },\n          uii: {\n            '#text': utils.toString(model.currentCall.uii),\n          },\n          record: {\n            '#text': utils.toString(this.record === true ? 'TRUE' : 'FALSE'),\n          },\n          pause: {\n            '#text': utils.toString(pauseTime),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes PAUSE-RECORD packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082910361503344\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"PAUSE-RECORD\",\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"status\":{\"#text\":\"OK | FAILURE\"},\n     *      \"message\":{},\n     *      \"detail\":{},\n     *      \"state\":{\"#text\":\"RECORDING | PAUSED\"},\n     *      \"pause\":{\"#text\":\"10\"}\n     *    }\n     * }\n     */\n    PauseRecordRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n      var currUII = '';\n      if (UIModel.getInstance().currentCall.uii) {\n        currUII = UIModel.getInstance().currentCall.uii;\n      }\n\n      formattedResponse.uii = utils.getText(resp, 'uii');\n      formattedResponse.state = utils.getText(resp, 'state');\n      formattedResponse.pause = utils.getText(resp, 'pause');\n\n      if (formattedResponse.status === 'OK') {\n        // make sure we are talking about the same call\n        if (formattedResponse.uii === currUII) {\n          if (formattedResponse.message === '') {\n            formattedResponse.message =\n              'Broadcasting new record state of ' + formattedResponse.state;\n          }\n          utils.logMessage(\n            LOG_LEVELS.DEBUG,\n            'Broadcasting new record state of ' + formattedResponse.state,\n            response,\n          );\n        } else {\n          utils.logMessage(\n            LOG_LEVELS.DEBUG,\n            'Pause Record Response is for a different call...discarding',\n            response,\n          );\n        }\n      } else {\n        if (formattedResponse.message === '') {\n          formattedResponse.message =\n            'Error processing PAUSE-RECORD request.' +\n            formattedResponse.message +\n            '\\n' +\n            formattedResponse.detail;\n        }\n        utils.logMessage(LOG_LEVELS.WARN, formattedResponse.message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var PingCallRequest = function () {};\n\n    PingCallRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.PING_CALL,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().currentCall.agentId,\n          },\n          uii: {\n            '#text': UIModel.getInstance().currentCall.uii,\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var PreviewDialRequest = function (\n      action,\n      searchFields,\n      requestId,\n      leadPhone,\n    ) {\n      this.agentId = UIModel.getInstance().agentSettings.agentId;\n      this.searchFields = searchFields || [];\n      this.requestId = requestId || '';\n      this.action = action || '';\n      this.leadPhone = leadPhone || ''; // pipe leads only\n    };\n\n    /*\n     * searchFields = [\n     *  {key: \"name\", value: \"Danielle\"},\n     *  {key: \"number\", value: \"5555555555\"\n     * ];\n     */\n    PreviewDialRequest.prototype.formatJSON = function () {\n      var fields = {};\n      for (var i = 0; i < this.searchFields.length; i++) {\n        var fieldObj = this.searchFields[i];\n        fields[fieldObj.key] = { '#text': utils.toString(fieldObj.value) };\n      }\n\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.PREVIEW_DIAL,\n          '@message_id': utils.getMessageId(),\n          '@action': this.action,\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          pending_request_id: {\n            '#text': utils.toString(this.requestId),\n          },\n          lead_phone: {\n            '#text': utils.toString(this.leadPhone),\n          },\n          search_fields: fields,\n          // { \"name\": {\"#text\": \"Danielle\" } }\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling PREVIEW-DIAL packets received\n     * from the dialer. It will save a copy of it in the UIModel.\n     *\n     * {\"dialer_request\":{\n     *      \"@action\":\"\", // <-- empty for Preview fetch, otherwise \"SEARCH\"\n     *      \"@callbacks\":\"TRUE|FALSE\"\n     *      ,\"@message_id\":\"ID2008091513163400220\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"PREVIEW_DIAL\",\n     *      \"dial_group_id\":{\"#text\":\"200018\"},\n     *      \"account_id\":{\"#text\":\"99999999\"},\n     *      \"agent_id\":{\"#text\":\"1810\"},\n     *      \"is_insert\":{\"#text\":\"TRUE|FALSE\"}, <--- TRUE if search triggered by insert\n     *      \"destinations\":{\n     *          \"lead\":[\n     *              {\n     *                  \"@aux_data1\":\"\",\"@aux_data2\":\"\",\"@aux_data3\":\"\",\"@aux_data4\":\"\",\"@aux_data5\":\"\",\n     *                  \"@aux_phone\":\"\",\"@campaign_id\":\"51\",\"@destination\":\"9548298548\",\"@dnis\":\"1112223333\",\n     *                  \"@extern_id\":\"amanda\",\"@lead_id\":\"2646\",\"@lead_state\":\"PENDING\",\"@live_answer_msg\":\"\",\n     *                  \"@mach_answer_msg\":\"\",\"@machine_detect\":\"FALSE\",\"@request_key\":\"IQ982008091516241101125\",\n     *                  \"@valid_until\":\"2008-09-15 17:24:11\",\"extern_id\":{\"#text\":\"9548298548\"},\n     *                  \"first_name\":{\"#text\":\"Amanda\"},\"mid_name\":{\"#text\":\"Amanda\"},\"last_name\":{\"#text\":\"Machutta2\"},\n     *                  \"address1\":{},\"address2\":{},\"city\":{},\"state\":{},\"zip\":{},\"aux_greeting\":{},\n     *                  \"aux_external_url\":{}, \"app_url\":{}\n     *              },\n     *          ]\n     *      }\n     *    }\n     * }\n     */\n    PreviewDialRequest.prototype.processResponse = function (notification) {\n      var notif = notification.dialer_request;\n      var model = UIModel.getInstance();\n      var leads = utils.processResponseCollection(\n        notif,\n        'destinations',\n        'lead',\n      );\n\n      // send over requestId (as well as requestKey for backwards compatibility)\n      // to match previewLeadState.notification property\n      for (var l = 0; l < leads.length; l++) {\n        var lead = leads[l];\n        lead.requestId = lead.requestKey;\n        lead.ani = lead.destination; // add ani prop since used in new call packet & update lead\n\n        // In case of a single lead returned, the XML converter to JSON will add lead as an object and not an array\n        //\n        if (!Array.isArray(notif.destinations.lead)) {\n          notif.destinations.lead = [notif.destinations.lead];\n        }\n\n        // parse extra data correctly\n        try {\n          var notifLead = notif.destinations.lead[l];\n\n          if (notifLead.extra_data) {\n            // if this lead doesn't match the current lead, find it from the notification\n            if (notifLead['@lead_id'] !== lead.leadId) {\n              notifLead = notif.destinations.lead.filter(function (destLead) {\n                return destLead['@lead_id'] === lead.leadId;\n              });\n            }\n\n            delete lead.extraDatas;\n            lead.extraData = {};\n            for (var key in notifLead.extra_data) {\n              lead.extraData[key] = notifLead.extra_data[key]['#text'];\n            }\n          }\n        } catch (e) {\n          console.warn('error parsing lead extra data: ' + e);\n        }\n      }\n\n      var formattedResponse = {\n        action: notif['@action'],\n        callbacks: notif['@callbacks'] === 'TRUE',\n        dialGroupId: utils.getText(notif, 'dial_group_id'),\n        accountId: utils.getText(notif, 'account_id'),\n        agentId: utils.getText(notif, 'agent_id'),\n        isInsert: utils.getText(notif, 'is_insert'),\n        leads: leads,\n      };\n\n      if (notif['@callbacks'] === 'TRUE') {\n        utils.logMessage(\n          LOG_LEVELS.INFO,\n          \"New CALLBACK packet request rec'd from dialer\",\n          notification,\n        );\n        // clear callbacks??\n        //model.callbacks = [];\n        for (var l = 0; l < leads.length; l++) {\n          var lead = leads[l];\n          model.callbacks.push(lead);\n        }\n      } else {\n        model.outboundSettings.previewDialLeads = leads;\n      }\n\n      return formattedResponse;\n    };\n\n    var RecordRequest = function (record) {\n      this.record = record;\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"RECORD\",\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"record\":{\"#text\":\"TRUE | FALSE\"}\n     *    }\n     * }\n     */\n    RecordRequest.prototype.formatJSON = function () {\n      var model = UIModel.getInstance();\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.RECORD,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(model.currentCall.agentId),\n          },\n          uii: {\n            '#text': utils.toString(model.currentCall.uii),\n          },\n          record: {\n            '#text': this.record === true ? 'TRUE' : 'FALSE',\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes RECORD packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082910361503344\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"RECORD\",\n     *      \"uii\":{\"#text\":\"200808291035510000000900029412\"},\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{},\n     *      \"detail\":{},\n     *      \"state\":{\"#text\":\"RECORDING | STOPPED\"}\n     *    }\n     * }\n     */\n    RecordRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n      var currUII = '';\n      if (UIModel.getInstance().currentCall.uii) {\n        currUII = UIModel.getInstance().currentCall.uii;\n      }\n\n      formattedResponse.uii = utils.getText(resp, 'uii');\n      formattedResponse.state = utils.getText(resp, 'state');\n\n      if (formattedResponse.status === 'OK') {\n        // make sure we are talking about the same call\n        if (formattedResponse.uii === currUII) {\n          if (formattedResponse.message === '') {\n            formattedResponse.message =\n              'Broadcasting new record state of ' + formattedResponse.state;\n          }\n          utils.logMessage(\n            LOG_LEVELS.DEBUG,\n            formattedResponse.message,\n            response,\n          );\n        } else {\n          utils.logMessage(\n            LOG_LEVELS.DEBUG,\n            'Record Response is for a different call...discarding',\n            response,\n          );\n        }\n      } else {\n        if (formattedResponse.message === '') {\n          formattedResponse.message =\n            'Error processing RECORD request.' +\n            formattedResponse.message +\n            '\\n' +\n            formattedResponse.detail;\n        }\n        utils.logMessage(LOG_LEVELS.WARN, formattedResponse.message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var RequeueRequest = function (queueId, skillId, maintain) {\n      this.queueId = queueId;\n      this.skillId = skillId;\n      this.maintain = maintain;\n    };\n\n    RequeueRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.REQUEUE,\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          uii: {\n            '#text': UIModel.getInstance().currentCall.uii,\n          },\n          gate_number: {\n            '#text': utils.toString(this.queueId),\n          },\n          skill_id: {\n            '#text': utils.toString(this.skillId),\n          },\n          maintain_agent: {\n            '#text': this.maintain === true ? 'TRUE' : 'FALSE',\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes RE-QUEUE packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082817165103291\",\n     *      \"@response_to\":\"UIV220088281716486\",\n     *      \"@type\":\"RE-QUEUE\",\n     *      \"status\":\"OK\",\n     *      \"message\":\"Success.\",\n     *      \"detail\":\"The re-queue request was successfully processed.\",\n     *      \"agent_id\":{\"#text\":\"1856\"},\n     *      \"uii\":{\"#text\":\"200808281716090000000900028070\"},\n     *      \"gate_number\":{\"#text\":\"19\"},\n     *      \"maintain_agent\":{\"#text\":\"FALSE\"}\n     *    }\n     * }\n     */\n    RequeueRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.agentId = utils.getText(resp, 'agent_id');\n      formattedResponse.uii = utils.getText(resp, 'uii');\n      formattedResponse.queueId = utils.getText(resp, 'gate_number');\n\n      if (formattedResponse.status === 'OK') {\n      } else {\n        var message =\n          'There was an error processing the requeue request. ' +\n          formattedResponse.detail;\n        utils.logMessage(LOG_LEVELS.WARN, message, response);\n      }\n\n      return formattedResponse;\n    };\n\n    var ScriptConfigRequest = function (scriptId, version) {\n      this.scriptId = scriptId;\n      this.version = version || null;\n    };\n\n    /*\n     * This event is responsible for requesting a script object\n     */\n    ScriptConfigRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          '@type': MESSAGE_TYPES.SCRIPT_CONFIG,\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          script_id: {\n            '#text': utils.toString(this.scriptId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class process SCRIPT-CONFIG packets received from IntelliQueue.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082817165103294\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"SCRIPT-CONFIG\",\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"message\":{},\n     *      \"script_id\":{\"#text\":\"123\"},\n     *      \"version\":{\"#text\":\"1\"},\n     *      \"json\":{},\n     *   }\n     * }\n     */\n    ScriptConfigRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      if (formattedResponse.status === 'true') {\n        formattedResponse.status = true;\n        formattedResponse.scriptId = utils.getText(resp, 'script_id');\n        formattedResponse.version = utils.getText(resp, 'version');\n        formattedResponse.json = utils.getText(resp, 'json');\n\n        // store script on model\n        UIModel.getInstance().scriptSettings.loadedScripts[\n          formattedResponse.scriptId\n        ] = formattedResponse;\n      } else {\n        formattedResponse.status = false;\n      }\n\n      return formattedResponse;\n    };\n\n    var ScriptResultRequest = function (uii, scriptId, jsonResult) {\n      this.uii = uii;\n      this.scriptId = scriptId;\n      this.jsonResult = jsonResult;\n    };\n\n    /*\n     * This event is responsible for sending the script result object\n     */\n    ScriptResultRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@message_id': utils.getMessageId(),\n          response_to: '',\n          '@type': MESSAGE_TYPES.SCRIPT_RESULT,\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          script_id: {\n            '#text': utils.toString(this.scriptId),\n          },\n          json_result: {\n            '#text': JSON.stringify(this.jsonResult),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var SearchDirectoryRequest = function () {};\n\n    SearchDirectoryRequest.prototype.searchDirectory = function (searchString) {\n      UIModel.getInstance().searchDirectoryRequest = this;\n      _searchDirectory('rcdirectory/getRcCorporateDirectory', searchString);\n    };\n\n    SearchDirectoryRequest.prototype.processResponse = function (response) {\n      UIModel.getInstance().filteredDirectory = response;\n      return UIModel.getInstance().filteredDirectory;\n    };\n\n    function _searchDirectory(path, searchString) {\n      var model = UIModel.getInstance();\n      var accountId = model.agentSettings.accountId; //subAccountId\n      var baseUrl = model.authHost + model.baseApiUri;\n      var engageAccessToken =\n        'Bearer ' +\n        utils.toString(\n          UIModel.getInstance().authenticateRequest.engageAccessToken,\n        );\n      var params = {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        queryParams: {},\n      };\n      params.headers['Authorization'] = engageAccessToken;\n      params.queryParams['searchString'] = searchString;\n      params.queryParams['accountId'] = accountId;\n      var errorMsg = 'Error on request to search Directory: ' + baseUrl + path;\n      new HttpService(baseUrl).httpGet(path, params).then(\n        function (response) {\n          try {\n            response = JSON.parse(response.response);\n            var searchDirResponse = UIModel.getInstance().searchDirectoryRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              UIModel.getInstance().libraryInstance,\n              CALLBACK_TYPES.SEARCH_DIR,\n              searchDirResponse,\n            );\n          } catch (err) {\n            utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n          }\n        },\n        function (err) {\n          var errResponse = {\n            type: 'Error retrieving directory list',\n            message: errorMsg,\n          };\n          utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n\n          // still fire callback on error response\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.SEARCH_DIR,\n            errResponse,\n          );\n        },\n      );\n    }\n\n    var StatsRequest = function () {};\n\n    /*\n     * { \"ui_request\": {\n     *      \"@response_to\":\"\",\n     *      \"@message_id\":\"IS20160901142437535\",\n     *      \"@type\":\"STATS\"\n     *    }\n     * }\n     */\n    StatsRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IS',\n          '@type': MESSAGE_TYPES.STATS,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var TcpaSafeRequest = function (\n      action,\n      searchFields,\n      requestId,\n      leadPhone,\n    ) {\n      this.agentId = UIModel.getInstance().agentSettings.agentId;\n      this.searchFields = searchFields || [];\n      this.requestId = requestId || '';\n      this.action = action || '';\n      this.leadPhone = leadPhone || ''; // pipe leads only\n    };\n\n    /*\n     * searchFields = [\n     *  {key: \"name\", value: \"Danielle\"},\n     *  {key: \"number\", value: \"5555555555\"\n     * ];\n     */\n    TcpaSafeRequest.prototype.formatJSON = function () {\n      var fields = {};\n      for (var i = 0; i < this.searchFields.length; i++) {\n        var fieldObj = this.searchFields[i];\n        fields[fieldObj.key] = { '#text': utils.toString(fieldObj.value) };\n      }\n\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.TCPA_SAFE,\n          '@message_id': utils.getMessageId(),\n          '@action': this.action,\n          response_to: '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          pending_request_id: {\n            '#text': utils.toString(this.requestId),\n          },\n          lead_phone: {\n            '#text': utils.toString(this.leadPhone),\n          },\n          search_fields: fields,\n          // { \"name\": {\"#text\": \"Danielle\"} }\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling TCPA-SAFE packets received\n     * from the dialer. It will save a copy of it in the UIModel.\n     *\n     * {\"dialer_request\":{\n     *      \"@action\":\"\",\n     *      \"@callbacks\":\"TRUE|FALSE\"\n     *      ,\"@message_id\":\"ID2008091513163400220\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"TCPA_SAFE\",\n     *      \"dial_group_id\":{\"#text\":\"200018\"},\n     *      \"account_id\":{\"#text\":\"99999999\"},\n     *      \"agent_id\":{\"#text\":\"1810\"},\n     *      \"is_insert\":{\"#text\":\"TRUE|FALSE\"}, <--- TRUE if search triggered by insert\n     *      \"destinations\":{\n     *          \"lead\":[\n     *              {\n     *                  \"@aux_data1\":\"\",\"@aux_data2\":\"\",\"@aux_data3\":\"\",\"@aux_data4\":\"\",\"@aux_data5\":\"\",\n     *                  \"@aux_phone\":\"\",\"@campaign_id\":\"51\",\"@destination\":\"9548298548\",\"@dnis\":\"1112223333\",\n     *                  \"@extern_id\":\"amanda\",\"@lead_id\":\"2646\",\"@lead_state\":\"PENDING\",\"@live_answer_msg\":\"\",\n     *                  \"@mach_answer_msg\":\"\",\"@machine_detect\":\"FALSE\",\"@request_key\":\"IQ982008091516241101125\",\n     *                  \"@valid_until\":\"2008-09-15 17:24:11\",\"extern_id\":{\"#text\":\"9548298548\"},\n     *                  \"first_name\":{\"#text\":\"Amanda\"},\"mid_name\":{\"#text\":\"Amanda\"},\"last_name\":{\"#text\":\"Machutta2\"},\n     *                  \"address1\":{},\"address2\":{},\"city\":{},\"state\":{},\"zip\":{},\"aux_greeting\":{},\n     *                  \"aux_external_url\":{}, \"app_url\":{}\n     *              },\n     *          ]\n     *      }\n     *    }\n     * }\n     *\n     */\n    TcpaSafeRequest.prototype.processResponse = function (notification) {\n      var notif = notification.dialer_request;\n      var model = UIModel.getInstance();\n      var leads = utils.processResponseCollection(\n        notif,\n        'destinations',\n        'lead',\n      );\n\n      // send over requestId (as well as requestKey for backwards compatibility)\n      // to match tcpaSafeLeadState.notification property\n      for (var l = 0; l < leads.length; l++) {\n        var lead = leads[l];\n        lead.requestId = lead.requestKey;\n        lead.ani = lead.destination; // add ani prop since used in new call packet & update lead\n\n        // In case of a single lead returned, the XML converter to JSON will add lead as an object and not an array\n        //\n        if (!Array.isArray(notif.destinations.lead)) {\n          notif.destinations.lead = [notif.destinations.lead];\n        }\n\n        // parse extra data correctly\n        try {\n          var notifLead = notif.destinations.lead[l];\n\n          if (notifLead.extra_data) {\n            // if this lead doesn't match the current lead, find it from the notification\n            if (notifLead['@lead_id'] !== lead.leadId) {\n              notifLead = notif.destinations.lead.filter(function (destLead) {\n                return destLead['@lead_id'] === lead.leadId;\n              });\n            }\n\n            delete lead.extraDatas;\n            lead.extraData = {};\n            for (var key in notifLead.extra_data) {\n              lead.extraData[key] = notifLead.extra_data[key]['#text'];\n            }\n          }\n        } catch (e) {\n          console.warn('error parsing lead extra data: ' + e);\n        }\n      }\n\n      var formattedResponse = {\n        action: notif['@action'],\n        callbacks: notif['@callbacks'] === 'TRUE',\n        dialGroupId: utils.getText(notif, 'dial_group_id'),\n        accountId: utils.getText(notif, 'account_id'),\n        agentId: utils.getText(notif, 'agent_id'),\n        isInsert: utils.getText(notif, 'is_insert'),\n        leads: leads,\n      };\n\n      if (notif['@callbacks'] === 'TRUE') {\n        var message = \"New CALLBACK packet request rec'd from dialer\";\n        utils.logMessage(LOG_LEVELS.INFO, message, notification);\n        // clear callbacks??\n        //model.callbacks = [];\n        for (var l = 0; l < leads.length; l++) {\n          var callbackLead = leads[l];\n          model.callbacks.push(callbackLead);\n        }\n      } else {\n        model.outboundSettings.tcpaSafeLeads = leads;\n      }\n\n      return formattedResponse;\n    };\n\n    var UpdateDialDestinationRequest = function (dialDest, isSoftphoneError) {\n      this.dialDest = dialDest;\n      this.isSoftphoneError = isSoftphoneError || false;\n    };\n\n    /*\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":MESSAGE_TYPES.UPDATE_DIAL_DESTINATION,\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"agent_id\":\"1\",\n     *      \"dial_dest\":{\"#text\":\"blah@something.com\"},\n     *      \"log_softphone_error\": {\"#text\":\"TRUE|FALSE\"},\n     *    }\n     * }\n     */\n    UpdateDialDestinationRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.UPDATE_DIAL_DESTINATION,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n          dial_dest: {\n            '#text': utils.toString(this.dialDest),\n          },\n          log_softphone_error: {\n            '#text': utils.toString(\n              this.isSoftphoneError === true ? 'TRUE' : 'FALSE',\n            ),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var XferWarmRequest = function (dialDest, callerId, sipHeaders, countryId) {\n      this.dialDest = dialDest;\n      this.callerId = callerId || '';\n      this.sipHeaders = sipHeaders || [];\n      this.countryId = countryId;\n    };\n\n    XferWarmRequest.prototype.formatJSON = function () {\n      var fields = [];\n      for (var i = 0; i < this.sipHeaders.length; i++) {\n        var fieldObj = this.sipHeaders[i];\n        fields.push({\n          '@name': utils.toString(fieldObj.name),\n          '@value': utils.toString(fieldObj.value),\n        });\n      }\n\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.XFER_WARM,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          uii: {\n            '#text': UIModel.getInstance().currentCall.uii,\n          },\n          dial_dest: {\n            '#text': utils.toString(this.dialDest),\n          },\n          caller_id: {\n            '#text': utils.toString(this.callerId),\n          },\n          country_id: {\n            '#text': utils.toString(this.countryId),\n          },\n          xfer_header: fields,\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class processes WARM-XFER packets rec'd from IQ.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ10012016082314475000219\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"WARM-XFER\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"uii\":{\"#text\":\"201608231447590139000000000200\"},\n     *      \"session_id\":{\"#text\":\"3\"},\n     *      \"status\":{\"#text\":\"OK\"},\n     *      \"dial_dest\":{\"#text\":\"3038593775\"},\n     *      \"message\":{\"#text\":\"OK\"},\"detail\":{}\n     *    }\n     * }\n     *  Response on CANCEL:\n     *  {\"ui_response\":{\n     *      \"@message_id\":\"IQ10012016082315005000264\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"WARM-XFER\",\n     *      \"agent_id\":{\"#text\":\"1\"},\n     *      \"uii\":{\"#text\":\"201608231501090139000000000204\"},\n     *      \"session_id\":{},\n     *      \"status\":{\"#text\":\"FAILURE\"},\n     *      \"dial_dest\":{\"#text\":\"3038593775\"},\n     *      \"message\":{\"#text\":\"Transfer CANCELED\"},\n     *      \"detail\":{\"#text\":\"NOANSWER after 3 seconds.\"}\n     *    }\n     * }\n     */\n    XferWarmRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.agentId = utils.getText(resp, 'agent_id');\n      formattedResponse.uii = utils.getText(resp, 'uii');\n      formattedResponse.sessionId = utils.getText(resp, 'session_id');\n      formattedResponse.dialDest = utils.getText(resp, 'dial_dest');\n\n      if (formattedResponse.status === 'OK') {\n        utils.logMessage(\n          LOG_LEVELS.DEBUG,\n          'Warm Xfer to ' +\n            formattedResponse.dialDest +\n            ' processed successfully.',\n          response,\n        );\n      } else {\n        utils.logMessage(\n          LOG_LEVELS.WARN,\n          'There was an error processing the Warm Xfer request. ' +\n            formattedResponse.message +\n            '\\n' +\n            formattedResponse.detail,\n          response,\n        );\n      }\n\n      return formattedResponse;\n    };\n\n    var XferWarmCancelRequest = function (dialDest) {\n      this.dialDest = dialDest;\n    };\n\n    XferWarmCancelRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.XFER_WARM_CANCEL,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          uii: {\n            '#text': UIModel.getInstance().currentCall.uii,\n          },\n          dial_dest: {\n            '#text': utils.toString(this.dialDest),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var WebRTCRequest = function () {};\n\n    WebRTCRequest.prototype.getSipRegistrationInfo = function () {\n      UIModel.getInstance().WebRTCRequest = this;\n      _getSipRegistrationInfo('sip/sipRegistrationInfo', {\n        agentId: UIModel.getInstance().agentSettings.agentId,\n        ssoLogin: UIModel.getInstance().applicationSettings.isSso,\n      });\n    };\n\n    /*\n     * legacy response\n     * {\n     *   \"sipInfo\": [\n     *       {\n     *           \"transport\": \"wss\",\n     *           \"username\": \"yadvendra_agent\",\n     *           \"password\": \"oct@2018\",\n     *           \"domain\": \"d03-reg1.vacd.biz\",\n     *           \"outboundProxy\": \"d03-reg1.vacd.biz:8089/freeswitch\"\n     *       }\n     *   ]\n     * }\n     *\n     * RC SSO response\n     * {\n     *   \"sipInfo\": [\n     *       {\n     *           \"transport\": \"WSS\",\n     *           \"username\": \"18662032059*101\",\n     *           \"password\": \"B77O85vO\",\n     *           \"authorizationId\": \"400017513008\",\n     *           \"domain\": \"sip-cfintams.lab.nordigy.ru\",\n     *           \"outboundProxy\": \"webphone-sip-cfintams.lab.nordigy.ru:8083\"\n     *       }\n     *   ]\n     * }\n     * */\n    WebRTCRequest.prototype.processResponse = function (response) {\n      var softphoneSettings = UIModel.getInstance().softphoneSettings;\n      softphoneSettings.sipInfo = response.sipInfo;\n\n      return softphoneSettings.sipInfo;\n    };\n\n    function _getSipRegistrationInfo(path, queryParams) {\n      var model = UIModel.getInstance();\n      var baseUrl = model.authHost + model.baseApiUri;\n      var engageAccessToken =\n        'Bearer ' +\n        utils.toString(\n          UIModel.getInstance().authenticateRequest.engageAccessToken,\n        );\n      var params = {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      };\n\n      params.headers['Authorization'] = engageAccessToken;\n      params['queryParams'] = queryParams;\n      var errorMsg =\n        'Error on request get to sip registration info. URL: ' + baseUrl + path;\n\n      new HttpService(baseUrl).httpGet(path, params).then(\n        function (response) {\n          try {\n            response = JSON.parse(response.response);\n            var webRTCResponse = UIModel.getInstance().WebRTCRequest.processResponse(\n              response,\n            );\n            model.softphoneSettings.lastSipFetchTime = Date.now();\n            utils.fireCallback(\n              UIModel.getInstance().libraryInstance,\n              CALLBACK_TYPES.WEBRTC_INFO,\n              webRTCResponse,\n            );\n          } catch (err) {\n            utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n          }\n        },\n        function (err) {\n          var errResponse = {\n            type: 'Error retrieving sip registration information',\n            message: errorMsg,\n          };\n          utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n\n          // still fire callback on error response\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.WEBRTC_INFO,\n            errResponse,\n          );\n        },\n      );\n    }\n    var ChatAgentEndRequest = function (agentId, uii) {\n      this.uii = uii;\n      this.agentId = agentId;\n    };\n\n    /*\n\nExternal Chat :\nwhen agent submits a chat end request, send \"CHAT-AGENT-END\" request to IntelliQueue\n\n{\n    \"ui_request\" : {\n        \"@destination\" : \"IQ\",\n        \"@type\" : MESSAGE_TYPES.CHAT_AGENT_END,\n        \"uii\":{\n            \"#text\":utils.toString(this.uii)\n        },\n        \"agent_id\":{\n            \"#text\":utils.toString(this.agentId)\n        }\n    }\n}\n\n*/\n\n    ChatAgentEndRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_AGENT_END,\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          operation_id: {\n            '#text': utils.generateOpId(),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n    /** Deprecated */\n    var ChatAliasRequest = function (alias) {\n      this.alias = alias;\n    };\n\n    /*\n     * This class is responsible for creating the request to change chat alias\n     * packet and sending it to intelliservices.\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT-ALIAS\",\n     *      \"alias\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    ChatAliasRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IS',\n          '@type': MESSAGE_TYPES.CHAT_ALIAS,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          alias: {\n            '#text': utils.toString(this.alias),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var ChatDispositionRequest = function (\n      uii,\n      agentId,\n      dispositionId,\n      notes,\n      sendAcknowlegement,\n      survey,\n      sessionId,\n    ) {\n      this.uii = uii;\n      this.agentId = agentId;\n      this.dispositionId = dispositionId;\n      this.notes = notes || '';\n      this.sendAcknowlegement = sendAcknowlegement || false;\n      this.sessionId = sessionId;\n\n      /*\n       * survey = {\n       *      first_name: {\n       *          leadField: \"first_name\"\n       *          value: \"Geoff\"\n       *      },\n       *      last_name: {\n       *          leadField: \"last_name\"\n       *          value: \"Mina\"\n       *      }\n       *      ...\n       * }\n       */\n      this.survey = survey || null;\n    };\n\n    /*\n     * External Chat:\n     * When agent dispositions a chat, send \"CHAT-DISPOSITION\" request to IntelliQueue\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-DISPOSITION\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"session_id\" : {\"#text\" : \"\"},\n     *      \"disposition_id\":{\"#text\":\"\"},\n     *      \"notes\":{\"#text\":\"hello\"},\n     *      \"do_ack\":{\"#text\":\"true\"},\n     *      \"survey\":{\n     *          \"response\":[\n     *              {\"@extern_id\":\"text_box\",\"#text\":\"hello\"},\n     *              {\"@extern_id\":\"check_box\",\"#text\":\"20\"},\n     *              {\"@extern_id\":\"radio_save\",\"#text\":\"23\"}\n     *          ]\n     *      }\n     *    }\n     * }\n     */\n    ChatDispositionRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_DISPOSITION,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          session_id: {\n            '#text': utils.toString(this.sessionId),\n          },\n          disposition_id: {\n            '#text': utils.toString(this.dispositionId),\n          },\n          notes: {\n            '#text': utils.toString(this.notes),\n          },\n          do_ack: {\n            '#text': this.sendAcknowlegement === true ? 'TRUE' : 'FALSE',\n          },\n        },\n      };\n\n      /*\n       * converts survey to this response\n       * survey : {\n       *      response: [\n       *          { \"@extern_id\":\"\", \"@lead_update_column\":\"\", \"#text\":\"\" }\n       *      ]\n       * }\n       */\n      if (this.survey !== null) {\n        var response = [];\n        var keys = Object.keys(this.survey);\n        for (var i = 0; i < keys.length; i++) {\n          var key = keys[i];\n          var obj = {\n            '@extern_id': key,\n            '#text': utils.toString(this.survey[key].value),\n          };\n          response.push(obj);\n        }\n        msg.ui_request.survey = { response: response };\n      }\n\n      return JSON.stringify(msg);\n    };\n\n    var ChatListRequest = function (agentId, monitorAgentId) {\n      this.agentId = agentId;\n      this.monitorAgentId = monitorAgentId;\n    };\n\n    /*\n     * External Chat:\n     * Requests a list of all chats by monitor agent id\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-LIST\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"monitor_agent_id\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n\n    ChatListRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_LIST,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          monitor_agent_id: {\n            '#text': utils.toString(this.monitorAgentId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"CHAT-LIST\" packets from IntelliQueue.\n     *\n     *  {\n     *      \"ui_response\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-LIST\",\n     *          \"@response_to\":\"\",\n     *          \"agent_id\":{\"#text\":\"17\"},\n     *          \"monitor_agent_id\":{\"#text\":\"18\"},\n     *          \"chat_list\": {}\n     *      }\n     *  }\n     */\n\n    ChatListRequest.prototype.processResponse = function (response) {\n      var notif = response.ui_response;\n      var model = UIModel.getInstance();\n      model.chatListResponse = response;\n      var formattedResponse = utils.buildDefaultResponse(response);\n\n      formattedResponse.message = 'Received CHAT-LIST response';\n      formattedResponse.status = 'OK';\n      formattedResponse.messageId = notif['@message_id'];\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.monitorAgentId = utils.getText(\n        notif,\n        'monitor_agent_id',\n      );\n      formattedResponse.chatList = utils.processResponseCollection(\n        notif,\n        'chat_list',\n        'active_chat',\n      );\n\n      return formattedResponse;\n    };\n\n    var ChatMessageRequest = function (uii, agentId, message, whisper) {\n      this.uii = uii;\n      this.agentId = agentId;\n      this.message = message;\n      this.whisper = whisper;\n    };\n\n    /*\n     * External Chat:\n     * When agent submits a chat message, send \"CHAT-MESSAGE\" request to IntelliQueue\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-MESSAGE\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"message\":{\"#text\":\"hello\"},\n     *      \"whisper\":{\"#text\":\"true|false\"}\n     *    }\n     * }\n     */\n    ChatMessageRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_MESSAGE,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          message: {\n            '#text': utils.toString(this.message),\n          },\n          whisper: {\n            '#text': utils.toString(this.whisper),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling external CHAT-MESSAGE packets received from\n     * IntelliQueue.\n     *\n     * {\"ui_notification\":{\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT-MESSAGE\",\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"account_id\":{\"#text\":\"\"},\n     *      \"from\":{\"#text\":\"\"},\n     *      \"message\":{\"#text\":\"hello\"},\n     *      \"dts\":{\"#text\":\"2017-05-10 12:40:28\"},\n     *      \"dequeue_agent_id\":{\"#text\":\"123\"},\n     *      \"whisper\":{\"#text\":'TRUE'|'FALSE'\"}\n     *    }\n     * }\n     */\n\n    ChatMessageRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_notification;\n      var dts = utils.getText(resp, 'dts').trim();\n      var dtsDate = new Date(dts.replace(' ', 'T'));\n\n      var formattedResponse = utils.buildDefaultResponse(response);\n      formattedResponse.status = 'OK';\n      formattedResponse.uii = utils.getText(resp, 'uii');\n      formattedResponse.accountId = utils.getText(resp, 'account_id');\n      formattedResponse.from = utils.getText(resp, 'from');\n      formattedResponse.type = utils.getText(resp, 'type');\n      formattedResponse.message = utils.getText(resp, 'message');\n      formattedResponse.whisper = utils.getText(resp, 'whisper');\n      formattedResponse.dequeueAgentId = utils.getText(\n        resp,\n        'dequeue_agent_id',\n      );\n      formattedResponse.dts = dtsDate;\n      formattedResponse.mediaLinks = utils.processResponseCollection(\n        resp,\n        'media_links',\n        'link',\n      );\n\n      utils.logMessage(\n        LOG_LEVELS.DEBUG,\n        'New CHAT-MESSAGE packet received from IntelliQueue',\n        response,\n      );\n\n      return formattedResponse;\n    };\n\n    var ChatPresentedResponseRequest = function (\n      uii,\n      messageId,\n      response,\n      responseReason,\n    ) {\n      this.uii = uii;\n      this.messageId = messageId;\n      this.response = response;\n      this.responseReason = responseReason || '';\n    };\n\n    /*\n     * External Chat:\n     * When Agent receives a CHAT-PRESENTED notification, respond with\n     * either ACCEPT or REJECT for presented chat.\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-PRESENTED-RESPONSE\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"response\":{\"#text\":\"ACCEPT|REJECT\"},\n     *      \"response_reason\":{\"#text\":\"\"}\n     *      \"operation_id\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    ChatPresentedResponseRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_PRESENTED_RESPONSE,\n          '@message_id': utils.getMessageId(),\n          '@response_to': this.messageId,\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          response: {\n            '#text': utils.toString(this.response),\n          },\n          response_reason: {\n            '#text': utils.toString(this.responseReason),\n          },\n          operation_id: {\n            '#text': utils.generateOpId(),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var ChatRequeueRequest = function (\n      uii,\n      agentId,\n      chatQueueId,\n      skillId,\n      maintainAgent,\n    ) {\n      this.uii = uii;\n      this.agentId = agentId;\n      this.chatQueueId = chatQueueId;\n      this.skillId = skillId || '';\n      this.maintainAgent = maintainAgent || false;\n    };\n\n    /*\n     * External Chat:\n     * When agent submits a chat message, send \"CHAT-REQUEUE\" request to IntelliQueue\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-REQUEUE\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"operation_id\":{\"#text\":\"1234567890asdfghjklzxcvb\"}, // 24 character hex string, only set for Engage Digital Tasks\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"chat_queue_id\":{\"#text\":\"\"},\n     *      \"skill_id\":{\"#text\":\"\"},\n     *      \"maintain_agent\":{\"#text\":\"true|false\"}\n     *    }\n     * }\n     */\n    ChatRequeueRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_REQUEUE,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          operation_id: {\n            '#text': utils.generateOpId(),\n          },\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          chat_queue_id: {\n            '#text': utils.toString(this.chatQueueId),\n          },\n          skill_id: {\n            '#text': utils.toString(this.skillId),\n          },\n          maintain_agent: {\n            '#text': utils.toString(this.maintainAgent),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /** Deprecated */\n    var ChatRoomRequest = function (\n      action,\n      roomType,\n      roomId,\n      agentOne,\n      agentTwo,\n    ) {\n      this.action = action;\n      this.roomType = roomType;\n      this.roomId = roomId;\n      this.agentOne = agentOne || '';\n      this.agentTwo = agentTwo || '';\n    };\n\n    /*\n     * This class is responsible for sending the packet requesting to either enter\n     * a chatroom, or to exit a chatroom to IS. It also handles private chats. There are\n     * two possible ways these packets could look:\n     *\n     * //PUBLIC\n     * {\"ui_request\":{\n     *      \"@destination\":\"IS\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT-ROOM\",\n     *      \"@room_type\":\"PUBLIC\",\n     *      \"room_id\":{\"#text\":\"\"},\n     *      \"action\":{\"#text\":\"EXIT|ENTER\"}\n     *    }\n     * }\n     * -OR-\n     * // PRIVATE\n     * {\"ui_request\":{\n     *      \"@destination\":\"IS\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT-ROOM\",\n     *      \"@room_type\":\"PRIVATE\",\n     *      \"agent_one\":{\"#text\":\"\"},\n     *      \"agent_two\":{\"#text\":\"\"},\n     *      \"action\":{\"#text\":\"ENTER|EXIT\"}\n     *    }\n     * }\n     *\n     */\n    ChatRoomRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IS',\n          '@type': MESSAGE_TYPES.CHAT_ROOM,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          action: {\n            '#text': utils.toString(this.action),\n          },\n        },\n      };\n\n      if (this.action !== 'EXIT') {\n        msg.ui_request['@room_type'] = this.roomType;\n      }\n\n      if (this.roomType === 'PRIVATE' && this.action === 'ENTER') {\n        msg.ui_request.agent_one = { '#text': utils.toString(this.agentOne) };\n        msg.ui_request.agent_two = { '#text': utils.toString(this.agentTwo) };\n      } else {\n        msg.ui_request.room_id = { '#text': utils.toString(this.roomId) };\n      }\n      return JSON.stringify(msg);\n    };\n\n    /** Deprecated */\n    var ChatRoomStateRequest = function () {};\n\n    /*\n     * This class is responsible for processing CHAT-ROOM-STATE packets received\n     * from IntelliServices.\n     *\n     * {\"ui_request\":{\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT-ROOM-STATE\",\n     *      \"room_id\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"chat_alias\":{\"#text\":\"\"},\n     *      \"state\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    ChatRoomStateRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_request;\n      var formattedResponse = {\n        roomId: utils.getText(resp, 'room_id'),\n        agentId: utils.getText(resp, 'agent_id'),\n        chatAlias: utils.getText(resp, 'chat_alias'),\n        state: utils.getText(resp, 'state'),\n      };\n\n      utils.logMessage(\n        LOG_LEVELS.DEBUG,\n        'Chat-Room-State update packet received for room #' +\n          formattedResponse.roomId,\n        response,\n      );\n      return formattedResponse;\n    };\n    /** Deprecated */\n    var ChatSendRequest = function (roomId, message) {\n      this.roomId = roomId;\n      this.message = message;\n    };\n\n    /*\n     * This class is responsible for creating the CHAT message packet and sending\n     * it to IntelliServices.\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IS\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT\",\n     *      \"room_id\":{\"#text\":\"\"}\n     *      \"message\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    ChatSendRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IS',\n          '@type': MESSAGE_TYPES.CHAT_SEND,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          room_id: {\n            '#text': utils.toString(this.roomId),\n          },\n          message: {\n            '#text': utils.toString(this.message),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling CHAT packets received from\n     * IntelliServices.\n     *\n     * //PUBLIC\n     * {\"ui_request\":{\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT\",\n     *      \"room_type\":\"GROUP\",\n     *      \"room_id\":{\"#text\":\"\"},\n     *      \"message\":{\"#text\":\"\"},\n     *      \"sender\":{\"#text\":\"\"},\n     *      \"sender_id\":{\"#text\":\"\"},\n     *      \"room_name\":{\"#text\":\"\"}\n     *    }\n     * }\n     * -OR-\n     * // PRIVATE\n     * {\"ui_request\":{\n     *      \"@dynamic_create\":\"TRUE\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT\",\n     *      \"room_type\":\"PRIVATE\",\n     *      \"room_id\":{\"#text\":\"\"},\n     *      \"message\":{\"#text\":\"\"},\n     *      \"sender\":{\"#text\":\"\"},\n     *      \"room_name\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n\n    ChatSendRequest.prototype.processResponse = function (response) {\n      var resp = response.ui_request;\n      var formattedResponse = {\n        roomType: utils.getText(resp, 'room_type'),\n        roomId: utils.getText(resp, 'room_id'),\n        message: utils.getText(resp, 'message'),\n        sender: utils.getText(resp, 'sender'),\n        senderId: utils.getText(resp, 'sender_id'),\n        roomName: utils.getText(resp, 'room_name'),\n        dynamicCreate: utils.getText(resp, 'dynamic_create') === 'TRUE',\n      };\n\n      utils.logMessage(\n        LOG_LEVELS.DEBUG,\n        'New CHAT packet received from IntelliServices',\n        response,\n      );\n\n      return formattedResponse;\n    };\n\n    var ChatTypingRequest = function (uii, message) {\n      this.uii = uii;\n      this.message = message;\n    };\n\n    /*\n     * External Chat:\n     * Agent sends typing message to notify client widgets,\n     * but the agent's pending message is not sent going this direction.\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-TYPING\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"message\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    ChatTypingRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_TYPING,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          message: {\n            '#text': utils.toString(this.message),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var LeaveChatRequest = function (uii, agentId, sessionId) {\n      this.uii = uii;\n      this.agentId = agentId;\n      this.sessionId = sessionId;\n    };\n\n    /*\n     * External Chat:\n     * Requests to terminate a chat session on an existing chat uii\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-DROP-SESSION\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"uii\":{\"#text\":\"\"},\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"session_id\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    LeaveChatRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.LEAVE_CHAT,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          uii: {\n            '#text': utils.toString(this.uii),\n          },\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          session_id: {\n            '#text': utils.toString(this.sessionId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var ChatManualSmsRequest = function (\n      agentId,\n      chatQueueId,\n      ani,\n      dnis,\n      message,\n    ) {\n      this.agentId = agentId;\n      this.chatQueueId = chatQueueId;\n      this.ani = ani;\n      this.dnis = dnis;\n      this.message = message;\n    };\n\n    /*\n     * External Chat:\n     * When agent submits a manual sms message, send \"MANUAL-SMS\" request to IntelliQueue\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"MANUAL-SMS\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"agent_id\":{\"#text\":\"1995\"},\n     *      \"chatQueueId\":{\"#text\":\"44\"},\n     *      \"ani\":{\"#text\":\"1231231234\"},\n     *      \"dnis\":{\"#text\":\"5435435432\"},\n     *      \"message\":{\"#text\":\"hello\"}\n     *    }\n     * }\n     */\n    ChatManualSmsRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.CHAT_MANUAL_SMS,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(this.agentId),\n          },\n          chat_queue_id: {\n            '#text': utils.toString(this.chatQueueId),\n          },\n          ani: {\n            '#text': utils.toString(this.ani),\n          },\n          dnis: {\n            '#text': utils.toString(this.dnis),\n          },\n          message: {\n            '#text': utils.toString(this.message),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var MonitorChatRequest = function (monitorAgentId) {\n      this.monitorAgentId = monitorAgentId;\n    };\n\n    /*\n     * External Chat:\n     * Requests a new session on an existing chat uii\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-MONITOR\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"monitor_agent_id\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    MonitorChatRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.MONITOR_CHAT,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          monitor_agent_id: {\n            '#text': utils.toString(this.monitorAgentId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    var StopMonitorChatRequest = function (monitorAgentId) {\n      this.monitorAgentId = monitorAgentId || '';\n    };\n\n    /*\n     * External Chat:\n     * Requests a termination of a chat monitor session for an agent\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IQ\",\n     *      \"@type\":\"CHAT-DROP-MONITORING-SESSION\",\n     *      \"@message_id\":\"\",\n     *      \"@response_to\":\"\",\n     *      \"agent_id\":{\"#text\":\"\"},\n     *      \"monitor_agent_id\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    StopMonitorChatRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IQ',\n          '@type': MESSAGE_TYPES.STOP_MONITOR_CHAT,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': UIModel.getInstance().agentSettings.agentId,\n          },\n          monitor_agent_id: {\n            '#text': utils.toString(this.monitorAgentId),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * Process a CHAT-DROP-MONITORING-SESSION notification. Used to notify supervisor monitors that agent has logged out.\n     *\n     * {\"ui_notification\":{\n     *      \"@message_id\":\"IQ10012016080217135001344\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"CHAT-DROP-MONITORING-SESSION\",\n     *      \"monitored_agent_id\":{\"#text\":\"1\"}\n     *    }\n     * }\n     */\n    StopMonitorChatRequest.prototype.processResponse = function (data) {\n      var notif = data.ui_notification;\n\n      return { monitoredAgentId: utils.getText(notif, 'monitored_agent_id') };\n    };\n\n    /** Deprecated */\n    var SupervisorListRequest = function () {};\n\n    /*\n     * This class is responsible for creating a packet to request a list of\n     * supervisors from IntelliServices. This is used by the chat function so an\n     * agent can grab a list of supervisors and then select one for a private chat.\n     *\n     * {\"ui_request\":{\n     *      \"@destination\":\"IS\",\n     *      \"@message_id\":\"UI200809291036128\",\n     *      \"@response_to\":\"\",\n     *      \"@type\":\"SUPERVISOR-LIST\",\n     *      \"agent_id\":{\"#text\":\"\"}\n     *    }\n     * }\n     */\n    SupervisorListRequest.prototype.formatJSON = function () {\n      var msg = {\n        ui_request: {\n          '@destination': 'IS',\n          '@type': MESSAGE_TYPES.SUPERVISOR_LIST,\n          '@message_id': utils.getMessageId(),\n          '@response_to': '',\n          agent_id: {\n            '#text': utils.toString(\n              UIModel.getInstance().agentSettings.agentId,\n            ),\n          },\n        },\n      };\n\n      return JSON.stringify(msg);\n    };\n\n    /*\n     * This class is responsible for handling the SUPERVISOR-LIST packet\n     * rec'd from intelliservices. It will save a copy of this list in the\n     * UIModel under a variable called \"supervisors\". Whenever a new list\n     * is rec'd it is overwritten.\n     *\n     * {\"ui_response\":{\n     *      \"@message_id\":\"IQ982008082910361503344\",\n     *      \"@response_to\":\"\",\n     *      \"supervisor\":[\n     *          {\"id\":{\"#text\":\"\"}, \"fname\":{\"#text\":\"\"}, \"lname\":{\"#text\":\"\"}, \"uname\":{\"#text\":\"\"} }\n     *          {\"id\":{\"#text\":\"\"}, \"fname\":{\"#text\":\"\"}, \"lname\":{\"#text\":\"\"}, \"uname\":{\"#text\":\"\"} }\n     *      ]\n     *    }\n     * }\n     */\n\n    SupervisorListRequest.prototype.processResponse = function (response) {\n      var model = UIModel.getInstance();\n      var tempList = utils.processResponseCollection(\n        response,\n        'ui_response',\n        'supervisor',\n      );\n      var supervisors = [];\n\n      for (var i = 0; i < tempList.length; i++) {\n        var sup = tempList[i];\n        supervisors.push({\n          agentId: sup.id,\n          firstName: sup.fname,\n          lastName: sup.lname,\n          username: sup.uname,\n        });\n      }\n\n      utils.logMessage(\n        LOG_LEVELS.DEBUG,\n        'New supervisor list received ',\n        supervisors,\n      );\n      model.supervisors = supervisors;\n\n      return model.supervisors;\n    };\n\n    var ChatClientReconnectNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"CHAT-CLIENT-RECONNECT\" packets from IntelliQueue.\n     * This is sent when a chat connect message is sent to a non-archieved chat.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-CLIENT-RECONNECT\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"}\n     *          \"agent_id\":{\"#text\":\"1\"}\n     *      }\n     *  }\n     */\n\n    ChatClientReconnectNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification);\n\n      formattedResponse.message = 'Received CHAT-CLIENT-RECONNECT notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.accountId = utils.getText(notif, 'account_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n\n      return formattedResponse;\n    };\n\n    var AddChatSessionNotification = function () {};\n\n    /*\n     * This class is responsible for handling \"ADD-CHAT-SESSION\" packets from IntelliQueue.\n     *\n     * {\n     *   \"ui_notification\": {\n     *       \"@message_id\": \"IQ982008082918151403727\",\n     *       \"@response_to\": \"\",\n     *       \"@type\": \"ADD-CHAT-SESSION\",\n     *       \"session_id\": { \"#text\": \"2\" },\n     *       \"uii\": { \"#text\": \"200808291814560000000900016558\" },\n     *       \"session_type\": { \"#text\": \"AGENT|MONITORING\" },\n     *       \"agent_id\": { \"#text\": \"1856\" } // null unless monitor type,\n     *       \"transcript\": { }\n     *   }\n     *  }\n     */\n    AddChatSessionNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification);\n\n      formattedResponse.status = 'OK';\n      formattedResponse.message = 'Received ADD-CHAT-SESSION notification';\n      formattedResponse.sessionId = utils.getText(notif, 'session_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.sessionType = utils.getText(notif, 'session_type');\n      formattedResponse.agentId = utils.getText(notif, 'agent_id');\n      formattedResponse.transcript = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'transcript',\n      )[0];\n\n      return formattedResponse;\n    };\n\n    var ChatActiveNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"CHAT-ACTIVE\" packets from IntelliQueue.\n     * This is sent in response to an agent's CHAT-PRESENTED-RESPONSE accept request.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-ACTIVE\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"is_monitoring\":{\"#text\":\"TRUE\"|\"FALSE\"}\n     *      }\n     *  }\n     */\n    ChatActiveNotification.prototype.processResponse = function (notification) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification, true);\n\n      formattedResponse.message = 'Received CHAT-ACTIVE notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.accountId = utils.getText(notif, 'account_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.isMonitoring = utils.getText(notif, 'is_monitoring');\n\n      return formattedResponse;\n    };\n\n    var ChatAgentAssignFailureNotification = function () {};\n\n    /*\n     * This class is responsible for handling \"CHAT-AGENT-ASSIGN-FAILURE\" packets from IntelliQueue.\n     * This is sent to the agent when the last session is disconnected from a chat.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-AGENT-ASSIGN-FAILURE\",\n     *          \"@destination\":\"IQ\",\n     *          \"operation_id\":{\"#text\":\"1234567890asdfghjklzxcvb\"}, // 24 character hex string, only set for Engage Digital Tasks\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"task_id\": {\"#text\":\"\"}\n     *      }\n     *  }\n     */\n\n    ChatAgentAssignFailureNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n\n      var agentAssignFailure = utils.buildDefaultResponse(notification, true);\n      agentAssignFailure.message =\n        'Received CHAT-AGENT-ASSIGN-FAILURE notification';\n      agentAssignFailure.status = 'OK';\n      agentAssignFailure.uii = utils.getText(notif, 'uii');\n      agentAssignFailure.taskId = utils.getText(notif, 'task_id');\n      agentAssignFailure.accountId = utils.getText(notif, 'account_id');\n\n      return agentAssignFailure;\n    };\n\n    var ChatCancelledNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for processing \"CHAT-CANCELLED\" packets from IntelliQueue.\n     * If an agent is presented a chat and doesn't respond before the timeout, the CHAT-CANCELLED\n     * message is sent from IQ.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-CANCELLED\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"operation_id\":{\"#text\":\"1234567890asdfghjklzxcvb\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"}\n     *      }\n     *  }\n     */\n    ChatCancelledNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification, true);\n\n      formattedResponse.message = 'Received CHAT-CANCELLED notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.messageId = notif['@message_id'];\n      formattedResponse.accountId = utils.getText(notif, 'account_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n\n      return formattedResponse;\n    };\n\n    var ChatInactiveNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"CHAT-INACTIVE\" packets from IntelliQueue.\n     * This is sent to the agent when the last session is disconnected from a chat.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-INACTIVE\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"operation_id\":{\"#text\":\"1234567890asdfghjklzxcvb\"}, // 24 character hex string, only set for Engage Digital Tasks\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"disposition_timeout\":{\"#text\":\"30\"},\n     *          \"dequeue_agent_id\":{\"#text\":\"123\"}\n     *      }\n     *  }\n     */\n    ChatInactiveNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification, true);\n\n      formattedResponse.message = 'Received CHAT-INACTIVE notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.accountId = utils.getText(notif, 'account_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.dispositionTimeout = utils.getText(\n        notif,\n        'disposition_timeout',\n      );\n      formattedResponse.dequeueAgentId = utils.getText(\n        notif,\n        'dequeue_agent_id',\n      );\n\n      return formattedResponse;\n    };\n\n    var ChatPresentedNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"CHAT-PRESENTED\" packets from IntelliQueue.\n     * When this notification is received, the Agent can either Accept or Decline which will\n     * be sent back to IntelliQueue as a CHAT-PRESENTED-RESPONSE.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-PRESENTED\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"task_id\":{\"#text\":\"123\"}, // only applicable for Engage Digital tasks\n     *          \"operation_id:{\"#text\":\"1234567890asdfghjklzxcvb\"} // 24 character hex string, only set for Engage Digital Tasks\n     *          \"chat_queue_id\":{\"#text\":\"3\"},\n     *          \"chat_queue_name\":{\"#text\":\"Support Chat\"},\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"channel_type\":{\"#text\":\"email\"},\n     *          \"allow_accept\":{\"#text\":\"TRUE|FALSE\"},\n     *          \"is_reconnect\":{\"#text\":\"TRUE|FALSE\"}\n     *          \"ed_source_id\":{\"#text\":\"5ec6d788f3b1490008773a10\"},\n     *          \"ed_category_ids\":{\"#text\": \"5ec6b48ff3b14900087739eb,5ec6b4c2f3b14900087739f1,5f11dff7fcd72e0007c53b3e\"},\n     *          \"ed_language_id\":{\"#text\":\"en\"},\n     *          \"ed_author_screen_name\":{\"#text\":\"Joe Smith\"},\n     *          \"ed_created_at\":{\"#text\":\"Thu Aug 20 08:21:00 UTC 2020\"},\n     *      }\n     *  }\n     */\n    ChatPresentedNotification.prototype.processResponse = function (\n      notification,\n    ) {\n      var notif = notification.ui_notification;\n      var edSourceId = utils.getText(notif, 'ed_source_id');\n      var edLanguageId = utils.getText(notif, 'ed_language_id');\n      var edCategoryIds = utils.getText(notif, 'ed_category_ids').split(',');\n      var taskId = utils.getText(notif, 'task_id');\n      var model = UIModel.getInstance();\n      var edSourceName = '';\n      var edSourceColor = 0;\n      var edLanguage = '';\n      var edCategories = [];\n      var processedResponse;\n      var instance = model.libraryInstance;\n\n      if (taskId) {\n        // look in cached values to see if we have ED info already loaded\n        var mainAccountId = model.authenticateRequest.mainAccountId;\n        var cachedSourceList =\n          model.applicationSettings.edSources[mainAccountId];\n        var cachedLanguageList =\n          model.applicationSettings.edLanguages[mainAccountId];\n        var cachedCategoryList =\n          model.applicationSettings.edCategories[mainAccountId];\n\n        var sourceCache = _getEdValue(cachedSourceList, edSourceId);\n        var languageCache = _getEdValue(cachedLanguageList, edLanguageId);\n        var categoryCache = _getMultiEdValues(\n          cachedCategoryList,\n          edCategoryIds,\n        );\n\n        var edProxyPath = 'digital-api-proxy/evMainAccount/' + mainAccountId;\n\n        if (\n          !sourceCache.isCached ||\n          !languageCache.isCached ||\n          !categoryCache.isCached\n        ) {\n          // make sure access token is valid by just getting fresh token\n          utils.refreshAccessToken().then(function () {\n            var authToken = model.authenticateRequest.engageAccessToken;\n            var sourceErrorMsg = 'Error retrieving ED source name from ETR.';\n            var languageErrorMsg =\n              'Error retrieving ED language name from ETR.';\n            var categoriesErrorMsg = 'Error retrieving ED categories from ETR.';\n            var sourcePromise, languagePromise, categoriesPromise;\n\n            if (sourceCache.isCached) {\n              edSourceName = sourceCache.name;\n              edSourceColor = sourceCache.color;\n            } else {\n              sourcePromise = _buildEtrHttpRequest(\n                edProxyPath + '/sources',\n                authToken,\n              );\n            }\n\n            if (languageCache.isCached) {\n              edLanguage = languageCache.name;\n            } else {\n              languagePromise = _buildEtrHttpRequest(\n                edProxyPath + '/languages',\n                authToken,\n              );\n            }\n\n            if (categoryCache.isCached) {\n              edCategories = categoryCache.names;\n            } else {\n              categoriesPromise = _buildEtrHttpRequest(\n                edProxyPath + '/categories',\n                authToken,\n              );\n            }\n\n            if (sourcePromise) {\n              sourcePromise.then(\n                function (sourceResponse) {\n                  try {\n                    var sourceList = JSON.parse(sourceResponse.response);\n                    model.applicationSettings.edSources[\n                      mainAccountId\n                    ] = sourceList; // store returned sources in memory for later use\n\n                    var currentSource = _getEdValue(sourceList, edSourceId);\n                    edSourceName = currentSource.name;\n                    edSourceColor = currentSource.color || 0;\n                  } catch (err) {\n                    utils.logMessage(LOG_LEVELS.WARN, sourceErrorMsg, err);\n                  }\n                },\n                function (err) {\n                  utils.logMessage(LOG_LEVELS.WARN, sourceErrorMsg, err);\n                },\n              );\n            }\n\n            if (languagePromise) {\n              languagePromise.then(\n                function (languageResponse) {\n                  try {\n                    var languageList = JSON.parse(languageResponse.response);\n                    model.applicationSettings.edLanguages[\n                      mainAccountId\n                    ] = languageList; // store returned languages in memory for later use\n                    edLanguage = _getEdValue(languageList, edLanguageId).name;\n                  } catch (err) {\n                    utils.logMessage(LOG_LEVELS.WARN, languageErrorMsg, err);\n                  }\n                },\n                function (err) {\n                  utils.logMessage(LOG_LEVELS.WARN, languageErrorMsg, err);\n                },\n              );\n            }\n\n            if (categoriesPromise) {\n              categoriesPromise.then(\n                function (categoryResponse) {\n                  try {\n                    var categoryList = JSON.parse(categoryResponse.response);\n                    model.applicationSettings.edCategories[\n                      mainAccountId\n                    ] = categoryList; // store returned categories in memory for later use\n                    edCategories = _getMultiEdValues(\n                      categoryList,\n                      edCategoryIds,\n                    ).names;\n                  } catch (err) {\n                    utils.logMessage(LOG_LEVELS.WARN, categoriesErrorMsg, err);\n                  }\n                },\n                function (err) {\n                  utils.logMessage(LOG_LEVELS.WARN, categoriesErrorMsg, err);\n                },\n              );\n            }\n\n            Promise.all([\n              sourcePromise,\n              languagePromise,\n              categoriesPromise,\n            ]).then(\n              function () {\n                processedResponse = _buildPresentedResponse(\n                  notification,\n                  edSourceName,\n                  edSourceColor,\n                  edLanguage,\n                  edCategories,\n                );\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.CHAT_PRESENTED,\n                  processedResponse,\n                );\n                return processedResponse;\n              },\n              function (err) {\n                utils.logMessage(\n                  LOG_LEVELS.WARN,\n                  'Error resolving ETR API promises',\n                  err,\n                );\n                processedResponse = _buildPresentedResponse(\n                  notification,\n                  edSourceName,\n                  edSourceColor,\n                  edLanguage,\n                  edCategories,\n                );\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.CHAT_PRESENTED,\n                  processedResponse,\n                );\n                return processedResponse;\n              },\n            );\n          });\n        } else {\n          // all values cached\n          edSourceName = sourceCache.name;\n          edSourceColor = sourceCache.color;\n          edLanguage = languageCache.name;\n          edCategories = categoryCache.names;\n          processedResponse = _buildPresentedResponse(\n            notification,\n            edSourceName,\n            edSourceColor,\n            edLanguage,\n            edCategories,\n          );\n          utils.fireCallback(\n            instance,\n            CALLBACK_TYPES.CHAT_PRESENTED,\n            processedResponse,\n          );\n          return processedResponse; // for testing\n        }\n      } else {\n        // not task\n        processedResponse = _buildPresentedResponse(\n          notification,\n          edSourceName,\n          edSourceColor,\n          edLanguage,\n          edCategories,\n        );\n        utils.fireCallback(\n          instance,\n          CALLBACK_TYPES.CHAT_PRESENTED,\n          processedResponse,\n        );\n        return processedResponse; // for testing\n      }\n    };\n\n    function _buildEtrHttpRequest(path, authorizationToken) {\n      var model = UIModel.getInstance();\n      var baseUrl = model.authHost + model.baseEtrUri;\n      var params = {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: 'Bearer ' + authorizationToken,\n        },\n      };\n\n      return new HttpService(baseUrl).httpGet(path, params);\n    }\n\n    function _getEdValue(list, id) {\n      var idx;\n      var isCached = false;\n      var name = '';\n      var color; // only present for source objects\n\n      if (list) {\n        for (idx = 0; idx < list.length; idx++) {\n          if (list[idx].id === id) {\n            name = list[idx].name;\n            isCached = true;\n            if (list[idx].color) {\n              color = list[idx].color;\n            }\n          }\n        }\n      }\n\n      var returnObj = { isCached: isCached, name: name };\n      if (color) {\n        returnObj.color = color;\n      }\n\n      return returnObj;\n    }\n\n    function _getMultiEdValues(searchList, ids) {\n      var idIndex;\n      var edValue;\n      var isCached = false;\n      var names = [];\n\n      if (searchList) {\n        for (idIndex = 0; idIndex < ids.length; idIndex++) {\n          edValue = _getEdValue(searchList, ids[idIndex]);\n          names.push(edValue.name);\n          if (edValue.isCached) {\n            isCached = true;\n          }\n        }\n      }\n      return { isCached: isCached, names: names };\n    }\n\n    function _buildPresentedResponse(\n      notification,\n      edSourceName,\n      edSourceColor,\n      edLanguage,\n      edCategories,\n    ) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification, true);\n\n      formattedResponse.message = 'Received CHAT-PRESENTED notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.messageId = notif['@message_id'];\n      formattedResponse.accountId = utils.getText(notif, 'account_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.channelType = utils.getText(notif, 'channel_type');\n      formattedResponse.taskId = utils.getText(notif, 'task_id');\n      formattedResponse.chatQueueId = utils.getText(notif, 'chat_queue_id');\n      formattedResponse.chatQueueName = utils.getText(notif, 'chat_queue_name');\n      formattedResponse.allowAccept = utils.getText(notif, 'allow_accept');\n      formattedResponse.isReconnect = utils.getText(notif, 'is_reconnect');\n      formattedResponse.edAuthorScreenName = utils.getText(\n        notif,\n        'ed_author_screen_name',\n      );\n      formattedResponse.edCreatedAt = utils.getText(notif, 'ed_created_at');\n      formattedResponse.edSourceName = edSourceName;\n      formattedResponse.sourceColor = edSourceColor;\n      formattedResponse.edLanguage = edLanguage;\n      formattedResponse.edCategories = edCategories;\n\n      return formattedResponse;\n    }\n\n    var ChatTypingNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"CHAT-TYPING\" packets from IntelliQueue.\n     * When this notification is received, the AgentUI will show the pending message\n     * so far from the client chat widget and typing notification.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"CHAT-TYPING\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"from\":{\"#text\":\"\"},\n     *          \"message\":{\"#text\":\"this is the message before actual send\"}\n     *          \"dequeue_agent_id\":{\"#text\":\"123\"}\n     *      }\n     *  }\n     */\n    ChatTypingNotification.prototype.processResponse = function (notification) {\n      var notif = notification.ui_notification;\n      var formattedResponse = utils.buildDefaultResponse(notification);\n\n      formattedResponse.message = 'Received CHAT-TYPING notification';\n      formattedResponse.status = 'OK';\n      formattedResponse.accountId = utils.getText(notif, 'account_id');\n      formattedResponse.uii = utils.getText(notif, 'uii');\n      formattedResponse.from = utils.getText(notif, 'from');\n      formattedResponse.type = utils.getText(notif, 'type');\n      formattedResponse.pendingMessage = utils.getText(notif, 'message');\n      formattedResponse.dequeueAgentId = utils.getText(\n        notif,\n        'dequeue_agent_id',\n      );\n\n      return formattedResponse;\n    };\n\n    var LoadMediaNotification = function () {};\n\n    /*\n     * Engage Digital Chat:\n     * This class is responsible for handling \"LOAD-MEDIA\" packets from IntelliQueue.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"LOAD-MEDIA\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"task_id\":{\"#text\":\"\"}\n     *          \"operation_id\":{\"#text\":\"\"}\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"session_id\":{\"#text\":\"2\"},\n     *          \"agent_id\":{\"#text\":\"1180958\"},\n     *          \"queue_dts\":{\"#text\":\"\"},\n     *          \"queue_time\":{\"#text\":\"\"},\n     *          \"chat_queue_id\":{\"#text\":\"\"},\n     *          \"chat_queue_name\":{\"#text\":\"\"},\n     *          \"chat_requeue_type\" : {\"#text\":\"\"}\n     *          \"channel_type\":{\"#text\":\"ENGAGE-DIGITAL\"},\n     *          \"idle_timeout\":{\"#text\":\"\"},\n     *          \"chat_dispositions\":{\n     *              \"disposition\":[\n     *                  { \"@disposition_id\":\"2\", \"@is_success\":\"true\", \"@is_complete\":\"false\", \"@is_default\"=\"0\", \"@email_template_id\":\"1\", \"#text\":\"Complete\"},\n     *                  { \"@disposition_id\":\"3\", \"@is_success\":\"true\", \"@is_complete\":\"false\", \"@is_default\"=\"0\", \"#text\":\"Requeue\"}\n     *              ]\n     *          },\n     *          \"chat_requeue_shortcuts\" :{\n     *              shortcut : [\n     *                {@chat_requeue_shortcut_id:\"3\", @name:\"test\", @rank:\"1\",@requeue_chat_queue_id:\"74\",@skill_id:\"\"}\n     *              ]\n     *          }\n     *      }\n     *  }\n     */\n    LoadMediaNotification.prototype.processResponse = function (notification) {\n      var notif = notification.ui_notification;\n\n      var dts = utils.getText(notif, 'queue_dts');\n      dts = new Date(dts.replace(' ', 'T'));\n\n      var newTask = utils.buildDefaultResponse(notification, true);\n\n      newTask.message = 'Received LOAD-MEDIA notification';\n      newTask.status = 'OK';\n      newTask.uii = utils.getText(notif, 'uii');\n      newTask.taskId = utils.getText(notif, 'task_id');\n      newTask.accountId = utils.getText(notif, 'account_id');\n      newTask.sessionId = utils.getText(notif, 'session_id');\n      newTask.agentId = utils.getText(notif, 'agent_id');\n      newTask.queueDts = dts;\n      newTask.queueTime = utils.getText(notif, 'queue_time');\n      newTask.chatQueueId = utils.getText(notif, 'chat_queue_id');\n      newTask.chatQueueName = utils.getText(notif, 'chat_queue_name');\n      newTask.chatRequeueType = utils.getText(notif, 'chat_requeue_type');\n      newTask.channelType = utils.getText(notif, 'channel_type');\n      newTask.idleTimeout = utils.getText(notif, 'idle_timeout');\n\n      newTask.requeueShortcuts = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'chat_requeue_shortcuts',\n        'shortcut',\n      )[0];\n      newTask.chatDispositions = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'chat_dispositions',\n        'disposition',\n      )[0];\n\n      if (newTask.chatDispositions && newTask.chatDispositions.disposition) {\n        newTask.chatDispositions.dispositions = [newTask.chatDispositions];\n      } else {\n        newTask.chatDispositions = newTask.chatDispositions.dispositions;\n      }\n\n      // convert numbers to boolean\n      if (newTask.chatDispositions) {\n        for (var d = 0; d < newTask.chatDispositions.length; d++) {\n          var disp = newTask.chatDispositions[d];\n          disp.isComplete = disp.isComplete === '1';\n          disp.isSuccess = disp.isSuccess === '1';\n          disp.isDefault = disp.isDefault === '1';\n        }\n      }\n\n      // Build token map\n      newTask.baggage = buildTaskTokenMap(newTask);\n\n      return newTask;\n    };\n\n    function buildTaskTokenMap(newTask) {\n      var tokens = {};\n      var model = UIModel.getInstance();\n\n      try {\n        tokens['chatQueueId'] = newTask.chatQueueId;\n        tokens['chatQueueName'] = newTask.chatQueueName;\n        tokens['uii'] = newTask.uii;\n      } catch (any) {\n        console.error(\n          'There was an error parsing chat tokens for basic chat info. ',\n          any,\n        );\n      }\n\n      try {\n        tokens['agentFirstName'] = model.agentSettings.firstName;\n        tokens['agentLastName'] = model.agentSettings.lastName;\n        tokens['agentExternalId'] = model.agentSettings.externalAgentId;\n        tokens['agentType'] = model.agentSettings.agentType;\n        tokens['agentEmail'] = model.agentSettings.email;\n        tokens['agentUserName'] = model.agentSettings.username;\n      } catch (any) {\n        console.error(\n          'There was an error parsing chat tokens for agent info. ',\n          any,\n        );\n      }\n\n      return tokens;\n    }\n\n    var NewChatNotification = function () {};\n\n    /*\n     * External Chat:\n     * This class is responsible for handling \"NEW-CHAT\" packets from IntelliQueue.\n     *\n     *  {\n     *      \"ui_notification\":{\n     *          \"@message_id\":\"IQ10012016081611595000289\",\n     *          \"@type\":\"NEW-CHAT\",\n     *          \"@destination\":\"IQ\",\n     *          \"@response_to\":\"\",\n     *          \"uii\":{\"#text\":\"201608161200240139000000000120\"},\n     *          \"account_id\":{\"#text\":\"99999999\"},\n     *          \"session_id\":{\"#text\":\"2\"},\n     *          \"agent_id\":{\"#text\":\"1180958\"},\n     *          \"queue_dts\":{\"#text\":\"\"},\n     *          \"queue_time\":{\"#text\":\"\"},\n     *          \"chat_queue_id\":{\"#text\":\"\"},\n     *          \"chat_queue_name\":{\"#text\":\"\"},\n     *          \"chat_requeue_type\" : {\"#text\":\"\"}\n     *          \"app_url\":{\"#text\":\"\"},\n     *          \"channel_type\":{\"#text\":\"\"},\n     *          \"ani\":{\"#text\":\"\"},\n     *          \"dnis\":{\"#text\":\"\"},\n     *          \"survey_pop_type\":{\"#text\":\"\"},\n     *          \"script_id\":{\"#text\":\"\"},\n     *          \"script_version\":{\"#text\":\"\"},\n     *          \"idle_timeout\":{\"#text\":\"\"},\n     *          \"is_monitoring\":{#text\":\"TRUE\"|\"FALSE\"},\n     *          \"monitored_agent_id\":{\"#text\":\"123\"| \"\"} <-- only populated if is_monitoring == TRUE\n     *          \"chat_dispositions\":{\n     *              \"disposition\":[\n     *                  { \"@disposition_id\":\"2\", \"@is_success\":\"true\", \"@is_complete\":\"false\", \"@is_default\"=\"0\", \"@email_template_id\":\"1\", \"#text\":\"Complete\"},\n     *                  { \"@disposition_id\":\"3\", \"@is_success\":\"true\", \"@is_complete\":\"false\", \"@is_default\"=\"0\", \"#text\":\"Requeue\"}\n     *              ]\n     *          },\n     *          \"chat_requeue_shortcuts\" :{\n     *              shortcut : [\n     *                {@chat_requeue_shortcut_id:\"3\", @name:\"test\", @rank:\"1\",@requeue_chat_queue_id:\"74\",@skill_id:\"\"}\n     *              ]\n     *          }\n     *          \"transcript\":{\n     *              \"message\":[\n     *                  { \"@from\":\"system\", \"@type\":\"SYSTEM\", \"@whisper\":\"FALSE\", \"@dts\":\"yyyy-MM-dd HH:mm:ss\", \"#text\":\"User1 connected\"},\n     *                  { \"@from\":\"dlbooks\", \"@type\":\"AGENT\", \"@whisper\":\"FALSE\", \"@dts\":\"yyyy-MM-dd HH:mm:ss\", \"#text\":\"Hello\"},\n     *                  { \"@from\":\"user1\", \"@type\":\"CLIENT\", \"@whisper\":\"FALSE\", \"@dts\":\"yyyy-MM-dd HH:mm:ss\", \"#text\":\"Hi\"}\n     *              ]\n     *          },\n     *          \"json_baggage\":{\"#text\":\"json_string_form_data\"}, <--- pre-form chat data\n     *      }\n     *  }\n     */\n    NewChatNotification.prototype.processResponse = function (notification) {\n      var notif = notification.ui_notification;\n\n      var dts = utils.getText(notif, 'queue_dts');\n      dts = new Date(dts.replace(' ', 'T'));\n\n      var newChat = utils.buildDefaultResponse(notification);\n      newChat.message = 'Received NEW-CHAT notification';\n      newChat.status = 'OK';\n      newChat.uii = utils.getText(notif, 'uii');\n      newChat.accountId = utils.getText(notif, 'account_id');\n      newChat.sessionId = utils.getText(notif, 'session_id');\n      newChat.agentId = utils.getText(notif, 'agent_id');\n      newChat.queueDts = dts;\n      newChat.queueTime = utils.getText(notif, 'queue_time');\n      newChat.chatQueueId = utils.getText(notif, 'chat_queue_id');\n      newChat.chatQueueName = utils.getText(notif, 'chat_queue_name');\n      newChat.chatRequeueType = utils.getText(notif, 'chat_requeue_type');\n      newChat.appUrl = utils.getText(notif, 'app_url');\n      newChat.channelType = utils.getText(notif, 'channel_type');\n      newChat.ani = utils.getText(notif, 'ani');\n      newChat.dnis = utils.getText(notif, 'dnis');\n      newChat.surveyPopType = utils.getText(notif, 'survey_pop_type');\n      newChat.scriptId = utils.getText(notif, 'script_id');\n      newChat.scriptVersion = utils.getText(notif, 'script_version');\n      newChat.idleTimeout = utils.getText(notif, 'idle_timeout');\n      newChat.isMonitoring = utils.getText(notif, 'is_monitoring');\n      newChat.monitoredAgentId = utils.getText(notif, 'monitored_agent_id');\n      newChat.preChatData = utils.getText(notif, 'json_baggage');\n\n      newChat.requeueShortcuts = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'chat_requeue_shortcuts',\n        'shortcut',\n      )[0];\n      newChat.chatDispositions = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'chat_dispositions',\n        'disposition',\n      )[0];\n      newChat.transcript = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'transcript',\n        'message',\n      )[0];\n      newChat.baggage = utils.processResponseCollection(\n        notification,\n        'ui_notification',\n        'json_baggage',\n      )[0];\n\n      if (newChat.chatDispositions && newChat.chatDispositions.disposition) {\n        newChat.chatDispositions.dispositions = [newChat.chatDispositions];\n      } else {\n        newChat.chatDispositions = newChat.chatDispositions.dispositions;\n      }\n\n      if (newChat.transcript && newChat.transcript.message) {\n        newChat.transcript = [newChat.transcript];\n      } else {\n        newChat.transcript = newChat.transcript.messages;\n      }\n\n      if (newChat.preChatData) {\n        try {\n          newChat.preChatData = JSON.parse(newChat.preChatData);\n        } catch (err) {\n          utils.logMessage(\n            LOG_LEVELS.ERROR,\n            'Error parsing the pre-form chat data.',\n            notif,\n          );\n        }\n      }\n\n      // convert numbers to boolean\n      if (newChat.chatDispositions) {\n        for (var d = 0; d < newChat.chatDispositions.length; d++) {\n          var disp = newChat.chatDispositions[d];\n          disp.isComplete = disp.isComplete === '1';\n          disp.isSuccess = disp.isSuccess === '1';\n          disp.isDefault = disp.isDefault === '1';\n        }\n      }\n\n      // convert dates\n      if (newChat.transcript) {\n        for (var t = 0; t < newChat.transcript.length; t++) {\n          var msg = newChat.transcript[t];\n          if (msg.dts) {\n            msg.dts = new Date(msg.dts.replace(' ', 'T'));\n          }\n        }\n      }\n\n      // Build token map\n      newChat.baggage = buildChatTokenMap(notif, newChat);\n\n      return newChat;\n    };\n\n    function buildChatTokenMap(notif, newChat) {\n      var tokens = {};\n      var model = UIModel.getInstance();\n\n      if (newChat.preChatData) {\n        for (var prop in newChat.preChatData) {\n          if (newChat.preChatData.hasOwnProperty(prop)) {\n            tokens[prop] = newChat.preChatData[prop];\n          }\n        }\n      }\n\n      try {\n        tokens['chatQueueId'] = newChat.chatQueueId;\n        tokens['chatQueueName'] = newChat.chatQueueName;\n        tokens['ani'] = newChat.ani;\n        tokens['dnis'] = newChat.dnis;\n        tokens['uii'] = newChat.uii;\n      } catch (any) {\n        console.error(\n          'There was an error parsing chat tokens for basic chat info. ',\n          any,\n        );\n      }\n\n      try {\n        tokens['agentFirstName'] = model.agentSettings.firstName;\n        tokens['agentLastName'] = model.agentSettings.lastName;\n        tokens['agentExternalId'] = model.agentSettings.externalAgentId;\n        tokens['agentType'] = model.agentSettings.agentType;\n        tokens['agentEmail'] = model.agentSettings.email;\n        tokens['agentUserName'] = model.agentSettings.username;\n      } catch (any) {\n        console.error(\n          'There was an error parsing chat tokens for agent info. ',\n          any,\n        );\n      }\n\n      return tokens;\n    }\n\n    var AgentStats = function () {};\n\n    /*\n * This class is responsible for handling an Agent Stats packet rec'd from IntelliServices.\n * It will save a copy of it in the UIModel. Could be a single agent or array of agents.\n *\n  {\"ui_stats\":{\n       \"@type\":\"AGENT\",\n       \"agent\":{\n           \"@alt\":\"INBOUND\",\n           \"@atype\":\"AGENT\",\n           \"@avgtt\":\"00.0\",\n           \"@calls\":\"0\",\n           \"@da\":\"0\",\n           \"@droute\":\"6789050673\",\n           \"@f\":\"John\",\n           \"@gdesc\":\"\",\n           \"@gname\":\"\",\n           \"@id\":\"1856\",\n           \"@l\":\"Doe\",\n           \"@ldur\":\"6\",\n           \"@ltype\":\"INBOUND\",\n           \"@oh\":\"0\",\n           \"@pd\":\"0\",\n           \"@pdt\":\"0\",\n           \"@pres\":\"0\",\n           \"@rna\":\"0\",\n           \"@sdur\":\"6\",\n           \"@sp\":\"\",\n           \"@state\":\"AVAILABLE\",\n           \"@ttt\":\"0\",\n           \"@u\":\"jdoe\",\n           \"@uii\":\"\",\n           \"@util\":\"0.00\",\n           \"@call_duration:0\"\n       }\n     }\n  }\n */\n    AgentStats.prototype.processResponse = function (stats) {\n      var resp = stats.ui_stats.agent;\n      var agentStats = [];\n\n      if (!Array.isArray(resp)) {\n        resp = [resp];\n      }\n\n      try {\n        for (var i = 0; i < resp.length; i++) {\n          agentStats.push({\n            agentLoginType: resp[i]['@alt'],\n            agentType: resp[i]['@atype'],\n            avgTalkTime: resp[i]['@avgtt'],\n            calls: resp[i]['@calls'],\n            isDequeueAgent: resp[i]['@da'],\n            defaultRoute: resp[i]['@droute'],\n            firstName: resp[i]['@f'],\n            queueDesc: resp[i]['@gdesc'],\n            queueName: resp[i]['@gname'],\n            agentId: resp[i]['@id'],\n            lastName: resp[i]['@l'],\n            loginDuration: resp[i]['@ldur'],\n            loginType: resp[i]['@ltype'],\n            offHook: resp[i]['@oh'],\n            pendingDisp: resp[i]['@pd'],\n            pendingDispTime: resp[i]['@pdt'],\n            presented: resp[i]['@pres'],\n            rna: resp[i]['@rna'],\n            stateDuration: resp[i]['@sdur'],\n            skillProfileName: resp[i]['@sp'],\n            agentState: resp[i]['@state'],\n            totalTalkTime: resp[i]['@ttt'],\n            username: resp[i]['@u'],\n            uii: resp[i]['@uii'],\n            utilization: resp[i]['@util'],\n            callDuration: resp[i]['@call_duration'],\n          });\n        }\n      } catch (e) {}\n\n      UIModel.getInstance().agentStats = agentStats;\n      return agentStats;\n    };\n\n    var AgentDailyStats = function () {};\n\n    /*\n     * This class is responsible for handling an Agent Daily Stats packet rec'd from IntelliServices.\n     * It will save a copy of it in the UIModel.\n     *\n     * {\"ui_stats\":{\n     *      \"@type\":\"AGENTDAILY\",\n     *      \"agent_id\":{\"#text\":\"1180723\"},\n     *      \"total_login_sessions\":{\"#text\":\"1\"},\n     *      \"total_calls_handled\":{\"#text\":\"0\"},\n     *      \"total_preview_dials\":{\"#text\":\"0\"},\n     *      \"total_manual_dials\":{\"#text\":\"0\"},\n     *      \"total_rna\":{\"#text\":\"0\"},\n     *      \"total_talk_time\":{\"#text\":\"0\"},\n     *      \"total_offhook_time\":{\"#text\":\"0\"},\n     *      \"total_login_time\":{\"#text\":\"7808\"},\n     *      \"total_success_dispositions\":{\"#text\":\"0\"}\n     *    }\n     * }\n     */\n    AgentDailyStats.prototype.processResponse = function (stats) {\n      var model = UIModel.getInstance().agentDailyStats;\n      var resp = stats.ui_stats;\n\n      model.agentId = utils.getText(resp, 'agent_id');\n      model.totalLoginSessions = utils.getText(resp, 'total_login_sessions');\n      model.totalChatsHandled = utils.getText(resp, 'total_chats_handled');\n      model.totalCallsHandled = utils.getText(resp, 'total_calls_handled');\n      model.totalPreviewDials = utils.getText(resp, 'total_preview_dials');\n      model.totalManualDials = utils.getText(resp, 'total_manual_dials');\n      model.totalRna = utils.getText(resp, 'total_rna');\n      model.totalSuccessDispositions = utils.getText(\n        resp,\n        'total_success_dispositions',\n      );\n\n      if (!model.totalTalkTime) {\n        // init daily stats to first stats packet if they don't exist\n        model.totalLoginTime = utils.getText(resp, 'total_login_time');\n        model.totalOffhookTime = utils.getText(resp, 'total_offhook_time');\n        model.totalTalkTime = utils.getText(resp, 'total_talk_time');\n        model.currCallTime = '0';\n      }\n\n      return model;\n    };\n\n    var CampaignStats = function () {};\n\n    /*\n     * This class is responsible for handling a Campaign Stats packet rec'd from IntelliServices.\n     * It will save a copy of it in the UIModel.\n     *\n     * {\"ui_stats\":{\n     *      \"@type\":\"CAMPAIGN\",\n     *      \"campaign\":[\n     *          {\n     *              \"@a\":\"0\",\"@aba\":\"0\",\"@an\":\"0\",\"@av\":\"0\",\"@b\":\"0\",\"@c\":\"1\",\"@e\":\"0\",\"@f\":\"0\",\n     *              \"@id\":\"60275\",\"@int\":\"0\",\"@m\":\"0\",\"@na\":\"0\",\"@name\":\"Test Campaign\",\n     *              \"@p\":\"0\",\"@r\":\"1\",\"@s\":\"0\",\"@tc\":\"0\",\"@ttt\":\"0\"\n     *          },\n     *          {\n     *              \"@a\":\"0\",\"@aba\":\"0\",\"@an\":\"0\",\"@av\":\"0\",\"@b\":\"0\",\"@c\":\"0\",\"@e\":\"0\",\"@f\":\"0\",\n     *              \"@id\":\"60293\",\"@int\":\"0\",\"@m\":\"0\",\"@na\":\"0\",\"@name\":\"Test Campaign w\\\\ Search\",\n     *              \"@p\":\"0\",\"@r\":\"19\",\"@s\":\"0\",\"@tc\":\"0\",\"@ttt\":\"0\"\n     *          }\n     *     ],\n     *     \"totals\":{\n     *          \"noanswer\":{\"#text\":\"0\"},\n     *          \"totalConnects\":{\"#text\":\"0\"},\n     *          \"pending\":{\"#text\":\"0\"},\n     *          \"active\":{\"#text\":\"0\"},\n     *          \"error\":{\"#text\":\"0\"},\n     *          \"totalTalkTime\":{\"#text\":\"0\"},\n     *          \"answer\":{\"#text\":\"0\"},\n     *          \"abandon\":{\"#text\":\"0\"},\n     *          \"ready\":{\"#text\":\"20\"},\n     *          \"machine\":{\"#text\":\"0\"},\n     *          \"intercept\":{\"#text\":\"0\"},\n     *          \"busy\":{\"#text\":\"0\"},\n     *          \"complete\":{\"#text\":\"1\"},\n     *          \"fax\":{\"#text\":\"0\"}\n     *     }\n     *   }\n     * }\n     */\n    CampaignStats.prototype.processResponse = function (stats) {\n      var resp = stats.ui_stats;\n      var totals = utils.processResponseCollection(\n        stats,\n        'ui_stats',\n        'totals',\n      )[0];\n      var campaigns = [];\n      var campRaw = null;\n\n      if (!Array.isArray(resp.campaign)) {\n        resp.campaign = [resp.campaign];\n      }\n\n      for (var c = 0; c < resp.campaign.length; c++) {\n        campRaw = resp.campaign[c];\n\n        if (campRaw == null) {\n          continue;\n        }\n\n        campaigns.push({\n          active: campRaw['@a'],\n          abandon: campRaw['@aba'],\n          answer: campRaw['@an'],\n          available: campRaw['@av'],\n          busy: campRaw['@b'],\n          complete: campRaw['@c'],\n          error: campRaw['@e'],\n          fax: campRaw['@f'],\n          campaignId: campRaw['@id'],\n          intercept: campRaw['@int'],\n          machine: campRaw['@m'],\n          noanswer: campRaw['@na'],\n          campaignName: campRaw['@name'],\n          pending: campRaw['@p'],\n          ready: campRaw['@r'],\n          staffed: campRaw['@s'],\n          totalConnects: campRaw['@tc'],\n          totalTalkTime: campRaw['@ttt'],\n        });\n      }\n\n      var campaignStats = {\n        type: resp['@type'],\n        campaigns: campaigns,\n        totals: totals,\n      };\n\n      UIModel.getInstance().campaignStats = campaignStats;\n\n      return campaignStats;\n    };\n\n    var ChatQueueStats = function () {};\n\n    /*\n     * This class is responsible for handling an Chat Stats packet rec'd from IntelliServices.\n     * It will save a copy of it in the UIModel.\n     *\n     *{\n     *  \"ui_stats\": {\n     *  \"@type\": \"CHAT\",\n     *  \"chatQueue\": [\n     *      {\n     *          \"@active\": \"1\",\n     *          \"@available\": \"0\",\n     *          \"@avgAbandon\": \"00.0\",\n     *          \"@avgChatTime\": \"00.0\",\n     *          \"@avgQueueTime\": \"00.0\",\n     *          \"@chatQueueId\": \"1\",\n     *          \"@chatQueueName\": \"testing chat quuee\",\n     *          \"@deflected\": \"0\",\n     *          \"@inQueue\": \"0\",\n     *          \"@longestInQueue\": \"0\",\n     *          \"@presented\": \"0\",\n     *          \"@routing\": \"0\",\n     *          \"@staffed\": \"0\",\n     *          \"@totalAbandonTime\": \"0\",\n     *          \"@totalAnswerTime\": \"0\",\n     *          \"@totalChatTime\": \"0\",\n     *          \"@totalQueueTime\": \"0\",\n     *          \"@utilization\": \"00.0\"\n     *      },\n     *      {\n     *          \"@active\": \"0\",\n     *          \"@available\": \"0\",\n     *          \"@avgAbandon\": \"00.0\",\n     *          \"@avgChatTime\": \"00.0\",\n     *          \"@avgQueueTime\": \"00.0\",\n     *          \"@chatQueueId\": \"3\",\n     *          \"@chatQueueName\": \"testing test\",\n     *          \"@deflected\": \"0\",\n     *          \"@inQueue\": \"0\",\n     *          \"@longestInQueue\": \"0\",\n     *          \"@presented\": \"0\",\n     *          \"@routing\": \"0\",\n     *          \"@staffed\": \"0\",\n     *          \"@totalAbandonTime\": \"0\",\n     *          \"@totalAnswerTime\": \"0\",\n     *          \"@totalChatTime\": \"0\",\n     *          \"@totalQueueTime\": \"0\",\n     *          \"@utilization\": \"00.0\"\n     *      }\n     *  ],\n     *  \"totals\": {\n     *      \"routing\": {\"#text\": \"0\"},\n     *      \"ttotalAnswerTime\": {\"#text\": \"0\"},\n     *      \"inQueue\": { \"#text\": \"0\"},\n     *      \"ttotalChatTime\": {\"#text\": \"0\"},\n     *      \"ttotalAbandonTime\": {\"#text\": \"0\"},\n     *      \"presented\": {\"#text\": \"0},\n     *      \"accepted\": {\"#text\": \"0\"},\n     *      \"deflected\": {\"#text\": \"0\"},\n     *      \"active\": {\"#text\": \"1\"},\n     *      \"abandoned\": {\"#text\": \"0\"},\n     *      \"ttotalQueueTime\": {\"#text\": \"0\"}\n     *   }\n     *  }\n     *}\n     */\n    ChatQueueStats.prototype.processResponse = function (stats) {\n      var resp = stats.ui_stats;\n      var totals = utils.processResponseCollection(\n        stats,\n        'ui_stats',\n        'totals',\n      )[0];\n      var chatQueues = utils.processResponseCollection(\n        stats,\n        'ui_stats',\n        'chatQueue',\n      );\n\n      var chatQueueStats = {\n        type: resp['@type'],\n        chatQueues: chatQueues,\n        totals: totals,\n      };\n\n      UIModel.getInstance().chatQueueStats = chatQueueStats;\n\n      return chatQueueStats;\n    };\n\n    var QueueStats = function () {};\n\n    /*\n     * This class is responsible for handling an Queue Stats packet rec'd from IntelliServices.\n     * It will save a copy of it in the UIModel.\n     *\n     * {\n     *   \"ui_stats\":{\n     *       \"@type\":\"GATE\",\n     *       \"gate\":{\n     *           \"@aba\":\"0\",\"@active\":\"0\",\"@ans\":\"0\",\"@asa\":\"00.0\",\"@avail\":\"2\",\n     *           \"@avga\":\"00.0\",\"@avgq\":\"00.0\",\"@avgt\":\"00.0\",\"@def\":\"0\",\"@id\":\"12126\",\n     *           \"@inq\":\"0\",\"@long_c\":\"0\",\"@longq\":\"0\",\"@name\":\"Cris inbound\",\n     *           \"@pres\":\"0\",\"@route\":\"0\",\"@short_aba\":\"0\",\"@short_c\":\"0\",\"@sla\":\"100.0\",\n     *           \"@sla_f\":\"0\",\"@sla_p\":\"0\",\"@staff\":\"2\",\"@t_aba\":\"0\",\"@t_q\":\"0\",\"@t_soa\":\"0\",\"@util\":\"00.0\"\n     *       },\n     *       \"totals\":{\n     *           \"inQueue\":{\"#text\":\"0\"},\n     *           \"answered\":{\"#text\":\"0\"},\n     *           \"totalABATime\":{\"#text\":\"0\"},\n     *           \"active\":{\"#text\":\"0\"},\n     *           \"longCall\":{\"#text\":\"0\"},\n     *           \"shortCall\":{\"#text\":\"0\"},\n     *           \"slaPass\":{\"#text\":\"0\"},\n     *           \"totalQueueTime\":{\"#text\":\"0\"},\n     *           \"routing\":{\"#text\":\"0\"},\n     *           \"totalTalkTime\":{\"#text\":\"0\"},\n     *           \"shortAbandon\":{\"#text\":\"0\"},\n     *           \"presented\":{\"#text\":\"0\"},\n     *           \"totalSOA\":{\"#text\":\"0\"},\n     *           \"slaFail\":{\"#text\":\"0\"},\n     *           \"deflected\":{\"#text\":\"0\"},\n     *           \"abandoned\":{\"#text\":\"0\"}\n     *      }\n     *   }\n     * }\n     */\n    QueueStats.prototype.processResponse = function (stats) {\n      var resp = stats.ui_stats;\n      var totals = utils.processResponseCollection(\n        stats,\n        'ui_stats',\n        'totals',\n      )[0];\n      var queues = [];\n      var gateRaw = {};\n\n      if (!Array.isArray(resp.gate)) {\n        resp.gate = [resp.gate];\n      }\n\n      for (var c = 0; c < resp.gate.length; c++) {\n        gateRaw = resp.gate[c];\n        if (gateRaw == null) {\n          continue;\n        }\n\n        queues.push({\n          abandon: gateRaw['@aba'],\n          active: gateRaw['@active'],\n          answer: gateRaw['@ans'],\n          asa: gateRaw['@asa'],\n          available: gateRaw['@avail'],\n          avgAbandon: gateRaw['@avga'],\n          avgQueue: gateRaw['@avgq'],\n          avgTalk: gateRaw['@avgt'],\n          deflected: gateRaw['@def'],\n          queueId: gateRaw['@id'],\n          inQueue: gateRaw['@inq'],\n          longCall: gateRaw['@long_c'],\n          longestInQueue: gateRaw['@longq'],\n          queueName: gateRaw['@name'],\n          presented: gateRaw['@pres'],\n          routing: gateRaw['@route'],\n          shortAbandon: gateRaw['@short_aba'],\n          shortCall: gateRaw['@short_c'],\n          sla: gateRaw['@sla'],\n          slaPass: gateRaw['@sla_p'],\n          slaFail: gateRaw['@sla_f'],\n          staffed: gateRaw['@staff'],\n          tAbandonTime: gateRaw['@t_aba'],\n          tQueueTime: gateRaw['@t_q'],\n          tSpeedOfAnswer: gateRaw['@t_soa'],\n          utilization: gateRaw['@util'],\n        });\n      }\n\n      var queueStats = {\n        type: resp['@type'],\n        queues: queues,\n        totals: totals,\n      };\n\n      UIModel.getInstance().queueStats = queueStats;\n\n      return queueStats;\n    };\n\n    var UIModel = (function () {\n      var instance;\n\n      function init() {\n        // Singleton\n\n        // Private methods and variables here //\n        //function privateMethod(){\n        //    console.log( \"I am private\" );\n        //}\n        //\n        //var privateVariable = \"I'm also private\";\n\n        // Public methods and variables\n        return {\n          currentCall: {}, // save the NEW-CALL notification in parsed form\n          pendingNewCallSessions: {}, // save any pending call sessions, in case the new call packet hasn't arrived\n          callTokens: {}, // Stores a map of all tokens for a call\n          callbacks: [],\n          libraryInstance: null, // Initialized to the library instance on startup\n          pingIntervalId: null, // The id of the timer used to send ping-call messages\n          statsIntervalId: null, // The id of the timer used to send stats request messages\n          pingStatIntervalId: null, // The id of the timer used to send ping-call beat messages\n          agentDailyIntervalId: null, // The id of the timer used to update some agent daily stats values\n          reconnectIntervalId: null, // The id of the timer used to try reconnecting the socket\n          waitingForAddSession: null,\n          authHost: window.location.origin, // default to protocol + hostname + port\n          socketProtocol: 'wss://', // default to secure socket unless local test flag passed in on initialization\n          baseAuthUri: '/api/auth/', // the path to engage-auth e.g.: http://localhost:81/api/auth/ or window.location.origin + \"/api/auth/\",\n          baseApiUri: '/api/v1/', // the path to engage-api\n          baseEtrUri: '/platform/api/ed-task-routing/v1/', // the path to ETR task routing endpoints\n\n          // internal chat requests\n          chatAliasRequest: null,\n          chatRoomRequest: null,\n          chatSendRequest: null,\n          supervisorListRequest: null,\n          chatRoomStateRequest: new ChatRoomStateRequest(),\n\n          //multi-socket\n          multiSocketRequest: new MultiSocketRequest(),\n          dataStore: new LocalStorageService('agentSDK'),\n\n          // external chat requests/notifications\n          chatCancelledNotification: new ChatCancelledNotification(),\n          chatActiveNotification: new ChatActiveNotification(),\n          chatInactiveNotification: new ChatInactiveNotification(),\n          chatDispositionRequest: null,\n          chatMessageRequest: new ChatMessageRequest(),\n          chatPresentedNotification: new ChatPresentedNotification(),\n          chatPresentedRequest: null,\n          chatRequeueRequest: null,\n          chatTypingNotification: new ChatTypingNotification(),\n          chatTypingRequest: null,\n          newChatNotification: new NewChatNotification(),\n          loadMediaNotification: new LoadMediaNotification(),\n          chatAgentAssignFailureNotification: new ChatAgentAssignFailureNotification(),\n          chatClientReconnectNotification: new ChatClientReconnectNotification(),\n\n          // request instances\n          agentStateRequest: null,\n          chatStateRequest: null,\n          ackRequest: new AckRequest(),\n          bargeInRequest: null,\n          callNotesRequest: null,\n          callbacksPendingRequest: null,\n          campaignDispositionsRequest: null,\n          loginRequest: null,\n          coldXferRequest: null,\n          dispositionRequest: null,\n          dispositionManualPassRequest: null,\n          hangupRequest: null,\n          holdRequest: null,\n          leadHistoryRequest: null,\n          leadInsertRequest: null,\n          leadUpdateRequest: null,\n          logoutRequest: null,\n          authenticateRequest: null, // get RC access token\n          loginPhase1Request: null,\n          offhookInitRequest: null,\n          offhookTermRequest: null,\n          oneToOneOutdialRequest: null,\n          oneToOneOutdialCancelRequest: null,\n          pauseRecordRequest: null,\n          pingCallRequest: null,\n          previewDialRequest: null,\n          reconnectRequest: null,\n          recordRequest: null,\n          requeueRequest: null,\n          statsRequest: null,\n          tcpaSafeRequest: null,\n          warmXferRequest: null,\n          warmXferCancelRequest: null,\n          chatListRequest: null,\n          directAgentTransferListRequest: null,\n          directAgentTransferRequest: null,\n          webRTCRequest: null,\n          searchDirectoryRequest: null,\n          extensionPresenceRequest: null,\n\n          // response packets\n          agentStatePacket: null,\n          chatStatePacket: null,\n          loginPacket: null,\n          currentCallPacket: null,\n          authenticatePacket: null,\n          loginPhase1Packet: null,\n          offhookInitPacket: null,\n          offhookTermPacket: null,\n          transferSessions: {},\n          chatListResponse: null,\n\n          // notification packets\n          addSessionNotification: new AddSessionNotification(),\n          dialGroupChangeNotification: new DialGroupChangeNotification(),\n          dialGroupChangePendingNotification: new DialGroupChangePendingNotification(),\n          dropSessionNotification: new DropSessionNotification(),\n          earlyUiiNotification: new EarlyUiiNotification(),\n          endCallNotification: new EndCallNotification(),\n          gatesChangeNotification: new GatesChangeNotification(),\n          genericNotification: new GenericNotification(),\n          newCallNotification: new NewCallNotification(),\n\n          // stats packets\n          agentStatsPacket: new AgentStats(),\n          agentDailyStatsPacket: new AgentDailyStats(),\n          queueStatsPacket: new QueueStats(),\n          campaignStatsPacket: new CampaignStats(),\n          chatQueueStatsPacket: new ChatQueueStats(),\n\n          // application state\n          applicationSettings: {\n            availableCountries: [],\n            isLoggedInIS: false, // a check for whether or not user is logged in with IntelliServices\n            socketConnected: false,\n            socketDest: '',\n            isTcpaSafeMode: false, // Comes in at the account-level - will get set to true if this interface should be in tcpa-safe-mode only.\n            isSso: false, // Passed in on phase 1 login response, if agent signed in through RC single sign-on path set to true\n            isFlr: false, // Check of Force legacy registration for dialing destination type\n            dialDestType: '', // What type of phone are we setting up: e.g. \"RC_SOFTPHONE\", \"LEGACY_SOFTPHONE\", \"RC_PHONE\" (for RC office ext)// Comes in at the account-level - will get set to true if this interface should be in tcpa-safe-mode only.\n            allowMultiSocket: false, // Determines whether agent can open a new socket under the same login\n            edSources: {}, // Cache for ED sources, loaded when first task received. Object indexed by mainAccountId, then array of all sources\n            edLanguages: {}, // Cache for ED language, loaded when first task received. Object indexed by mainAccountId, then array of all languages\n            edCategories: {}, // Cache for ED categories, loaded when first task received. Object indexed by mainAccountId, then array of all categories\n          },\n\n          // stat objects\n          agentStats: [],\n          agentDailyStats: {},\n          campaignStats: {},\n          queueStats: {},\n          chatQueueStats: {},\n\n          // current agent settings\n          agentSettings: {\n            accountId: null, // account agent belongs to\n            agentId: 0,\n            agentPassword: '', //agent Password\n            agentType: 'AGENT', // AGENT | SUPERVISOR\n            altDefaultLoginDest: '',\n            availableAgentStates: [],\n            callerIds: [],\n            callState: null, // display the current state of the call\n            corporateDirectory: false,\n            consultCall: false, //consult call allow\n            currentState: 'OFFLINE', // Agent system/base state\n            currentStateLabel: '', // Agent aux state label\n            defaultLoginDest: '',\n            dialDest: '', // Destination agent is logged in with for offhook session, set on configure response, if multi values in format \"xxxx|,,xxxx\"\n            email: '',\n            externalAgentId: '',\n            firstName: '',\n            guid: '', // unique key generated on login, used for accessing spring endpoints\n            isLoggedIn: false, // agent is logged in to the platform\n            isOffhook: false, // track whether or not the agent has an active offhook session\n            isMonitoring: false, // track whether or not the offhook session is for monitoring\n            initLoginState: 'AVAILABLE', // state agent is placed in on successful login\n            initLoginStateLabel: 'Available', // state label for agent on successful login\n            isOutboundPrepay: false, // determines if agent is a prepay agent\n            lastName: '',\n            loginDTS: null, // date and time of the final login phase (IQ)\n            loginType: 'NO-SELECTION', // Could be INBOUND | OUTBOUND | BLENDED | NO-SELECTION, set on login response\n            maxBreakTime: -1,\n            maxLunchTime: -1,\n            onCall: false, // true if agent is on an active call\n            onManualOutdial: false, // true if agent is on a manual outdial call\n            outboundManualDefaultRingtime: '30',\n            pendingCallbacks: [],\n            pendingDialGroupChange: 0, // Set to Dial Group Id if we are waiting to change dial groups until agent ends call\n            phoneLoginPin: '',\n            realAgentType: 'AGENT',\n            supervisors: [], // Used for agent chat\n            totalCalls: 0, // Call counter that is incremented every time a new session is received\n            transferNumber: '', // May be pre-populated by an external interface, if so, the transfer functionality uses it\n            updateDGFromAdminUI: false, // if pending Dial Group change came from AdminUI, set to true (only used if request is pending)\n            updateLoginMode: false, // gets set to true when doing an update login (for events control)\n            username: '', // Agent's username\n            wasMonitoring: false, // used to track if the last call was a monitoring call\n          },\n\n          // current agent permissions\n          agentPermissions: {\n            allowBlended: true, // Controls whether or not the agent can log into both inbound queues and an outbound dialgroup\n            allowCallControl: true, // Set from the the login response packet\n            allowChat: false, // Controls whether or not the agent has the option to open the Chat Queue Manager\n            enableChat: false, // Controls whether or not the agent has legacy chat and SMS access on the account level\n            allowCrossQueueRequeue: false, // Controls whether or not the agent can requeue to a different queue group\n            allowInbound: true, // Controls whether or not the agent can log into an inbound queue\n            allowLeadInserts: false, // Controls whether or not the agents can insert leads\n            allowLeadSearch: false, // Controlled by the dial-group allow_lead_search setting. Enables or disables the lead search\n            allowLoginControl: true, // Controls whether or not the agent can log in\n            allowLoginUpdates: true, // Controls whether or not the agent can update their login\n            allowManualCalls: true, // Controls whether or not the agents have the option to make a manual outbound call\n            allowManualPass: true, // Controls whether or not the agent has the option to make a manual pass on a lead\n            allowManualIntlCalls: false, // Controls whether or not the agent has the option to make international manual outbound calls\n            allowManualOutboundGates: false, // Controls whether or not the agent has the option to select queues to convert manual outbound calls to\n            allowOffHook: true, // Controls whether or not the agents can go offhook\n            allowOutbound: true, // Controls whether or not the agent can log into an outdial group\n            allowPreviewLeadFilters: false, // Controlled by the dial-group allow_preview_lead_filters setting. Enables or disables the filters on the preview style forms\n            allowLeadUpdatesByCampaign: {}, // For each campaign ID, store whether leads can be updated\n            disableSupervisorMonitoring: true, // Controls whether or not a supervisor can view agent stats\n            progressiveEnabled: false, // Preview dial feature that enables auto-calls from the preview window.\n            requireFetchedLeadsCalled: false, // Controlled by the dial-group require_fetched_leads_called setting. Enables or disables the requirement to only fetch new leads when current leads are called or expired. ONly for Preview or TCPA-SAFE.\n            showLeadHistory: true, // Controls whether or not the agents can view lead history\n            enableTaskMode: false, // Controls whether or not the agent has access to Digital task mode\n            enableFolderMode: false, // Controls whether or not the agent has access to Digital folder mode\n          },\n\n          // chat\n          chatSettings: {\n            availableChatQueues: [], // List of all chat queues agent has access to, set on login\n            availableChatRooms: [], // List of all chat rooms agent has access to, set on login\n            chatQueues: [], // Array of chat queues agent is signed into\n            alias: '', // Chat alias, on-login this is the UID, but is changed if the user changes it\n          },\n\n          // connection objects\n          connectionSettings: {\n            hashCode: '', // used specifically for reconnects\n            reconnect: false, // variable tracks the type of login, on init it's false...once connected it's set to true\n            isMultiSocket: false,\n          },\n\n          // inbound settings\n          inboundSettings: {\n            availableQueues: [], // array of queues agent has access to, set on login\n            availableSkillProfiles: [], // array of skill profiles agent has access to, set on login\n            queues: [], // array of queues agent is signed into, set on config response\n            skillProfile: {}, // The skill profile the agent is signed into, set on config response\n          },\n\n          // outbound settings\n          outboundSettings: {\n            availableCampaigns: [], // array of campaigns agent has access to, set on login\n            availableOutdialGroups: [], // array of dial groups agent has access to, set on login\n            insertCampaigns: [],\n            defaultDialGroup: 0,\n            outdialGroup: {}, // dial group agent is signed into\n            previewDialLeads: [], // list of leads returned from preview dial request\n            tcpaSafeLeads: [], // list of leads returned from tcpa safe request\n            campaignDispositions: [], // list of campaign dispositions for specific campaign\n          },\n\n          scriptSettings: {\n            availableScripts: [], // array of all scripts associated with any campaigns or queues agent is logged into\n            loadedScripts: {}, // stores script data by script id e.g. {1:{}, 32:{}}\n          },\n\n          softphoneSettings: {\n            webRtc: null, // stores the CFSimpleSip object\n            isRegistered: false, // whether or not the softphone is currently registered\n            muteActive: false, // whether or not the softphone is muted\n            registerPending: null, // timeout to trigger no register response\n            maintainOH: false, // based on the configurable agent setting to keep offhook session after ending call\n            autoStartOH: false, // determines whether or not to start an offhook session automatically after softphone registrar reconnect\n            wsServers: [], // current sip server domain + user credentials, set as array for SIP.js ua object\n            sipInfo: [], // array of sip server domains + user credentials for softphone registration, retrieved from engage-auth\n            uri: '', // username + @ + domain\n            displayName: '', // username - Used to register softphone with freeswitch (legacy)\n            authorizationUser: '', // username - Used to register softphone with freeswitch (legacy)\n            sipPassword: '', // password for sip softphone registration\n            sipDialDest: '', // dialDest used for softphone connection\n            attemptingSoftphoneReconnect: false, // set to true when attempting to rotate softphone registrar and reconnect\n            //manualSoftphoneReconnect: false,     // set to true when agent triggered registrar rotation\n            lastSipFetchTime: 0, //set current time when sip registration info fetched.\n          },\n\n          // Filtered Directory\n          filteredDirectory: {\n            rcAccountId: '',\n            records: [],\n          },\n\n          extensionPresenceResponse: [],\n\n          // Public methods\n          incrementTotalCalls: function () {\n            this.agentSettings.totalCalls = this.agentSettings.totalCalls + 1;\n          },\n        };\n      }\n\n      return {\n        // Get the Singleton instance if one exists\n        // or create one if it doesn't\n        getInstance: function () {\n          if (!instance) {\n            instance = init();\n          }\n          return instance;\n        },\n\n        resetInstance: function () {\n          instance = null;\n        },\n      };\n    })();\n\n    var LocalStorageService = function (name) {\n      if (!window.localStorage) {\n        console.log('Browser does not support HTML5 Web Storage');\n      }\n      this.prefix = name + ':';\n    };\n    LocalStorageService.prototype.save = function (key, value) {\n      // TODO: that window.localStorage is add by ringcentral-integration\n      if (!window.localStorage || !key || !value) {\n        console.log('Missing parameters key or value on add');\n        return false;\n      }\n      window.localStorage.setItem(this.prefix + key, JSON.stringify(value));\n    };\n    LocalStorageService.prototype.get = function (key) {\n      // TODO: that window.localStorage is add by ringcentral-integration\n      if (\n        !window.localStorage ||\n        !key ||\n        !window.localStorage.getItem(this.prefix + key)\n      ) {\n        console.log('Missing parameter key on retrieve');\n        return false;\n      }\n      return window.localStorage.getItem(this.prefix + key);\n    };\n\n    LocalStorageService.prototype.remove = function (key) {\n      // TODO: that window.localStorage is add by ringcentral-integration\n      if (\n        !window.localStorage ||\n        !key ||\n        !window.localStorage.getItem(this.prefix + key)\n      ) {\n        console.log('Missing parameter key on remove');\n        return false;\n      }\n      window.localStorage.removeItem(this.prefix + key);\n    };\n    // --------------------------\n    // BroadcastChannelHelper.js\n    // --------------------------\n    var broadcastChannelHelper = {\n      // Generate handlers to request / response BroadcastChannels\n      //\n      requestChannel: null,\n      responseChannel: null,\n      currentCallMessageId: null,\n      currentCallRequestCallback: null,\n\n      // Registers the request / response channels\n      //\n      init: function () {\n        if (this.requestChannel != null) {\n          return;\n        }\n\n        var self = this;\n        this.requestChannel = new BroadcastChannel('ev-multisocket-request');\n        this.responseChannel = new BroadcastChannel('ev-multisocket-response');\n\n        // Listen for requests coming from the requestChannel\n        //\n        this.requestChannel.onmessage = function (e) {\n          var type = e.data.type;\n          var messageId = e.data.messageId;\n\n          switch (type) {\n            case 'currentCall':\n              self._sendCurrentCall(messageId);\n              break;\n          }\n        };\n\n        // Listen for requests coming from the responseChannel\n        //\n        this.responseChannel.onmessage = function (e) {\n          var type = e.data.type;\n\n          switch (type) {\n            case 'currentCall':\n              self._processCurrentCallResponse(e.data.data, e.data.messageId);\n          }\n        };\n      },\n\n      destroy: function () {\n        if (this.requestChannel == null) {\n          return;\n        }\n\n        this.requestChannel.onmessage = null;\n        this.responseChannel.onmessage = null;\n\n        this.requestChannel.close();\n        this.responseChannel.close();\n\n        this.requestChannel = null;\n        this.responseChannel = null;\n      },\n\n      // ----------------------------------------------------\n      // Current Call, Request & Response\n      // ----------------------------------------------------\n\n      // When a new tab opens and needs to get the current call, it can do so with this method.  Passing\n      // a callback function to response with (could be a Promise if we are using them in SDK). Once\n      // a response is retrieved, it will be handled in the \"processCurrentCall\" method, and returned\n      // back to the original callback function\n      //\n      requestCurrentCall: function (fn) {\n        this.currentCallMessageId = Math.random();\n        this.currentCallRequestCallback = fn;\n\n        this.requestChannel.postMessage({\n          type: 'currentCall',\n          messageId: this.currentCallMessageId,\n        });\n      },\n\n      // Any instance that has knowledge of the current call can respond to the request\n      //\n      _sendCurrentCall: function (messageId) {\n        if (UIModel.getInstance().currentCall != null) {\n          var obj = {\n            type: 'currentCall',\n            messageId: messageId,\n            data: UIModel.getInstance().currentCall,\n          };\n\n          this.responseChannel.postMessage(obj);\n        }\n      },\n\n      // When a current call response is received, every tab will try to process it.  Only the original\n      // requestor will be able to process it successfully.\n      //\n      _processCurrentCallResponse: function (data, messageId) {\n        if (this.currentCallMessageId === messageId) {\n          // Set the current call model\n          UIModel.getInstance().currentCall = data;\n\n          // Alert the original method that our data is now available.\n          if (this.currentCallRequestCallback != null) {\n            this.currentCallRequestCallback(data);\n          }\n\n          // Null out properties - this ensure subsequent responses from other tabs will be ignored.\n          this.currentCallMessageId = null;\n          this.currentCallRequestCallback = null;\n        }\n      },\n    };\n\n    function HttpService(apiBase) {\n      this.XMLHttpRequest = window.XMLHttpRequest;\n      this.encodeURIComponent = window.encodeURIComponent;\n      this.apiBase = apiBase || 'http://localhost:81';\n\n      var that = this;\n\n      /**\n       * Makes a GET request to Engage Auth.\n       *\n       * @param {string} path - Relative path to append to apiUrl.\n       * @param {Object} config - Object describing different properties of the request.\n       * @returns {Promise} Promise that represents status of the request. Resolves if server responds with 200 status code, and is rejected otherwise.\n       */\n      this.httpGet = function (path, config) {\n        return new Promise(function (resolve, reject) {\n          var req = new that.XMLHttpRequest();\n          var queryParams = '';\n          if (config.queryParams) {\n            queryParams = '?' + _getUriEncodedParams(config.queryParams);\n          }\n          req.open('GET', that.apiBase + path + queryParams);\n          _addHeaders(config, req);\n          _addCompletionListeners(resolve, reject, req);\n          req.send();\n        });\n      };\n\n      /**\n       * Makes a GET request to Engage Auth.\n       *\n       * @param {string} path - Relative path to append to apiUrl.\n       * @param {Object} config - Object describing different properties of the request.\n       * @returns {Promise} Promise that represents status of the request. Resolves if server responds with 200 status code, and is rejected otherwise.\n       */\n      this.httpPost = function (path, config) {\n        return new Promise(function (resolve, reject) {\n          var req = new that.XMLHttpRequest();\n          var queryParams = '';\n          if (config.queryParams) {\n            queryParams = '?' + _getUriEncodedParams(config.queryParams);\n          }\n          req.open('POST', that.apiBase + path + queryParams);\n          _addHeaders(config, req);\n          _addCompletionListeners(resolve, reject, req);\n          req.send(_getUriEncodedBody(config));\n        });\n      };\n\n      /**\n       * Utility method used to check if an argument is actually an object.\n       *\n       * @param {*} obj\n       */\n      function _isObj(obj) {\n        return typeof obj === 'object' && obj !== null;\n      }\n\n      /**\n       * Adds headers to XMLHttpRequest based on configuration object.\n       *\n       * @param {Object} config - Config object passed to HttpService methods.\n       * @param {XMLHttpRequest} req - Instance of XMLHttpRequest that needs to be configured.\n       */\n      function _addHeaders(config, req) {\n        if (!_isObj(config)) {\n          return;\n        }\n\n        var headers = config.headers;\n\n        if (!_isObj(headers)) {\n          return;\n        }\n\n        for (var key in headers) {\n          req.setRequestHeader(key, headers[key]);\n        }\n      }\n\n      /**\n       * Configures an XMLHttpRequest object to properly resolve/reject a promise, depending on the outcome of the request.\n       *\n       * @param {Function} resolve - Resolve callback function from a promise. Invoked if the request completed successfully.\n       * @param {Function} reject - Reject callback function from a promise. Invoked if the request failed.\n       * @param {XMLHttpRequest} req - Instance of XMLHttpRequest that will be configured.\n       */\n      function _addCompletionListeners(resolve, reject, req) {\n        req.addEventListener('error', function (e) {\n          reject(e);\n        });\n        req.addEventListener('timeout', function () {\n          reject(new Error('request timeout'));\n        });\n        req.addEventListener('load', function () {\n          if (this.status !== 200) {\n            reject({\n              status: this.status,\n              response: this.responseText,\n            });\n          } else {\n            resolve({\n              status: this.status,\n              response: this.responseText,\n            });\n          }\n        });\n      }\n\n      /**\n       * Takes a config object and serializes/URI encodes the contents of the body property. If the \"Content-Type\" header is set\n       * to \"application/json\", it encodes the payload as JSON. Otherwise, we assume that the payload should be x-www-form-urlencoded.\n       */\n      function _getUriEncodedBody(config) {\n        var contentType =\n          config && config.headers && config.headers['Content-Type'];\n        var body = (config && config.body) || '';\n\n        if (contentType === 'application/json') {\n          body = JSON.stringify(body);\n        } else {\n          if (_isObj(body)) {\n            body = _getUriEncodedParams(body);\n          }\n        }\n\n        return body;\n      }\n\n      function _getUriEncodedParams(params) {\n        if (!_isObj(params)) {\n          return;\n        }\n\n        return Object.keys(params)\n          .map(function (key) {\n            return (\n              encodeURIComponent(key) + '=' + encodeURIComponent(params[key])\n            );\n          })\n          .join('&');\n      }\n    }\n\n    function NewCallUtils(instance, data) {\n      this.instance = instance;\n      this.data = data;\n\n      var that = this;\n\n      this.setupAddSessionCallback = function () {\n        var sessionUii = utils.getText(data.ui_notification, 'uii'),\n          sessionId = utils.getText(data.ui_notification, 'session_id'),\n          call = UIModel.getInstance().currentCall;\n\n        console.log(sessionUii + ' ADD SESSION ' + sessionId);\n\n        if (call.uii === sessionUii) {\n          // we already have a new call packet for this session\n          _delayedAddSessionCallback(that.instance, that.data);\n        } else {\n          // uii mismatch, but call has been dispositioned\n          UIModel.getInstance().pendingNewCallSessions[sessionUii] =\n            UIModel.getInstance().pendingNewCallSessions[sessionUii] || {};\n          UIModel.getInstance().pendingNewCallSessions[sessionUii][\n            sessionId\n          ] = that;\n        }\n      };\n\n      this.processSessionsForCall = function () {\n        var uii = UIModel.getInstance().currentCall.uii,\n          delayedSessions = UIModel.getInstance().pendingNewCallSessions[uii];\n\n        console.log(uii + ' NEW CALL');\n\n        if (delayedSessions && Object.keys(delayedSessions).length > 0) {\n          // we have delayed sessions to process\n          for (var sessionId in delayedSessions) {\n            if (delayedSessions.hasOwnProperty(sessionId)) {\n              var session = delayedSessions[sessionId];\n              _delayedAddSessionCallback(session.instance, session.data);\n            } else {\n              console.error(\n                'error processing sessions for uii: ' +\n                  uii +\n                  ' session: ' +\n                  sessionId,\n              );\n            }\n          }\n\n          delete UIModel.getInstance().pendingNewCallSessions[uii];\n        }\n      };\n\n      function _delayedAddSessionCallback(instance, data) {\n        var addSessionNotif = new AddSessionNotification();\n        var addResponse = addSessionNotif.processResponse(data);\n        utils.fireCallback(instance, CALLBACK_TYPES.ADD_SESSION, addResponse);\n      }\n    }\n\n    var utils = {\n      logMessage: function (logLevel, message, data) {\n        var instance = UIModel.getInstance().libraryInstance;\n        if (instance._db) {\n          try {\n            var transaction = instance._db.transaction(['logger'], 'readwrite');\n            var store = transaction.objectStore('logger');\n\n            var record = {\n              logLevel: logLevel,\n              message: message,\n              dts: new Date(),\n              data: data,\n            };\n\n            var request = store.add(record);\n          } catch (err) {\n            console.error('Error adding log message: ' + err);\n          }\n        } else {\n          //console.log(\"AgentLibrary: indexedDb not available\");\n        }\n      },\n\n      sendMessage: function (instance, msg) {\n        var msgObj = JSON.parse(msg);\n\n        if (instance.socket && instance.socket.readyState === 1) {\n          // add message id to request map, then send message\n          var type = msgObj.ui_request['@type'];\n          var destination = msgObj.ui_request['@destination'];\n          var message =\n            'Sending ' + type + ' request message to ' + destination;\n          instance._requests.push({\n            id: msgObj.ui_request['@message_id'],\n            type: msgObj.ui_request['@type'],\n            msg: msgObj.ui_request,\n          });\n\n          // keep rolling window of latest 1000 requests\n          if (instance._requests.length > 1000) {\n            instance._requests.shift();\n          }\n\n          instance.socket.send(msg);\n\n          if (type === 'STATS') {\n            utils.logMessage(LOG_LEVELS.STATS, message, msgObj);\n          } else {\n            utils.logMessage(LOG_LEVELS.INFO, message, msgObj);\n          }\n        } else {\n          // add message to queue if socket is not open.\n          instance._queuedMsgs.push({ dts: new Date(), msg: msg });\n        }\n      },\n\n      processResponse: function (instance, response) {\n        var type = response.ui_response['@type'];\n        var messageId = response.ui_response['@message_id'];\n        var dest =\n          messageId === '' || !messageId ? 'IS' : messageId.slice(0, 2);\n        var message =\n          'Received ' + type.toUpperCase() + ' response message from ' + dest;\n\n        // log message response\n        utils.logMessage(LOG_LEVELS.INFO, message, response);\n\n        // Send generic on message response\n        utils.fireCallback(instance, CALLBACK_TYPES.ON_MESSAGE, response);\n\n        // Fire callback function\n        switch (type.toUpperCase()) {\n          case MESSAGE_TYPES.AGENT_STATE:\n            if (UIModel.getInstance().agentStateRequest === null) {\n              UIModel.getInstance().agentStateRequest = new AgentStateRequest(\n                response.ui_response.current_state['#text'],\n                response.ui_response.agent_aux_state['#text'],\n              );\n            }\n            var stateChangeResponse = UIModel.getInstance().agentStateRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.AGENT_STATE,\n              stateChangeResponse,\n            );\n            break;\n          case MESSAGE_TYPES.BARGE_IN:\n            var resp = UIModel.getInstance().bargeInRequest.processResponse(\n              response,\n            );\n            var responseTo = response.ui_response['@response_to'];\n            var request = utils.findRequestById(instance, responseTo);\n            if (request) {\n              // found corresponding request, fire registered callback for type\n              var audioState = request.msg.audio_state['#text'];\n              if (audioState === 'MUTE') {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.SILENT_MONITOR,\n                  resp,\n                );\n              } else if (audioState === 'COACHING') {\n                utils.fireCallback(instance, CALLBACK_TYPES.COACH_CALL, resp);\n              } else {\n                utils.fireCallback(instance, CALLBACK_TYPES.BARGE_IN, resp);\n              }\n            } else {\n              // no corresponding request, just fire FULL audio type BARGE-IN callback\n              utils.fireCallback(instance, CALLBACK_TYPES.BARGE_IN, resp);\n            }\n            break;\n          case MESSAGE_TYPES.CAMPAIGN_DISPOSITIONS:\n            var campaignDispsResposne = UIModel.getInstance().campaignDispositionsRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CAMPAIGN_DISPOSITIONS,\n              campaignDispsResposne,\n            );\n            break;\n          case MESSAGE_TYPES.CALL_NOTES:\n            var callNotes = UIModel.getInstance().callNotesRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.CALL_NOTES, callNotes);\n            break;\n          case MESSAGE_TYPES.CALLBACK_PENDING:\n            var pendingCallbacks = UIModel.getInstance().callbacksPendingRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CALLBACK_PENDING,\n              pendingCallbacks,\n            );\n            break;\n          case MESSAGE_TYPES.HOLD:\n            var holdRequest;\n            if (UIModel.getInstance().holdRequest === null) {\n              holdRequest = new HoldRequest();\n            } else {\n              holdRequest = UIModel.getInstance().holdRequest;\n            }\n            var hold = holdRequest.processResponse(response);\n            utils.fireCallback(instance, CALLBACK_TYPES.HOLD, hold);\n            break;\n          case MESSAGE_TYPES.LEAD_HISTORY:\n            var history = UIModel.getInstance().leadHistoryRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.LEAD_HISTORY, history);\n            break;\n          case MESSAGE_TYPES.LEAD_INSERT:\n            var insert = UIModel.getInstance().leadInsertRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.LEAD_INSERT, insert);\n            break;\n          case MESSAGE_TYPES.LEAD_UPDATE:\n            var update = UIModel.getInstance().leadUpdateRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.LEAD_UPDATE, update);\n            break;\n          case MESSAGE_TYPES.LOGIN_PHASE_1:\n            var loginPhase1Response = UIModel.getInstance().loginPhase1Request.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.LOGIN_PHASE_1,\n              loginPhase1Response,\n            );\n            break;\n          case MESSAGE_TYPES.LOGIN:\n            var loginResponse = UIModel.getInstance().loginRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.LOGIN, loginResponse);\n            break;\n          case MESSAGE_TYPES.OFFHOOK_INIT:\n            var offhook = new OffhookInitRequest();\n            var initResponse = offhook.processResponse(response);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.OFFHOOK_INIT,\n              initResponse,\n            );\n            break;\n          case MESSAGE_TYPES.PAUSE_RECORD:\n            var pauseRequest;\n            if (UIModel.getInstance().pauseRecordRequest === null) {\n              pauseRequest = new PauseRecordRequest();\n            } else {\n              pauseRequest = UIModel.getInstance().pauseRecordRequest;\n            }\n            var pauseRec = pauseRequest.processResponse(response);\n            utils.fireCallback(instance, CALLBACK_TYPES.PAUSE_RECORD, pauseRec);\n            break;\n          case MESSAGE_TYPES.RECORD:\n            var record = UIModel.getInstance().recordRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.RECORD, record);\n            break;\n          case MESSAGE_TYPES.REQUEUE:\n            var requeue = UIModel.getInstance().requeueRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.REQUEUE, requeue);\n            break;\n          case MESSAGE_TYPES.SUPERVISOR_LIST:\n            var supervisorList = UIModel.getInstance().supervisorListRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.SUPERVISOR_LIST,\n              supervisorList,\n            );\n            break;\n          case MESSAGE_TYPES.SCRIPT_CONFIG:\n            var script = UIModel.getInstance().scriptConfigRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.SCRIPT_CONFIG, script);\n            break;\n          case MESSAGE_TYPES.XFER_COLD:\n            var coldXfer = UIModel.getInstance().coldXferRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.XFER_COLD, coldXfer);\n            break;\n          case MESSAGE_TYPES.XFER_WARM:\n            var warmXfer = UIModel.getInstance().warmXferRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(instance, CALLBACK_TYPES.XFER_WARM, warmXfer);\n            break;\n          case MESSAGE_TYPES.XFER_WARM_CANCEL:\n            var warmXferCancel = UIModel.getInstance().warmXferCancelRequest.processResponse(\n              response,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.XFER_WARM_CANCEL,\n              warmXferCancel,\n            );\n            break;\n          case MESSAGE_TYPES.ACK:\n            var ack = UIModel.getInstance().ackRequest.processResponse(\n              response,\n            );\n            var responseTo = response.ui_response['@response_to'];\n            var request = utils.findRequestById(instance, responseTo);\n            ack.uii = request.msg.uii && request.msg.uii['#text'];\n            utils.fireCallback(instance, CALLBACK_TYPES.ACK, ack);\n            break;\n          case MESSAGE_TYPES.CHAT_LIST:\n            var chatList = new ChatListRequest();\n            var chatListResponse = chatList.processResponse(response);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_LIST,\n              chatListResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_STATE:\n            var chatState = new ChatStateRequest();\n            var chatStateResponse = chatState.processResponse(response);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_STATE,\n              chatStateResponse,\n            );\n            break;\n          case MESSAGE_TYPES.DIRECT_AGENT_TRANSFER_LIST:\n            var agentList = new DirectAgentTransferList();\n            var agentListResponse = agentList.processResponse(response);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.DIRECT_AGENT_TRANSFER_LIST,\n              agentListResponse,\n            );\n            break;\n          case MESSAGE_TYPES.DIRECT_AGENT_TRANSFER:\n            var agentXfer = new DirectAgentTransfer();\n            var agentXferResponse = agentXfer.processResponse(response);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.DIRECT_AGENT_TRANSFER,\n              agentXferResponse,\n            );\n            break;\n        }\n      },\n\n      processNotification: function (instance, data) {\n        var type = data.ui_notification['@type'];\n        var messageId = data.ui_notification['@message_id'];\n        var dest = messageId === '' ? 'IS' : messageId.slice(0, 2);\n        var message =\n          'Received ' +\n          type.toUpperCase() +\n          ' notification message from ' +\n          dest;\n\n        // log message response\n        utils.logMessage(LOG_LEVELS.INFO, message, data);\n\n        switch (type.toUpperCase()) {\n          case MESSAGE_TYPES.ADD_SESSION:\n            new NewCallUtils(instance, data).setupAddSessionCallback();\n            break;\n          case MESSAGE_TYPES.DIAL_GROUP_CHANGE:\n            var dgChangeNotif = new DialGroupChangeNotification();\n            var changeResponse = dgChangeNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.DIAL_GROUP_CHANGE,\n              changeResponse,\n            );\n            break;\n          case MESSAGE_TYPES.DIAL_GROUP_CHANGE_PENDING:\n            var dgChangePendNotif = new DialGroupChangePendingNotification();\n            var pendResponse = dgChangePendNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.DIAL_GROUP_CHANGE_PENDING,\n              pendResponse,\n            );\n            break;\n          case MESSAGE_TYPES.DROP_SESSION:\n            var dropSesNotif = new DropSessionNotification(instance);\n            var dropSesResponse = dropSesNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.DROP_SESSION,\n              dropSesResponse,\n            );\n            break;\n          case MESSAGE_TYPES.EARLY_UII:\n            var earlyUiiNotif = new EarlyUiiNotification(instance);\n            var earlyUiiResponse = earlyUiiNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.EARLY_UII,\n              earlyUiiResponse,\n            );\n            break;\n          case MESSAGE_TYPES.END_CALL:\n            var endCallNotif = new EndCallNotification(instance);\n            var endCallResponse = endCallNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.END_CALL,\n              endCallResponse,\n            );\n            break;\n          case MESSAGE_TYPES.GATES_CHANGE:\n            var gateChangeNotif = new GatesChangeNotification();\n            var gateChangeResponse = gateChangeNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.GATES_CHANGE,\n              gateChangeResponse,\n            );\n            break;\n          case MESSAGE_TYPES.GENERIC:\n            var genericNotif = new GenericNotification();\n            var generic = genericNotif.processResponse(data);\n            var responseTo = data.ui_notification['@response_to'];\n            var request = utils.findRequestById(instance, responseTo);\n            if (request) {\n              // found corresponding request, fire registered callback for type\n              var type = request.type;\n              var callbackFnName = utils.findCallbackBasedOnMessageType(type);\n\n              if (callbackFnName) {\n                if (type === MESSAGE_TYPES.CALLBACK_CANCEL) {\n                  generic.leadId = request.msg.lead_id['#text'];\n                }\n                utils.fireCallback(instance, callbackFnName, generic);\n              } else {\n                // no registered callback, fallback to generic notification\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.GENERIC_NOTIFICATION,\n                  generic,\n                );\n              }\n            } else {\n              if (generic.messageCode === '001') {\n                // caller hangup, stop pinging call\n                if (UIModel.getInstance().pingIntervalId) {\n                  clearInterval(UIModel.getInstance().pingIntervalId);\n                }\n              }\n\n              // no corresponding request, just fire generic notification callback\n              utils.fireCallback(\n                instance,\n                CALLBACK_TYPES.GENERIC_NOTIFICATION,\n                generic,\n              );\n            }\n            break;\n          case MESSAGE_TYPES.NEW_CALL:\n            var newCallNotif = new NewCallNotification();\n            var newCallResponse = newCallNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.NEW_CALL,\n              newCallResponse,\n            );\n            new NewCallUtils(instance, data).processSessionsForCall();\n\n            break;\n          case MESSAGE_TYPES.OFFHOOK_TERM:\n            if (UIModel.getInstance().offhookTermRequest === null) {\n              // offhook term initiated by IQ\n              UIModel.getInstance().offhookTermRequest = new OffhookTermRequest();\n            }\n            var termResponse = UIModel.getInstance().offhookTermRequest.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.OFFHOOK_TERM,\n              termResponse,\n            );\n            break;\n          case MESSAGE_TYPES.PREVIEW_LEAD_STATE:\n            var leadStateNotif = new PreviewLeadStateNotification();\n            var leadStateResponse = leadStateNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.PREVIEW_LEAD_STATE,\n              leadStateResponse,\n            );\n            break;\n          case MESSAGE_TYPES.PENDING_DISP:\n            var pendingDispNotif = new PendingDispNotification();\n            var pendingDispResponse = pendingDispNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.PENDING_DISP,\n              pendingDispResponse,\n            );\n            break;\n          case MESSAGE_TYPES.PENDING_CHAT_DISP:\n            var pendingChatDispNotif = new PendingChatDispNotification();\n            var pendingChatDispResponse = pendingChatDispNotif.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.PENDING_CHAT_DISP,\n              pendingChatDispResponse,\n            );\n            break;\n          case MESSAGE_TYPES.REVERSE_MATCH:\n            var reverseMatchNotif = new ReverseMatchNotification();\n            var reverseMatchResponse = reverseMatchNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.REVERSE_MATCH,\n              reverseMatchResponse,\n            );\n            break;\n          case MESSAGE_TYPES.TCPA_SAFE_LEAD_STATE:\n            var leadStateTcpaNotif = new TcpaSafeLeadStateNotification();\n            var leadStateTcpaResponse = leadStateTcpaNotif.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.TCPA_SAFE_LEAD_STATE,\n              leadStateTcpaResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_ACTIVE:\n            var activeNotif = new ChatActiveNotification();\n            var activeResponse = activeNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_ACTIVE,\n              activeResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_INACTIVE:\n            var inactiveNotif = new ChatInactiveNotification();\n            var inactiveResponse = inactiveNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_INACTIVE,\n              inactiveResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_CLIENT_RECONNECT:\n            var reconnectNotif = new ChatClientReconnectNotification();\n            var reconnectResponse = reconnectNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_CLIENT_RECONNECT,\n              reconnectResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_PRESENTED:\n            var presentedNotif = new ChatPresentedNotification();\n            presentedNotif.processResponse(data);\n            break;\n          case MESSAGE_TYPES.CHAT_TYPING:\n            var typingNotif = new ChatTypingNotification();\n            var typingResponse = typingNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_TYPING,\n              typingResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_NEW:\n            var newChatNotif = new NewChatNotification();\n            var newChatResponse = newChatNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_NEW,\n              newChatResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_MESSAGE:\n            var chatMessage = new ChatMessageRequest();\n            var chatMessageResponse = chatMessage.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_MESSAGE,\n              chatMessageResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_CANCELLED:\n            var chatCancelled = new ChatCancelledNotification();\n            var chatCancelledResponse = chatCancelled.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_CANCELLED,\n              chatCancelledResponse,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_ADD_SESSION:\n            var addChatSession = new AddChatSessionNotification();\n            var addChatSessionResponse = addChatSession.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_ADD_SESSION,\n              addChatSessionResponse,\n            );\n            break;\n          case MESSAGE_TYPES.STOP_MONITOR_CHAT:\n            var stopChatMonitor = new StopMonitorChatRequest();\n            var stopChatMonitorResponse = stopChatMonitor.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_STOP_MONITOR,\n              stopChatMonitorResponse,\n            );\n            break;\n          case MESSAGE_TYPES.DIRECT_AGENT_ROUTE:\n            var directAgentTransfer = new DirectAgentTransferNotification();\n            var directAgentTransferResponse = directAgentTransfer.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.DIRECT_AGENT_TRANSFER_NOTIF,\n              directAgentTransferResponse,\n            );\n            break;\n          case MESSAGE_TYPES.AGENT_DEBUG_EMAIL:\n            var emailNotif = new AdminDebugEmailNotification();\n            var emailNotifResp = emailNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.AGENT_DEBUG_EMAIL_NOTIF,\n              emailNotifResp,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_LOAD_MEDIA:\n            var loadMediaNotif = new LoadMediaNotification();\n            var loadMediaResp = loadMediaNotif.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_LOAD_MEDIA,\n              loadMediaResp,\n            );\n            break;\n          case MESSAGE_TYPES.CHAT_AGENT_ASSIGN_FAILURE:\n            var chatAgentAssignFailureNotif = new ChatAgentAssignFailureNotification();\n            var chatAgentAssignFailureResp = chatAgentAssignFailureNotif.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_AGENT_ASSIGN_FAILURE,\n              chatAgentAssignFailureResp,\n            );\n            break;\n          case MESSAGE_TYPES.LOGOUT:\n            var logoutNotification = new LogoutRequest();\n            var logoutNotifResponse = logoutNotification.processResponse(data);\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.LOGOUT,\n              logoutNotifResponse,\n            );\n            var model = UIModel.getInstance();\n\n            //remove agent_id and hash_code from local storage\n            model.dataStore.remove('agent_id');\n            model.dataStore.remove('hash_code');\n\n            // set login flag here in case notification initiated externally\n            // and not in response to agent logout request\n            model.agentSettings.isLoggedIn = false;\n\n            instance.closeSocket();\n            break;\n          case MESSAGE_TYPES.MONITOR_CHAT:\n            //TODO: do this\n\n            break;\n          case MESSAGE_TYPES.LEAVE_CHAT:\n            //TODO: do this\n\n            break;\n        }\n      },\n\n      processDialerResponse: function (instance, response) {\n        var type = response.dialer_request['@type'];\n        var messageId = response.dialer_request['@message_id'];\n        var dest = messageId === '' ? 'IS' : messageId.slice(0, 2);\n        var message =\n          'Received ' +\n          type.toUpperCase() +\n          ' dialer response message from ' +\n          dest;\n\n        // log message response\n        utils.logMessage(LOG_LEVELS.INFO, message, response);\n\n        // Send generic on message response\n        utils.fireCallback(instance, CALLBACK_TYPES.ON_MESSAGE, response);\n\n        // Fire callback function\n        switch (type.toUpperCase()) {\n          case MESSAGE_TYPES.PREVIEW_DIAL_ID:\n            var pdRequest = new PreviewDialRequest();\n            var dialResponse = pdRequest.processResponse(response);\n            if (dialResponse.action.toUpperCase() === 'SEARCH') {\n              utils.fireCallback(\n                instance,\n                CALLBACK_TYPES.LEAD_SEARCH,\n                dialResponse,\n              );\n            } else {\n              utils.fireCallback(\n                instance,\n                CALLBACK_TYPES.PREVIEW_FETCH,\n                dialResponse,\n              );\n            }\n            break;\n          case MESSAGE_TYPES.TCPA_SAFE_ID:\n            var tcpaRequest = new TcpaSafeRequest();\n            var tcpaResponse = tcpaRequest.processResponse(response);\n            if (tcpaResponse.action.toUpperCase() === 'SEARCH') {\n              utils.fireCallback(\n                instance,\n                CALLBACK_TYPES.SAFE_MODE_SEARCH,\n                tcpaResponse,\n              );\n            } else {\n              utils.fireCallback(\n                instance,\n                CALLBACK_TYPES.SAFE_MODE_FETCH,\n                tcpaResponse,\n              );\n            }\n            break;\n        }\n      },\n\n      processRequest: function (instance, message) {\n        var type = message.ui_request['@type'];\n\n        // Fire callback function\n        switch (type.toUpperCase()) {\n          case MESSAGE_TYPES.CHAT_SEND:\n            var chatSendRequest = new ChatSendRequest();\n            var chatSendResponse = chatSendRequest.processResponse(message);\n            utils.fireCallback(instance, CALLBACK_TYPES.CHAT, chatSendResponse);\n            break;\n          case MESSAGE_TYPES.CHAT_ROOM_STATE:\n            var chatRoomStateRequest = new ChatRoomStateRequest();\n            var chatRoomStateResponse = chatRoomStateRequest.processResponse(\n              message,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.CHAT_ROOM_STATE,\n              chatRoomStateResponse,\n            );\n            break;\n        }\n      },\n\n      processStats: function (instance, data) {\n        var type = data.ui_stats['@type'];\n        var message =\n          'Received ' + type.toUpperCase() + ' response message from IS';\n\n        // Fire callback function\n        switch (type.toUpperCase()) {\n          case MESSAGE_TYPES.STATS_AGENT:\n            var agentStats = UIModel.getInstance().agentStatsPacket.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.STATS_AGENT,\n              agentStats,\n            );\n            break;\n          case MESSAGE_TYPES.STATS_AGENT_DAILY:\n            var agentDailyStats = UIModel.getInstance().agentDailyStatsPacket.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.STATS_AGENT_DAILY,\n              agentDailyStats,\n            );\n\n            // start daily stats interval timer, request update every second\n            if (UIModel.getInstance().agentDailyIntervalId === null) {\n              UIModel.getInstance().agentDailyIntervalId = setInterval(\n                utils.onAgentDailyStats,\n                1000,\n              );\n            }\n\n            break;\n          case MESSAGE_TYPES.STATS_CAMPAIGN:\n            var campaignStats = UIModel.getInstance().campaignStatsPacket.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.STATS_CAMPAIGN,\n              campaignStats,\n            );\n            break;\n          case MESSAGE_TYPES.STATS_QUEUE:\n            var queueStats = UIModel.getInstance().queueStatsPacket.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.STATS_QUEUE,\n              queueStats,\n            );\n            break;\n          case MESSAGE_TYPES.STATS_CHAT:\n            var chatStats = UIModel.getInstance().chatQueueStatsPacket.processResponse(\n              data,\n            );\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.STATS_CHAT_QUEUE,\n              chatStats,\n            );\n            break;\n        }\n      },\n\n      /*\n       * Take the xml marked JSON, group and item property names and reformat to\n       * simple javascript object without the xml markers.\n       * Will work recursively down the tree on nested objects and arrays.\n       *\n       * example of acceptable response tree (groupProp = requeue_gates, itemProp = gate_group):\n       *   \"requeue_gates\": {\n       *       \"gate_group\": [\n       *           {\n       *               \"@gate_group_id\": \"4\",\n       *               \"@group_name\": \"Test Gate Group\",\n       *               \"gates\": {\n       *                   \"gate\": [\n       *                       {\n       *                           \"@gate_desc\": \"\",\n       *                           \"@gate_id\": \"10951\",\n       *                           \"@gate_name\": \"CD ACD Queue\"\n       *                       },\n       *                       {\n       *                           \"@gate_desc\": \"\",\n       *                           \"@gate_id\": \"11036\",\n       *                           \"@gate_name\": \"Xerox Test Gate\"\n       *                       }\n       *                   ]\n       *               },\n       *               \"skills\": {\n       *                   \"skill\": [\n       *                       {\n       *                           \"@skill_desc\": \"\",\n       *                           \"@skill_id\": \"322\",\n       *                           \"@skill_name\": \"English\"\n       *                       },\n       *                       {\n       *                           \"@skill_desc\": \"\",\n       *                           \"@skill_id\": \"323\",\n       *                           \"@skill_name\": \"Spanish\"\n       *                       }\n       *                   ]\n       *               }\n       *           },\n       *           {\n       *               \"@gate_group_id\": \"14292\",\n       *               \"@group_name\": \"New Test Group\",\n       *               \"gates\": {\n       *                   \"gate\": {\n       *                       \"@gate_desc\": \"\",\n       *                       \"@gate_id\": \"15535\",\n       *                       \"@gate_name\": \"New Test Gate\"\n       *                   }\n       *               },\n       *               \"skills\": {\n       *                   \"skill\": {\n       *                       \"@skill_desc\": \"\",\n       *                       \"@skill_id\": \"1658\",\n       *                       \"@skill_name\": \"new skill\"\n       *                   }\n       *               }\n       *           }\n       *       ]\n       *   }\n       *\n       *   OR\n       *\n       *   \"outdial_dispositions\": {\n       *       \"@type\": \"GATE\",\n       *       \"disposition\": [\n       *          {\n       *           \"@contact_forwarding\": \"false\",\n       *           \"@disposition_id\": \"926\",\n       *           \"@is_complete\": \"1\",\n       *           \"@require_note\": \"0\",\n       *           \"@save_survey\": \"1\",\n       *           \"@xfer\": \"0\",\n       *           \"#text\": \"One B\"\n       *          },\n       *          {\n       *           \"@contact_forwarding\": \"false\",\n       *           \"@disposition_id\": \"926\",\n       *           \"@is_complete\": \"1\",\n       *           \"@require_note\": \"0\",\n       *           \"@save_survey\": \"1\",\n       *           \"@xfer\": \"0\",\n       *           \"#text\": \"One B\"\n       *          }\n       *      ]\n       *   }\n       *\n       *   OR\n       *\n       *   \"outdial_dispositions\": {\n       *       \"@type\": \"GATE\",\n       *       \"disposition\": {\n       *          {\n       *           \"@contact_forwarding\": \"false\",\n       *           \"@disposition_id\": \"926\",\n       *           \"@is_complete\": \"1\",\n       *           \"@require_note\": \"0\",\n       *           \"@save_survey\": \"1\",\n       *           \"@xfer\": \"0\",\n       *           \"#text\": \"One B\"\n       *          }\n       *      }\n       *   }\n       */\n\n      processResponseCollection: function (\n        response,\n        groupProp,\n        itemProp,\n        textName,\n      ) {\n        textName = textName || 'text';\n\n        if (\n          response[groupProp] &&\n          typeof response[groupProp][itemProp] !== 'undefined'\n        ) {\n          var itemsRaw = response[groupProp][itemProp];\n          return this._processItems(itemsRaw, textName);\n        } else {\n          return [];\n        }\n      },\n\n      escapeSoftphoneUsername: function (str) {\n        return str && str.replace(/[@]/g, '_at_');\n      },\n\n      _processItems: function (itemsRaw, textName) {\n        var result = [];\n        if (typeof itemsRaw === 'undefined' || itemsRaw === null) {\n          return result;\n        }\n\n        if (!Array.isArray(itemsRaw)) {\n          itemsRaw = [itemsRaw];\n        }\n\n        for (var i = 0; i < itemsRaw.length; i++) {\n          result.push(this._processItem(itemsRaw[i], textName));\n        }\n\n        return result;\n      },\n\n      _processItem: function (itemRaw, textName) {\n        /*\n         * Be sure that the item we are processing is not a #text node only, where the \"texName\" is also \"text\". If this\n         * is the case, it means there's a default value that needs to get converted and isn't going to be mapped to a custom\n         * field.  Therefore, we treat it as just a single value, not an object.\n         */\n        if (\n          textName === 'text' &&\n          Object.keys(itemRaw).length === 1 &&\n          itemRaw['#text'] != null\n        ) {\n          return this._tryConvertValueToBoolean(itemRaw['#text']);\n        }\n\n        // Convert the raw item to a new item, with keys and values processed below\n        //\n        var item = {};\n        for (var key in itemRaw) {\n          var formattedKey = this._convertToFormattedKey(key, textName);\n\n          var value = itemRaw[key];\n\n          // If we aren't an object, set the value and continue to next key\n          if (typeof value !== 'object') {\n            item[formattedKey] = this._tryConvertValueToBoolean(value);\n            continue;\n          }\n\n          if (\n            (Array.isArray(value) && value.length === 0) ||\n            Object.keys(value).length === 0\n          ) {\n            // Empty property\n            item[formattedKey] = '';\n          } else if (Array.isArray(value) || Object.keys(value).length > 1) {\n            // Array or object with more than one key\n            formattedKey = this._convertKeyForCollection(formattedKey);\n            item[formattedKey] = this._processItems(value, textName);\n          } else if (\n            Object.keys(value).length === 1 &&\n            value['#text'] != null\n          ) {\n            // One property of type \"#text\"\n            item[formattedKey] = value['#text'];\n          } else {\n            // One property not with key \"#text\"\n            item[formattedKey] = this._processItems(\n              value[Object.keys(value)[0]],\n              'text',\n            );\n          }\n        }\n\n        return item;\n      },\n\n      _convertToFormattedKey: function (key, textName) {\n        var formattedKey;\n        if (key.match(/^#/)) {\n          // dealing with text property\n          formattedKey = textName;\n        } else {\n          // dealing with attribute\n          formattedKey = key.replace(/@/, ''); // remove leading '@'\n          formattedKey = formattedKey.replace(/_([a-z])/g, function (g) {\n            return g[1].toUpperCase();\n          }); // convert to camelCase\n        }\n\n        return formattedKey;\n      },\n\n      _convertKeyForCollection: function (formattedKey) {\n        if (formattedKey.substr(formattedKey.length - 1) !== 's') {\n          return formattedKey + 's';\n        }\n\n        return formattedKey;\n      },\n\n      _tryConvertValueToBoolean: function (value) {\n        if (value === null) {\n          return null;\n        }\n\n        // can't convert 0 | 1 to boolean since some are counters\n        if (value.toUpperCase() === 'TRUE') {\n          return true;\n        } else if (value.toUpperCase() === 'FALSE') {\n          return false;\n        } else {\n          return value;\n        }\n      },\n\n      fireCallback: function (instance, type, response) {\n        response = response || '';\n        if (\n          typeof type !== 'undefined' &&\n          typeof instance.callbacks[type] === 'function'\n        ) {\n          instance.callbacks[type].call(instance, response);\n        }\n      },\n\n      setCallback: function (instance, type, callback) {\n        if (typeof type !== 'undefined' && typeof callback !== 'undefined') {\n          instance.callbacks[type] = callback;\n        }\n      },\n\n      getMessageId: function () {\n        function s4() {\n          return Math.floor((1 + Math.random()) * 0x10000)\n            .toString(16)\n            .substring(1);\n        }\n\n        return (\n          s4() +\n          s4() +\n          '-' +\n          s4() +\n          '-' +\n          s4() +\n          '-' +\n          s4() +\n          '-' +\n          s4() +\n          s4() +\n          s4()\n        );\n      },\n\n      // check whether the given array of ids exist in the given array of objects\n      // if not available, remove the id\n      // returns the clean list of acceptable ids\n      checkExistingIds: function (objArray, idArray, idProperty) {\n        var availIds = [];\n        var removeIds = [];\n\n        // get list of available ids\n        for (var o = 0; o < objArray.length; o++) {\n          availIds.push(parseInt(objArray[o][idProperty], 10));\n        }\n\n        // go through selected ids and mark unfound ones for removal\n        for (var i = 0; i < idArray.length; i++) {\n          if (availIds.indexOf(parseInt(idArray[i], 10)) === -1) {\n            // selected id not found in available list, mark for removal\n            removeIds.push(parseInt(idArray[i], 10));\n          }\n        }\n\n        // remove marked ids\n        for (var r = idArray.length - 1; r >= 0; r--) {\n          if (removeIds.indexOf(parseInt(idArray[r], 10)) > -1) {\n            // remove\n            idArray.splice(r, 1);\n          }\n        }\n\n        return idArray;\n      },\n\n      // find an object by given id in an array of objects\n      findObjById: function (objArray, id, propName) {\n        for (var o = 0; o < objArray.length; o++) {\n          var obj = objArray[o];\n          if (obj[propName] === id) {\n            return obj;\n          }\n        }\n\n        return null;\n      },\n\n      // check whether agent dialDest is either a 10-digit number or valid sip\n      validateDest: function (dialDest) {\n        var isValid = false;\n        var isNum = /^\\d+$/.test(dialDest);\n        if (isNum && dialDest.length === 10) {\n          // is a 10-digit number\n          isValid = true;\n        } else if (\n          dialDest.slice(0, 4).toLowerCase() === 'sip:' &&\n          dialDest.indexOf('@') !== -1\n        ) {\n          // has sip prefix and '@'\n          isValid = true;\n        }\n\n        return isValid;\n      },\n\n      // pass in MESSAGE_TYPE string (e.g. \"CANCEL-CALLBACK\"),\n      // return corresponding CALLBACK_TYPE function name string (e.g. \"callbackCancelResponse\")\n      findCallbackBasedOnMessageType: function (messageType) {\n        var callbackFnName = '';\n        for (var key in MESSAGE_TYPES) {\n          if (MESSAGE_TYPES[key] === messageType) {\n            callbackFnName = CALLBACK_TYPES[key];\n          }\n        }\n        return callbackFnName;\n      },\n\n      // add message, detail, and status values to the formattedResponse\n      // returned from each request processResponse method\n      buildDefaultResponse: function (response, includeOpId) {\n        includeOpId = includeOpId || false; // default to false, the ES5 way\n        var message = '';\n        var detail = '';\n        var status = '';\n        var operationId = '';\n\n        var msg = '';\n        var det = '';\n        var stat = '';\n        var opId = '';\n\n        // add properties if present\n        if (response.ui_response) {\n          msg = response.ui_response.message;\n          det = response.ui_response.detail;\n          stat = response.ui_response.status;\n          opId = response.ui_response.operation_id;\n        } else if (response.ui_notification) {\n          msg = response.ui_notification.message;\n          det = response.ui_notification.detail;\n          stat = response.ui_notification.status;\n          opId = response.ui_notification.operation_id;\n        }\n\n        if (msg) {\n          message = msg['#text'] || '';\n        }\n        if (det) {\n          detail = det['#text'] || '';\n        }\n        if (stat) {\n          status = stat['#text'] || '';\n        }\n        if (opId) {\n          operationId = opId['#text'] || '';\n        }\n\n        var returnMsg = {\n          message: message,\n          detail: detail,\n          status: status,\n        };\n\n        if (includeOpId) {\n          returnMsg.operationId = operationId;\n        }\n\n        return returnMsg;\n      },\n\n      toString: function (val) {\n        if (val) {\n          return val.toString();\n        } else {\n          return '';\n        }\n      },\n\n      // safely check if property exists and return empty string\n      // instead of undefined if it doesn't exist\n      // convert \"TRUE\" | \"FALSE\" to boolean\n      getText: function (obj, prop) {\n        var o = obj[prop];\n        if (o && o['#text']) {\n          if (o['#text'].toUpperCase() === 'TRUE') {\n            return true;\n          } else if (o['#text'].toUpperCase() === 'FALSE') {\n            return false;\n          } else {\n            return o['#text'] || '';\n          }\n        } else {\n          return '';\n        }\n      },\n\n      // safely check if property exists and return empty string\n      // instead of undefined if it doesn't exist\n      // convert \"TRUE\" | \"FALSE\" to boolean\n      getAttribute: function (obj, prop) {\n        var o = obj[prop];\n        if (o && o[prop]) {\n          if (o[prop].toUpperCase() === 'TRUE') {\n            return true;\n          } else if (o[prop].toUpperCase() === 'FALSE') {\n            return false;\n          } else {\n            return o[prop] || '';\n          }\n        } else {\n          return '';\n        }\n      },\n\n      // Parses a string of key value pairs and returns an Array of KeyValue objects.\n      // @param str The string of keyvalue pairs to parse\n      // @param outerDelimiter The delimiter that separates each keyValue pair\n      // @param innerDelimiter The delimiter that separates each key from its value\n      parseKeyValuePairsFromString: function (\n        str,\n        outerDelimiter,\n        innerDelimiter,\n      ) {\n        if (!str) {\n          return [];\n        }\n\n        var arr = str.split(outerDelimiter).reduce(function (dict, pair) {\n          var keyValue = pair.split(innerDelimiter);\n          dict[keyValue[0]] = keyValue[1];\n          return dict;\n        }, {});\n\n        return arr;\n      },\n\n      // Finds a request by responseTo id\n      findRequestById: function (instance, id) {\n        var request = null;\n        for (var i = 0; i < instance._requests.length; i++) {\n          if (instance._requests[i].id === id) {\n            request = instance._requests[i];\n            break;\n          }\n        }\n        return request;\n      },\n\n      // called every 30 seconds letting intelliQueue know\n      // not to archive the call so dispositions and other call\n      // clean up actions can happen\n      sendPingCallMessage: function () {\n        UIModel.getInstance().pingCallRequest = new PingCallRequest();\n        var msg = UIModel.getInstance().pingCallRequest.formatJSON();\n        var msgObj = JSON.parse(msg);\n        var agentId = utils.getText(msgObj.ui_request, 'agent_id');\n        var uii = utils.getText(msgObj.ui_request, 'uii');\n        if (agentId === '' || uii === '') {\n          utils.logMessage(\n            LOG_LEVELS.WARN,\n            'PING-CALL message failed, agentId or UII is empty',\n            msgObj,\n          );\n        } else {\n          utils.sendMessage(UIModel.getInstance().libraryInstance, msg);\n        }\n      },\n\n      // called every 5 seconds to request stats from IntelliServices\n      sendStatsRequestMessage: function () {\n        UIModel.getInstance().statsRequest = new StatsRequest();\n        var msg = UIModel.getInstance().statsRequest.formatJSON();\n        utils.sendMessage(UIModel.getInstance().libraryInstance, msg);\n      },\n\n      // called every 20 seconds to ping IntelliSocket whent stats are disabled\n      sendPingRequestMessage: function () {\n        var msg = 'BEAT';\n        var instance = UIModel.getInstance().libraryInstance;\n        if (instance.socket && instance.socket.readyState === 1) {\n          instance.socket.send('BEAT');\n        }\n      },\n\n      // called every second\n      // if we have received agent daily stats\n      // start incrementing various data points since not all\n      // data is incremented when we want on the IntelliServices side\n      onAgentDailyStats: function () {\n        if (Object.keys(UIModel.getInstance().agentDailyStats).length !== 0) {\n          var agentSettings = UIModel.getInstance().agentSettings,\n            stats = UIModel.getInstance().agentDailyStats;\n\n          var curLoginTime = stats.totalLoginTime;\n          stats.totalLoginTime = Number(curLoginTime) + 1;\n\n          if (agentSettings.isOffhook) {\n            var curOffhookTime = stats.totalOffhookTime;\n            stats.totalOffhookTime = Number(curOffhookTime) + 1;\n          }\n\n          if (agentSettings.currentState === 'ENGAGED') {\n            var curTalkTime = stats.totalTalkTime;\n            stats.totalTalkTime = Number(curTalkTime) + 1;\n\n            var curCallTime = stats.currCallTime;\n            stats.currCallTime = Number(curCallTime) + 1;\n          }\n        }\n      },\n\n      // called in loginAgent if 'integrated' dial destination passed in\n      getDialDestination: function () {\n        var model = UIModel.getInstance();\n        var softphoneSettings = model.softphoneSettings;\n        var dialDestType = model.applicationSettings.dialDestType;\n\n        var dialDest = '';\n\n        // default to the first server in the array\n        if (softphoneSettings.sipInfo.length > 0) {\n          var currentServer = softphoneSettings.sipInfo[0];\n          if (dialDestType === 'LEGACY_SOFTPHONE') {\n            dialDest =\n              'sip:' +\n              utils.escapeSoftphoneUsername(currentServer.username) +\n              '@' +\n              currentServer.domain;\n          } else if (dialDestType === 'RC_SOFTPHONE') {\n            dialDest =\n              utils.escapeSoftphoneUsername(currentServer.username) +\n              '@RC_SOFTPHONE';\n          }\n        }\n\n        return dialDest;\n      },\n\n      // get valid access token based on agentId and login hash code\n      refreshAccessToken: function () {\n        var model = UIModel.getInstance();\n        var baseUrl = model.authHost + model.baseAuthUri;\n        var errorMsg = 'Error in refreshing access token';\n        var params = {\n          queryParams: {\n            loginHashcode: model.connectionSettings.hashCode,\n            agentId: model.agentSettings.agentId,\n            platformId: model.authenticateRequest.platformId,\n            isSso: model.applicationSettings.isSso,\n          },\n        };\n\n        return new HttpService(baseUrl)\n          .httpPost('login/agent/hashcode', params)\n          .then(\n            function (response) {\n              try {\n                response = JSON.parse(response.response);\n                UIModel.getInstance().authenticateRequest.engageAccessToken =\n                  response.accessToken;\n              } catch (err) {\n                utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n              }\n            },\n            function (err) {\n              var errResponse = {\n                type: 'refreshAccessToken Error',\n                message: errorMsg,\n              };\n              utils.logMessage(LOG_LEVELS.WARN, errResponse, err);\n            },\n          );\n      },\n\n      // return random string of length given\n      generateOpId: function (length) {\n        length = length || 24;\n        var CHARACTERS = '0123456789abcdefghijklmnopqrstuvwxyz';\n\n        var result = '';\n        for (var i = length; i > 0; --i) {\n          result +=\n            CHARACTERS[Math.round(Math.random() * (CHARACTERS.length - 1))];\n        }\n        return result;\n      },\n    };\n\n    // CONSTANTS\n\n    /*jshint esnext: true */\n    const LOG_LEVELS = {\n      DEBUG: 'debug',\n      STATS: 'stats',\n      INFO: 'info',\n      WARN: 'warn',\n      ERROR: 'error',\n    };\n\n    const AUTHENTICATE_TYPES = {\n      USERNAME_PASSWORD: 'USERNAME_PASSWORD',\n      RC_TOKEN: 'RC_TOKEN',\n      ENGAGE_TOKEN: 'ENGAGE_TOKEN',\n    };\n\n    // add all callback types to setCallback method description\n    const CALLBACK_TYPES = {\n      ACK: 'acknowledgeResponse',\n      ADD_SESSION: 'addSessionNotification',\n      AGENT_DEBUG_EMAIL_NOTIF: 'agentDebugEmailNotification',\n      AGENT_STATE: 'agentStateResponse',\n      AUTHENTICATE: 'authenticateResponse',\n      BARGE_IN: 'bargeInResponse',\n      CALLBACK_CANCEL: 'callbackCancelResponse',\n      CALLBACK_PENDING: 'callbacksPendingResponse',\n      CALL_NOTES: 'callNotesResponse',\n      CAMPAIGN_DISPOSITIONS: 'campaignDispositionsResponse',\n      CHAT: 'chatResponse', // internal chat\n      CHAT_ACTIVE: 'chatActiveNotification', // external chat\n      CHAT_ADD_SESSION: 'addChatSessionNotification', // external chat\n      CHAT_CANCELLED: 'chatCancelledNotification', // external chat\n      CHAT_CLIENT_RECONNECT: 'chatClientReconnectNotification',\n      CHAT_INACTIVE: 'chatInactiveNotification', // external chat\n      CHAT_LIST: 'chatListResponse', // external chat\n      CHAT_LOAD_MEDIA: 'chatLoadMediaResponse', // engage digital task\n      CHAT_AGENT_ASSIGN_FAILURE: 'chatAgentAssignFailureResponse', // engage digital task\n      CHAT_MESSAGE: 'chatMessageNotification', // external chat\n      CHAT_NEW: 'chatNewNotification', // external chat\n      CHAT_PRESENTED: 'chatPresentedNotification', // external chat\n      CHAT_ROOM_STATE: 'chatRoomStateResponse',\n      CHAT_STATE: 'chatStateResponse', // external chat\n      CHAT_STOP_MONITOR: 'stopAgentChatMonitorNotification', // external chat\n      CHAT_TYPING: 'chatTypingNotification', // external chat\n      CLOSE_SOCKET: 'closeResponse',\n      COACH_CALL: 'coachResponse',\n      CONFIG: 'configureResponse',\n      DIAL_GROUP_CHANGE: 'dialGroupChangeNotification',\n      DIAL_GROUP_CHANGE_PENDING: 'dialGroupChangePendingNotification',\n      DIRECT_AGENT_TRANSFER: 'directAgentTransferResponse',\n      DIRECT_AGENT_TRANSFER_LIST: 'directAgentTransferListResponse',\n      DIRECT_AGENT_TRANSFER_NOTIF: 'directAgentTransferNotification',\n      DROP_SESSION: 'dropSessionNotification',\n      EARLY_UII: 'earlyUiiNotification',\n      END_CALL: 'endCallNotification',\n      GATES_CHANGE: 'gatesChangeNotification',\n      GENERIC_NOTIFICATION: 'genericNotification',\n      GENERIC_RESPONSE: 'genericResponse',\n      HOLD: 'holdResponse',\n      LEAD_HISTORY: 'leadHistoryResponse',\n      LEAD_INSERT: 'leadInsertResponse',\n      LEAD_SEARCH: 'leadSearchResponse',\n      LEAD_UPDATE: 'leadUpdateResponse',\n      LOGIN: 'loginResponse',\n      LOGIN_PHASE_1: 'loginPhase1Response',\n      LOGIN_MULTISOCKET: 'multiSocketResponse',\n      LOGOUT: 'logoutResponse',\n      LOG_CONSOLE_RESULTS: 'logConsoleResultsResponse',\n      LOG_RESULTS: 'logResultsResponse',\n      NEW_CALL: 'newCallNotification',\n      OFFHOOK_INIT: 'offhookInitResponse',\n      OFFHOOK_TERM: 'offhookTermNotification',\n      OPEN_SOCKET: 'openResponse',\n      PAUSE_RECORD: 'pauseRecordResponse',\n      PENDING_CHAT_DISP: 'pendingChatDispNotification',\n      PENDING_DISP: 'pendingDispNotification',\n      PREVIEW_FETCH: 'previewFetchResponse',\n      PREVIEW_LEAD_STATE: 'previewLeadStateNotification',\n      RECORD: 'recordResponse',\n      REQUEUE: 'requeueResponse',\n      REVERSE_MATCH: 'reverseMatchNotification',\n      SAFE_MODE_FETCH: 'safeModeFetchResponse',\n      SAFE_MODE_SEARCH: 'safeModeSearchResponse',\n      SCRIPT_CONFIG: 'scriptConfigResponse',\n      SILENT_MONITOR: 'monitorResponse',\n      STATS_AGENT: 'agentStats',\n      STATS_AGENT_DAILY: 'agentDailyStats',\n      STATS_CAMPAIGN: 'campaignStats',\n      STATS_CHAT_QUEUE: 'chatQueueStats',\n      STATS_QUEUE: 'queueStats',\n      SUPERVISOR_LIST: 'supervisorListResponse',\n      TCPA_SAFE_LEAD_STATE: 'tcpaSafeLeadStateNotification',\n      WEBRTC_INFO: 'webRtcInfoResponse',\n      XFER_COLD: 'coldXferResponse',\n      XFER_WARM: 'warmXferResponse',\n      SEARCH_DIR: 'searchDirectoryResponse',\n      EXTENSION_PRESENCE: 'extensionPresenceInfo',\n\n      // SOFTPHONE Callbacks\n      SIP_CONNECTED: 'sipConnectedNotification',\n      SIP_DIAL_DEST_CHANGED: 'sipDialDestChangedNotification',\n      SIP_ENDED: 'sipEndedNotification',\n      SIP_MUTE: 'sipMuteResponse',\n      SIP_REGISTERED: 'sipRegisteredNotification',\n      SIP_REGISTRATION_FAILED: 'sipRegistrationFailedNotification',\n      SIP_RINGING: 'sipRingingNotification',\n      SIP_SWITCH_REGISTRAR: 'sipSwitchRegistrarNotification',\n      SIP_UNMUTE: 'sipUnmuteResponse',\n      SIP_UNREGISTERED: 'sipUnregisteredNotification',\n      ROTATE_WEBRTC_SERVER: 'rotateWebRtcServer',\n    };\n\n    const MESSAGE_TYPES = {\n      ACK: 'ACK',\n      ADD_SESSION: 'ADD-SESSION',\n      AGENT_DEBUG_EMAIL: 'AGENT-DEBUG-EMAIL',\n      AGENT_STATE: 'AGENT-STATE',\n      BARGE_IN: 'BARGE-IN',\n      CALLBACK_CANCEL: 'CANCEL-CALLBACK',\n      CALLBACK_PENDING: 'PENDING-CALLBACKS',\n      CALL_NOTES: 'CALL-NOTES',\n      CAMPAIGN_DISPOSITIONS: 'CAMPAIGN-DISPOSITIONS',\n      CHAT_ACTIVE: 'CHAT-ACTIVE', // external chat\n      CHAT_ADD_SESSION: 'ADD-CHAT-SESSION', // external chat\n      CHAT_AGENT_END: 'CHAT-END', // external chat\n      CHAT_ALIAS: 'CHAT-ALIAS', // internal chat\n      CHAT_CANCELLED: 'CHAT-CANCELLED', // external chat\n      CHAT_CLIENT_RECONNECT: 'CHAT-CLIENT-RECONNECT', // external chat\n      CHAT_DISPOSITION: 'CHAT-DISPOSITION', // external chat\n      CHAT_INACTIVE: 'CHAT-INACTIVE', // external chat\n      CHAT_LIST: 'CHAT-LIST', // external chat\n      CHAT_MANUAL_SMS: 'MANUAL-SMS', // external chat\n      CHAT_MESSAGE: 'CHAT-MESSAGE', // external chat\n      CHAT_NEW: 'NEW-CHAT', // external chat\n      CHAT_PRESENTED: 'CHAT-PRESENTED', // external chat\n      CHAT_PRESENTED_RESPONSE: 'CHAT-PRESENTED-RESPONSE', // external chat\n      CHAT_REQUEUE: 'CHAT-REQUEUE', // external chat\n      CHAT_ROOM: 'CHAT-ROOM', // internal chat\n      CHAT_ROOM_STATE: 'CHAT-ROOM-STATE', // internal chat\n      CHAT_SEND: 'CHAT', // internal chat\n      CHAT_STATE: 'CHAT-STATE', // external chat\n      CHAT_TYPING: 'CHAT-TYPING', // external chat\n      CHAT_LOAD_MEDIA: 'LOAD-MEDIA', // engage digital task\n      CHAT_AGENT_ASSIGN_FAILURE: 'CHAT-AGENT-ASSIGN-FAILURE', // engage digital task\n      DIAL_GROUP_CHANGE: 'DIAL_GROUP_CHANGE',\n      DIAL_GROUP_CHANGE_PENDING: 'DIAL_GROUP_CHANGE_PENDING',\n      DIRECT_AGENT_ROUTE: 'DIRECT-AGENT-ROUTE',\n      DIRECT_AGENT_TRANSFER: 'DIRECT-AGENT-TRANSFER',\n      DIRECT_AGENT_TRANSFER_LIST: 'DIRECT-AGENT-TRANSFER-LIST',\n      DROP_SESSION: 'DROP-SESSION',\n      EARLY_UII: 'EARLY_UII',\n      END_CALL: 'END-CALL',\n      GATES_CHANGE: 'GATES_CHANGE',\n      GENERIC: 'GENERIC',\n      HANGUP: 'HANGUP',\n      HOLD: 'HOLD',\n      INBOUND_DISPOSITION: 'INBOUND-DISPOSITION',\n      LEAD_HISTORY: 'LEAD-HISTORY',\n      LEAD_INSERT: 'LEAD-INSERT',\n      LEAD_UPDATE: 'LEAD-UPDATE',\n      LEAVE_CHAT: 'CHAT-DROP-SESSION', // external chat\n      LOGIN: 'LOGIN',\n      LOGIN_PHASE_1: 'LOGIN-PHASE-1',\n      LOGIN_MULTISOCKET: 'MULTISOCKET',\n      LOGOUT: 'LOGOUT',\n      MONITOR_CHAT: 'CHAT-MONITOR', // external chat\n      NEW_CALL: 'NEW-CALL',\n      OFFHOOK_INIT: 'OFF-HOOK-INIT',\n      OFFHOOK_TERM: 'OFF-HOOK-TERM',\n      ONE_TO_ONE_OUTDIAL: 'ONE-TO-ONE-OUTDIAL',\n      ONE_TO_ONE_OUTDIAL_CANCEL: 'ONE-TO-ONE-OUTDIAL-CANCEL',\n      ON_MESSAGE: 'ON-MESSAGE',\n      OUTDIAL_DISPOSITION: 'OUTDIAL-DISPOSITION',\n      PAUSE_RECORD: 'PAUSE-RECORD',\n      PENDING_CHAT_DISP: 'PENDING-CHAT-DISP', // external chat\n      PENDING_DISP: 'PENDING_DISP',\n      PING_CALL: 'PING-CALL',\n      PREVIEW_DIAL: 'PREVIEW-DIAL',\n      PREVIEW_DIAL_ID: 'PREVIEW_DIAL',\n      PREVIEW_LEAD_STATE: 'PREVIEW-LEAD-STATE',\n      RECORD: 'RECORD',\n      REQUEUE: 'RE-QUEUE',\n      REVERSE_MATCH: 'REVERSE_MATCH',\n      SCRIPT_CONFIG: 'SCRIPT-CONFIG',\n      SCRIPT_RESULT: 'SCRIPT-RESULT',\n      STATS: 'STATS',\n      STATS_AGENT: 'AGENT',\n      STATS_AGENT_DAILY: 'AGENTDAILY',\n      STATS_CAMPAIGN: 'CAMPAIGN',\n      STATS_CHAT: 'CHAT',\n      STATS_QUEUE: 'GATE',\n      STOP_MONITOR_CHAT: 'CHAT-DROP-MONITORING-SESSION', // external chat\n      SUPERVISOR_LIST: 'SUPERVISOR-LIST', // internal chat\n      TCPA_SAFE: 'TCPA-SAFE',\n      TCPA_SAFE_ID: 'TCPA_SAFE',\n      TCPA_SAFE_LEAD_STATE: 'TCPA-SAFE-LEAD-STATE',\n      UPDATE_DIAL_DESTINATION: 'UPDATE_DIAL_DESTINATION',\n      XFER_COLD: 'COLD-XFER',\n      XFER_WARM: 'WARM-XFER',\n      XFER_WARM_CANCEL: 'WARM-XFER-CANCEL',\n      // SOFTPHONE message types\n      SETUP_WEB_RTC_SERVER: 'SETUP_WEB_RTC_SERVER',\n      SIP_INIT: 'SIP_INIT',\n      SIP_ANSWER: 'SIP_ANSWER',\n      SIP_REJECT: 'SIP_REJECT',\n      SIP_REGISTER: 'SIP_REGISTER',\n      SIP_HANGUP: 'SIP_HANGUP',\n      SIP_SEND_DTMF: 'SIP_SEND_DTMF',\n      SIP_TOGGLE_MUTE: 'SIP_TOGGLE_MUTE',\n      SOFTPHONE_RESET_SESSION: 'SOFTPHONE_RESET_SESSION',\n      SWITCH_SOFTPHONE_REGISTRAR: 'SWITCH_SOFTPHONE_REGISTRAR',\n    };\n\n    /*\n     * Init wrapper for the core module.\n     * @param {Object} The Object that the library gets attached to in\n     * library.init.js.  If the library was not loaded with an AMD loader such as\n     * require.js, this is the global Object.\n     */\n    function initAgentLibraryCore(context) {\n      'use strict';\n\n      /**\n     * This is the constructor for the Library Object. Note that the constructor is also being\n     * attached to the context that the library was loaded in.\n     * @param {Object} [config={}] Set authHost, if the WebSocket should be secure or not with the testingLocal boolean, and callback functions.\n     * @constructor\n     * @namespace Core\n     * @memberof AgentLibrary\n     * @property {object} callbacks Internal map of registered callback functions\n     * @property {array} _requests Internal map of requests by message id, private property.\n     * @property {array} _queuedMsgs Array of pending messages to be sent when socket reconnected\n     * @property {boolean} _isReconnect Whether or not we are doing a reconnect for the socket\n     * @example\n      var Lib = new AgentLibrary({\n           authHost:'d01-test.cf.dev:8080', // window.location.origin\n           testingLocal: true,\n           allowMultiSocket: true,\n           callbacks: {\n               closeResponse: onCloseFunction,\n               openResponse: onOpenFunction\n           }\n      });\n     */\n      var AgentLibrary = (context.AgentLibrary = function (config) {\n        config = config || {};\n\n        // define properties\n        this.callbacks = {};\n        this._requests = [];\n        this._queuedMsgs = [];\n        this._isReconnect = false;\n\n        // start with new model instance\n        UIModel.resetInstance();\n\n        // set instance on model object\n        UIModel.getInstance().libraryInstance = this;\n\n        // initialize indexedDB for logging\n        this.openLogger();\n        this.openConsoleLogger();\n\n        // set default values\n        if (typeof config.callbacks !== 'undefined') {\n          this.callbacks = config.callbacks;\n        }\n\n        if (typeof config.authHost !== 'undefined') {\n          UIModel.getInstance().authHost = config.authHost;\n        }\n\n        if (config.isSecureSocket !== 'undefined') {\n          if (typeof config.isSecureSocket === 'string') {\n            config.isSecureSocket =\n              config.isSecureSocket.toLowerCase() === 'true';\n          }\n          UIModel.getInstance().socketProtocol = config.isSecureSocket\n            ? 'wss://'\n            : 'ws://';\n        }\n\n        UIModel.getInstance().applicationSettings.allowMultiSocket =\n          config.allowMultiSocket === true;\n\n        return this;\n      });\n\n      /**\n       * Set multiple callback functions based on type\n       * @memberof AgentLibrary.Core\n       * @param {Object} callbackMap Contains map of callback types to their respective functions:<br />\n       * <tt>callbackMap = {<br />\n       *      closeResponse: onCloseFunction,<br />\n       *      openResponse: onOpenFunction<br />\n       * }\n       * </tt>\n       *<br />\n       * Possible callback types:\n       * <li>\"addSessionNotification\"</li>\n       * <li>\"agentStateResponse\"</li>\n       * <li>\"acknowledgeResponse\"</li>\n       * <li>\"bargeInResponse\"</li>\n       * <li>\"closeResponse\"</li>\n       * <li>\"coachResponse\"</li>\n       * <li>\"configureResponse\"</li>\n       * <li>\"callNotesResponse\"</li>\n       * <li>\"callbacksPendingResponse\"</li>\n       * <li>\"callbackCancelResponse\"</li>\n       * <li>\"campaignDispositionsResponse\"</li>\n       * <li>\"chatResponse\"</li>\n       * <li>\"dialGroupChangeNotification\"</li>\n       * <li>\"dialGroupChangePendingNotification\"</li>\n       * <li>\"dropSessionNotification\"</li>\n       * <li>\"earlyUiiNotification\"</li>\n       * <li>\"endCallNotification\"</li>\n       * <li>\"gatesChangeNotification\"</li>\n       * <li>\"genericNotification\"</li>\n       * <li>\"genericResponse\"</li>\n       * <li>\"holdResponse\"</li>\n       * <li>\"leadSearchResponse\"</li>\n       * <li>\"loginResponse\"</li>\n       * <li>\"logoutResponse\"</li>\n       * <li>\"monitorResponse\"</li>\n       * <li>\"newCallNotification\"</li>\n       * <li>\"offhookInitResponse\"</li>\n       * <li>\"offhookTermNotification\"</li>\n       * <li>\"openResponse\"</li>\n       * <li>\"pauseRecordResponse\"</li>\n       * <li>\"pendingDispNotification\"</li>\n       * <li>\"previewFetchResponse\"</li>\n       * <li>\"previewLeadStateNotification\"</li>\n       * <li>\"recordResponse\"</li>\n       * <li>\"requeueResponse\"</li>\n       * <li>\"reverseMatchNotification\"</li>\n       * <li>\"safeModeFetchResponse\"</li>\n       * <li>\"safeModeSearchResponse\"</li>\n       * <li>\"scriptConfigResponse\"</li>\n       * <li>\"supervisorListResponse\"</li>\n       * <li>\"coldXferResponse\"</li>\n       * <li>\"warmXferResponse\"</li>\n       * <li>\"agentStats\"</li>\n       * <li>\"agentDailyStats\"</li>\n       * <li>\"campaignStats\"</li>\n       * <li>\"queueStats\"</li>\n       * <li>\"chatQueueStats\"</li>\n       * @type {object}\n       */\n      AgentLibrary.prototype.setCallbacks = function (callbackMap) {\n        for (var property in callbackMap) {\n          this.callbacks[property] = callbackMap[property];\n        }\n      };\n\n      /**\n       * Set an individual callback function for the given type\n       * @memberof AgentLibrary.Core\n       * @param {string} type The name of the event that fires the callback function\n       * @param {function} callback The function to call for the given type\n       */\n      AgentLibrary.prototype.setCallback = function (type, callback) {\n        this.callbacks[type] = callback;\n      };\n\n      /**\n       * Get the map of all registered callbacks\n       * @memberof AgentLibrary.Core\n       * @returns {array}\n       */\n      AgentLibrary.prototype.getCallbacks = function () {\n        return this.callbacks;\n      };\n\n      /**\n       * Get a given registered callback by type\n       * @memberof AgentLibrary.Core\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCallback = function (type) {\n        return this.callbacks[type];\n      };\n\n      /**\n       * Get the socket connection to IntelliSocket\n       * @memberof AgentLibrary.Core\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getSocket = function (type) {\n        return this.socket;\n      };\n\n      /**\n       * @namespace Requests\n       * @memberof AgentLibrary.Core\n       */\n\n      ////////////////////////////\n      // requests and responses //\n      ////////////////////////////\n      /**\n       * Get outgoing Authenticate Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAuthenticateRequest = function () {\n        return UIModel.getInstance().authenticateRequest;\n      };\n      /**\n       * Get outgoing Login Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getLoginRequest = function () {\n        return UIModel.getInstance().loginRequest;\n      };\n      /**\n       * Get the MultiSocket Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getMultiSocketRequest = function () {\n        return UIModel.getInstance().multiSocketRequest;\n      };\n      /**\n       * Get outgoing Login Phase 1 Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentConfigRequest = function () {\n        return UIModel.getInstance().loginPhase1Request;\n      };\n      /**\n       * Get outgoing Logout Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getLogoutRequest = function () {\n        return UIModel.getInstance().logoutRequest;\n      };\n      /**\n       * Get latest Agent Daily Stats object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentDailyStats = function () {\n        return UIModel.getInstance().agentDailyStats;\n      };\n      /**\n       * Get latest Call Tokens object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCallTokens = function () {\n        return UIModel.getInstance().callTokens;\n      };\n      /**\n       * Get latest outgoing Agent State Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentStateRequest = function () {\n        return UIModel.getInstance().agentStateRequest;\n      };\n      /**\n       * Get latest outgoing offhook init Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getOffhookInitRequest = function () {\n        return UIModel.getInstance().offhookInitRequest;\n      };\n      /**\n       * Get latest outgoing offhook termination Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getOffhookTermRequest = function () {\n        return UIModel.getInstance().offhookTermRequest;\n      };\n      /**\n       * Get latest outgoing Hangup Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getHangupRequest = function () {\n        return UIModel.getInstance().hangupRequest;\n      };\n      /**\n       * Get latest outgoing Preview Dial Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getPreviewDialRequest = function () {\n        return UIModel.getInstance().previewDialRequest;\n      };\n      /**\n       * Get latest TCPA Safe Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getTcpaSafeRequest = function () {\n        return UIModel.getInstance().tcpaSafeRequest;\n      };\n      /**\n       * Get latest Manual Outdial Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getManualOutdialRequest = function () {\n        return UIModel.getInstance().oneToOneOutdialRequest;\n      };\n      /**\n       * Get latest Manual Outdial Cancel Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getManualOutdialCancelRequest = function () {\n        return UIModel.getInstance().oneToOneOutdialCancelRequest;\n      };\n      /**\n       * Get latest Call Notes Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCallNotesRequest = function () {\n        return UIModel.getInstance().callNotesRequest;\n      };\n      /**\n       * Get latest Campaign Dispositions Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCampaignDispositionsRequest = function () {\n        return UIModel.getInstance().campaignDispositionsRequest;\n      };\n      /**\n       * Get latest Disposition Call Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getDispositionRequest = function () {\n        return UIModel.getInstance().dispositionRequest;\n      };\n      /**\n       * Get latest Disposition Manual Pass Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getDispositionManualPassRequest = function () {\n        return UIModel.getInstance().dispositionManualPassRequest;\n      };\n      /**\n       * Get latest Warm Transfer Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getWarmTransferRequest = function () {\n        return UIModel.getInstance().warmXferRequest;\n      };\n      /**\n       * Get latest Cold Transfer Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getColdTransferRequest = function () {\n        return UIModel.getInstance().coldXferRequest;\n      };\n      /**\n       * Get latest Warm Transfer Cancel Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getWarmTransferCancelRequest = function () {\n        return UIModel.getInstance().warmXferCancelRequest;\n      };\n      /**\n       * Get latest Requeue Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getRequeueRequest = function () {\n        return UIModel.getInstance().requeueRequest;\n      };\n      /**\n       * Get latest Barge-In Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getBargeInRequest = function () {\n        return UIModel.getInstance().bargeInRequest;\n      };\n      /**\n       * Get latest Hold Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getHoldRequest = function () {\n        return UIModel.getInstance().holdRequest;\n      };\n      /**\n       * Get latest Pause Record Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getPauseRecordRequest = function () {\n        return UIModel.getInstance().pauseRecordRequest;\n      };\n      /**\n       * Get latest Record Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getRecordRequest = function () {\n        return UIModel.getInstance().recordRequest;\n      };\n      /**\n       * Get latest Chat Presented Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatPresentedRequest = function () {\n        return UIModel.getInstance().chatPresentedRequest;\n      };\n      /**\n       * Get latest Chat Disposition Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatDispositionRequest = function () {\n        return UIModel.getInstance().chatDispositionRequest;\n      };\n      /**\n       * Get latest Chat Message Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatMessageRequest = function () {\n        return UIModel.getInstance().chatMessageRequest;\n      };\n      /**\n       * Get latest Chat Requeue Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatRequeueRequest = function () {\n        return UIModel.getInstance().chatRequeueRequest;\n      };\n      /**\n       * Get latest Chat Typing Request object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatTypingRequest = function () {\n        return UIModel.getInstance().chatTypingRequest;\n      };\n      /**\n       * Get latest Agent Stats object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentStatsPacket = function () {\n        return UIModel.getInstance().agentStatsPacket;\n      };\n      /**\n       * Get latest Agent Daily Stats object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentDailyStatsPacket = function () {\n        return UIModel.getInstance().agentDailyStatsPacket;\n      };\n      /**\n       * Get latest Queue Stats object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getQueueStatsPacket = function () {\n        return UIModel.getInstance().queueStatsPacket;\n      };\n      /**\n       * Get latest Chat Queue Stats object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatQueueStatsPacket = function () {\n        return UIModel.getInstance().chatQueueStatsPacket;\n      };\n      /**\n       * Get latest Campaign Stats object\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCampaignStatsPacket = function () {\n        return UIModel.getInstance().campaignStatsPacket;\n      };\n      /**\n       * Get packet received on successful Phase 1 login\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentConfigPacket = function () {\n        return UIModel.getInstance().loginPhase1Packet;\n      };\n      /**\n       * Get packet received on successful Login (2nd layer login)\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getLoginPacket = function () {\n        return UIModel.getInstance().loginPacket;\n      };\n      /**\n       * Get latest received packet for Agent State\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentStatePacket = function () {\n        return UIModel.getInstance().agentStatePacket;\n      };\n      /**\n       * Get latest received packet for the Current Call\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCurrentCallPacket = function () {\n        return UIModel.getInstance().currentCallPacket;\n      };\n      /**\n       * Get latest received packet for initiating an offhook session\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getOffhookInitPacket = function () {\n        return UIModel.getInstance().offhookInitPacket;\n      };\n      /**\n       * Get latest received packet for terminating an offhook session\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getOffhookTermPacket = function () {\n        return UIModel.getInstance().offhookTermPacket;\n      };\n\n      /**\n       * Get chat agent end request class\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n\n      AgentLibrary.prototype.getChatAgentEnd = function () {\n        return UIModel.getInstance().chatAgentEnd;\n      };\n\n      /**\n       * Get WebRTC request class\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n\n      AgentLibrary.prototype.getWebRTCRequest = function () {\n        return UIModel.getInstance().webRTCRequest;\n      };\n\n      AgentLibrary.prototype.getChatListRequest = function () {\n        return UIModel.getInstance().chatListRequest;\n      };\n\n      /**\n       * Get SearchDirectoryRequest class\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n\n      AgentLibrary.prototype.getSearchDirectoryRequest = function () {\n        return UIModel.getInstance().searchDirectoryRequest;\n      };\n\n      /**\n       * @namespace Notifications\n       * @memberof AgentLibrary.Core\n       */\n      ///////////////////\n      // notifications //\n      ///////////////////\n      /**\n       * Get Dial Group Change notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getDialGroupChangeNotification = function () {\n        return UIModel.getInstance().dialGroupChangeNotification;\n      };\n      /**\n       * Get Dial Group Change Pending notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getDialGroupChangePendingNotification = function () {\n        return UIModel.getInstance().dialGroupChangePendingNotification;\n      };\n      /**\n       * Get End Call notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getEndCallNotification = function () {\n        return UIModel.getInstance().endCallNotification;\n      };\n      /**\n       * Get Gates Change notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getGatesChangeNotification = function () {\n        return UIModel.getInstance().gatesChangeNotification;\n      };\n      /**\n       * Get Generic notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getGenericNotification = function () {\n        return UIModel.getInstance().genericNotification;\n      };\n      /**\n       * Get New Call notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getNewCallNotification = function () {\n        return UIModel.getInstance().newCallNotification;\n      };\n      /**\n       * Get current call object\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCurrentCall = function () {\n        return UIModel.getInstance().currentCall;\n      };\n      /**\n       * Get Add Session notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAddSessionNotification = function () {\n        return UIModel.getInstance().addSessionNotification;\n      };\n      /**\n       * Get Drop Session notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getDropSessionNotification = function () {\n        return UIModel.getInstance().dropSessionNotification;\n      };\n      /**\n       * Get Early UII notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getEarlyUiiNotification = function () {\n        return UIModel.getInstance().earlyUiiNotification;\n      };\n      /**\n       * Get Chat Active notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatActiveNotification = function () {\n        return UIModel.getInstance().chatActiveNotification;\n      };\n      /**\n       * Get Chat Inactive notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatInactiveNotification = function () {\n        return UIModel.getInstance().chatInactiveNotification;\n      };\n      /**\n       * Get Chat Inactive notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatClientReconnectNotification = function () {\n        return UIModel.getInstance().chatClientReconnectNotification;\n      };\n      /**\n       * Get Chat Presented notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatPresentedNotification = function () {\n        return UIModel.getInstance().chatPresentedNotification;\n      };\n      /**\n       * Get Chat Typing notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatTypingNotification = function () {\n        return UIModel.getInstance().chatTypingNotification;\n      };\n      /**\n       * Get New Chat notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getNewChatNotification = function () {\n        return UIModel.getInstance().newChatNotification;\n      };\n      /**\n       * Get Load Media notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getLoadMediaNotification = function () {\n        return UIModel.getInstance().loadMediaNotification;\n      };\n      /**\n       * Get Load Media notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatAgentAssignFailureNotification = function () {\n        return UIModel.getInstance().chatAgentAssignFailureNotification;\n      };\n      /**\n       * Get Chat Typing notification class\n       * @memberof AgentLibrary.Core.Notifications\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatCancelledNotification = function () {\n        return UIModel.getInstance().chatCancelledNotification;\n      };\n\n      /**\n       * @namespace Settings\n       * @memberof AgentLibrary.Core\n       */\n      //////////////////////\n      // settings objects //\n      //////////////////////\n      /**\n       * Get Application Settings object containing the current state of application related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getApplicationSettings = function () {\n        return UIModel.getInstance().applicationSettings;\n      };\n      /**\n       * Get Softphone Settings object containing the current state of SIP related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getSoftphoneSettings = function () {\n        return UIModel.getInstance().softphoneSettings;\n      };\n      /**\n       * Get Chat Settings object containing the current state of chat related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatSettings = function () {\n        return UIModel.getInstance().chatSettings;\n      };\n      /**\n       * Get Connection Settings object containing the current state of connection related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getConnectionSettings = function () {\n        return UIModel.getInstance().connectionSettings;\n      };\n      /**\n       * Get Inbound Settings object containing the current state of inbound related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getInboundSettings = function () {\n        return UIModel.getInstance().inboundSettings;\n      };\n      /**\n       * Get Outbound Settings object containing the current state of outbound related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getOutboundSettings = function () {\n        return UIModel.getInstance().outboundSettings;\n      };\n      /**\n       * Get Agent Settings object containing the current state of agent related data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentSettings = function () {\n        return UIModel.getInstance().agentSettings;\n      };\n      /**\n       * Get Transfer Sessions\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getTransferSessions = function () {\n        return UIModel.getInstance().transferSessions;\n      };\n\n      AgentLibrary.prototype.getPendingSessions = function () {\n        return UIModel.getInstance().pendingNewCallSessions;\n      };\n      /**\n       * Get the Agent Permissions object containing the current state of agent permissions\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentPermissions = function () {\n        return UIModel.getInstance().agentPermissions;\n      };\n\n      /**\n       * @namespace Stats\n       * @memberof AgentLibrary.Core\n       */\n      ///////////////////\n      // stats objects //\n      ///////////////////\n\n      /**\n       * Get the Agent stats object containing the current state of agent stats\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentStats = function () {\n        return UIModel.getInstance().agentStats;\n      };\n      /**\n       * Get the Agent Daily stats object containing the current state of agent daily stats\n       * @memberof AgentLibrary.Core.Stats\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getAgentDailyStats = function () {\n        return UIModel.getInstance().agentDailyStats;\n      };\n      /**\n       * Get the Queue stats object containing the current state of queue stats\n       * @memberof AgentLibrary.Core.Stats\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getQueueStats = function () {\n        return UIModel.getInstance().queueStats;\n      };\n      /**\n       * Get the Chat Queue stats object containing the current state of chat queue stats\n       * @memberof AgentLibrary.Core.Stats\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getChatQueueStats = function () {\n        return UIModel.getInstance().chatQueueStats;\n      };\n      /**\n       * Get the Campaign stats object containing the current state of campaign stats\n       * @memberof AgentLibrary.Core.Stats\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getCampaignStats = function () {\n        return UIModel.getInstance().campaignStats;\n      };\n\n      /**\n       * Get filteredDirectory object containing the filtered directory data\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getFilteredDirectory = function () {\n        return UIModel.getInstance().filteredDirectory;\n      };\n\n      /**\n       * Get extensionPresenceResponse object containing the presenceInfo of extensionIds\n       * @memberof AgentLibrary.Core.Settings\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getExtensionPresenceResponse = function () {\n        return UIModel.getInstance().extensionPresenceResponse;\n      };\n\n      /**\n       * Get ExtensionPresenceRequest class\n       * @memberof AgentLibrary.Core.Requests\n       * @returns {object}\n       */\n      AgentLibrary.prototype.getExtensionPresenceRequest = function () {\n        return UIModel.getInstance().extensionPresenceRequest;\n      };\n\n      /**********************\n       *  PRIVATE FUNCTIONS *\n       **********************/\n\n      AgentLibrary.prototype._utils = utils;\n\n      AgentLibrary.prototype._NewCallUtils = NewCallUtils;\n\n      AgentLibrary.prototype._HttpService = HttpService;\n\n      AgentLibrary.prototype._getUIModel = function () {\n        return UIModel;\n      };\n    }\n\n    function initAgentLibrarySocket(context) {\n      'use strict';\n      var AgentLibrary = context.AgentLibrary;\n\n      AgentLibrary.prototype.openSocket = function (agentId, callback) {\n        var instance = this;\n        utils.setCallback(instance, CALLBACK_TYPES.OPEN_SOCKET, callback);\n        if ('WebSocket' in context) {\n          if (!instance.socket) {\n            var model = UIModel.getInstance();\n\n            model.agentSettings.agentId = agentId; // set agentId here since id is in scope\n\n            if (instance._isReconnect) {\n              // update access_token on reconnect\n              _getNewAccessToken(instance);\n            } else {\n              _buildSocketDest();\n              _initSocket(instance);\n            }\n          }\n        } else {\n          console.error('WebSocket NOT supported by your Browser');\n          utils.logMessage(\n            LOG_LEVELS.WARN,\n            'WebSocket NOT supported by your Browser',\n            '',\n          );\n        }\n      };\n\n      AgentLibrary.prototype.closeSocket = function () {\n        this.socket.close();\n      };\n\n      // when socket is successfully opened, check to see if there are any queued messaged\n      // and if so, send them.\n      AgentLibrary.prototype.socketOpened = function () {\n        var instance = this;\n        var currDts = new Date();\n        var threeMins = 3 * 60 * 1000; // milliseconds\n        var queuedMsg;\n\n        // get agent configuration information - \"phase 1 login\"\n        UIModel.getInstance().loginPhase1Request = new LoginPhase1Request();\n        var msg = UIModel.getInstance().loginPhase1Request.formatJSON();\n        utils.sendMessage(this, msg);\n\n        // if this is a reconnect, we need to re-authenticate with IntelliServices & IntelliQueue\n        if (instance._isReconnect) {\n          instance._isReconnect = false;\n          // Add IntelliQueue reconnect\n          var loginRequest = JSON.parse(\n            UIModel.getInstance().loginRequest.formatJSON(),\n          );\n          var hashCode = UIModel.getInstance().connectionSettings.hashCode;\n          loginRequest.ui_request.hash_code = {\n            '#text': hashCode,\n          };\n          loginRequest.ui_request.update_login = {\n            '#text': 'FALSE',\n          };\n          loginRequest.ui_request.reconnect = {\n            '#text': 'TRUE',\n          };\n          instance._queuedMsgs.unshift({\n            dts: new Date(),\n            msg: JSON.stringify(loginRequest),\n          });\n        }\n        for (var idx = 0; idx < instance._queuedMsgs.length; idx++) {\n          queuedMsg = instance._queuedMsgs[idx];\n          if (currDts.getTime() - queuedMsg.dts.getTime() < threeMins) {\n            // message queued less than 3 mins ago, send\n            utils.logMessage(\n              LOG_LEVELS.DEBUG,\n              'Sending queued message to IntelliSocket.',\n              queuedMsg.msg,\n            );\n            utils.sendMessage(instance, queuedMsg.msg);\n          } else {\n            // message expired, don't send\n            utils.logMessage(\n              LOG_LEVELS.DEBUG,\n              'Queued message expired, discarding.',\n              queuedMsg.msg,\n            );\n          }\n        }\n        // reset queued messages\n        instance._queuedMsgs = [];\n      };\n\n      // build WebSocket destination based on current agentId and access token\n      function _buildSocketDest() {\n        var model = UIModel.getInstance();\n        var socketDest = model.applicationSettings.socketDest;\n        socketDest = model.socketProtocol + model.authenticateRequest.socketUrl;\n        socketDest += ':' + model.authenticateRequest.socketPort;\n        socketDest += '?access_token=' + model.authenticateRequest.accessToken;\n        socketDest += '&agent_id=' + model.agentSettings.agentId;\n\n        model.applicationSettings.socketDest = socketDest; // seems redundant, but needed to update value on model\n        return socketDest;\n      }\n\n      // connect socket, setup socket event listeners\n      function _initSocket(instance) {\n        var socketDest = UIModel.getInstance().applicationSettings.socketDest;\n        utils.logMessage(\n          LOG_LEVELS.DEBUG,\n          'Attempting to open socket connection to ' + socketDest,\n          '',\n        );\n\n        instance.socket = new WebSocket(socketDest);\n\n        instance.socket.onopen = function () {\n          // stop reconnect timer\n          clearInterval(UIModel.getInstance().reconnectIntervalId);\n          UIModel.getInstance().reconnectIntervalId = null;\n\n          UIModel.getInstance().applicationSettings.socketConnected = true;\n          utils.fireCallback(instance, CALLBACK_TYPES.OPEN_SOCKET, {\n            reconnect: instance._isReconnect,\n          });\n          instance.socketOpened();\n        };\n\n        instance.socket.onerror = function (err) {\n          utils.fireCallback(instance, CALLBACK_TYPES.OPEN_SOCKET, {\n            error: err,\n          });\n        };\n\n        instance.socket.onmessage = function (evt) {\n          if (evt.data !== 'BOP') {\n            var data = JSON.parse(evt.data);\n            if (data.ui_response) {\n              utils.processResponse(instance, data);\n            } else if (data.ui_notification) {\n              utils.processNotification(instance, data);\n            } else if (data.dialer_request) {\n              utils.processDialerResponse(instance, data);\n            } else if (data.ui_stats) {\n              utils.processStats(instance, data);\n            } else if (data.ui_request) {\n              utils.processRequest(instance, data);\n            }\n          }\n        };\n\n        instance.socket.onclose = function () {\n          utils.fireCallback(instance, CALLBACK_TYPES.CLOSE_SOCKET, '');\n          UIModel.getInstance().applicationSettings.socketConnected = false;\n          instance.socket = null;\n\n          // cancel daily stats timer\n          clearInterval(UIModel.getInstance().agentDailyIntervalId);\n          UIModel.getInstance().agentDailyIntervalId = null;\n\n          // cancel stats timer\n          clearInterval(UIModel.getInstance().statsIntervalId);\n          UIModel.getInstance().statsIntervalId = null;\n\n          // cancel BEAT timer\n          clearInterval(UIModel.getInstance().pingStatIntervalId);\n          UIModel.getInstance().pingStatIntervalId = null;\n\n          // if we are still logged in, set reconnect flag and try to reconnect\n          if (UIModel.getInstance().agentSettings.isLoggedIn) {\n            instance._isReconnect = true;\n            console.warn(\n              'AgentLibrary: WebSocket is not connected, attempting to reconnect.',\n            );\n\n            // try reconnect every 5 seconds\n            UIModel.getInstance().reconnectIntervalId = setInterval(\n              function () {\n                instance.openSocket(\n                  UIModel.getInstance().agentSettings.agentId,\n                );\n              },\n              5000,\n            );\n          }\n        };\n      }\n\n      // get valid access token based on agentId and login hash code\n      function _getNewAccessToken(instance) {\n        var model = UIModel.getInstance();\n        var baseUrl = model.authHost + model.baseAuthUri;\n        var errorMsg = 'Error in opening WebSocket on retrieving access token';\n        var params = {\n          queryParams: {\n            loginHashcode: model.connectionSettings.hashCode,\n            agentId: model.agentSettings.agentId,\n            platformId: model.authenticateRequest.platformId,\n            isSso: model.applicationSettings.isSso,\n          },\n        };\n\n        new HttpService(baseUrl).httpPost('login/agent/hashcode', params).then(\n          function (response) {\n            try {\n              response = JSON.parse(response.response);\n              UIModel.getInstance().authenticateRequest.accessToken =\n                response.accessToken;\n              _buildSocketDest();\n              _initSocket(instance);\n            } catch (err) {\n              utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n            }\n          },\n          function (err) {\n            var errResponse = {\n              type: 'WebSocket Error',\n              message: errorMsg,\n            };\n            utils.logMessage(LOG_LEVELS.WARN, errorMsg, err);\n          },\n        );\n      }\n    }\n\n    function initAgentLibraryAgent(context) {\n      /**\n       * @namespace Agent\n       * @memberof AgentLibrary\n       */\n\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      /**\n       * Sends authenticate request to Engage Auth. Can either pass in 3 params of username, password, and platformId or\n       * two params of jwt and tokenType. In each case a callback function may optionally be specified.\n       * @memberof AgentLibrary.Agent\n       * @param {string} username Agent's username\n       * @param {string} password Agent's password\n       * @param {string} platformId Designate the platform where the agent is set up\n       * @param {function} [callback=null] Callback function when loginAgent response received\n       */\n      AgentLibrary.prototype.authenticateAgentWithUsernamePassword = function (\n        username,\n        password,\n        platformId,\n        callback,\n      ) {\n        UIModel.getInstance().authenticateRequest = new AuthenticateRequest({\n          username: username,\n          password: password,\n          platformId: platformId,\n          authType: AUTHENTICATE_TYPES.USERNAME_PASSWORD,\n        });\n        UIModel.getInstance().authenticateRequest.sendHttpRequest();\n\n        utils.setCallback(this, CALLBACK_TYPES.AUTHENTICATE, callback);\n      };\n\n      /**\n       * Sends authenticate request to Engage Auth. Returns an array of agents to continue login process.\n       * @memberof AgentLibrary.Agent\n       * @param {string} rcAccessToken JSON Web Token received from RingCentral Single Sign-on API\n       * @param {string} tokenType string type received from RingCentral Single Sign-on API\n       * @param {function} [callback=null] Callback function when loginAgent response received\n       */\n      AgentLibrary.prototype.authenticateAgentWithRcAccessToken = function (\n        rcAccessToken,\n        tokenType,\n        callback,\n      ) {\n        UIModel.getInstance().authenticateRequest = new AuthenticateRequest({\n          rcAccessToken: rcAccessToken,\n          tokenType: tokenType,\n          authType: AUTHENTICATE_TYPES.RC_TOKEN,\n        });\n        UIModel.getInstance().authenticateRequest.sendHttpRequest();\n\n        utils.setCallback(this, CALLBACK_TYPES.AUTHENTICATE, callback);\n      };\n\n      /**\n       * Sends authenticate request to Engage Auth. Returns an array of agents to continue login process.\n       * @memberof AgentLibrary.Agent\n       * @param {string} engageAccessToken JSON Web Token received from RingCentral Single Sign-on API\n       * @param {function} [callback=null] Callback function when loginAgent response received\n       */\n      AgentLibrary.prototype.authenticateAgentWithEngageAccessToken = function (\n        engageAccessToken,\n        callback,\n      ) {\n        UIModel.getInstance().authenticateRequest = new AuthenticateRequest({\n          engageAccessToken: engageAccessToken,\n          authType: AUTHENTICATE_TYPES.ENGAGE_TOKEN,\n        });\n        UIModel.getInstance().authenticateRequest.sendHttpRequest();\n\n        utils.setCallback(this, CALLBACK_TYPES.AUTHENTICATE, callback);\n      };\n\n      /**\n       * Sends request to IntelliQueue to get the agent's available products for login\n       * @memberof AgentLibrary.Agent\n       * @param {function} [callback=null] Callback function when loginPhase1 response received\n       */\n      AgentLibrary.prototype.getAgentConfig = function (callback) {\n        UIModel.getInstance().loginPhase1Request = new LoginPhase1Request();\n        var msg = UIModel.getInstance().loginPhase1Request.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.LOGIN_PHASE_1, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends request to the WebRTC Endpoint URL and process the response.\n       * @memberof AgentLibrary.Agent\n       *\n       * @param {function} [callback=null] Callback function when web rtc info response received\n       */\n      AgentLibrary.prototype.getWebRtcInfo = function (callback) {\n        var model = UIModel.getInstance();\n        model.webRTCRequest = new WebRTCRequest();\n        model.webRTCRequest.getSipRegistrationInfo();\n\n        utils.setCallback(this, CALLBACK_TYPES.WEBRTC_INFO, callback);\n      };\n\n      /**\n       * Sends agent configure message (2nd layer login) to IntelliQueue\n       * @memberof AgentLibrary.Agent\n       * @param {string} dialDest The agent's number, sip | DID.\n       * @param {string[]} [queueIds=null] The queue ids the agent will be logged into.\n       * @param {string[]} [chatIds=null] The chat ids the agent will be logged into.\n       * @param {string} [skillProfileId=null] The skill profile the agent will be logged into.\n       * @param {string} [dialGroupId=null] The outbound dial group id the agent will be logged into.\n       * @param {string} [updateFromAdminUI=false] Whether the request is generated from the AdminUI or not.\n       * @param {boolean} isForce Whether the agent login is forcing an existing agentlogin out.\n       * @param {function} [callback=null] Callback function when configureAgent response received.\n       */\n      AgentLibrary.prototype.loginAgent = function (\n        dialDest,\n        queueIds,\n        chatIds,\n        skillProfileId,\n        dialGroupId,\n        updateFromAdminUI,\n        isForce,\n        callback,\n      ) {\n        var model = UIModel.getInstance();\n        var config = {\n          dialDest: dialDest,\n          queueIds: queueIds,\n          chatIds: chatIds,\n          skillProfileId: skillProfileId,\n          dialGroupId: dialGroupId,\n          updateFromAdminUI: updateFromAdminUI,\n          isForce: isForce,\n        };\n        var instance = this;\n\n        // if dialDest is set to `integrated`, we are doing an integrated softphone\n        // and need to get SIP credentials\n        if (config.dialDest === 'integrated') {\n          // set up some global variables to track dial dest type for later offhook init\n          if (\n            model.applicationSettings.isFlr ||\n            !model.applicationSettings.isSso\n          ) {\n            model.applicationSettings.dialDestType = 'LEGACY_SOFTPHONE';\n          } else {\n            model.applicationSettings.dialDestType = 'RC_SOFTPHONE';\n          }\n\n          if (model.softphoneSettings.sipInfo.length === 0) {\n            // call engage-auth api to get webRtc info\n            model.libraryInstance.getWebRtcInfo(function () {\n              config.dialDest = utils.getDialDestination();\n              _setUpAndSendLogin(config, callback, instance);\n            });\n          } else {\n            // set webRtc info from model, could be an update login\n            config.dialDest = utils.getDialDestination();\n            _setUpAndSendLogin(config, callback, instance);\n          }\n        } else {\n          // set up some global variables to track dial dest type for later offhook init\n          if (config.dialDest === 'RC_PHONE') {\n            model.applicationSettings.dialDestType = 'RC_PHONE';\n          }\n\n          _setUpAndSendLogin(config, callback, instance);\n        }\n      };\n\n      function _setUpAndSendLogin(config, callback, instance) {\n        UIModel.getInstance().loginRequest = new LoginRequest(\n          config.dialDest,\n          config.queueIds,\n          config.chatIds,\n          config.skillProfileId,\n          config.dialGroupId,\n          config.updateFromAdminUI,\n          config.isForce,\n        );\n        var msg = UIModel.getInstance().loginRequest.formatJSON();\n\n        utils.setCallback(instance, CALLBACK_TYPES.LOGIN, callback);\n        utils.sendMessage(instance, msg);\n      }\n      /**\n       * Sends multisocket message to IntelliQueue\n       * @memberof AgentLibrary.Agent\n       * @param {function} [callback=null] Callback function when multisocket response received.\n       */\n      AgentLibrary.prototype.multiLoginRequest = function (callback) {\n        var model = UIModel.getInstance();\n        model.multiSocketRequest = new MultiSocketRequest();\n        var msg = model.multiSocketRequest.formatJSON();\n        if (\n          model.dataStore.get('agent_id') &&\n          model.dataStore.get('hash_code')\n        ) {\n          utils.setCallback(this, CALLBACK_TYPES.LOGIN_MULTISOCKET, callback);\n          utils.sendMessage(this, msg);\n        } else {\n          this.getAgentConfig(callback);\n        }\n      };\n\n      /**\n       * Sends agent logout message to IntelliQueue\n       * @memberof AgentLibrary.Agent\n       * @param {number} agentId Id of the agent that will be logged out.\n       * @param {function} [callback=null] Callback function when logoutAgent response received.\n       */\n      AgentLibrary.prototype.logoutAgent = function (agentId, callback) {\n        var model = UIModel.getInstance();\n        if (model.agentSettings.isLoggedIn) {\n          model.agentSettings.isLoggedIn = false;\n          model.logoutRequest = new LogoutRequest(agentId);\n          var msg = model.logoutRequest.formatJSON();\n\n          // socket closed in callback function\n          utils.setCallback(this, CALLBACK_TYPES.LOGOUT, callback);\n          utils.sendMessage(this, msg);\n        }\n      };\n\n      /**\n       * Sends agent logout for the given agent to logout message to IntelliQueue\n       * @memberof AgentLibrary.Agent\n       * @param {number} agentToLogout Id of the agent that will be logged out.\n       * @param {number} [requestMessage=\"\"] Message to send for the logout request.\n       * @param {function} [callback=null] Callback function when logoutAgent response received.\n       */\n      AgentLibrary.prototype.requestLogoutAgent = function (\n        agentToLogout,\n        requestMessage,\n        callback,\n      ) {\n        var isSupervisor =\n          UIModel.getInstance().agentSettings.agentType === 'SUPERVISOR';\n        if (isSupervisor) {\n          //This is a supervisor request to log an agent out. Create the\n          //logout packet and then send the packet to IntelliQueue.\n          UIModel.getInstance().logoutRequest = new LogoutRequest(\n            agentToLogout,\n            requestMessage,\n          );\n          utils.setCallback(this, CALLBACK_TYPES.LOGOUT, callback);\n          var msg = UIModel.getInstance().logoutRequest.formatJSON();\n          utils.sendMessage(this, msg);\n        }\n      };\n\n      /**\n       * Sends agent state change message to IntelliQueue\n       * @memberof AgentLibrary.Agent\n       * @param {string} agentState The system/base state to transition to <br />\n       * AVAILABLE | TRANSITION | ENGAGED | ON-BREAK | WORKING | AWAY | LUNCH | AUX-UNAVAIL-NO-OFFHOOK | AUX-UNAVAIL-OFFHOOK\n       * @param {string} [agentAuxState=\"\"] The aux state display label\n       * @param {function} [callback=null] Callback function when agentState response received\n       */\n      AgentLibrary.prototype.setAgentState = function (\n        agentState,\n        agentAuxState,\n        callback,\n      ) {\n        UIModel.getInstance().agentStateRequest = new AgentStateRequest(\n          agentState,\n          agentAuxState,\n        );\n        var msg = UIModel.getInstance().agentStateRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.AGENT_STATE, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Initiates an agent offhook session\n       * @memberof AgentLibrary.Agent\n       * @param {function} [callback=null] Callback function when offhookInit response received\n       */\n      AgentLibrary.prototype.offhookInit = function (callback) {\n        UIModel.getInstance().offhookInitRequest = new OffhookInitRequest();\n        var msg = UIModel.getInstance().offhookInitRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.OFFHOOK_INIT, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Terminates agent's offhook session\n       * @memberof AgentLibrary.Agent\n       * @param {function} [callback=null] Callback function when pending callbacks response received\n       */\n      AgentLibrary.prototype.offhookTerm = function (callback) {\n        UIModel.getInstance().offhookTermRequest = new OffhookTermRequest();\n        var msg = UIModel.getInstance().offhookTermRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.OFFHOOK_TERM, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Returns scheduled callbacks for the given agent\n       * @memberof AgentLibrary.Agent\n       * @param {number} [agentId=logged in agent id] Id of agent to get callbacks for\n       * @param {function} [callback=null] Callback function when pending callbacks response received\n       */\n      AgentLibrary.prototype.getPendingCallbacks = function (\n        agentId,\n        callback,\n      ) {\n        UIModel.getInstance().callbacksPendingRequest = new CallbacksPendingRequest(\n          agentId,\n        );\n        var msg = UIModel.getInstance().callbacksPendingRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CALLBACK_PENDING, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Cancel a scheduled callback for the given agent based on lead id\n       * @memberof AgentLibrary.Agent\n       * @param {number} leadId Id of lead callback to cancel\n       * @param {number} [agentId=logged in agent id] Id of agent to cancel specified lead callback for\n       * @param {function} [callback=null] Callback function when callback is canceled\n       */\n      AgentLibrary.prototype.cancelCallback = function (\n        leadId,\n        agentId,\n        callback,\n      ) {\n        UIModel.getInstance().callbackCancelRequest = new CallbackCancelRequest(\n          leadId,\n          agentId,\n        );\n        var msg = UIModel.getInstance().callbackCancelRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CALLBACK_CANCEL, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request stats messages to be sent every 5 seconds. The stats responses will be sent as\n       * four possible callback types: agentStats, agentDailyStats, campaignStats, or queueStats\n       * @memberof AgentLibrary.Agent\n       */\n      AgentLibrary.prototype.requestStats = function () {\n        // start stats interval timer, request stats every 5 seconds\n        if (UIModel.getInstance().statsIntervalId === null) {\n          UIModel.getInstance().statsIntervalId = setInterval(\n            utils.sendStatsRequestMessage,\n            5000,\n          );\n          _terminatePing();\n        }\n      };\n\n      /**\n       * Terminate stats messages sent to the agent every 5 seconds.\n       * @memberof AgentLibrary.Agent\n       */\n      AgentLibrary.prototype.terminateStats = function () {\n        clearInterval(UIModel.getInstance().statsIntervalId);\n        UIModel.getInstance().statsIntervalId = null;\n        _requestPing();\n      };\n\n      function _requestPing() {\n        // start ping interval timer, request BEAT every 20 seconds\n        if (UIModel.getInstance().pingStatIntervalId === null) {\n          UIModel.getInstance().pingStatIntervalId = setInterval(\n            utils.sendPingRequestMessage,\n            20000,\n          );\n        }\n      }\n\n      function _terminatePing() {\n        clearInterval(UIModel.getInstance().pingStatIntervalId);\n        UIModel.getInstance().pingStatIntervalId = null;\n      }\n\n      /**\n       * Set the agent dial destination\n       * @memberof AgentLibrary.Agent\n       * @param {string} dialDest The dial destination used for softphone registration\n       * @param {boolean} isSoftphoneError True - if we want to log this dial destination update as a softphone error\n       */\n      AgentLibrary.prototype.updateDialDestination = function (\n        dialDest,\n        isSoftphoneError,\n      ) {\n        UIModel.getInstance().updateDialDestinationRequest = new UpdateDialDestinationRequest(\n          dialDest,\n          isSoftphoneError,\n        );\n        var msg = UIModel.getInstance().updateDialDestinationRequest.formatJSON();\n\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Search Directory for the searchString passed to function.\n       * @memberof AgentLibrary.Agent\n       * @param {string} searchString The search filter for PBX directory\n       */\n      AgentLibrary.prototype.searchDirectory = function (\n        searchString,\n        callback,\n      ) {\n        var model = UIModel.getInstance();\n\n        model.searchDirectoryRequest = new SearchDirectoryRequest(searchString);\n        model.searchDirectoryRequest.searchDirectory(searchString);\n        utils.setCallback(this, CALLBACK_TYPES.SEARCH_DIR, callback);\n      };\n\n      /**\n       * Refresh Token method\n       * @memberof AgentLibrary.Agent\n       */\n      AgentLibrary.prototype.getRefreshedToken = function () {\n        utils.refreshAccessToken();\n      };\n\n      /**\n       * get Extension Presence  Info for the extension Ids passed to function.\n       * @memberof AgentLibrary.Agent\n       * @param {string} extensionIds The extension Ids of RC\n       */\n      AgentLibrary.prototype.getExtensionPresenceInfo = function (\n        extensionIds,\n        callback,\n      ) {\n        var model = UIModel.getInstance();\n        model.extensionPresenceRequest = new ExtensionPresenceRequest(\n          extensionIds,\n        );\n        model.extensionPresenceRequest.getExtensionPresenceInfo(extensionIds);\n        utils.setCallback(this, CALLBACK_TYPES.EXTENSION_PRESENCE, callback);\n      };\n    }\n\n    function initAgentLibraryCall(context) {\n      /**\n       * @namespace Call\n       * @memberof AgentLibrary\n       */\n\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      /**\n       * Barge in on a call, can hear all parties and be heard by all\n       * @memberof AgentLibrary.Call\n       * @param {number} agentId Agent Id of the current logged in agent\n       * @param {string} uii UII of the active call you wish to monitor\n       * @param {number} monitorAgentId UII Agent Id of the agent you wish to monitor\n       * @param {function} [callback=null] Callback function when barge in response received\n       */\n      AgentLibrary.prototype.bargeIn = function (\n        agentId,\n        uii,\n        monitorAgentId,\n        callback,\n      ) {\n        UIModel.getInstance().bargeInRequest = new BargeInRequest(\n          'FULL',\n          agentId,\n          uii,\n          monitorAgentId,\n        );\n        var msg = UIModel.getInstance().bargeInRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.BARGE_IN, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Add a coaching session to the call, can hear all parties but only able to speak on agent channel\n       * @memberof AgentLibrary.Call\n       * @param {number} agentId Agent Id of the current logged in agent\n       * @param {string} uii UII of the active call you wish to monitor\n       * @param {number} monitorAgentId UII Agent Id of the agent you wish to monitor\n       * @param {function} [callback=null] Callback function when coaching session response received\n       */\n      AgentLibrary.prototype.coach = function (\n        agentId,\n        uii,\n        monitorAgentId,\n        callback,\n      ) {\n        UIModel.getInstance().bargeInRequest = new BargeInRequest(\n          'COACHING',\n          agentId,\n          uii,\n          monitorAgentId,\n        );\n        var msg = UIModel.getInstance().bargeInRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.COACH_CALL, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer to another number and end the call for the original agent (cold transfer).\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number to transfer to\n       * @param {number} [callerId=\"\"] Caller Id for caller (DNIS)\n       * @param {number} [sipHeaders=[]] Name/Value header pairs\n       * @param {function} [callback=null] Callback function when cold transfer response received\n       */\n      AgentLibrary.prototype.coldXfer = function (\n        dialDest,\n        callerId,\n        sipHeaders,\n        callback,\n      ) {\n        UIModel.getInstance().coldXferRequest = new XferColdRequest(\n          dialDest,\n          callerId,\n          sipHeaders,\n        );\n        var msg = UIModel.getInstance().coldXferRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.XFER_COLD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer to another number and end the call for the original agent (cold transfer).\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number to transfer to\n       * @param {number} [callerId=\"\"] Caller Id for caller (DNIS)\n       * @param {number} [sipHeaders=[]] Name/Value header pairs\n       * @param {number} [countryId=\"\"] Country Id for the dialDest\n       * @param {function} [callback=null] Callback function when warm transfer response received\n       */\n      AgentLibrary.prototype.internationalColdXfer = function (\n        dialDest,\n        callerId,\n        sipHeaders,\n        countryId,\n        callback,\n      ) {\n        UIModel.getInstance().coldXferRequest = new XferColdRequest(\n          dialDest,\n          callerId,\n          sipHeaders,\n          countryId,\n        );\n        var msg = UIModel.getInstance().coldXferRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.XFER_COLD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send a disposition for an inbound or outbound call\n       * @memberof AgentLibrary.Call\n       * @param {string} uii UII (unique id) for call\n       * @param {string} dispId The disposition id\n       * @param {string} notes Agent notes for call\n       * @param {boolean} callback Boolean for whether or not this call is a callback\n       * @param {string} [callbackDTS=\"\"] date time stamp if callback\n       * @param {string} [contactForwardNumber=null] Number for contact forwarding\n       * @param {string} [survey=null] The survey response values for the call.\n       * Format: survey = [ { label: \"\", externId: \"\", leadUpdateColumn: \"\"} ]\n       * @param {string} [externId=null] The external id associated with the lead for this call (only for Outbound Dispositions).\n       * @param {string} [leadId=null] The lead id associated with this call (only for Outbound Dispositions).\n       * @param {string} [requestId=null] The request id associated with a preview fetched lead (only for Outbound Dispositions).\n       */\n      AgentLibrary.prototype.dispositionCall = function (\n        uii,\n        dispId,\n        notes,\n        callback,\n        callbackDTS,\n        contactForwardNumber,\n        survey,\n        externId,\n        leadId,\n        requestId,\n      ) {\n        var model = UIModel.getInstance();\n        model.dispositionRequest = new DispositionRequest(\n          uii,\n          dispId,\n          notes,\n          callback,\n          callbackDTS,\n          contactForwardNumber,\n          survey,\n          externId,\n          leadId,\n          requestId,\n        );\n        var msg = model.dispositionRequest.formatJSON();\n        utils.sendMessage(this, msg);\n\n        // cancel ping call timer\n        if (model.pingIntervalId) {\n          clearInterval(model.pingIntervalId);\n          model.pingIntervalId = null;\n        }\n      };\n\n      /**\n       * Send a disposition for a manual pass on a lead\n       * @memberof AgentLibrary.Call\n       * @param {string} dispId The disposition id\n       * @param {string} notes Agent notes for call\n       * @param {boolean} callback Boolean for whether or not this call is a callback\n       * @param {string} [callbackDTS=\"\"] date time stamp if callback\n       * @param {string} [leadId=null] The lead id\n       * @param {string} [requestId=null] The request key for the lead\n       * @param {string} [externId=null] The external id of the lead\n       */\n      AgentLibrary.prototype.dispositionManualPass = function (\n        dispId,\n        notes,\n        callback,\n        callbackDTS,\n        leadId,\n        requestId,\n        externId,\n      ) {\n        UIModel.getInstance().dispositionManualPassRequest = new DispositionManualPassRequest(\n          dispId,\n          notes,\n          callback,\n          callbackDTS,\n          leadId,\n          requestId,\n          externId,\n        );\n        var msg = UIModel.getInstance().dispositionManualPassRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Get a list of all campaign dispositions for given campaign id\n       * @memberof AgentLibrary.Call\n       * @param {string} campaignId Id for campaign to get dispositions for\n       * @param {function} [callback=null] Callback function when campaign dispositions response received\n       */\n      AgentLibrary.prototype.getCampaignDispositions = function (\n        campaignId,\n        callback,\n      ) {\n        UIModel.getInstance().campaignDispositionsRequest = new CampaignDispositionsRequest(\n          campaignId,\n        );\n        var msg = UIModel.getInstance().campaignDispositionsRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CAMPAIGN_DISPOSITIONS, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends a hangup request message\n       * @memberof AgentLibrary.Call\n       * @param {string} [sessionId=\"\"] Session to hangup, defaults to current call session id\n       * @param {boolean} resetPendingDisp, reset pendingDisp to false, in case of bad reconnect\n       */\n      AgentLibrary.prototype.hangup = function (sessionId, resetPendingDisp) {\n        UIModel.getInstance().hangupRequest = new HangupRequest(\n          sessionId,\n          resetPendingDisp,\n        );\n        var msg = UIModel.getInstance().hangupRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Place a call on hold\n       * @memberof AgentLibrary.Call\n       * @param {boolean} holdState Whether we are putting call on hold or taking off hold - values true | false\n       * @param {function} [callback=null] Callback function when hold response received\n       */\n      AgentLibrary.prototype.hold = function (holdState, callback) {\n        UIModel.getInstance().holdRequest = new HoldRequest(holdState);\n        var msg = UIModel.getInstance().holdRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.HOLD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Place a specified session of a call on hold\n       * @memberof AgentLibrary.Call\n       * @param {boolean} holdState Whether we are putting call on hold or taking off hold - values true | false\n       * @param {integer|string} sessionId session id of the call to place on hold\n       * @param {function} [callback=null] Callback function when hold response received\n       */\n      AgentLibrary.prototype.holdSession = function (\n        holdState,\n        sessionId,\n        callback,\n      ) {\n        UIModel.getInstance().holdRequest = new HoldRequest(\n          holdState,\n          sessionId,\n        );\n        var msg = UIModel.getInstance().holdRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.HOLD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends a manual outdial request message\n       * @memberof AgentLibrary.Call\n       * @param {string} destination Number to call - ANI\n       * @param {number} callerId Number displayed to callee, DNIS\n       * @param {number} [ringTime=60] Time in seconds to ring call\n       * @param {string} [countryId='USA'] Country for the destination number\n       * @param {number} [queueId=''] Queue id to tie manual call to\n       */\n      AgentLibrary.prototype.manualOutdial = function (\n        destination,\n        callerId,\n        ringTime,\n        countryId,\n        queueId,\n      ) {\n        UIModel.getInstance().oneToOneOutdialRequest = new OneToOneOutdialRequest(\n          destination,\n          callerId,\n          ringTime,\n          countryId,\n          queueId,\n        );\n        var msg = UIModel.getInstance().oneToOneOutdialRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Cancels a manual outdial request by UII.\n       * @memberof AgentLibrary.Call\n       * @param {string} uii UII of manual call request, the UII is returned in the EARLY_UII notification.\n       */\n      AgentLibrary.prototype.manualOutdialCancel = function (uii) {\n        UIModel.getInstance().oneToOneOutdialCancelRequest = new OneToOneOutdialCancelRequest(\n          uii,\n        );\n        var msg = UIModel.getInstance().oneToOneOutdialCancelRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Pause call recording\n       * @memberof AgentLibrary.Call\n       * @param {boolean} record Whether we are recording or not\n       * @param {function} [callback=null] Callback function when pause record response received\n       */\n      AgentLibrary.prototype.pauseRecord = function (record, callback) {\n        UIModel.getInstance().pauseRecordRequest = new PauseRecordRequest(\n          record,\n        );\n        var msg = UIModel.getInstance().pauseRecordRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.PAUSE_RECORD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends a preview dial request to call lead based on request id and (optional) lead phone.\n       * Call previewFetch method first to get request id.\n       * @memberof AgentLibrary.Call\n       * @param {number} requestId Pending request id sent back with lead, required to dial lead.\n       * @param {number} [leadPhone=\"\"] Lead phone number. Only needed if there are multiple numbers loaded for given lead.\n       */\n      AgentLibrary.prototype.previewDial = function (requestId, leadPhone) {\n        UIModel.getInstance().previewDialRequest = new PreviewDialRequest(\n          '',\n          [],\n          requestId,\n          leadPhone,\n        );\n        var msg = UIModel.getInstance().previewDialRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends a message to fetch preview dialable leads\n       * @memberof AgentLibrary.Call\n       * @param {array} [searchFields=[]] Array of objects with key/value pairs for search parameters\n       * e.g. [ {key: \"name\", value: \"Geoff\"} ]\n       * @param {function} [callback=null] Callback function when preview fetch completed, returns matched leads\n       */\n      AgentLibrary.prototype.previewFetch = function (searchFields, callback) {\n        UIModel.getInstance().previewDialRequest = new PreviewDialRequest(\n          '',\n          searchFields,\n          '',\n        );\n        var msg = UIModel.getInstance().previewDialRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.PREVIEW_FETCH, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Pull back leads that match search criteria\n       * @memberof AgentLibrary.Call\n       * @param {array} [searchFields=[]] Array of objects with key/value pairs for search parameters\n       * e.g. [ {key: \"name\", value: \"Geoff\"} ]\n       * @param {function} [callback=null] Callback function when lead search completed, returns matched leads\n       */\n      AgentLibrary.prototype.searchLeads = function (searchFields, callback) {\n        UIModel.getInstance().previewDialRequest = new PreviewDialRequest(\n          'search',\n          searchFields,\n          '',\n        );\n        var msg = UIModel.getInstance().previewDialRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.LEAD_SEARCH, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Set agent notes for a call\n       * @memberof AgentLibrary.Call\n       * @param {string} notes Agent notes to add to call\n       * @param {function} [callback=null] Callback function when call notes response received\n       */\n      AgentLibrary.prototype.setCallNotes = function (notes, callback) {\n        UIModel.getInstance().callNotesRequest = new CallNotesRequest(notes);\n        var msg = UIModel.getInstance().callNotesRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CALL_NOTES, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Add a silent monitor session to a call, can hear all channels but can't be heard by any party\n       * @memberof AgentLibrary.Call\n       * @param {number} agentId Agent Id of the current logged in agent\n       * @param {string} uii UII of the active call you wish to monitor\n       * @param {number} monitorAgentId UII Agent Id of the agent you wish to monitor\n       * @param {function} [callback=null] Callback function when silent monitor response received\n       */\n      AgentLibrary.prototype.monitor = function (\n        agentId,\n        uii,\n        monitorAgentId,\n        callback,\n      ) {\n        UIModel.getInstance().bargeInRequest = new BargeInRequest(\n          'MUTE',\n          agentId,\n          uii,\n          monitorAgentId,\n        );\n        var msg = UIModel.getInstance().bargeInRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.SILENT_MONITOR, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Toggle call recording based on passed in boolean true | false\n       * @memberof AgentLibrary.Call\n       * @param {boolean} record Whether we are recording or not\n       * @param {function} [callback=null] Callback function when record response received\n       */\n      AgentLibrary.prototype.record = function (record, callback) {\n        UIModel.getInstance().recordRequest = new RecordRequest(record);\n        var msg = UIModel.getInstance().recordRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.RECORD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Requeue a call\n       * @memberof AgentLibrary.Call\n       * @param {number} queueId Queue Id to send the call to\n       * @param {number} skillId Skill Id for the requeued call\n       * @param {boolean} maintain Whether or not to maintain the current agent\n       * @param {function} [callback=null] Callback function when requeue response received\n       */\n      AgentLibrary.prototype.requeueCall = function (\n        queueId,\n        skillId,\n        maintain,\n        callback,\n      ) {\n        UIModel.getInstance().requeueRequest = new RequeueRequest(\n          queueId,\n          skillId,\n          maintain,\n        );\n        var msg = UIModel.getInstance().requeueRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.REQUEUE, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends a TCPA Safe call request to call lead based on request id and (optional) lead phone.\n       * Call safeModeFetch method first to get request id.\n       * @memberof AgentLibrary.Call\n       * @param {number} requestId Pending request id sent back with lead, required to dial lead.\n       * @param {number} [leadPhone=\"\"] Lead phone number. Only needed if there are multiple numbers loaded for given lead.\n       */\n      AgentLibrary.prototype.safeModeCall = function (requestId, leadPhone) {\n        UIModel.getInstance().tcpaSafeRequest = new TcpaSafeRequest(\n          '',\n          [],\n          requestId,\n          leadPhone,\n        );\n        var msg = UIModel.getInstance().tcpaSafeRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends a message to fetch safe mode dialable leads\n       * @memberof AgentLibrary.Call\n       * @param {array} [searchFields=[]] Array of objects with key/value pairs for search parameters\n       * e.g. [ {key: \"name\", value: \"Geoff\"} ]\n       * @param {function} [callback=null] Callback function when safe mode fetch completed, returns matched leads\n       */\n      AgentLibrary.prototype.safeModeFetch = function (searchFields, callback) {\n        UIModel.getInstance().tcpaSafeRequest = new TcpaSafeRequest(\n          '',\n          searchFields,\n          '',\n        );\n        var msg = UIModel.getInstance().tcpaSafeRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.SAFE_MODE_FETCH, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Pull back Safe Mode leads that match search criteria\n       * @memberof AgentLibrary.Call\n       * @param {array} [searchFields=[]] Array of objects with key/value pairs for search parameters\n       * e.g. [ {key: \"name\", value: \"Geoff\"} ]\n       * @param {function} [callback=null] Callback function when safe mode fetch completed, returns matched leads\n       */\n      AgentLibrary.prototype.safeSearchLeads = function (\n        searchFields,\n        callback,\n      ) {\n        UIModel.getInstance().tcpaSafeRequest = new TcpaSafeRequest(\n          'search',\n          searchFields,\n          '',\n        );\n        var msg = UIModel.getInstance().tcpaSafeRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.SAFE_MODE_SEARCH, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer to another number while keeping the original agent on the line (warm transfer).\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number to transfer to\n       * @param {number} [callerId=\"\"] Caller Id for caller (DNIS)\n       * @param {number} [sipHeaders=[]] Name/Value header pairs\n       * @param {number} [countryId=\"\"] Country Id for the dialDest\n       * @param {function} [callback=null] Callback function when warm transfer response received\n       */\n      AgentLibrary.prototype.internationalWarmXfer = function (\n        dialDest,\n        callerId,\n        sipHeaders,\n        countryId,\n        callback,\n      ) {\n        UIModel.getInstance().warmXferRequest = new XferWarmRequest(\n          dialDest,\n          callerId,\n          sipHeaders,\n          countryId,\n        );\n        var msg = UIModel.getInstance().warmXferRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.XFER_WARM, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer to another number while keeping the original agent on the line (warm transfer).\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number to transfer to\n       * @param {number} [callerId=\"\"] Caller Id for caller (DNIS)\n       * @param {number} [sipHeaders=[]] Name/Value header pairs\n       * @param {function} [callback=null] Callback function when warm transfer response received\n       */\n      AgentLibrary.prototype.warmXfer = function (\n        dialDest,\n        callerId,\n        sipHeaders,\n        callback,\n      ) {\n        UIModel.getInstance().warmXferRequest = new XferWarmRequest(\n          dialDest,\n          callerId,\n          sipHeaders,\n        );\n        var msg = UIModel.getInstance().warmXferRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.XFER_WARM, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Cancel a warm transfer\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number that was transfered to\n       */\n      AgentLibrary.prototype.warmXferCancel = function (dialDest) {\n        UIModel.getInstance().warmXferCancelRequest = new XferWarmCancelRequest(\n          dialDest,\n        );\n        var msg = UIModel.getInstance().warmXferCancelRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer to another number while keeping the original agent on the line (warm transfer).\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number to transfer to\n       * @param {number} [callerId=\"\"] Caller Id for caller (DNIS)\n       * @param {number} [sipHeaders=[]] Name/Value header pairs\n       * @param {number} [countryId=\"\"] Country Id for the dialDest\n       * @param {function} [callback=null] Callback function when warm transfer response received\n       */\n      AgentLibrary.prototype.corporateDirWarmXfer = function (\n        dialDest,\n        callerId,\n        sipHeaders,\n        countryId,\n        callback,\n      ) {\n        UIModel.getInstance().warmXferRequest = new XferWarmRequest(\n          dialDest,\n          callerId,\n          sipHeaders,\n          countryId,\n        );\n        var msg = UIModel.getInstance().warmXferRequest.formatJSON();\n        utils.setCallback(this, CALLBACK_TYPES.XFER_WARM, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer to another number and end the call for the original agent (cold transfer).\n       * @memberof AgentLibrary.Call\n       * @param {number} dialDest Number to transfer to\n       * @param {number} [callerId=\"\"] Caller Id for caller (DNIS)\n       * @param {number} [sipHeaders=[]] Name/Value header pairs\n       * @param {number} [countryId=\"\"] Country Id for the dialDest\n       * @param {function} [callback=null] Callback function when cold transfer response received\n       */\n      AgentLibrary.prototype.corporateDirColdXfer = function (\n        dialDest,\n        callerId,\n        sipHeaders,\n        countryId,\n        callback,\n      ) {\n        UIModel.getInstance().coldXferRequest = new XferColdRequest(\n          dialDest,\n          callerId,\n          sipHeaders,\n          countryId,\n        );\n        var msg = UIModel.getInstance().coldXferRequest.formatJSON();\n        utils.setCallback(this, CALLBACK_TYPES.XFER_COLD, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Requests a script object based on given id\n       * @memberof AgentLibrary.Call\n       * @param {number} scriptId Id of script\n       * @param {number} version The version number of the script, if the current loaded script version matches,\n       *                 just return current script. Otherwise, fetch new version of script.\n       * @param {function} [callback=null] Callback function when warm transfer response received\n       */\n      AgentLibrary.prototype.getScript = function (\n        scriptId,\n        version,\n        callback,\n      ) {\n        var model = UIModel.getInstance();\n        var script = model.scriptSettings.loadedScripts[scriptId];\n        utils.setCallback(this, CALLBACK_TYPES.SCRIPT_CONFIG, callback);\n\n        if (script && script.version === version) {\n          // return from memory\n          var savedScript = UIModel.getInstance().scriptSettings.loadedScripts[\n            scriptId\n          ];\n          callback(savedScript);\n        } else {\n          // load script\n          model.scriptConfigRequest = new ScriptConfigRequest(scriptId);\n          var msg = UIModel.getInstance().scriptConfigRequest.formatJSON();\n          utils.sendMessage(this, msg);\n        }\n      };\n\n      /**\n       * Saves the results from a script\n       * @memberof AgentLibrary.Call\n       * @param {string} uii The UII of the call the script results belong to\n       * @param {number} scriptId Id of script\n       * @param {object} jsonResult JSON object of script results, name/value pairs\n       */\n      AgentLibrary.prototype.saveScriptResult = function (\n        uii,\n        scriptId,\n        jsonResult,\n      ) {\n        UIModel.getInstance().scriptResultRequest = new ScriptResultRequest(\n          uii,\n          scriptId,\n          jsonResult,\n        );\n        var msg = UIModel.getInstance().scriptResultRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Get available list of agents available for Direct Transfer\n       * @memberof AgentLibrary.Call\n       */\n      AgentLibrary.prototype.directAgentXferList = function (callback) {\n        UIModel.getInstance().directAgentTransferListRequest = new DirectAgentTransferList();\n        var msg = UIModel.getInstance().directAgentTransferListRequest.formatJSON();\n\n        utils.setCallback(\n          this,\n          CALLBACK_TYPES.DIRECT_AGENT_TRANSFER_LIST,\n          callback,\n        );\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer directly to an available agent from the directAgentXferList result and stay on the call\n       * @memberof AgentLibrary.Call\n       * @param {number} targetAgentId Agent id to transfer the call to\n       */\n      AgentLibrary.prototype.warmDirectAgentXfer = function (targetAgentId) {\n        UIModel.getInstance().directAgentTransferRequest = new DirectAgentTransfer(\n          targetAgentId,\n          'WARM',\n        );\n        var msg = UIModel.getInstance().directAgentTransferRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Transfer directly to an available agent from the directAgentXferList result\n       * and terminate the current agents call session\n       * @memberof AgentLibrary.Call\n       * @param {number} targetAgentId Agent id to transfer the call to\n       */\n      AgentLibrary.prototype.coldDirectAgentXfer = function (targetAgentId) {\n        UIModel.getInstance().directAgentTransferRequest = new DirectAgentTransfer(\n          targetAgentId,\n          'COLD',\n        );\n        var msg = UIModel.getInstance().directAgentTransferRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Cancel the request to transfer directly to an agent\n       * @memberof AgentLibrary.Call\n       * @param {number} targetAgentId Agent id to transfer the call to\n       */\n      AgentLibrary.prototype.cancelDirectAgentXfer = function (targetAgentId) {\n        UIModel.getInstance().directAgentTransferRequest = new DirectAgentTransfer(\n          targetAgentId,\n          'CANCEL',\n        );\n        var msg = UIModel.getInstance().directAgentTransferRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send the direct agent transfer straight to voicemail, avoid any attempts to connect to the target agent\n       * @memberof AgentLibrary.Call\n       * @param {number} targetAgentId Agent id to receive the voicemail\n       */\n      AgentLibrary.prototype.voicemailDirectAgentXfer = function (\n        targetAgentId,\n      ) {\n        UIModel.getInstance().directAgentTransferRequest = new DirectAgentTransfer(\n          targetAgentId,\n          'VOICEMAIL',\n        );\n        var msg = UIModel.getInstance().directAgentTransferRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Reject a presented direct agent transfer, if WARM requesting agent will be notified to try again,\n       * if COLD a voicemail will be left for the target agent\n       * @memberof AgentLibrary.Call\n       * @param {number} targetAgentId Agent id to receive the voicemail\n       */\n      AgentLibrary.prototype.rejectDirectAgentXfer = function (uii) {\n        UIModel.getInstance().directAgentTransferRequest = new DirectAgentTransfer(\n          '0',\n          'REJECT',\n          uii,\n        );\n        var msg = UIModel.getInstance().directAgentTransferRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n    }\n\n    function initAgentLibraryLead(context) {\n      /**\n       * @namespace Lead\n       * @memberof AgentLibrary\n       */\n\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      /**\n       * Get the history for a given lead\n       * @memberof AgentLibrary.Lead\n       * @param {number} leadId The lead id to retrieve history for\n       * @param {function} [callback=null] Callback function when lead history response received\n       */\n      AgentLibrary.prototype.leadHistory = function (leadId, callback) {\n        UIModel.getInstance().leadHistoryRequest = new LeadHistoryRequest(\n          leadId,\n        );\n        var msg = UIModel.getInstance().leadHistoryRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.LEAD_HISTORY, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Insert a lead to the given campaign\n       * @memberof AgentLibrary.Lead\n       * @param {object} dataObj agentId, campaignId, and lead info\n       * @param {function} [callback=null] Callback function when lead history response received\n       */\n      AgentLibrary.prototype.leadInsert = function (dataObj, callback) {\n        UIModel.getInstance().leadInsertRequest = new LeadInsertRequest(\n          dataObj,\n        );\n        var msg = UIModel.getInstance().leadInsertRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.LEAD_INSERT, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Update lead information\n       * @memberof AgentLibrary.Lead\n       * @param {string} leadId Id for lead to update\n       * @param {string} leadPhone Lead phone number\n       * @param {object} baggage Object containing lead information\n       * @param {function} [callback=null] Callback function when lead history response received\n       */\n      AgentLibrary.prototype.leadUpdate = function (\n        leadId,\n        leadPhone,\n        baggage,\n        callback,\n      ) {\n        UIModel.getInstance().leadUpdateRequest = new LeadUpdateRequest(\n          leadId,\n          leadPhone,\n          baggage,\n        );\n        var msg = UIModel.getInstance().leadUpdateRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.LEAD_UPDATE, callback);\n        utils.sendMessage(this, msg);\n      };\n    }\n\n    function initAgentLibraryChat(context) {\n      /**\n       * @namespace Chat\n       * @memberof AgentLibrary\n       */\n\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      /**\n       * Set the agent chat alias\n       * @memberof AgentLibrary.Chat\n       * @param {string} alias The alias string to be used for agent chat messages\n       * @deprecated\n       */\n      AgentLibrary.prototype.setChatAlias = function (alias) {\n        UIModel.getInstance().chatAliasRequest = new ChatAliasRequest(alias);\n        var msg = UIModel.getInstance().chatAliasRequest.formatJSON();\n\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request to enter/exit a public chat room\n       * @memberof AgentLibrary.Chat\n       * @param {string} action \"ENTER\" | \"EXIT\"\n       * @param {number} roomId Chat room id\n       * @deprecated\n       */\n      AgentLibrary.prototype.publicChatRoom = function (action, roomId) {\n        UIModel.getInstance().chatRoomRequest = new ChatRoomRequest(\n          action,\n          'PUBLIC',\n          roomId,\n        );\n        var msg = UIModel.getInstance().chatRoomRequest.formatJSON();\n\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request to enter/exit a private chat room\n       * @memberof AgentLibrary.Chat\n       * @param {string} action \"ENTER\" | \"EXIT\"\n       * @param {number} roomId Chat room id\n       * @param {number} agentOne Id for the logged in agent\n       * @param {number} agentTwo Id for the agent or supervisor the logged in agent is chatting with\n       * @deprecated\n       */\n      AgentLibrary.prototype.privateChatRoom = function (\n        action,\n        roomId,\n        agentOne,\n        agentTwo,\n      ) {\n        UIModel.getInstance().chatRoomRequest = new ChatRoomRequest(\n          action,\n          'PRIVATE',\n          roomId,\n          agentOne,\n          agentTwo,\n        );\n        var msg = UIModel.getInstance().chatRoomRequest.formatJSON();\n\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send a chat message to the given room\n       * @memberof AgentLibrary.Chat\n       * @param {number} roomId Id for chat room\n       * @param {string} message The message to be sent\n       * @param {function} [callback=null] Callback function when chat message received\n       * @deprecated\n       */\n      AgentLibrary.prototype.sendChat = function (roomId, message, callback) {\n        UIModel.getInstance().chatSendRequest = new ChatSendRequest(\n          roomId,\n          message,\n        );\n        var msg = UIModel.getInstance().chatSendRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CHAT, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Get list of supervisors for logged in agent\n       * @memberof AgentLibrary.Chat\n       * @param {function} [callback=null] Callback function when chat message received\n       * @deprecated\n       */\n      AgentLibrary.prototype.getSupervisors = function (callback) {\n        UIModel.getInstance().supervisorListRequest = new SupervisorListRequest();\n        var msg = UIModel.getInstance().supervisorListRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.SUPERVISOR_LIST, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send accept/decline response when a chat is presented to an agent\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {string} messageId Id tied to chat presented notification which this response is connected to.\n       * @param {string} response ACCEPT|REJECT response\n       * @param {string} responseReason Agent reason for Reject\n       */\n      AgentLibrary.prototype.chatPresentedResponse = function (\n        uii,\n        messageId,\n        response,\n        responseReason,\n      ) {\n        UIModel.getInstance().chatPresentedRequest = new ChatPresentedResponseRequest(\n          uii,\n          messageId,\n          response,\n          responseReason,\n        );\n        var msg = UIModel.getInstance().chatPresentedRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send an external chat message\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {string} agentId The agent associated with the chat\n       * @param {string} message The message sent by the agent\n       */\n      AgentLibrary.prototype.chatMessage = function (uii, agentId, message) {\n        UIModel.getInstance().chatMessageRequest = new ChatMessageRequest(\n          uii,\n          agentId,\n          message,\n          false,\n        );\n        var msg = UIModel.getInstance().chatMessageRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send an whisper type chat message\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {string} agentId The agent associated with the chat\n       * @param {string} message The message sent by the agent\n       */\n      AgentLibrary.prototype.chatWhisper = function (uii, agentId, message) {\n        UIModel.getInstance().chatMessageRequest = new ChatMessageRequest(\n          uii,\n          agentId,\n          message,\n          true,\n        );\n        var msg = UIModel.getInstance().chatMessageRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send a disposition to end a chat session\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {number} agentId The agent's id\n       * @param {number} dispositionId Id of the selected disposition\n       * @param {string} [notes=\"\"] Agent notes\n       * @param {boolean} sendAcknowlegement Whether or not to fire callback\n       * @param {object} [script=null] Script data associated with the chat session\n       * @param {number} sessionId Id for chat session\n       */\n      AgentLibrary.prototype.chatDisposition = function (\n        uii,\n        agentId,\n        dispositionId,\n        notes,\n        sendAcknowlegement,\n        script,\n        sessionId,\n      ) {\n        UIModel.getInstance().chatDispositionRequest = new ChatDispositionRequest(\n          uii,\n          agentId,\n          dispositionId,\n          notes,\n          sendAcknowlegement,\n          script,\n          sessionId,\n        );\n        var msg = UIModel.getInstance().chatDispositionRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Send the chat to a different Chat Queue\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {number} agentId The agent's id\n       * @param {number} chatQueueId Id of the Chat Queue to requeue to\n       * @param {number} skillId Skill id associated with the Chat Queue\n       * @param {boolean} [maintainAgent=false] Whether or not to keep the current agent connected to the chat on requeue\n       */\n      AgentLibrary.prototype.chatRequeue = function (\n        uii,\n        agentId,\n        chatQueueId,\n        skillId,\n        maintainAgent,\n      ) {\n        UIModel.getInstance().chatRequeueRequest = new ChatRequeueRequest(\n          uii,\n          agentId,\n          chatQueueId,\n          skillId,\n          maintainAgent,\n        );\n        var msg = UIModel.getInstance().chatRequeueRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sent when agent starts/stops typing\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {string} message Pending Agent message - sent to any monitoring Supervisors\n       */\n      AgentLibrary.prototype.chatTyping = function (uii, message) {\n        UIModel.getInstance().chatTypingRequest = new ChatTypingRequest(\n          uii,\n          message,\n        );\n        var msg = UIModel.getInstance().chatTypingRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request to add a session on an existing chat\n       * @memberof AgentLibrary.Chat\n       * @param {string} monitorAgentId Agent id handling this chat, the agent being monitored\n       */\n      AgentLibrary.prototype.monitorAgentChats = function (monitorAgentId) {\n        UIModel.getInstance().monitorChatRequest = new MonitorChatRequest(\n          monitorAgentId,\n        );\n        var msg = UIModel.getInstance().monitorChatRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request to stop a chat monitoring session for a specific agent\n       * @memberof AgentLibrary.Chat\n       * @param {string} monitorAgentId Agent id of agent being monitored\n       */\n      AgentLibrary.prototype.stopMonitoringChatsByAgent = function (\n        monitorAgentId,\n      ) {\n        UIModel.getInstance().stopMonitorChatRequest = new StopMonitorChatRequest(\n          monitorAgentId,\n        );\n        var msg = UIModel.getInstance().stopMonitorChatRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request to drop all chat monitoring sessions for the logged in agent\n       * @memberof AgentLibrary.Chat\n       */\n      AgentLibrary.prototype.stopMonitoringAllAgentChats = function () {\n        UIModel.getInstance().stopMonitorChatRequest = new StopMonitorChatRequest();\n        var msg = UIModel.getInstance().stopMonitorChatRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request to terminate an active chat session\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {string} agentId Current logged in agent id\n       * @param {string} sessionId Chat session id\n       */\n      AgentLibrary.prototype.leaveChat = function (uii, agentId, sessionId) {\n        UIModel.getInstance().leaveChatRequest = new LeaveChatRequest(\n          uii,\n          agentId,\n          sessionId,\n        );\n        var msg = UIModel.getInstance().leaveChatRequest.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Request a list of active chats by agent id\n       * @memberof AgentLibrary.Chat\n       * @param {string} agentId Current logged in agent id\n       * @param {string} monitorAgentId Agent id handling chats\n       * @param {function} [callback=null] Callback function when chat-list request received\n       */\n      AgentLibrary.prototype.chatList = function (\n        agentId,\n        monitorAgentId,\n        callback,\n      ) {\n        UIModel.getInstance().chatListRequest = new ChatListRequest(\n          agentId,\n          monitorAgentId,\n        );\n        var msg = UIModel.getInstance().chatListRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CHAT_LIST, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * set chat in state of agent-chat-end\n       * @memberof AgentLibrary.Chat\n       * @param {string} uii Unique identifier for the chat session\n       * @param {string} agentId Current logged in agent id\n       */\n\n      AgentLibrary.prototype.chatAgentEnd = function (agentId, uii) {\n        UIModel.getInstance().chatAgentEnd = new ChatAgentEndRequest(\n          agentId,\n          uii,\n        );\n        var msg = UIModel.getInstance().chatAgentEnd.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * Sends chat state change message to IntelliQueue\n       * @memberof AgentLibrary.Agent\n       * @param {string} chatState The base chat state <br />\n       * CHAT-AVAILABLE | CHAT-PRESENTED | CHAT-ENGAGED | CHAT-RNA\n       * @param {function} [callback=null] Callback function when chatState response received\n       */\n      AgentLibrary.prototype.setChatState = function (chatState, callback) {\n        UIModel.getInstance().chatStateRequest = new ChatStateRequest(\n          chatState,\n        );\n        var msg = UIModel.getInstance().chatStateRequest.formatJSON();\n\n        utils.setCallback(this, CALLBACK_TYPES.CHAT_STATE, callback);\n        utils.sendMessage(this, msg);\n      };\n\n      /**\n       * initialize a chat session by sending a manual outbound sms\n       * @memberof AgentLibrary.Chat\n       * @param {string} agentId Current logged in agent id\n       * @param {number} chatQueueId Id of the Chat Queue to send this sms through\n       * @param {number} ani to receive the sms\n       * @param {number} dnis to be used for the sms\n       * @param {string} message content\n       */\n\n      AgentLibrary.prototype.sendManualOutboundSms = function (\n        agentId,\n        chatQueueId,\n        ani,\n        dnis,\n        message,\n      ) {\n        UIModel.getInstance().chatManualSms = new ChatManualSmsRequest(\n          agentId,\n          chatQueueId,\n          ani,\n          dnis,\n          message,\n        );\n        var msg = UIModel.getInstance().chatManualSms.formatJSON();\n        utils.sendMessage(this, msg);\n      };\n    }\n\n    function initAgentLibraryLogger(context) {\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      AgentLibrary.prototype.openLogger = function () {\n        var instance = this;\n\n        if ('indexedDB' in context) {\n          // Open database\n          var dbRequest = indexedDB.open('AgentLibraryLogging', 6); // version number\n\n          dbRequest.onerror = function (event) {\n            console.error('Error requesting DB access');\n          };\n\n          dbRequest.onsuccess = function (event) {\n            instance._db = event.target.result;\n\n            //prune items older than 2 days\n            instance.purgeLog(instance._db, 'logger');\n\n            instance._db.onerror = function (event) {\n              // Generic error handler for all errors targeted at this database requests\n              console.error(\n                'AgentLibrary: Database error - ' + event.target.errorCode,\n              );\n            };\n\n            instance._db.onsuccess = function (event) {\n              console.log('AgentLibrary: Successful logging of record');\n            };\n          };\n\n          // This event is only implemented in recent browsers\n          dbRequest.onupgradeneeded = function (event) {\n            instance._db = event.target.result;\n\n            // Create an objectStore to hold log information. Key path should be unique\n            if (!instance._db.objectStoreNames.contains('logger')) {\n              var objectStore = instance._db.createObjectStore('logger', {\n                autoIncrement: true,\n              });\n\n              // simple indicies: index name, index column path\n              objectStore.createIndex('logLevel', 'logLevel', {\n                unique: false,\n              });\n              objectStore.createIndex('dts', 'dts', { unique: false });\n\n              // index for logLevel and date range\n              var name = 'levelAndDate';\n              var keyPath = ['logLevel', 'dts'];\n              objectStore.createIndex(name, keyPath, { unique: false });\n            }\n          };\n        } else {\n          console.warn(\n            'AgentLibrary: indexedDB NOT supported by your Browser.',\n          );\n        }\n      };\n\n      /**\n       * Purge records older than 2 days from the AgentLibrary log\n       * @memberof AgentLibrary\n       */\n      AgentLibrary.prototype.purgeLog = function (db, store) {\n        var instance = this;\n\n        if (db) {\n          try {\n            var transaction = db.transaction([store], 'readwrite');\n            var objectStore = transaction.objectStore(store);\n            var dateIndex = objectStore.index('dts');\n            var endDate = new Date();\n            endDate.setDate(endDate.getDate() - 2); // two days ago\n\n            var range = IDBKeyRange.upperBound(endDate);\n            dateIndex.openCursor(range).onsuccess = function (event) {\n              var cursor = event.target.result;\n              if (cursor) {\n                objectStore.delete(cursor.primaryKey);\n                cursor.continue();\n              }\n            };\n          } catch (err) {\n            // no op\n          }\n        }\n      };\n\n      /**\n       * Clear the AgentLibrary log by emptying the IndexedDB object store\n       * @memberof AgentLibrary\n       */\n      AgentLibrary.prototype.clearLog = function (db) {\n        var transaction = db.transaction(['logger'], 'readwrite');\n        var objectStore = transaction.objectStore('logger');\n\n        var objectStoreRequest = objectStore.clear();\n\n        objectStoreRequest.onsuccess = function (event) {\n          console.log('AgentLibrary: logger database cleared');\n        };\n      };\n\n      AgentLibrary.prototype.deleteDB = function (dbName) {\n        dbName = dbName || 'AgentLibraryLogging';\n        var DBDeleteRequest = indexedDB.deleteDatabase(dbName);\n\n        DBDeleteRequest.onerror = function (event) {\n          console.log('Error deleting database.', dbName);\n        };\n\n        DBDeleteRequest.onsuccess = function (event) {\n          console.log('Database', dbName, 'deleted successfully');\n        };\n      };\n\n      AgentLibrary.prototype.getLogRecords = function (\n        logLevel,\n        startDate,\n        endDate,\n        maxRows,\n        callback,\n      ) {\n        logLevel = logLevel || '';\n        var instance = this;\n        var transaction = instance._db.transaction(['logger'], 'readonly');\n        var objStore = transaction.objectStore('logger');\n        var index = null,\n          cursor = null,\n          range = null,\n          limit = maxRows || 100;\n        utils.setCallback(instance, CALLBACK_TYPES.LOG_RESULTS, callback);\n\n        if (\n          logLevel !== '' &&\n          logLevel.toUpperCase() !== 'ALL' &&\n          logLevel.toUpperCase() !== 'NO-STATS'\n        ) {\n          // looking for specific log level type\n          if (startDate && endDate) {\n            var lowerBound = [logLevel.toLowerCase(), startDate];\n            var upperBound = [logLevel.toLowerCase(), endDate];\n            range = IDBKeyRange.bound(lowerBound, upperBound);\n          } else if (startDate) {\n            range = IDBKeyRange.lowerBound([logLevel.toLowerCase(), startDate]);\n          } else if (endDate) {\n            range = IDBKeyRange.upperBound([logLevel.toLowerCase(), endDate]);\n          }\n\n          if (range !== null) {\n            // with the provided date range\n            var levelAndDateReturn = [];\n            var idxLevelAndDate = 0;\n            index = objStore.index('levelAndDate');\n            index.openCursor(range, 'prev').onsuccess = function (event) {\n              cursor = event.target.result;\n              if (cursor && idxLevelAndDate < limit) {\n                levelAndDateReturn.push(cursor.value);\n                idxLevelAndDate = idxLevelAndDate + 1;\n                cursor.continue();\n              } else {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.LOG_RESULTS,\n                  levelAndDateReturn,\n                );\n              }\n            };\n          } else {\n            // no date range specified, return all within log level\n            var logLevelReturn = [];\n            var idxLogLevel = 0;\n            index = objStore.index('logLevel');\n            index.openCursor(logLevel, 'prev').onsuccess = function (event) {\n              cursor = event.target.result;\n              if (cursor && idxLogLevel < limit) {\n                logLevelReturn.push(cursor.value);\n                idxLogLevel = idxLogLevel + 1;\n                cursor.continue();\n              } else {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.LOG_RESULTS,\n                  logLevelReturn,\n                );\n              }\n            };\n          }\n        } else if (logLevel.toUpperCase() === 'NO-STATS') {\n          // give us all types except stats\n          if (startDate && endDate) {\n            range = IDBKeyRange.bound(startDate, endDate);\n          } else if (startDate) {\n            range = IDBKeyRange.lowerBound(startDate);\n          } else if (endDate) {\n            range = IDBKeyRange.upperBound(endDate);\n          }\n\n          if (range !== null) {\n            // with the provided date range\n            var dtsNoStatsReturn = [];\n            var idxDTSNoStats = 0;\n            index = objStore.index('dts');\n\n            index.openCursor(range, 'prev').onsuccess = function (event) {\n              cursor = event.target.result;\n              if (cursor && idxDTSNoStats < limit) {\n                if (cursor.value.logLevel !== 'stats') {\n                  dtsNoStatsReturn.push(cursor.value);\n                  idxDTSNoStats = idxDTSNoStats + 1;\n                }\n                cursor.continue();\n              } else {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.LOG_RESULTS,\n                  dtsNoStatsReturn,\n                );\n              }\n            };\n          } else {\n            // no date range specified, return all records\n            var noStatsReturn = [];\n            var idxNoStats = 0;\n            objStore.openCursor().onsuccess = function (event) {\n              cursor = event.target.result;\n              if (cursor && idxNoStats < limit) {\n                if (cursor.value.logLevel !== 'stats') {\n                  noStatsReturn.push(cursor.value);\n                  idxNoStats = idxNoStats + 1;\n                }\n                cursor.continue();\n              } else {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.LOG_RESULTS,\n                  noStatsReturn,\n                );\n              }\n            };\n          }\n        } else {\n          // give us all log level types\n          if (startDate && endDate) {\n            range = IDBKeyRange.bound(startDate, endDate);\n          } else if (startDate) {\n            range = IDBKeyRange.lowerBound(startDate);\n          } else if (endDate) {\n            range = IDBKeyRange.upperBound(endDate);\n          }\n\n          if (range !== null) {\n            // with the provided date range\n            var dtsReturn = [];\n            var idxDTS = 0;\n            index = objStore.index('dts');\n\n            index.openCursor(range, 'prev').onsuccess = function (event) {\n              cursor = event.target.result;\n              if (cursor && idxDTS < limit) {\n                dtsReturn.push(cursor.value);\n                idxDTS = idxDTS + 1;\n                cursor.continue();\n              } else {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.LOG_RESULTS,\n                  dtsReturn,\n                );\n              }\n            };\n          } else {\n            // no date range specified, return all records\n            var allValsReturn = [];\n            var idxAll = 0;\n            objStore.openCursor().onsuccess = function (event) {\n              cursor = event.target.result;\n              if (cursor && idxAll < limit) {\n                allValsReturn.push(cursor.value);\n                idxAll = idxAll + 1;\n                cursor.continue();\n              } else {\n                utils.fireCallback(\n                  instance,\n                  CALLBACK_TYPES.LOG_RESULTS,\n                  allValsReturn,\n                );\n              }\n            };\n          }\n        }\n\n        return null;\n      };\n    }\n\n    function initAgentLibraryMultisocket(context) {\n      /**\n       * @namespace Multisocket\n       * @memberof AgentLibrary\n       */\n\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      /**\n       * Method to request call details from other tabs using the broadcast channel, for multisocket\n       */\n      AgentLibrary.prototype.loadCurrentCall = function (callback) {\n        broadcastChannelHelper.requestCurrentCall(callback);\n      };\n    }\n    function initAgentLibraryConsoleLogger(context) {\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n\n      AgentLibrary.prototype.openConsoleLogger = function () {\n        var instance = this;\n\n        if ('indexedDB' in context) {\n          var dbRequest = indexedDB.open('AgentLibraryConsoleLogging', 1);\n\n          dbRequest.onerror = function (event) {\n            console.error('Error requesting DB access');\n          };\n\n          dbRequest.onsuccess = function (event) {\n            instance._consoleDb = event.target.result;\n\n            //prune items older than 2 days\n            instance.purgeLog(instance._consoleDb, 'consoleLogger');\n\n            instance._consoleDb.onerror = function (event) {\n              // Generic error handler for all errors targeted at this database requests\n              console.error(\n                'AgentLibrary: Database error - ' + event.target.errorCode,\n              );\n            };\n\n            instance._consoleDb.onsuccess = function (event) {\n              console.log('AgentLibrary: Successful logging of record');\n            };\n\n            _overrideConsole();\n          };\n\n          // This event is only implemented in recent browsers\n          dbRequest.onupgradeneeded = function (event) {\n            instance._consoleDb = event.target.result;\n\n            // Create an objectStore to hold log information. Key path should be unique\n            if (\n              !instance._consoleDb.objectStoreNames.contains('consoleLogger')\n            ) {\n              var objectStore = instance._consoleDb.createObjectStore(\n                'consoleLogger',\n                { autoIncrement: true },\n              );\n\n              // simple indicies: index name, index column path\n              objectStore.createIndex('type', 'type', { unique: false });\n              objectStore.createIndex('dts', 'dts', { unique: false });\n              objectStore.createIndex('agentId', 'agentId', { unique: false });\n\n              // index for type and agent id\n              var name = 'typeAndAgent';\n              var keyPath = ['type', 'agentId'];\n              objectStore.createIndex(name, keyPath, { unique: false });\n            }\n\n            _overrideConsole();\n          };\n        } else {\n          console.warn(\n            'AgentLibrary: indexedDB NOT supported by your Browser.',\n          );\n        }\n      };\n\n      AgentLibrary.prototype.getConsoleLogRecords = function (type, callback) {\n        var agentId = UIModel.getInstance().agentSettings.agentId; // only return records for this agent id\n        var instance = this;\n        var transaction = instance._consoleDb.transaction(\n          ['consoleLogger'],\n          'readonly',\n        );\n        var objStore = transaction.objectStore('consoleLogger');\n        var index = null,\n          cursor = null,\n          range = null,\n          limit = 5000;\n\n        utils.setCallback(\n          instance,\n          CALLBACK_TYPES.LOG_CONSOLE_RESULTS,\n          callback,\n        );\n\n        var result = [];\n        if (type) {\n          // everything with this type\n          index = objStore.index('typeAndAgent');\n          range = IDBKeyRange.only([type.toUpperCase(), agentId]);\n        } else {\n          index = objStore.index('agentId');\n          range = IDBKeyRange.only(agentId);\n        }\n\n        var count = 0;\n        index.openCursor(range, 'prev').onsuccess = function (event) {\n          cursor = event.target.result;\n          if (cursor && count < limit) {\n            result.push(cursor.value);\n            count++;\n            cursor.continue();\n          } else {\n            utils.fireCallback(\n              instance,\n              CALLBACK_TYPES.LOG_CONSOLE_RESULTS,\n              result,\n            );\n          }\n        };\n      };\n\n      function _overrideConsole() {\n        // override the window.console functions, process as normal then save to the local db\n        var browserConsole = Object.assign({}, window.console);\n        (function (defaultConsole) {\n          var instance;\n          if (\n            UIModel &&\n            UIModel.getInstance() &&\n            UIModel.getInstance().libraryInstance\n          ) {\n            instance = UIModel.getInstance().libraryInstance;\n          } else {\n            // fallback\n            instance = new AgentLibrary();\n          }\n\n          var agentSettings = UIModel.getInstance().agentSettings;\n\n          function _getRecord(type, args) {\n            var result = [];\n            for (var i = 0; i < args.length; i++) {\n              var arg = args[i];\n              if (typeof arg === 'function') {\n                result.push(arg.toString());\n              } else if (typeof arg === 'object') {\n                try {\n                  result.push(JSON.stringify(arg));\n                } catch (e) {}\n              } else {\n                result.push(arg);\n              }\n            }\n\n            return {\n              type: type,\n              message: result.join(' '),\n              dts: new Date(),\n              agentId: agentSettings.agentId,\n              agentName: agentSettings.firstName + ' ' + agentSettings.lastName,\n            };\n          }\n\n          function _saveRecord(type, args) {\n            if (instance._consoleDb) {\n              var transaction = instance._consoleDb.transaction(\n                ['consoleLogger'],\n                'readwrite',\n              );\n              var store = transaction.objectStore('consoleLogger');\n\n              store.add(_getRecord(type, args));\n            }\n          }\n\n          window.console.log = function () {\n            defaultConsole.log.apply(this, arguments);\n            _saveRecord('LOG', arguments);\n          };\n          window.console.info = function () {\n            defaultConsole.info.apply(this, arguments);\n            _saveRecord('INFO', arguments);\n          };\n          window.console.warn = function () {\n            defaultConsole.warn.apply(this, arguments);\n            _saveRecord('WARN', arguments);\n          };\n          window.console.error = function () {\n            defaultConsole.error.apply(this, arguments);\n            _saveRecord('ERROR', arguments);\n          };\n        })(browserConsole);\n      }\n    }\n\n    function initAgentLibrarySoftphoneService(context) {\n      /**\n       * @namespace Softphone\n       * @memberof AgentLibrary\n       */\n\n      'use strict';\n\n      var AgentLibrary = context.AgentLibrary;\n      // var agentAuthRequest = UIModel.getInstance().authenticateRequest;\n      // // Auth token ,agentId,dialDest will be passed in init() function when sipInit is initialized in AgentJs.\n      // var serviceInstance = new SoftphoneService({\n      //     authToken: agentAuthRequest && agentAuthRequest.engageAccessToken,\n      //     agentId: UIModel.getInstance().agentSettings.agentId,\n      // });\n\n      // // set the softphone instance on the Lib\n      // AgentLibrary.prototype._SoftphoneService = serviceInstance;\n\n      //////////////////////\n      // PUBLIC FUNCTIONS //\n      //////////////////////\n      /* These functions are available externally to agent-js or other parent apps */\n\n      /**\n       * Initializes the SIP library, sets up callback functions\n       * @memberof AgentLibrary.Softphone\n       */\n      AgentLibrary.prototype.sipInit = function () {\n        var model = UIModel.getInstance();\n        var softphoneSettings = model.softphoneSettings;\n\n        // if webRtc settings not yet set, do so now\n        if (\n          softphoneSettings.uri === '' ||\n          softphoneSettings.wsServers.length === 0 ||\n          softphoneSettings.displayName === '' ||\n          softphoneSettings.authorizationUser === ''\n        ) {\n          SoftphoneService.setupWebRtcServer();\n        }\n\n        if (softphoneSettings.wsServers.length > 0) {\n          var webRtc = new CFSimpleSip(_getSipConfig());\n\n          // callbacks\n          webRtc.on('connected', _connected);\n          webRtc.on('ended', _ended);\n          webRtc.on('registered', _registered);\n          webRtc.on('unregistered', _unregistered);\n          webRtc.on('registrationFailed', _registrationFailed);\n          webRtc.on('ringing', _ringing);\n          webRtc.on('mute', _mute);\n          webRtc.on('unmute', _unmute);\n\n          // after 15 sec of no registration response, rotate the registrar\n          softphoneSettings.registerPending = setTimeout(\n            _handleNoRegisterResponse,\n            15 * 1000,\n          );\n          softphoneSettings.webRtc = webRtc; // set back on the UIModel instance\n        } else {\n          console.error('Unable to setup WebRtc server');\n        }\n      };\n\n      /**\n       * clear webRtc settings, hangup, unregister\n       * @memberof SoftphoneLibrary\n       * @returns boolean - success state\n       */\n      AgentLibrary.prototype.sipTerminate = function () {\n        var model = UIModel.getInstance();\n        var webRtc = model.softphoneSettings.webRtc;\n        if (webRtc && webRtc.ua) {\n          var opts = {\n            all: true,\n          };\n          model.libraryInstance.offhookTerm(); // TODO - dlb - set up callback with agent-js??\n          webRtc.hangup();\n          webRtc.ua.unregister(opts);\n\n          webRtc.removeAllListeners('connected');\n          webRtc.removeAllListeners('ended');\n          webRtc.removeAllListeners('registered');\n          webRtc.removeAllListeners('unregistered');\n          webRtc.removeAllListeners('registrationFailed');\n          webRtc.removeAllListeners('ringing');\n          webRtc.removeAllListeners('mute');\n          webRtc.removeAllListeners('unmute');\n\n          webRtc.ua.stop();\n          webRtc = null;\n          model.softphoneSettings.webRtc = webRtc; // set back on model\n          model.softphoneSettings.isRegistered = false;\n          model.softphoneSettings.attemptingSoftphoneReconnect = false;\n          model.softphoneSettings.muteActive = false;\n          model.softphoneSettings.registerPending = null;\n          model.softphoneSettings.uri = '';\n\n          return true;\n        }\n\n        console.warn('sipTerminate: sip rtc settings or ua missing', webRtc);\n        return false;\n      };\n      /**\n       * Sends a session.accept response to a SIP invite event.\n       * @memberof AgentLibrary.Softphone\n       */\n      AgentLibrary.prototype.sipAnswer = function () {\n        var webRtc = UIModel.getInstance().softphoneSettings.webRtc;\n        if (webRtc) {\n          webRtc.answer();\n        }\n      };\n\n      /**\n       * Sends a session.reject response to a SIP invite event.\n       * @memberof AgentLibrary.Softphone\n       */\n      AgentLibrary.prototype.sipReject = function () {\n        var webRtc = UIModel.getInstance().softphoneSettings.webRtc;\n        if (webRtc && webRtc.reject) {\n          webRtc.reject();\n        }\n      };\n\n      /**\n       * Request microphone access, if already registered, call hangup\n       * @memberof AgentLibrary.Softphone\n       */\n      AgentLibrary.prototype.sipRegister = function () {\n        var model = UIModel.getInstance();\n        var webRtc = model.softphoneSettings.webRtc;\n\n        try {\n          // enable microphone access notification if not already done\n          if (\n            window.webkitNotifications &&\n            window.webkitNotifications.checkPermission() !== 0\n          ) {\n            window.webkitNotifications.requestPermission();\n          }\n\n          if (!webRtc) {\n            return;\n          }\n\n          // if already registered, hangup\n          if (model.softphoneSettings.isRegistered) {\n            model.libraryInstance.sipHangUp();\n          }\n        } catch (e) {\n          console.error('sip reg error:' + e);\n        }\n      };\n\n      /**\n       * Sends session.cancel if connected, or session.bye if not connected to a call\n       * @memberof AgentLibrary.Softphone\n       */\n      AgentLibrary.prototype.sipHangUp = function () {\n        var webRtc = UIModel.getInstance().softphoneSettings.webRtc;\n        if (webRtc && webRtc.hangup) {\n          webRtc.hangup();\n        }\n      };\n\n      /**\n       * Sends session.dtmf for the tone specified\n       * @memberof AgentLibrary.Softphone\n       * @param {string} dtmf The dtmf tone to send\n       */\n      AgentLibrary.prototype.sipSendDTMF = function (dtmf) {\n        var webRtc = UIModel.getInstance().softphoneSettings.webRtc;\n        if (webRtc) {\n          webRtc.sendDTMF(dtmf);\n        }\n      };\n\n      /**\n       * Toggles call audio on/off\n       * @memberof AgentLibrary.Softphone\n       * @param {boolean} state The dtmf tone to send\n       */\n      AgentLibrary.prototype.sipToggleMute = function (state) {\n        var softphoneSettings = UIModel.getInstance().softphoneSettings;\n        var webRtc = softphoneSettings.webRtc;\n        var muteActive = softphoneSettings.muteActive;\n\n        if (webRtc) {\n          if (muteActive || state === false) {\n            webRtc.unmute();\n            utils.fireCallback(\n              UIModel.getInstance().libraryInstance,\n              CALLBACK_TYPES.SIP_UNMUTE,\n              { message: 'Call unmuted' },\n            );\n          } else {\n            webRtc.mute();\n            utils.fireCallback(\n              UIModel.getInstance().libraryInstance,\n              CALLBACK_TYPES.SIP_MUTE,\n              { message: 'Call muted' },\n            );\n          }\n        }\n      };\n\n      AgentLibrary.prototype.switchSoftphoneRegistrar = function (\n        maintainOffhook,\n        autoStartOffhook,\n      ) {\n        var model = UIModel.getInstance();\n\n        if (typeof autoStartOffhook === 'undefined') {\n          autoStartOffhook = true;\n        }\n        if (\n          model.softphoneSettings.attemptingSoftphoneReconnect &&\n          autoStartOffhook\n        ) {\n          _updateOHFlags(maintainOffhook, autoStartOffhook);\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.SIP_SWITCH_REGISTRAR,\n            {\n              message: 'Updating offhook flags, set status message',\n              status: 'UPDATE',\n            },\n          );\n        } else {\n          model.libraryInstance.resetSoftphoneSession({\n            maintainOH: maintainOffhook,\n            autoStartOH: autoStartOffhook,\n          });\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.SIP_SWITCH_REGISTRAR,\n            { message: 'Triggering softphone registrar swap', status: 'RESET' },\n          );\n        }\n      };\n\n      AgentLibrary.prototype.resetSoftphoneSession = function (offhookParams) {\n        var model = UIModel.getInstance();\n        var softphoneSettings = model.softphoneSettings;\n        if (\n          softphoneSettings.isRegistered &&\n          !softphoneSettings.attemptingSoftphoneReconnect\n        ) {\n          model.libraryInstance.sipTerminate(); // clear current SIP.js object\n          _rotateWebRtcServer(function () {\n            SoftphoneService.setupWebRtcServer();\n            if (offhookParams) {\n              if (offhookParams.maintainOH === 'null') {\n                offhookParams.maintainOH = softphoneSettings.maintainOH; // default to model setting\n              }\n              _updateOHFlags(\n                offhookParams.maintainOH,\n                offhookParams.autoStartOH,\n              );\n            }\n\n            model.libraryInstance.sipInit();\n            model.libraryInstance.sipRegister();\n          });\n        }\n      };\n\n      // INTERNAL FUNCTIONS //\n      ////////////////////////\n      /* These functions are globally available to the AgentSDK app */\n\n      var SoftphoneService = {\n        setupWebRtcServer: function () {\n          var model = UIModel.getInstance();\n          var softphoneSettings = model.softphoneSettings;\n\n          // webRtcServerInfo format for Legacy\n          // [\n          //     {\n          //        \"transport\": \"wss\",\n          //        \"username\": \"yadvendra_agent\",\n          //        \"password\": \"oct@2018\",\n          //        \"domain\": \"d03-reg1.vacd.biz\",\n          //        \"outboundProxy\": \"d03-reg1.vacd.biz:8089/freeswitch\"\n          //    }\n          // ]\n          //\n          // webRtcServerInfo format for RC Int API\n          // [\n          //     {\n          //        \"transport\": \"WSS\",\n          //        \"username\": \"18662032059*101\",\n          //        \"password\": \"B77O85vO\",\n          //        \"authorizationId\": \"400017513008\",\n          //        \"domain\": \"sip-cfintams.lab.nordigy.ru\",\n          //        \"outboundProxy\": \"webphone-sip-cfintams.lab.nordigy.ru:8083\"\n          //    }\n          // ]\n          var sipInfo = _getCurrentWebRtcServerInfo();\n          if (sipInfo !== null) {\n            var username = sipInfo.username.toLowerCase();\n            var webRtcServer =\n              sipInfo.transport.toLowerCase() + '://' + sipInfo.outboundProxy; // e.g. \"wss://aws87-f06-ccw01.vacd.biz:8089/freeswitch\";\n\n            softphoneSettings.uri =\n              utils.escapeSoftphoneUsername(username) + '@' + sipInfo.domain;\n            softphoneSettings.wsServers = [webRtcServer];\n            softphoneSettings.displayName = username;\n            softphoneSettings.authorizationUser = sipInfo.authorizationId;\n\n            softphoneSettings.sipPassword = sipInfo.password;\n            softphoneSettings.sipDialDest = 'sip:' + softphoneSettings.uri;\n\n            return {\n              webRtcServer: webRtcServer,\n              username: username,\n              password: softphoneSettings.sipPassword,\n              domain: sipInfo.domain || null,\n              dialDest: softphoneSettings.sipDialDest || null,\n              uri: softphoneSettings.uri || null,\n              wsServers: softphoneSettings.wsServers || [],\n            };\n          }\n\n          return null;\n        },\n      };\n\n      ///////////////////////\n      // PRIVATE FUNCTIONS //\n      ///////////////////////\n      /* These functions are just used within this softphoneService.js file */\n\n      function _getSipConfig() {\n        var remoteAudioElement = document.getElementById('remoteAudio'), // audio node on index.html\n          model = UIModel.getInstance(),\n          softphoneSettings = model.softphoneSettings,\n          config = {\n            media: {\n              remote: {\n                audio: remoteAudioElement,\n              },\n            },\n            ua: {\n              displayName: utils.escapeSoftphoneUsername(\n                softphoneSettings.displayName,\n              ),\n              authorizationUser: utils.escapeSoftphoneUsername(\n                softphoneSettings.authorizationUser,\n              ),\n              password: softphoneSettings.sipPassword,\n              uri: softphoneSettings.uri,\n              wsServers: softphoneSettings.wsServers,\n              traceSip: true,\n              registerExpires: 60,\n              userAgentString: navigator.userAgent,\n            },\n          };\n        return config;\n      }\n\n      function _handleNoRegisterResponse() {\n        // registration timeout reached, rotate registrar\n        var model = UIModel.getInstance();\n        var softphoneSettings = model.softphoneSettings;\n\n        // we want to force a registrar refresh\n        softphoneSettings.isRegistered = true;\n        softphoneSettings.attemptingSoftphoneReconnect = false;\n\n        model.libraryInstance.switchSoftphoneRegistrar(\n          softphoneSettings.maintainOH,\n          softphoneSettings.autoStartOH,\n        );\n      }\n\n      // clear registration timeout\n      function _registerHasResponse() {\n        clearTimeout(UIModel.getInstance().softphoneSettings.registerPending);\n      }\n\n      function _rotateWebRtcServer(callback) {\n        var softphoneSettings = UIModel.getInstance().softphoneSettings;\n        utils.setCallback(\n          UIModel.getInstance().libraryInstance,\n          CALLBACK_TYPES.ROTATE_WEBRTC_SERVER,\n          callback,\n        );\n        var sipInfo = softphoneSettings.sipInfo;\n        var timeSinceLastFetch =\n          Date.now() - softphoneSettings.lastSipFetchTime;\n        console.log(\n          '## Checking to rotate webRtc Server.SipInfo array length is ' +\n            sipInfo.length +\n            '. Time since last fetch of webRtcInfo is ' +\n            timeSinceLastFetch / 60000 +\n            ' mins.',\n        );\n        if (sipInfo.length > 1 && timeSinceLastFetch < 5 * 60000) {\n          sipInfo.shift();\n          console.log(\n            '## rotated sip server.Will now attempt to new server: ' +\n              sipInfo[0].domain,\n          );\n          softphoneSettings.attemptingSoftphoneReconnect = true;\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.ROTATE_WEBRTC_SERVER,\n            callback,\n          );\n        } else {\n          console.log('## fetching webRtcInfo.');\n          // fetch Sip Registration info again if array is consumed to rotate registrar\n          var model = UIModel.getInstance();\n          model.libraryInstance.getWebRtcInfo(callback);\n        }\n      }\n\n      function _updateOHFlags(maintainOffhook, autoStartOffhook) {\n        var softphoneSettings = UIModel.getInstance().softphoneSettings;\n        softphoneSettings.maintainOH = maintainOffhook;\n        softphoneSettings.autoStartOH = autoStartOffhook;\n      }\n\n      function _getCurrentWebRtcServerInfo() {\n        var softphoneSettings = UIModel.getInstance().softphoneSettings;\n        return softphoneSettings.sipInfo != null &&\n          softphoneSettings.sipInfo.length > 0\n          ? softphoneSettings.sipInfo[0]\n          : null;\n      }\n\n      ///////////////////////////////\n      // SIP JS CALLBACK FUNCTIONS //\n      ///////////////////////////////\n      /* These functions bubble up SIP callbacks to the UI */\n\n      function _connected() {\n        // send response to agent-js\n        utils.fireCallback(\n          UIModel.getInstance().libraryInstance,\n          CALLBACK_TYPES.SIP_CONNECTED,\n          { message: 'SIP connected' },\n        );\n      }\n\n      function _ended() {\n        utils.fireCallback(\n          UIModel.getInstance().libraryInstance,\n          CALLBACK_TYPES.SIP_ENDED,\n          { message: 'SIP ended' },\n        );\n      }\n\n      function _registered() {\n        var model = UIModel.getInstance();\n        _registerHasResponse();\n        model.softphoneSettings.isRegistered = true;\n\n        // check if dial destination has changed to a new registrar,\n        // but not just with the IQ replacement of @RC_SOFTPHONE\n        if (\n          model.agentSettings.dialDest !==\n            model.softphoneSettings.sipDialDest &&\n          model.agentSettings.dialDest.indexOf('@RC_SOFTPHONE') === -1\n        ) {\n          // update agent dial dest on instance\n          model.agentSettings.dialDest = JSON.parse(\n            JSON.stringify(model.softphoneSettings.sipDialDest),\n          );\n\n          // notify agent of change\n          var responseObj = {\n            message: 'SIP dial destination changed',\n            dialDest: model.agentSettings.dialDest,\n            maintainOH: model.softphoneSettings.maintainOH,\n            autoStartOH: model.softphoneSettings.autoStartOH,\n          };\n\n          if (!model.softphoneSettings.autoStartOH) {\n            model.softphoneSettings.attemptingSoftphoneReconnect = false; // done with reconnect steps for now\n          }\n\n          utils.fireCallback(\n            UIModel.getInstance().libraryInstance,\n            CALLBACK_TYPES.SIP_DIAL_DEST_CHANGED,\n            responseObj,\n          );\n\n          // update dial destination on agent login record, send request to IQ\n          model.libraryInstance.updateDialDestination(\n            model.agentSettings.dialDest,\n            true,\n          );\n        }\n\n        utils.fireCallback(\n          model.libraryInstance,\n          CALLBACK_TYPES.SIP_REGISTERED,\n          { message: 'SIP registered' },\n        );\n      }\n\n      function _unregistered() {\n        var model = UIModel.getInstance();\n        _registerHasResponse();\n        model.softphoneSettings.isRegistered = false;\n        model.libraryInstance.sipTerminate();\n        model.libraryInstance.sipInit();\n      }\n\n      function _registrationFailed() {\n        var model = UIModel.getInstance();\n        _registerHasResponse();\n        model.softphoneSettings.isRegistered = false;\n        model.libraryInstance.sipTerminate();\n      }\n\n      function _ringing(notif) {\n        var model = UIModel.getInstance();\n        var usingRcPhone =\n          model.agentSettings.dialDest.indexOf('@RC_SOFTPHONE') > -1;\n\n        var rcHeader =\n          notif.transaction &&\n          notif.transaction.request &&\n          notif.transaction.request.headers['P-Rc-Call-Source'];\n\n        var rcHeaderValue =\n          rcHeader && rcHeader.length === 1 && rcHeader[0].raw;\n\n        // do not notify the app of ringing if Rc Call Source is not 'partner-contact-center'\n        if (usingRcPhone && rcHeaderValue !== 'partner-contact-center') {\n          return;\n        }\n\n        utils.fireCallback(\n          UIModel.getInstance().libraryInstance,\n          CALLBACK_TYPES.SIP_RINGING,\n          { message: 'SIP ringing', data: notif },\n        );\n      }\n\n      function _mute() {\n        UIModel.getInstance().softphoneSettings.muteActive = true;\n      }\n\n      function _unmute() {\n        UIModel.getInstance().softphoneSettings.muteActive = false;\n      }\n      /**\n       * Initializes the SIP library, sets up callback functions\n       * Request microphone access, if already registered, call hangup\n       * @memberof AgentLibrary.Softphone\n       */\n      // AgentLibrary.prototype.sipInitAndRegister = serviceInstance.sipInitAndRegister.bind(\n      //     serviceInstance\n      // );\n    }\n\n    var initAgentLibrary = function (context) {\n      initAgentLibraryCore(context);\n      initAgentLibrarySocket(context);\n      initAgentLibraryAgent(context);\n      initAgentLibraryCall(context);\n      initAgentLibraryLead(context);\n      initAgentLibraryChat(context);\n      initAgentLibraryLogger(context);\n      initAgentLibraryConsoleLogger(context);\n      initAgentLibrarySoftphoneService(context);\n      initAgentLibraryMultisocket(context);\n\n      return context.AgentLibrary;\n    };\n\n    return initAgentLibrary(this);\n  }.call(this, this);\n}.call(window));\n"],"file":"agentLibrary.js"}