{"version":3,"sources":["index.js"],"names":["DEFAULT_LOCALE","PSEUDO_LOCALE","RUNTIME","locale","defaultLocale","instances","Set","padRatio","fallbackLocale","setLocale","i","load","I18n","loadLocale","Error","_loadLocale","_cache","add","data","_load","key","Object","prototype","hasOwnProperty","call","str","_getString","ratio","Number","isNaN","console","log","parseFloat"],"mappings":"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","sourcesContent":["import toPseudoString from './lib/toPseudoString';\n\nexport const DEFAULT_LOCALE = 'en-US';\nexport const PSEUDO_LOCALE = 'en-ZZ';\nexport const RUNTIME = {\n  locale: DEFAULT_LOCALE,\n  defaultLocale: DEFAULT_LOCALE,\n  instances: new Set(),\n  padRatio: 0.3,\n  fallbackLocale: DEFAULT_LOCALE,\n};\n\n/**\n * @function\n * @description Set currrent runtime locale and load the locale files accordingly\n * @param {String} locale - The desired locale.\n * @return Promise<undefined>\n */\nasync function setLocale(locale) {\n  RUNTIME.locale = locale;\n  for (const i of RUNTIME.instances) {\n    await i.load();\n  }\n}\n\n/**\n * @class\n * @description I18n is a simple localizations helper class that represents a set of locale files.\n */\nexport default class I18n {\n  /**\n   * @constructor\n   * @description Accepts a loadLocale function that should be async and resolve to the locale\n   *  object when invoked.\n   * @param {String => Promise<Object>} loadLocale - Asynchronous locale loader function.\n   */\n  constructor(loadLocale) {\n    if (typeof loadLocale !== 'function') {\n      throw new Error('loadLocale must be a function');\n    }\n    this._loadLocale = loadLocale;\n    this._cache = {};\n    RUNTIME.instances.add(this);\n    this.load();\n  }\n  async _load(locale) {\n    if (locale !== PSEUDO_LOCALE && !this._cache[locale]) {\n      let data;\n      try {\n        data = await (async () => this._loadLocale(locale))();\n      } catch (error) {\n        /* ignore error */\n        data = {};\n      }\n      this._cache[locale] = data;\n    }\n  }\n  async load() {\n    await this._load(RUNTIME.fallbackLocale);\n    await this._load(RUNTIME.defaultLocale);\n    await this._load(RUNTIME.locale);\n  }\n  _getString(key, locale) {\n    if (\n      this._cache[locale] &&\n      Object.prototype.hasOwnProperty.call(this._cache[locale], key)\n    ) {\n      return this._cache[locale][key];\n    }\n    if (\n      this._cache[RUNTIME.defaultLocale] &&\n      Object.prototype.hasOwnProperty.call(\n        this._cache[RUNTIME.defaultLocale],\n        key,\n      )\n    ) {\n      return this._cache[RUNTIME.defaultLocale][key];\n    }\n    if (\n      this._cache[RUNTIME.fallbackLocale] &&\n      Object.prototype.hasOwnProperty.call(\n        this._cache[RUNTIME.fallbackLocale],\n        key,\n      )\n    ) {\n      return this._cache[RUNTIME.fallbackLocale][key];\n    }\n\n    return key;\n  }\n  getString(key, locale = RUNTIME.locale) {\n    if (locale === PSEUDO_LOCALE) {\n      return toPseudoString({\n        str: this._getString(key, RUNTIME.fallbackLocale),\n        padRatio: RUNTIME.padRatio,\n      });\n    }\n    return this._getString(key, locale);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  get currentLocale() {\n    return RUNTIME.locale;\n  }\n  // eslint-disable-next-line class-methods-use-this\n  get setLocale() {\n    return setLocale;\n  }\n\n  static get currentLocale() {\n    return RUNTIME.locale;\n  }\n\n  static get setLocale() {\n    return setLocale;\n  }\n\n  static get padRatio() {\n    return RUNTIME.padRatio;\n  }\n\n  static set padRatio(ratio) {\n    if (Number.isNaN(ratio)) {\n      console.log('ratio must be a number');\n      return;\n    }\n    RUNTIME.padRatio = Number.parseFloat(ratio);\n  }\n\n  static setDefaultLocale(locale) {\n    RUNTIME.defaultLocale = locale;\n  }\n}\n"],"file":"index.js"}