{"version":3,"sources":["containers/RecentActivityContainer/index.js"],"names":["getTabs","ready","currentLocale","dateTimeFormatter","navigateTo","recentMessages","recentCalls","currentContact","sessionId","showRecentCalls","showRecentMessage","showFax","showVoiceMails","messages","calls","id","contactId","activityCardId","icon","label","i18n","getString","path","isActive","view","getData","cleanUp","dynamicsFont","composeText","isMessagesLoaded","getMessages","cleanUpMessages","contact","active","isCallsLoaded","getCalls","cleanUpCalls","filter","x","mapToProps","_","phone","locale","dateTimeFormat","contactMatcher","formatDateTime","getSession","useContact","session","contactMatch","contactMapping","dataMapping","phoneNumber","direction","callDirections","outbound","to","from","length","title","showSpinner","tabs","defaultTab","RecentActivityContainer","RecentActivityPanel"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport RecentActivityPanel from '../../components/RecentActivityPanel';\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\nimport RecentActivityMessages from '../../components/RecentActivityMessages';\nimport RecentActivityCalls from '../../components/RecentActivityCalls';\nimport VoicemailIcon from '../../assets/images/VoicemailIcon.svg';\nimport FaxIcon from '../../assets/images/Fax.svg';\nimport { withPhone } from '../../lib/phoneContext';\nimport i18n from './i18n';\n\nfunction getTabs({\n  ready,\n  currentLocale,\n  dateTimeFormatter,\n  navigateTo,\n  recentMessages,\n  recentCalls,\n  currentContact,\n  sessionId,\n  showRecentCalls,\n  showRecentMessage,\n  showFax,\n  showVoiceMails,\n}) {\n  if (!ready) return [];\n  let messages = [];\n  let calls = [];\n  if (currentContact && currentContact.id) {\n    const contactId = currentContact.id;\n    const activityCardId = sessionId ? `${contactId}-${sessionId}` : contactId;\n    if (recentMessages.messages[activityCardId]) {\n      messages = recentMessages.messages[activityCardId];\n    }\n    if (recentCalls.calls[activityCardId]) {\n      calls = recentCalls.calls[activityCardId];\n    }\n  }\n\n  return [\n    showVoiceMails\n      ? {\n          icon: <VoicemailIcon width={21} height={21} />,\n          label: i18n.getString('voicemail', currentLocale),\n          path: 'voicemails',\n          isActive: (path) => path === 'voicemails',\n          view: null,\n          getData() {},\n          cleanUp() {},\n        }\n      : null,\n    showRecentMessage\n      ? {\n          icon: <span className={dynamicsFont.composeText} />,\n          label: i18n.getString('text', currentLocale),\n          path: 'recentMessages',\n          isActive: (path) => path === 'recentMessages',\n          view: (\n            <RecentActivityMessages\n              messages={messages}\n              navigateTo={navigateTo}\n              dateTimeFormatter={dateTimeFormatter}\n              currentLocale={currentLocale}\n              isMessagesLoaded={recentMessages.isMessagesLoaded}\n            />\n          ),\n          getData() {\n            recentMessages.getMessages({ currentContact, sessionId });\n          },\n          cleanUp: () =>\n            recentMessages.cleanUpMessages({\n              contact: currentContact,\n              sessionId,\n            }),\n        }\n      : null,\n    showFax\n      ? {\n          icon: <FaxIcon width={21} height={21} />,\n          label: i18n.getString('fax', currentLocale),\n          path: 'faxes',\n          isActive: (path) => path === 'faxes',\n          view: null,\n          getData() {},\n          cleanUp() {},\n        }\n      : null,\n    showRecentCalls\n      ? {\n          icon: <span className={dynamicsFont.active} />,\n          label: i18n.getString('call', currentLocale),\n          path: 'recentCalls',\n          isActive: (path) => path === 'recentCalls',\n          view: (\n            <RecentActivityCalls\n              calls={calls}\n              dateTimeFormatter={dateTimeFormatter}\n              currentLocale={currentLocale}\n              isCallsLoaded={recentCalls.isCallsLoaded}\n            />\n          ),\n          getData() {\n            recentCalls.getCalls({ currentContact, sessionId });\n          },\n          cleanUp: () =>\n            recentCalls.cleanUpCalls({ contact: currentContact, sessionId }),\n        }\n      : null,\n  ].filter((x) => x !== null);\n}\n\nfunction mapToProps(\n  _,\n  {\n    phone: {\n      locale,\n      dateTimeFormat,\n      recentMessages,\n      recentCalls,\n      contactMatcher,\n    },\n    currentLocale = locale.currentLocale,\n    navigateTo,\n    dateTimeFormatter = (...args) => dateTimeFormat.formatDateTime(...args),\n    getSession,\n    useContact,\n    contact,\n    showRecentCalls = true,\n    showRecentMessage = true,\n    showFax = true,\n    showVoiceMails = true,\n  },\n) {\n  let sessionId = null;\n  let currentContact = contact;\n  let ready =\n    dateTimeFormat.ready &&\n    locale.ready &&\n    recentMessages.ready &&\n    recentCalls.ready;\n  if (!useContact) {\n    const session = getSession();\n    sessionId = session.id;\n    currentContact = session.contactMatch;\n    const contactMapping = contactMatcher && contactMatcher.dataMapping;\n    const phoneNumber =\n      session.direction === callDirections.outbound ? session.to : session.from;\n    if (!currentContact) {\n      currentContact = contactMapping && contactMapping[phoneNumber];\n      if (currentContact && currentContact.length >= 1) {\n        currentContact = currentContact[0];\n      }\n    }\n    ready = ready && contactMatcher.ready;\n  }\n  return {\n    currentLocale,\n    title: i18n.getString('recentActivities', locale.currentLocale),\n    showSpinner: !ready,\n    currentContact,\n    calls: recentCalls.calls || [],\n    tabs: getTabs({\n      ready,\n      currentLocale,\n      dateTimeFormatter,\n      navigateTo,\n      currentContact,\n      recentMessages,\n      recentCalls,\n      sessionId,\n      showFax,\n      showRecentCalls,\n      showVoiceMails,\n      showRecentMessage,\n    }),\n    defaultTab: 'recentCalls',\n  };\n}\n\nconst RecentActivityContainer = withPhone(\n  connect(mapToProps)(RecentActivityPanel),\n);\n\nexport { getTabs, mapToProps, RecentActivityContainer as default };\n"],"file":"index.js"}