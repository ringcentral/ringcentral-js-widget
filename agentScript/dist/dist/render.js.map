{"version":3,"sources":["agentScript/dist/dist/render.js"],"names":["angular","module","directive","Directive","restrict","scope","uii","config","callbacks","templateUrl","link","element","attrs","controller","$scope","$element","$timeout","Render_ScriptSvc","Router","NavSvc","htmlElementFactory","RENDER_TOOL_TYPES","_init","key","when","type","uiiListener","toString","$watch","newUii","oldUii","reset","init","onRouteChange","_trackNav","scriptId","scriptName","name","getScriptData","then","initialModel","model","scriptResult","navPosition","setConfig","lookupGoTo","$on","removeUii","toRoute","fromRoute","params","node","nodeId","id","parentId","join","renderFormValid","setScriptResult","run","$templateCache","put","constant","bindHtmlUnsafe","$compile","nameWatcher","htmlName","newVal","_compile","newHTML","html","require","cfRequired","modelCtrl","isDefined","$modelValue","length","$setValidity","ngModel","attr","Date","getTime","format","timePicker","datetimepicker","keepInvalid","useCurrent","timeZone","widgetParent","jQuery","closest","on","e","moment","date","Render_javascriptExecutor","INPUT_JAVASCRIPT_TRIGGER_TYPES","ngModelCtrl","script","options","data","javascript","input","parent","find","trigger","BLUR","_evalScript","CHANGE","isArray","_","debounce","oldVal","delay","CLICK","execute","factory","JavascriptBuilder","goTo","getData","putData","generateJavascript","connections","result","conn","_buildGoTo","target","generateSwitch","tool","properties","each","switchCases","sc","comparisons","comp","index","modelAttr","value","_buildGetData","comparator","action","generateDataBuilder","label","JSON","stringify","dest","Factory","Render_objectSvc","utils","_jsClosure","getCallbacks","brackets","RegExp","indexOf","match","byString","parsed","parse","startRecording","setRecordingState","stopRecording","holdCall","setHoldState","resumeCall","coldRequeue","gateId","skillId","requestColdRequeue","warmRequeue","requestWarmRequeue","hangup","requestHangup","coldTransfer","dialDest","callerId","requestColdTransfer","warmTransfer","requestWarmTransfer","dispositionCall","disposition","notes","isCallback","contactForwardNum","callbackDts","disps","call","dispositions","disp","d","toUpperCase","requestDisposition","console","error","changeScript","state","scriptWrapper","eval","Service","isFirstPage","toolId","trackHistory","goToId","parts","split","forwardNode","asId","current","getCurrent","next","curr","resolve","isActive","prev","goBack","_findTool","currNode","isNestedView","PAGE","go","setNestedView","setCurrentRoute","history","getHistory","firstPageInHistory","some","p","setIsFirstPage","getIsFirstPage","found","getScript","tools","s","str","service","ObjectService","DATA_TYPES","$interpolate","string","allOrNothing","isString","trim","getType","obj","ARRAY","isObject","OBJECT","CONSTANT","provider","Provider","callbackStack","routes","currentRoute","stateParams","setPath","setCurrent","path","triggerChange","push","$get","$stateParams","callback","copy","lastRoute","pop","renderUii","route","$controller","priority","template","compile","_trackView","newRoute","elemHtml","get","foundElement","contents","oldRoute","newParams","agentCallbacks","warn","allowSendKbArticle","sendKbArticle","getKnowledgeBaseArticles","modelCopy","dataMaps","flattened","map","reportAs","modelVal","report","reportKey","leadField","byLayout","a","b","layout","y","x","$q","executing","props","defer","opts","url","method","crossDomain","headers","success","reject","complete","bodyType","_getFormBody","_getBody","replace","_getValue","h","form","variables","variable","body","tag","mockValue","undefined","exec","val","ajax","promise","formlyConfig","getAvailableHtml","getConfigs","that","allTypes","getTypes","blockedTypes","resultObj","configs","hasKey","hasLabel","configFunc","concat","typeConfigs","extend","checkboxConfigs","hasSource","hasOptions","hasRequired","hasInlineStyle","hasMultipleDefaults","hasScripting","inputConfigs","hasPlaceholder","hasDefaultValue","hasInputTypes","hasMaxLength","hrConfigs","emailConfigs","phoneConfigs","numberConfigs","customConfigs","hasMaskInput","dateConfigs","linkConfigs","hasHref","imageConfigs","iFrameConfigs","hasHttpsHref","radioConfigs","selectConfigs","selectBoxConfigs","multipleSelectBoxConfigs","textareaConfigs","buttonConfigs","hasButtonSettings","hasActionType","hasNavigation","navigationConfigs","hasNavigationLabel","pageBreakConfigs","viewConfigs","hasViewConfig","textConfigs","hasRichText","tableConfigs","hasTableConfig","dispositionsConfigs","hasDispositionDisplayType","knowledgeBaseConfigs","hasKnowledgeBase","setType","wrapper","overwriteOk","defaultOptions","ngModelElAttrs","$destroy","elem","atts","toggleCheckbox","isChecked","keys","modelArray","_isInModel","splice","findIndex","v","getClass","size","ignoreModel","view","location","isDisabled","disableInvalid","prop","expressionProperties","$parse","templateOptions","prevLabel","nextLabel","placeholder","forward","track","content","urlPrefix","getStyle","anchorColorObj","style","color","display","isInline","getTableData","dataSource","table","cols","columns","c","title","visible","DataTable","searching","searchable","paging","info","ordering","select","selectable","language","search","searchPlaceholder","dt","indexes","rowData","rows","toArray","_setModel","kbGroups","updateKb","send","toggle","allowSendArticle","group","knowledgeBaseCategories","filter","category","knowledgeBaseArticles","kb","cpy","kbSearch","article","labels","toLowerCase","filteredKb","event","stopPropagation","contentPlain","item","collapse","setWrapper","buttonCtrl","growl","origLabel","to","isNavButton","isFirstPageBack","takeAction","actionResult","payload","_navigate","callAction","holdState","label_alt","_showGrowl","xferTo","transferTo","transferCallerId","xfer_header","_buildXferHeader","_handleRequeue","forwardNum","newScriptId","header","isWarm","requeueTo","requeueSkill","requeueToGate","dispositionCtrl","dispositionSvc","InputType_dispositionSvc","sendDisp","localDts","currDisp","localTimezone","tz","guess","timezones","leadTimezone","leadDate","leadTime","nowPlusTimeout","add","dispWatch","time","hours","minutes","seconds","leadDts","dispositionId","self","defaultDisp","ExternalSourceUrlCtrl","$sce","fullUrl","trustedUrl","trustAsResourceUrl","OptionCtrl","o","defaultValue","currentModel","parsedModelVal","bracketRegex","replaceModel","isNumericInput","isNaN","Number","Controller","log","scriptComplete","SWITCH","advancedMode","DATA_BUILDER","dataMap","SortSvc","modelWatch","validWatch","getValue","renderForm","fields","pageData","sort","f","cellHeight","verticalMargin","$valid","$digest","inputs","first","focus","gridstack","watcher","parentWatcher","field","runExpressions","noop","hideExpression","$parent","_initHiddenWatcher","grid","update","START_REC","connecting","callbackPromise","STOP_REC","status","Render_wwwRequestSvc"],"mappings":"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","sourcesContent":["(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render', [])\n        .directive('scriptRender', Directive);\n\n    function Directive() {\n        return {\n            restrict: 'E',\n            scope: {\n                uii: '@',\n                config: '=',\n                callbacks: '='\n            },\n            templateUrl: 'scriptRender/render.tpl.html',\n            link: function(scope, element, attrs) {\n\n            },\n            controller: function ($scope, $element, $timeout,\n                                  Render_ScriptSvc, Router, NavSvc, htmlElementFactory,\n                                  RENDER_TOOL_TYPES) {\n\n                _init();\n                function _init() {\n                    for(var key in RENDER_TOOL_TYPES) {\n                        Router.when(RENDER_TOOL_TYPES[key].type, RENDER_TOOL_TYPES[key]);\n                    }\n\n                    if(uiiListener) {\n                        uiiListener();\n                    }\n\n                    if($scope.uii){\n                        $scope.uii = $scope.uii.toString();\n                    }\n\n                    // don't load the directive until we have a script object\n                    var uiiListener = $scope.$watch('uii', function(newUii, oldUii) {\n                            if(newUii && $scope.config) {\n                                NavSvc.reset(newUii);\n                                Router.init(newUii);\n                                Router.onRouteChange('updateLastNav', _trackNav);\n                                $scope.scriptId = $scope.config.scriptId;\n                                $scope.scriptName = $scope.config.name;\n\n                                $scope.callbacks.getScriptData().then(function(initialModel) {\n                                    $scope.model = $scope.config.scriptResult || initialModel;\n                                    $scope.config.scriptResult = $scope.model;\n\n                                    //$scope.config.navPosition = $scope.config.navPosition || 'start';\n                                    $scope.config.navPosition = 'start';\n\n                                    Render_ScriptSvc.setConfig($scope.config, $scope.callbacks);\n                                    NavSvc.lookupGoTo($scope.config.navPosition, false);\n                                });\n                            }\n                        }\n                    );\n\n                    $scope.$on(\"$destroy\", function() {\n                        uiiListener();\n                        Router.removeUii($scope.uii);\n                        Render_ScriptSvc.removeUii($scope.uii);\n                    });\n\n                    function _trackNav(toRoute, fromRoute, params) {\n                        if(params && params.node) {\n                            var nodeId = params.node.id;\n                            if(params.parentId) {\n                                nodeId = [params.parentId, nodeId].join('.');\n                            }\n                            $scope.model.renderFormValid = true;\n                            Render_ScriptSvc.setScriptResult($scope.model);\n                            $scope.config.navPosition = nodeId;\n\n                        }\n                    }\n                }\n            }\n        };\n    }\n})();\n\nangular.module('scriptingStudio.render').run(['$templateCache', function($templateCache) {$templateCache.put('scriptRender/render.tpl.html','<div id=\"renderMain\" class=\"container-fluid\">\\n\\t<div class=\"render-router-view\" render-router-view></div>\\n</div>\\n');\n$templateCache.put('scriptRender/tools/executing.tpl.html','<div class=\"container-fluid\">\\n\\t<md-progress-linear md-mode=\"indeterminate\"></md-progress-linear>\\n\\n\\t<h4 class=\"executing-node text-center\">\\n\\t\\texecuting {{ node.label }}...\\n\\t</h4>\\n</div>\\n');\n$templateCache.put('scriptRender/tools/endScript/EndScript.tpl.html','<div class=\"container-fluid\">\\n\\t<h2>Script Result</h2>\\n\\t<div ng-repeat=\"(key, value) in model.model\">\\n\\t\\t<label>{{key}}</label>\\n\\t\\t<span> - {{value}}</span>\\n\\t</div>\\n</div>\\n');\n$templateCache.put('scriptRender/tools/page/Page.tpl.html','<ng-form class=\"render-form\" name=\"renderForm\" role=\"form\">\\n\\t<div class=\"grid-stack render-stack gridRender_{{ ::uii }}\">\\n\\t\\t<div class=\"grid-stack-item\"\\n\\t\\t\\t ng-repeat=\"field in ::fields track by field.id\"\\n\\t\\t\\t data-gs-id=\"{{ ::field.type.concat(\\'_\\').concat($index) }}\"\\n\\t\\t\\t data-gs-x=\"{{ ::field.data.layout.x }}\"\\n\\t\\t\\t data-gs-y=\"{{ ::field.data.layout.y }}\"\\n\\t\\t\\t data-gs-width=\"{{ ::field.data.layout.w }}\"\\n\\t\\t\\t data-gs-height=\"{{ ::field.data.layout.h }}\"\\n\\t\\t\\t data-gs-no-move=\"true\"\\n\\t\\t\\t data-gs-no-resize=\"true\"\\n\\t\\t\\t cf-gridstack-layout\\n\\t\\t\\t ng-show=\"visible\">\\n\\n\\t\\t\\t<div class=\"grid-stack-item-content\"\\n\\t\\t\\t     ng-if=\"field.type === \\'view\\' ? true : visible\"\\n\\t\\t\\t\\t formly-field data-get-value=\"getValue\"\\n\\t\\t\\t\\t data-model=\"model\"\\n\\t\\t\\t\\t data-options=\"field\">\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t</div>\\n</ng-form>\\n');\n$templateCache.put('scriptRender/tools/recording/recording.tpl.html','<div class=\"container-fluid recording\">\\n\\t<h3>\\n\\t\\t<i class=\"fa fa-circle fa-fw\" ng-class=\"{ \\'active\\':status, \\'connecting\\':connecting }\"></i>\\n\\t\\tRecording\\n\\n\\t\\t<small>\\n\\t\\t\\tStatus: {{ status ? \\'Recording\\' : \\'Not Recording\\' }}\\n\\t\\t</small>\\n\\t</h3>\\n</div>\\n');\n$templateCache.put('scriptRender/tools/startScript/StartScript.tpl.html','<div class=\"container-fluid\">\\n\\tloading...\\n</div>\\n');}]);\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .constant('DATA_TYPES', {\n            'ARRAY': 'ARRAY',\n            'OBJECT': 'OBJECT',\n            'CONSTANT': 'CONSTANT',\n            'FIELD': 'FIELD'\n        });\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .constant('RENDER_TOOL_TYPES', {\n            \"START_SCRIPT\": {\n                type: \"start\",\n                controller: \"StartScriptCtrl\",\n                templateUrl: \"scriptRender/tools/startScript/StartScript.tpl.html\"\n            },\n            \"END_SCRIPT\": {\n                type: \"end\",\n                controller: \"EndScriptCtrl\",\n                templateUrl: \"scriptRender/tools/endScript/EndScript.tpl.html\"\n            },\n            \"PAGE\": {\n                type: \"page\",\n                controller: \"PageCtrl\",\n                templateUrl: \"scriptRender/tools/page/Page.tpl.html\"\n            },\n            \"WWW\": {\n                type: \"www\",\n                controller: \"WwwCtrl\",\n                templateUrl: \"scriptRender/tools/executing.tpl.html\"\n            },\n            \"SCRIPT\": {\n                type: \"javascript\",\n                controller: \"JavascriptCtrl\",\n                templateUrl: \"scriptRender/tools/executing.tpl.html\"\n            },\n            \"SWITCH\": {\n                type: \"switch\",\n                controller: \"JavascriptCtrl\",\n                templateUrl: \"scriptRender/tools/executing.tpl.html\"\n            },\n            \"DATA_BUILDER\": {\n                type: \"dataBuilder\",\n                controller: \"JavascriptCtrl\",\n                templateUrl: \"scriptRender/tools/executing.tpl.html\"\n            },\n            \"START_REC\": {\n                type: \"startRecording\",\n                controller: \"RecordingCtrl\",\n                templateUrl: \"scriptRender/tools/recording/recording.tpl.html\"\n            },\n            \"STOP_REC\": {\n                type: \"stopRecording\",\n                controller: \"RecordingCtrl\",\n                templateUrl: \"scriptRender/tools/recording/recording.tpl.html\"\n            },\n            \"MAPPING\": {\n                type: \"mapping\",\n                controller: \"MappingCtrl\",\n                templateUrl: \"scriptRender/tools/executing.tpl.html\"\n            }\n        });\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .directive('bindHtmlUnsafe', bindHtmlUnsafe);\n\n    function bindHtmlUnsafe($compile) {\n        return {\n            restrict: 'A',\n            controller: function($scope) {\n                $scope.$on('$destroy', function () {\n                    if ($scope.nameWatcher) {\n                        $scope.nameWatcher();\n                        $scope.nameWatcher = null;\n                    }\n                });\n            },\n            link: function(scope, element, attrs) {\n                var htmlName = attrs.bindHtmlUnsafe;\n\n                scope.nameWatcher = scope.$watch(htmlName, function (newVal) {\n                    if (newVal) {\n                        _compile(newVal);\n                    }\n                });\n\n                function _compile(newHTML) {\n                    newHTML = $compile(newHTML)(scope);\n                    element.html(newHTML);\n                }\n            }\n        };\n    }\n})();\n\n(function(){\n    'use strict';\n\n    angular.module('scriptingStudio.render')\n        .directive('cfValidator', Directive);\n\n    function Directive(){\n        return {\n            require: 'ngModel',\n            scope : {\n                cfRequired : '='\n            },\n            link: function (scope, element, attrs, modelCtrl) { // modelCtrl = ngModel\n\n                scope.$watch(function(){\n                    if(angular.isDefined(modelCtrl.$modelValue)){\n                        return modelCtrl.$modelValue.length;\n                    }\n                }, function(){\n                    if(angular.isDefined(modelCtrl.$modelValue) && !modelCtrl.$modelValue.length && scope.cfRequired){\n                        modelCtrl.$setValidity('required', false);\n\n                    }else if(angular.isDefined(modelCtrl.$modelValue) &&  modelCtrl.$modelValue.length){\n                        modelCtrl.$setValidity('required', true);\n                    }\n                });\n\n            }\n        };\n    }\n\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .directive('renderDatePicker', Directive);\n\n    function Directive() {\n        return {\n            restrict: 'A',\n            require: 'ngModel',\n            scope: {\n                ngModel: '='\n            },\n\n            link: function(scope, element, attrs, controller) {\n                element.attr('id', (new Date()).getTime());\n\n                scope.format = 'MM/DD/YYYY';\n                if(attrs.timePicker) {\n                    scope.format += ' hh:mm a';\n                }\n\n                element.datetimepicker({\n                    format: scope.format,\n                    keepInvalid: true,\n                    useCurrent: true,\n                    timeZone: '',\n                    widgetParent: jQuery(element).closest('.grid-stack-item')\n                });\n\n                element.on('dp.change', function(e) {\n                    scope.ngModel = moment(e.date).format(scope.format);\n                });\n            }\n        };\n    }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n        .module('scriptingStudio.render')\n        .directive('scriptingInputJavascript', Directive)\n        .constant('INPUT_JAVASCRIPT_TRIGGER_TYPES', {\n            \"BLUR\": \"BLUR\",\n            \"CHANGE\": \"CHANGE\",\n            \"CLICK\": \"CLICK\"\n        });\n\n    function Directive($timeout,\n                       Render_javascriptExecutor,\n                       INPUT_JAVASCRIPT_TRIGGER_TYPES) {\n        return {\n            restrict: 'A',\n            require: \"?ngModel\",\n            link: function(scope, element, attrs, ngModelCtrl) {\n                var script = scope.options &&\n                             scope.options.data &&\n                             scope.options.data.javascript &&\n                             scope.options.data.javascript.script;\n\n                if(script && script.length > 0) {\n                    $timeout(function() {\n                        var input = element.parent().find(':input');\n                        if(input && !input[0]) {\n                            input = element;\n                        }\n\n                        switch(scope.options.data.javascript.trigger) {\n                            case(INPUT_JAVASCRIPT_TRIGGER_TYPES.BLUR):\n                                input\n                                    .on('blur', function() {\n                                        _evalScript();\n                                    });\n                                break;\n                            case(INPUT_JAVASCRIPT_TRIGGER_TYPES.CHANGE):\n                                if(ngModelCtrl) {\n                                    scope.$watch(function () {\n                                        if(ngModelCtrl.$modelValue && angular.isArray(ngModelCtrl.$modelValue)) {\n                                            return ngModelCtrl.$modelValue.length\n                                        } else {\n                                            return ngModelCtrl.$modelValue;\n                                        }\n                                    }, _.debounce(function(newVal, oldVal) {\n                                        if(newVal !== oldVal) {\n                                            _evalScript();\n                                        }\n                                    }, scope.options.data.javascript.delay));\n                                } else {\n                                    input\n                                        .on('change', _.debounce(function() {\n                                            _evalScript();\n                                        }, scope.options.data.javascript.delay));\n                                }\n\n                                break;\n                            case(INPUT_JAVASCRIPT_TRIGGER_TYPES.CLICK):\n                                input\n                                    .on('click', function() {\n                                        _evalScript();\n                                    });\n                                break;\n                        }\n                    });\n                }\n\n                function _evalScript() {\n                    Render_javascriptExecutor.execute(scope, scope.options.data.javascript.script);\n                }\n            }\n        };\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .factory('JavascriptBuilder', JavascriptBuilder);\n\n    function JavascriptBuilder() {\n        var goTo = 'goTo',\n            getData = 'getData',\n            putData = 'putData';\n\n        function generateJavascript(connections) {\n            var result = '\\n\\n',\n                conn;\n\n            if(connections.length > 0) {\n                conn = connections[0];\n            }\n\n            if(conn) {\n                result += _buildGoTo(conn.target);\n                result += '\\n';\n            }\n\n            return result;\n        }\n\n        function generateSwitch(tool) {\n            var result = '';\n\n            if(tool.properties) {\n                _.each(tool.properties.switchCases, function(sc) {\n                    result += 'if(';\n                    _.each(sc.comparisons, function(comp, index) {\n                        if(comp.modelAttr && comp.value) {\n                            if(index > 0) {\n                                result += ' ';\n                                result += comp.join;\n                                result += ' ';\n                            }\n\n                            result += _buildGetData(comp.modelAttr);\n                            result += comp.comparator;\n                            result += ' ';\n                            result += _buildGetData(comp.value);\n                        }\n                    });\n                    result += ') {\\n\\t';\n                    result += _buildGoTo(sc.action);\n                    result += '\\n}\\n\\n';\n                });\n            }\n\n            return result;\n        }\n\n        function generateDataBuilder(tool) {\n            var result = '',\n                conn;\n\n            result += putData;\n            result += '(\"';\n            result += tool.label;\n            result += '\", ';\n            result += JSON.stringify(tool.properties.data);\n            result += ');\\n';\n\n            if(tool.connections.length > 0) {\n                conn = tool.connections[0];\n            }\n\n            if(conn) {\n                result += _buildGoTo(conn.target);\n            }\n            return result;\n        }\n\n        function _buildGoTo(dest) {\n            var result = 'return ';\n            result += goTo;\n            result += '(\"';\n            result += dest;\n            result +='\");\\n';\n\n            return result;\n        }\n\n        function _buildGetData(attr) {\n            var result = '';\n            result += getData;\n            result += '(\"';\n            result += attr;\n            result += '\") ';\n\n            return result;\n        }\n\n        return {\n            generateJavascript: generateJavascript,\n            generateSwitch: generateSwitch,\n            generateDataBuilder: generateDataBuilder\n        };\n    }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n        .module('scriptingStudio.render')\n        .factory('Render_javascriptExecutor', Factory);\n\n    function Factory(Render_ScriptSvc,\n                     Render_objectSvc,\n                     NavSvc) {\n        var utils = {\n            execute: execute\n        };\n\n        function execute(scope, script) {\n            _jsClosure(scope, script);\n        }\n\n        function _jsClosure(scope, script) {\n            var $scope = scope,\n                callbacks = Render_ScriptSvc.getCallbacks(),\n                model = scope.model,\n                brackets = new RegExp(/({{).*(}})/g);\n\n            function getData(name) {\n                if(name.indexOf(\"model.\") === 0 && !name.match(brackets)){\n                    name = '{{' + name + '}}';   // byString expects braces\n                }\n                var result = Render_objectSvc.byString(scope, name);\n                try {\n                    var parsed = JSON.parse(result);\n                    result = parsed;\n                } catch(e) {\n                    // do nothing\n                }\n\n                return result;\n            }\n\n            function putData(attr, data) {\n                scope.model['model'][attr] = data;\n            }\n\n            function startRecording() {\n                callbacks.setRecordingState(true);\n            }\n\n            function stopRecording() {\n                callbacks.setRecordingState(false);\n            }\n\n            function holdCall() {\n                callbacks.setHoldState(true);\n            }\n\n            function resumeCall() {\n                callbacks.setHoldState(false);\n            }\n\n            function coldRequeue(gateId, skillId) {\n                callbacks.requestColdRequeue(gateId, skillId);\n            }\n\n            function warmRequeue(gateId, skillId) {\n                callbacks.requestWarmRequeue(gateId, skillId);\n            }\n\n            function hangup() {\n                callbacks.requestHangup();\n            }\n\n            function coldTransfer(dialDest, callerId) {\n                callbacks.requestColdTransfer(dialDest, callerId);\n            }\n\n            function warmTransfer(dialDest, callerId) {\n                callbacks.requestWarmTransfer(dialDest, callerId);\n            }\n\n            function dispositionCall(disposition, notes, isCallback, contactForwardNum, callbackDts) {\n                // look up dispositions\n                var disps = scope.model.call.dispositions,\n                    uii = scope.model.call.uii;\n                var disp = _.find(disps, function(d) {\n                    return d.disposition.toUpperCase() === disposition.toUpperCase();\n                });\n\n                if(disp) {\n                    callbacks.requestDisposition(uii, disp, notes, isCallback, contactForwardNum, callbackDts);\n                } else {\n                    console.error('disposition doesnt exist', disposition, disps);\n                }\n            }\n\n            function changeScript(scriptId) {\n                callbacks.changeScript(scope.model.call.uii, scriptId);\n            }\n\n            function goTo(state) {\n                NavSvc.goTo({id:state, label:state});\n            }\n\n            try {\n                // execute the saved script\n                var scriptWrapper = '(function() {';\n                scriptWrapper += script;\n                scriptWrapper += '})();';\n\n                eval(scriptWrapper);   // jshint ignore:line\n\n            } catch(error) {\n                console.error(\"error in eval javascript\", error);\n            }\n        }\n\n        return utils;\n    }\n\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .factory('NavSvc', Service);\n\n    function Service(RENDER_TOOL_TYPES, Render_ScriptSvc, Router) {\n        var isFirstPage = true;\n\n        Service.lookupGoTo = function(toolId, trackHistory) {\n            var goToId = toolId,\n                params = {};\n            if(toolId && toolId.indexOf('.') > -1) {\n                var parts = toolId.split('.');\n                goToId = parts[0];\n                params.forwardNode = parts[1];\n                params.trackHistory = trackHistory;\n            }\n\n            Service.goTo(Service.asId(goToId), params, trackHistory);\n        };\n\n        Service.current = function() {\n            return Router.getCurrent();\n        };\n\n        Service.next = function() {\n            // get connected node, explictly go to it\n            var curr = Service.current(),\n                conn = curr && curr.resolve.node.connections[0],\n                isActive = conn && conn.type.length > 0;\n\n            if(angular.isDefined(conn) && isActive && angular.isDefined(conn.target)) {\n                Service.goTo(Service.asId(conn.target));\n            }\n        };\n\n        Service.prev = function() {\n            Router.goBack();\n        };\n\n        Service.goTo = function(tool, params, trackHistory) {\n            var next = _findTool(tool);\n\n            if(angular.isDefined(next)) {\n                params = params || {};\n                params.node = next;\n\n\n                var current = Service.current(),\n                    currNode = current && current.resolve && current.resolve.node,\n                    conn = currNode && currNode.connections && currNode.connections[0];\n                params.isNestedView = (angular.isDefined(params.isNestedView) && params.isNestedView) ||\n                                        (conn && conn.type.indexOf('nestedPage') > -1);\n\n                // init the first page of type to disable nav\n                if(next.type === RENDER_TOOL_TYPES.PAGE.type && isFirstPage) {\n                    params.isFirstPage = true;\n                    isFirstPage = false;\n                }\n\n                if(params.isNestedView) {\n                    params.parentId = Service.current().resolve.node.id;\n                } else if(current && current.resolve && current.resolve.isNestedView) {\n                    params.parentId = current.resolve.parentId;\n                }\n\n                Router.go(next.type, params, trackHistory);\n            }\n        };\n\n        Service.reset = function(uii) {\n            Router.setNestedView(false);    // reset for now\n            Router.setCurrentRoute(null);   // don't track where we were\n\n            // set the first page tracker\n            var history = Router.getHistory()[uii];\n            if(history) {\n                // see if there are any pages with the param isFirstPage\n                var firstPageInHistory = _.some(history, function(p) {\n                    return p.resolve && p.resolve.isFirstPage;\n                });\n\n                isFirstPage = !firstPageInHistory;\n            } else {\n                isFirstPage = true;\n            }\n        };\n\n        Service.setIsFirstPage = function(state) {\n            isFirstPage = state;\n        };\n\n        Service.getIsFirstPage = function() {\n            return isFirstPage;\n        };\n\n        function _findTool(tool) {\n            var found = _.find(Render_ScriptSvc.getScript().data.tools, function(s) {\n                return s.id === tool.id || tool.label === s.label;\n            });\n\n            return found;\n        }\n\n        Service.asId = function(str) {\n            return {id: str};\n        };\n\n        return Service;\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .service('Render_objectSvc', ObjectService);\n\n    function ObjectService(DATA_TYPES, $interpolate) {\n        ObjectService.byString = function(scope, string, allOrNothing) {\n            if(string && angular.isString(string)) {\n                string = string.trim();\n                if(string.indexOf('model.') === 0 && string.indexOf(\"{{\") === -1 && string.indexOf(\"}}\") === -1) {\n                    string = '{{' + string + '}}';\n                }\n\n                if(allOrNothing) {\n                    return $interpolate(string, false, null, true)(scope);\n                } else {\n                    return $interpolate(string)(scope);\n                }\n            }\n        };\n\n        ObjectService.getType = function (obj) {\n            if (angular.isArray(obj)) {\n                return DATA_TYPES.ARRAY;\n            } else if (angular.isObject(obj)) {\n                return DATA_TYPES.OBJECT;\n            } else {\n                return DATA_TYPES.CONSTANT;\n            }\n        };\n\n        return ObjectService;\n    }\n})();\n\n(function() {\n    // http://plnkr.co/edit/u03zden3OtK1LFK25bSP?p=preview\n\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .provider('Router', Provider);\n\n    function Provider() {\n        var callbackStack = {},\n            routes = {},\n            history = {},\n            currentRoute = {},\n            isNestedView = false,\n            stateParams;\n\n        this.when = setPath;\n\n        this.setCurrent = function(path) {\n            currentRoute[stateParams.uii] = routes[path];\n        };\n\n        function setPath(path, config) {\n            config.path = path;\n            routes[path] = config;\n            return this;\n        }\n\n        function triggerChange(toRoute, fromRoute, params, trackHistory) {\n            params = params || {};\n            params.isNestedView = isNestedView;\n            toRoute.resolve = params;\n            currentRoute[stateParams.uii] = toRoute;\n\n            if(trackHistory && fromRoute &&\n                (fromRoute.controller !== 'JavascriptCtrl' &&\n                fromRoute.controller !== 'RecordingCtrl' &&\n                fromRoute.controller !== 'WwwCtrl' )) {\n\n                history[stateParams.uii].push(fromRoute);\n            }\n\n            for(var key in callbackStack[stateParams.uii]) {\n                callbackStack[stateParams.uii][key](toRoute, fromRoute, params);\n            }\n        }\n\n        this.$get = function($stateParams) {\n            stateParams = $stateParams;\n            return {\n                onRouteChange: function(key, callback) {\n                    if(!callbackStack[stateParams.uii]) {\n                        callbackStack[stateParams.uii] = {};\n                    }\n\n                    callbackStack[stateParams.uii][key] = callback;\n                },\n                go: function(path, params, trackHistory) {\n                    if(!path || !routes[path]) {\n                        return currentRoute[stateParams.uii];\n                    }\n\n                    if(angular.isDefined(params) && params.isNestedView) {\n                        isNestedView = params.isNestedView;\n                    }\n\n                    trackHistory = angular.isDefined(trackHistory) ? trackHistory : true;\n                    triggerChange(angular.copy(routes[path]), angular.copy(currentRoute[stateParams.uii]), params, trackHistory);\n                },\n                goBack: function() {\n                    var lastRoute = history[stateParams.uii].length > 0 && history[stateParams.uii].pop() || null;\n\n                    if(lastRoute && !lastRoute.path) {\n                        return currentRoute[stateParams.uii];\n                    }\n\n                    triggerChange(lastRoute, currentRoute[stateParams.uii], lastRoute.resolve);\n                },\n                init: function(renderUii) {\n                    if(!history[renderUii]) {\n                        history[renderUii] = [];\n                    }\n\n                    if(!currentRoute[renderUii]) {\n                        currentRoute[renderUii] = {};\n                    }\n\n                    if(!callbackStack[renderUii]) {\n                        callbackStack[renderUii] = {};\n                    }\n                },\n                when: function(path, config) {\n                    setPath(path, config);\n                },\n                getCurrent: function() {\n                    return currentRoute[stateParams.uii];\n                },\n                setNestedView: function(state) {\n                    isNestedView = state;\n                },\n                setCurrentRoute: function(route) {\n                    currentRoute[stateParams.uii] = route;\n                },\n                getHistory: function() {\n                    return history;\n                },\n                removeUii: function(uii) {\n                    delete callbackStack[uii];\n                    delete history[uii];\n                    delete currentRoute[uii];\n                }\n            };\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .directive('renderRouterView', Directive);\n\n    function Directive($compile, $controller, $templateCache,\n                       Router) {\n        return {\n            priority: 1,\n            restrict: 'A',\n            template: '<div id=\"scriptView_{{ uii }}\"></div>',\n            controller: function($scope, $stateParams) {\n                $scope.uii = $stateParams.uii.toString();\n\n            },\n            link: function(scope, element, attrs) {\n                scope.compile = compile;\n                Router.onRouteChange('updateView', _trackView);\n\n                function compile(newRoute) {\n                    var params = {\n                        $scope: scope\n                    };\n\n                    var elemHtml =\n                        '<div>' +\n                        $templateCache.get(newRoute.templateUrl) +\n                        '</div>';\n\n                    var foundElement = jQuery(scope.isNestedView ? '#nestedScriptView_' + (scope.uii || '') : '#scriptView_' + (scope.uii || ''));\n                    var html = angular.element(elemHtml);\n                    foundElement.html(html);\n                    $controller(newRoute.controller, params);\n                    $compile(foundElement.contents())(scope);\n                }\n\n                function _trackView(newRoute, oldRoute, newParams) {\n                    for(var key in newParams) {\n                        scope[key] = newParams[key];\n                    }\n\n                    if(scope.compile) {\n                        scope.compile(newRoute);\n                    }\n                }\n            }\n        };\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .factory('Render_ScriptSvc', Service);\n\n    function Service($stateParams, Render_objectSvc) {\n        var script = {},\n            callbacks = {};\n\n        Service.setConfig = function(config, agentCallbacks) {\n            script[$stateParams.uii] = config;\n            callbacks[$stateParams.uii] = agentCallbacks;\n\n            if(!angular.isDefined(callbacks[$stateParams.uii].setScriptResult)) { console.warn('setScriptResult not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].setRecordingState)) { console.warn('setRecordingState not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].setHoldState)) { console.warn('setHoldState not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].requestColdRequeue)) { console.warn('requestColdRequeue not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].requestWarmRequeue)) { console.warn('requestWarmRequeue not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].requestHangup)) { console.warn('requestHangup not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].getScriptData)) { console.warn('getScriptData not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].requestColdTransfer)) { console.warn('requestColdTransfer not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].requestWarmTransfer)) { console.warn('requestWarmTransfer not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].requestDisposition)) { console.warn('requestDisposition not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].changeScript)) { console.warn('changeScript not defined'); }\n\n            if(!angular.isDefined(callbacks[$stateParams.uii].allowSendKbArticle)) { console.warn('allowSendKbArticle not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].sendKbArticle)) { console.warn('sendKbArticle not defined'); }\n            if(!angular.isDefined(callbacks[$stateParams.uii].getKnowledgeBaseArticles)) { console.warn('getKnowledgeBaseArticles not defined'); }\n        };\n\n        Service.removeUii = function(uii) {\n            delete script[uii];\n        };\n\n        Service.getScript = function() {\n            return script[$stateParams.uii];\n        };\n\n        Service.getCallbacks = function() {\n            return callbacks[$stateParams.uii];\n        };\n\n        Service.setScriptResult = function(scope) {\n            var modelCopy = angular.copy(scope);\n\n            if(modelCopy.dataMaps) {\n                var flattened = {};\n                _.each(modelCopy.dataMaps, function(map) {\n                    _.each(map, function(value, key) {\n                        value.key = key;\n                        flattened[value.reportAs] = value;\n                    });\n                });\n\n                for(var key in flattened) {\n                    var value = flattened[key],\n                        modelVal = Render_objectSvc.byString(modelCopy, '{{model.' + value.key + '}}', true);\n\n                    if( value.report &&\n                        angular.isDefined(modelVal)) {\n\n                        var reportKey = value.reportAs;\n\n                        modelCopy.model[reportKey] = {\n                            value: modelVal,\n                            leadField: value.leadField\n                        };\n                    }\n                }\n            } else {\n                // no maps set, just keep everything\n                _.each(modelCopy.model, function(value, key) {\n                    modelCopy.model[key] = {\n                        value: value,\n                        leadField: ''\n                    };\n                });\n            }\n\n            return Service.getCallbacks().setScriptResult(modelCopy);\n        };\n\n        return Service;\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .service('SortSvc', Service);\n\n    function Service() {\n        var utils = {\n            byLayout: byLayout\n        };\n\n        return utils;\n\n        // order by layout.y, if on the same y, order by layout.x\n        function byLayout(a, b) {\n            if(a.data.layout.y > b.data.layout.y) {\n                return 1;\n            }\n\n            if(a.data.layout.y < b.data.layout.y) {\n                return -1;\n            }\n\n            if(a.data.layout.y === b.data.layout.y) {\n                if(a.data.layout.x > b.data.layout.x) {\n                    return 1;\n                } else {\n                    return -1;\n                }\n            }\n\n            return 0;\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .service('Render_wwwRequestSvc', Service);\n\n    function Service($q, Render_objectSvc) {\n        var executing = false;  // limit execution to just 1 at a time\n        Service.execute = function(props, scope) {\n            var defer = $q.defer();\n            var opts = {\n                url: angular.copy(props.url),\n                method: props.method,\n                crossDomain: true,\n                headers: {},\n                success: function(result) {\n                    defer.resolve(result);\n                },\n                error: function(error) {\n                    defer.reject(error);\n                },\n                complete: function() {\n                    //defer.resolve(true);\n                    executing = false;\n                }\n            };\n\n            if((props.method === 'PUT' || props.method === 'POST' || props.method === 'PATCH') && props.bodyType) {\n                var type = '';\n                switch(props.bodyType) {\n                    case('FORM'):\n                        type = 'application/x-www-form-urlencoded';\n                        opts.type = false;\n                        opts['data'] = _getFormBody();\n                        break;\n                    case('JSON'):\n                        type = 'application/json';\n                        opts['data'] = _getBody();\n                        break;\n                    case('XML'):\n                        type = 'text/xml';\n                        opts['data'] = _getBody();\n                        break;\n                    case('TEXT'):\n                        type = 'text/plain';\n                        opts['data'] = _getBody();\n                        break;\n                    default:\n                        console.warn('invalid body type requested');\n                }\n\n                opts['headers']['Content-Type'] = type;\n            }\n\n            if(props.params) {\n                _.each(props.params, function(p) {\n                    opts.url = opts.url.replace(':' + p.name, _getValue(p));\n                });\n            }\n\n            if(props.headers.length) {\n                _.each(props.headers, function(h, index) {\n                    opts['headers'][h.name] = _getValue(h);\n                });\n            }\n\n            function _getFormBody() {\n                var form = {};\n                _.each(props.variables, function(variable) {\n                    form[variable.name] = _getValue(variable);\n                });\n\n                return form;\n            }\n\n            function _getBody() {\n                var result = angular.copy(props.body),\n                    brackets = new RegExp(/\\{{2}.*?\\}{2}/g),\n                    tag,\n                    mockValue = {value:undefined};\n\n                while(tag = brackets.exec(props.body)) {\n                    mockValue.value = tag[0];\n                    result = result.replace(new RegExp(tag[0], 'g'), _getValue(mockValue));\n                }\n\n                return result;\n            }\n\n            function _getValue(val) {\n                var modelVal = Render_objectSvc.byString(scope, val.value),\n                    result = modelVal;\n                if(angular.isDefined(modelVal) &&\n                    _.isObject(modelVal) &&\n                    ('data' in modelVal) ) {   // modelVal exists, check for 'data' key\n\n                        result = modelVal.data;\n                }\n\n                return result;\n            }\n\n            if(!executing) {\n                executing = true;\n                jQuery.ajax(opts);\n            }\n\n            return defer.promise;\n        };\n\n        return Service;\n    }\n})();\n\n(function() {\n\n    // https://github.com/formly-js/angular-formly-templates-bootstrap\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .factory('htmlElementFactory', Factory);\n\n    function Factory(formlyConfig, $timeout) {\n        var utils = {\n                getAvailableHtml: getAvailableHtml,\n                getConfigs: getConfigs\n            },\n            that = this;\n\n        /**\n         * filters all available types and removes any we don't want the user to see\n         *\n         * @returns  object with available formly types\n         */\n        function getAvailableHtml() {\n            var allTypes = formlyConfig.getTypes();\n            var blockedTypes = ['multiCheckbox', 'select'];\n            var resultObj = {};\n\n            _.each(allTypes, function(value, key) {\n                if (blockedTypes.indexOf(key) === -1) {\n                    resultObj[key] = value;\n                }\n            });\n\n            return resultObj;\n        }\n\n        function getConfigs(type) {\n            type = type || '';\n            var configs = {\n                    hasKey: true,\n                    hasLabel: true\n                },\n                configFunc = type.concat('Configs'),\n                typeConfigs = {};\n\n            if(angular.isDefined(type) && angular.isDefined(that[configFunc])) {\n                typeConfigs = that[configFunc]();\n            }\n\n            return angular.extend({}, configs, typeConfigs);\n        }\n\n\n        /**\n         *  Configs for all formly types.\n         *  We use these to display the correct\n         *  fields on the edit form\n         */\n        this.checkboxConfigs = function() {\n            return {\n                hasSource: true,\n                hasOptions:true,\n                hasRequired: true,\n                hasInlineStyle:true,\n                hasMultipleDefaults: true,\n                hasScripting: true\n            };\n        };\n\n        this.inputConfigs = function() {\n            return {\n                hasPlaceholder: true,\n                hasDefaultValue: true,\n                hasRequired: true,\n                hasInputTypes: true,\n                hasMaxLength: true,\n                hasScripting: true\n            };\n        };\n\n        this.hrConfigs = function() {\n            return {\n                hasKey: false,\n                hasLabel: false\n            };\n        };\n\n        this.emailConfigs = function() { return this.inputConfigs(); };\n\n        this.phoneConfigs = function() {\n            var configs = this.inputConfigs();\n            configs.hasMaxLength = false;\n            return configs;\n        };\n\n        this.numberConfigs = function() {\n            var configs = this.inputConfigs();\n            configs.hasMaxLength = false;\n            return configs;\n        };\n\n        this.customConfigs = function() {\n            var configs = this.inputConfigs();\n            configs.hasMaskInput = true;\n\n            return configs;\n        };\n\n        this.dateConfigs = function() {\n            var configs = this.inputConfigs();\n            configs.hasInputTypes = false;\n            configs.hasMaxLength = false;\n            configs.hasMaskInput = false;\n\n            return configs;\n        };\n\n        this.linkConfigs = function() {\n            return {\n                hasLabel: true,\n                hasKey: false,\n                hasHref: true,\n                hasScripting: true\n            };\n        };\n\n        this.imageConfigs = function() {\n            var link = this.linkConfigs();\n            link.hasScripting = false;\n            return link;\n        };\n\n        this.iFrameConfigs = function() {\n            var link = this.linkConfigs();\n            link.hasHref = false;\n            link.hasHttpsHref = true;\n            link.hasScripting = false;\n            return link;\n        };\n\n        this.radioConfigs = function() {\n            return {\n                hasSource: true,\n                hasOptions: true,\n                hasRequired: true,\n                hasDefaultValue: true,\n                hasInlineStyle: true,\n                hasScripting: true\n            };\n        };\n\n        this.selectConfigs = function() {\n            return {\n                hasSource: true,\n                hasDefaultValue: true,\n                hasOptions: true,\n                hasScripting: true\n            };\n        };\n\n        this.selectBoxConfigs = function() {\n            return {\n                hasSource: true,\n                hasOptions: true,\n                hasRequired: true,\n                hasPlaceholder: true,\n                hasDefaultValue: true,\n                hasScripting: true\n            };\n        };\n\n        this.multipleSelectBoxConfigs = function() {\n            return {\n                hasSource: true,\n                hasOptions: true,\n                hasRequired: true,\n                hasPlaceholder: true,\n                hasMultipleDefaults: true,\n                hasScripting: true\n            };\n        };\n\n        this.textareaConfigs = function() {\n            return {\n                hasPlaceholder: true,\n                hasDefaultValue: true,\n                hasRequired: true,\n                hasMaxLength: true,\n                hasScripting: true\n            };\n        };\n\n        this.buttonConfigs = function() {\n            return {\n                hasKey: false,\n                hasButtonSettings: true,\n                hasActionType: true,\n                hasNavigation: true,\n                hasScripting: true\n            };\n        };\n\n        this.navigationConfigs = function() {\n            return {\n                hasKey: false,\n                hasButtonSettings: true,\n                hasNavigationLabel: true\n            };\n        };\n\n        this.pageBreakConfigs = function() {\n            return {\n                hasLabel: false,\n                hasKey: false\n            };\n        };\n\n        this.viewConfigs = function() {\n            return {\n                hasViewConfig: true,\n                hasLabel: false,\n                hasKey: false\n            };\n        };\n\n        this.textConfigs = function() {\n            return {\n                hasLabel: false,\n                hasKey: false,\n                hasRichText: true\n            };\n        };\n\n        this.tableConfigs = function(){\n            return {\n                hasLabel: false,\n                hasSource: true,\n                hasRequired: false,\n                hasTableConfig: true\n            };\n        };\n\n        this.dispositionsConfigs = function() {\n            return {\n                hasKey: false,\n                hasSource: false,\n                hasOptions: false,\n                hasRequired: false,\n                hasDefaultValue: false,\n                hasPlaceholder: true,\n                hasDispositionDisplayType: true\n            };\n        };\n\n        this.knowledgeBaseConfigs = function() {\n            return {\n                hasLabel: false,\n                hasKey: false,\n                hasSource: false,\n                hasOptions: false,\n                hasRequired: false,\n                hasDefaultValue: false,\n                hasPlaceholder: false,\n                hasKnowledgeBase: true\n            };\n        };\n\n        function init() {\n            // config custom formly fields\n            formlyConfig.setType({\n                name:'radio',\n                wrapper: ['bootstrapLabel', 'bootstrapHasError'],\n                overwriteOk: true,\n                template:   '<md-radio-group layout=\"{{ to.isInline ? \\'row\\' : \\'column\\' }}\" ng-model=\"model[options.key]\" ng-required=\"to.required\" md-no-ink>' +\n                                '<md-radio-button ng-repeat=\"option in to.options\" ng-value=\"option.value\" aria-label=\"{{option.name}}\" class=\"md-accent\">' +\n                                    '{{ option.name }}' +\n                                '</md-radio-button>' +\n                            '</md-radio-group>',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    data: {\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    ngModelElAttrs: {\n                        'scripting-input-javascript': \"\"\n                    },\n                    link: function(scope, element, attrs) {\n                        element.on('$destroy', function() {\n                            scope.$destroy();\n                        });\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name:'checkbox',\n                wrapper: ['bootstrapLabel', 'bootstrapHasError'],\n                overwriteOk: true,\n                template:   '<div layout=\"{{ to.isInline ? \\'row\\' : \\'column\\' }}\" ng-model=\"model[keys[0]][keys[1]]\" cf-validator cf-required=\"to.required\">' +\n                                '<div ng-repeat=\"option in to.options\" flex-gt-sm=\"100\">' +\n                                    '<md-checkbox ng-click=\"toggleCheckbox(option.value)\" ng-checked=\"isChecked(option.value)\" ng-name=\"to.label\" ng-value=\"option.value\" aria-label=\"{{option.name}}\" class=\"md-accent\" md-no-ink>{{ option.name }}</md-checkbox>' +\n                                '</div>' +\n                            '</div>',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    data: {\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    ngModelElAttrs: {\n                        'scripting-input-javascript': \"\"\n                    },\n                    link: function(scope, elem, atts, modelCtrl) {\n                        scope.toggleCheckbox = toggleCheckbox;\n                        scope.isChecked = isChecked;\n\n                        var keys;\n\n                        _init();\n                        function _init() {\n                            if(scope.options && scope.options.key) {\n                                scope.keys = scope.options.key.split('.');\n                                keys = scope.keys;\n                                var modelArray = scope.model[keys[0]][keys[1]];\n                                if(!modelArray || !angular.isArray(modelArray)) {\n                                    scope.model[keys[0]][keys[1]] = [];\n                                }\n                            }\n                        }\n\n                        function isChecked(val) {\n                            var result = false,\n                                index = -1;\n\n                            if(angular.isDefined(keys)) {\n                                index = _isInModel(scope.model[keys[0]][keys[1]], val);\n\n                                if(index > -1) {\n                                    result = true;\n                                }\n                            }\n\n                            return result;\n                        }\n\n                        function toggleCheckbox(val) {\n                            if(angular.isDefined(keys)) {\n                                var index = _isInModel(scope.model[keys[0]][keys[1]], val);\n\n                                if(index > -1) {\n                                    (scope.model[keys[0]][keys[1]]).splice(index, 1);\n                                } else {\n                                    (scope.model[keys[0]][keys[1]]).push(val);\n                                }\n                            }\n                        }\n\n                        function _isInModel(model, val) {\n                            var index = _.findIndex(model, function(v) {\n                                return v === val;\n                            });\n\n                            return index;\n                        }\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name:'selectBox',\n                wrapper: ['bootstrapLabel', 'bootstrapHasError'],\n                template:   '<ui-select ui-select-custom ng-model=\"model[options.key]\" theme=\"bootstrap\" title=\"{{ to.label }}\" ng-required=\"to.required\" append-to-body=\"true\">' +\n                                '<ui-select-match placeholder=\"{{ options.templateOptions.placeholder }}\">{{$select.selected.name}}</ui-select-match>' +\n                                '<ui-select-choices repeat=\"option.value as option in to.options | filter: $select.search\">' +\n                                    '<span ng-bind-html=\"option.name | highlight: $select.search\"></span> ' +\n                                '</ui-select-choices>' +\n                            '</ui-select>',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    data: {\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    ngModelElAttrs: {\n                        'scripting-input-javascript': \"\"\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name:'multipleSelectBox',\n                wrapper: ['bootstrapLabel', 'bootstrapHasError'],\n                template:   '<ui-select multiple ng-model=\"model[options.key]\" theme=\"bootstrap\" title=\"{{ to.label }}\" append-to-body=\"true\" ng-required=\"to.required\" sortable=\"true\" close-on-select=\"false\">' +\n                                '<ui-select-match placeholder=\"{{ options.templateOptions.placeholder }}\">{{ $item.name }}</ui-select-match>' +\n                                    '<ui-select-choices repeat=\"option.value as option in to.options | filter: $select.search\">' +\n                                    '<span ng-bind-html=\"option.name | highlight: $select.search\"></span> - ' +\n                                    '<small ng-bind-html=\"option.value | highlight: $select.search\"></small>' +\n                                '</ui-select-choices>'+\n                            '</ui-select>',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    data: {\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    ngModelElAttrs: {\n                        'scripting-input-javascript': \"\"\n                    }\n                }\n            });\n\n            /**\n             *      type: 'button',\n             *      data: {\n             *          action: function() { goToPage('2'); }\n             *      },\n             *      templateOptions: {\n             *          label: 'save',\n             *          className: 'btn-default'\n             *      }\n             **/\n            formlyConfig.setType({\n                name: 'button',\n                template: '<button scripting-input-javascript ng-click=\"takeAction()\" class=\"btn\" ng-class=\"getClass()\" ng-disabled=\"isDisabled()\">{{ to.label | translate }}</button>',\n                defaultOptions: {\n                    controller: 'InputType_buttonCtrl',\n                    link: function(scope) {\n                        scope.getClass = function() {\n                            var result = 'btn-' + scope.options.data.class;\n                            result += ' btn-' + scope.options.data.size;\n\n                            return result;\n                        };\n                    },\n                    data: {\n                        ignoreModel: true,\n                        action: {\n                            type: 'navigation',\n                            view: 'goTo',\n                            location: 'next'\n                        },\n                        class: 'default',\n                        size: 'default',\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'navigation',\n                template:   '<div class=\"nav-buttons\">' +\n                                '<div class=\"prev\">' +\n                                    '<button ng-click=\"prev()\" class=\"btn\" ng-class=\"getClass()\" ng-disabled=\"isFirstPage()\">' +\n                                        '<i class=\"fa fa-fw fa-chevron-left\"></i>' +\n                                        '<span>{{ to.prevLabel }}</span>' +\n                                    '</button>' +\n                                '</div>' +\n                                '<div class=\"next\">' +\n                                    '<button ng-click=\"next()\" class=\"btn\" ng-class=\"getClass()\" ng-disabled=\"isDisabled()\">' +\n                                        '<span>{{ to.nextLabel }}</span>' +\n                                        '<i class=\"fa fa-fw fa-chevron-right\"></i>' +\n                                    '</button>' +\n                                '</div>' +\n                            '</div>',\n                defaultOptions: {\n                    controller: function($scope, NavSvc) {\n                        $scope.next = next;\n                        $scope.prev = prev;\n                        $scope.isFirstPage = isFirstPage;\n                        $scope.isDisabled = isDisabled;\n\n                        function next() {\n                            NavSvc.next();\n                        }\n\n                        function prev() {\n                            NavSvc.prev();\n                        }\n\n                        function isFirstPage() {\n                            return angular.isDefined(NavSvc.current()) && angular.isDefined(NavSvc.current().resolve) && NavSvc.current().resolve.isFirstPage || false;\n                        }\n\n                        function isDisabled() {\n                            if($scope.options.data.action) {\n                                var disableInvalid = $scope.options.data.action.disableInvalid && !$scope.model.renderFormValid;\n                                var prop = $scope.options.expressionProperties && $scope.options.expressionProperties['templateOptions.disabled'];\n                                return disableInvalid || prop && $parse(prop)($scope);\n                            } else {\n                                return false;\n                            }\n                        }\n                    },\n                    link: function(scope) {\n                        scope.getClass = function() {\n                            var result = 'btn-' + scope.options.data.class;\n                            result += ' btn-' + scope.options.data.size;\n\n                            return result;\n                        };\n                    },\n                    templateOptions: {\n                        prevLabel: \"Previous\",\n                        nextLabel: \"Next\"\n                    },\n                    data: {\n                        class: 'default',\n                        size: 'default'\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'input',\n                wrapper: ['bootstrapLabel', 'bootstrapHasError'],\n                overwriteOk: true,\n                template: '<input class=\"form-control\" ng-model=\"model[options.key]\" maxlength=\"{{options.templateOptions.maxLength}}\">',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    data: {\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    ngModelElAttrs: {\n                        'scripting-input-javascript': \"\"\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'phone',\n                extends: 'input',\n                template: '<input class=\"form-control\" mask=\"(999)999-9999\" ng-model=\"model[options.key]\" />'\n            });\n\n            formlyConfig.setType({\n                name: 'email',\n                extends: 'input',\n                template: '<input class=\"form-control\" type=\"email\" ng-model=\"model[options.key]\" />'\n            });\n\n            formlyConfig.setType({\n                name: 'number',\n                extends: 'input',\n                template: '<input class=\"form-control\" type=\"number\" ng-model=\"model[options.key]\" />'\n            });\n\n            formlyConfig.setType({\n                name: 'custom',\n                extends: 'input',\n                template: '<input class=\"form-control\" mask=\"{{ options.data.inputMask }}\" ng-model=\"model[options.key]\" />'\n            });\n\n            formlyConfig.setType({\n                name: 'date',\n                extends: 'input',\n                template: '<input render-date-picker class=\"form-control\" ng-model=\"model[options.key]\" />',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    templateOptions: {\n                        placeholder: 'mm/dd/yyyy'\n                    },\n                    link: function(scope, element, attrs) {\n\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'textarea',\n                wrapper: ['bootstrapLabel', 'bootstrapHasError'],\n                overwriteOk: true,\n                template: '<textarea class=\"form-control\" ng-model=\"model[options.key]\" maxlength=\"{{options.templateOptions.maxLength}}\"></textarea>',\n                defaultOptions: {\n                    controller: 'optionCtrl',\n                    data: {\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    ngModelElAttrs: {\n                        'scripting-input-javascript': \"\"\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'hr',\n                template: '<hr aria-label=\"page break\" ng-style=\"{\\'border-color\\':options.data.style.color}\">',\n                defaultOptions: {\n                    data: {\n                        ignoreModel: true\n                    }\n                }\n            });\n\n            /**\n             *      type: 'view'\n             *      templateOptions: {\n             *          viewName: 'header'\n             *      }\n             */\n\n            formlyConfig.setType({\n                name: 'view',\n                template: '<div class=\"row\" id=\"nestedScriptView_{{ uii }}\" nested-render-router-view data-name=\"{{options.data.view.name}}\"></div>',\n                defaultOptions: {\n                    data: {\n                        ignoreModel: true\n                    },\n                    controller: function($scope,\n                                         $timeout,\n                                         $stateParams,\n                                         NavSvc) {\n                        $scope.uii = $stateParams.uii;\n\n                        $timeout(function() {\n                            var curr = NavSvc.current(),\n                                forward, track;\n\n                            if(curr) {\n                                if(curr.resolve.forwardNode) {\n                                    forward = curr.resolve.forwardNode;\n                                    track = curr.resolve.trackHistory;\n                                } else if(curr.params && curr.params.forwardNode) {\n                                    forward = curr.params.forwardNode;\n                                    track = curr.params.trackHistory;\n                                }\n                            }\n\n                            if(forward) {\n                                NavSvc.goTo(NavSvc.asId(forward), {isNestedView: true}, track);\n                            } else if(!curr.resolve.isNestedView) {\n                                NavSvc.next();\n                            }\n                        });\n                    }\n                }\n            });\n\n            /**\n             *      type: 'text'\n             *      data: {\n             *          content: 'content text'\n             *      }\n             */\n\n            formlyConfig.setType({\n                name: 'text',\n                template: '<div ng-aria-label=\"options.data.content\" class=\"ql-editor\" bind-html-unsafe=\"options.data.content\"></div>',\n                defaultOptions: {\n                    data: {\n                        ignoreModel: true,\n                        content: 'page text area'\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'link',\n                template: '<a scripting-input-javascript href=\"{{ trustedUrl }}\" ng-style=\"getStyle()\" ng-alt=\"options.templateOptions.label\" target=\"_blank\">{{ options.templateOptions.label }}</a>',\n                defaultOptions: {\n                    data: {\n                        ignoreModel: true,\n                        urlPrefix: 'http://',\n                        javascript: {\n                            trigger: 'BLUR',\n                            delay: 250\n                        }\n                    },\n                    controller: 'externalSourceUrlCtrl',\n                    link: function(scope) {                        \n                        scope.getStyle = function() {\n                           var anchorColorObj = {\n                                \"color\" : scope.options.data.style.color\n                              };                            \n                            return anchorColorObj;\n                        };\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'image',\n                template: '<img alt=\"image\" ng-src=\"{{ trustedUrl }}\">',\n                defaultOptions: {\n                    data: {\n                        ignoreModel: true,\n                        urlPrefix: 'http://'\n                    },\n                    controller: 'externalSourceUrlCtrl'\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'iFrame',\n                template: '<iframe ng-src=\"{{ trustedUrl }}\" style=\"border:none;width:100%;height:100%;\"></iframe>',\n                defaultOptions: {\n                    data: {\n                        ignoreModel: true,\n                        urlPrefix: 'https://'\n                    },\n                    controller: 'externalSourceUrlCtrl'\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'dispositions',\n                template:\n                '<div>' +\n                    '<form name=\"dispForm\" novalidate>' +\n                        '<div class=\"row\">' +\n                            '<div class=\"col-md-6\">' +\n                                '<div ng-if=\"options.data.display.type === \\'select\\'\" class=\"form-group disposition-select\">' +\n                                    '<label>{{ to.label }}</label>' +\n                                    '<ui-select ng-model=\"disposition.disp\" theme=\"bootstrap\" title=\"{{ to.label }}\" ng-required=\"to.required\" append-to-body=\"true\">' +\n                                        '<ui-select-match placeholder=\"{{ to.placeholder }}\">{{ $select.selected.disposition }}</ui-select-match>' +\n                                            '<ui-select-choices repeat=\"disp in model.call.dispositions | filter: $select.search\">' +\n                                            '<span ng-bind-html=\"disp.disposition | highlight: $select.search\"></span>' +\n                                        '</ui-select-choices>' +\n                                    '</ui-select>' +\n                                '</div>' +\n                                '<div ng-if=\"options.data.display.type === \\'radio\\'\" class=\"form-group\">' +\n                                    '<label>{{ to.label }}</label>' +\n                                    '<md-radio-group ng-model=\"disposition.disp\" layout=\"{{ options.data.display.isInline ? \\'row\\' : \\'column\\' }}\" ng-required=\"to.required\">' +\n                                        '<md-radio-button ng-repeat=\"disp in model.call.dispositions\" ng-value=\"disp\" aria-label=\"{{disp.disposition}}\" class=\"md-accent\">' +\n                                            '{{ disp.disposition }}' +\n                                        '</md-radio-button>' +\n                                    '</md-radio-group>' +\n                                '</div>' +\n                                '<div ng-if=\"disposition.disp\">' +\n                                    '<div ng-if=\"disposition.disp.contactForwarding\">' +\n                                        '<div class=\"form-group\">' +\n                                            '<label translate=\"DISPOSITIONS.CONTACT_FORWARDING\"></label>' +\n                                            '<input ng-model=\"disposition.contactForwardNum\" class=\"form-control\" name=\"contactForwarding\" id=\"contactForwarding\" placeholder=\"{{\\'DISPOSITIONS.CONTACT_FORWARDING.PLACEHOLDER\\' | translate}}\" maxlength=\"10\" required/>' +\n                                        '</div>' +\n                                    '</div>' +\n                                    '<div ng-if=\"disposition.disp.disposition && !disposition.disp.isComplete && !disposition.disp.contactForwarding\">' +\n                                        '<div class=\"checkbox\">' +\n                                            '<label>' +\n                                                '<md-checkbox ng-model=\"disposition.isCallback\" aria-label=\"{{\\'DISPOSITIONS.CALL_BACK\\' | translate}}\" class=\"md-accent\">{{ \\'DISPOSITIONS.CALL_BACK\\' | translate }}</md-checkbox>' +\n                                            '</label>' +\n                                        '</div>' +\n                                    '</div>' +\n                                '</div>' +\n                            '</div>' +\n                            '<div class=\"col-md-6\">' +\n                                '<div class=\"form-group\">' +\n                                    '<label translate=\"DISPOSITIONS.NOTES\"></label>' +\n                                    '<span class=\"text-right float-right\" ng-if=\"disposition.disp && disposition.disp.requireNote\" translate=\"GENERICS.LABELS.ERR_REQUIRED\"></span>' +\n                                    '<textarea ng-model=\"disposition.notes\" class=\"form-control\" ng-required=\"disposition.disp && disposition.disp.requireNote\" rows=\"5\"> </textarea>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n                        '<div class=\"row\">' +\n                            '<div class=\"col-md-6\" ng-if=\"disposition.isCallback\">' +\n                                '<div class=\"row\">' +\n                                    '<div class=\"col-md-12 form-group\">' +\n                                        '<label translate=\"DISPOSITIONS.CALL_BACK_LEAD_TZ\"></label>' +\n                                        '<select required ng-model=\"disposition.leadTimezone\" class=\"form-control\" ng-options=\"timezone.value as (\\'DISPOSITIONS.CALL_BACK_LEAD_TZ.\\' +  timezone.label | translate) for timezone in timezones\"></select>' +\n                                    '</div>' +\n                                '</div>' +\n                                '<div class=\"row\">' +\n                                    '<div class=\"col-sm-6\">' +\n                                        '<div class=\"form-group\">' +\n                                            '<label translate=\"DISPOSITIONS.CALL_BACK.DATE\" aria-label=\"Call Back Date\"></label>' +\n                                            '<cf-date-time-picker name=\"date\" ' +\n                                                                 'append-to-body=\"true\" ' +\n                                                                 'ng-model=\"disposition.leadDate\" ' +\n                                                                 'data-format=\"MMM Do, YYYY\" ' +\n                                                                 'data-required=\"true\">' +\n                                            '</cf-date-time-picker>' +\n                                        '</div>' +\n                                    '</div>' +\n                                    '<div class=\"col-sm-6\">' +\n                                        '<div class=\"form-group\">' +\n                                            '<label translate=\"DISPOSITIONS.CALL_BACK.TIME\" aria-label=\"Call Back Time\"></label>' +\n                                            '<cf-date-time-picker name=\"date\" ' +\n                                                                 'append-to-body=\"true\" ' +\n                                                                 'ng-model=\"disposition.leadTime\" ' +\n                                                                 'data-format=\"hh:mm a\" ' +\n                                                                 'data-required=\"true\">' +\n                                            '</cf-date-time-picker> ' +\n                                        '</div> ' +\n                                    '</div>' +\n                                '</div>' +\n                                '<div class=\"row\">' +\n                                    '<div class=\"col-md-12 no-left-padding\" ng-if=\"localDts\">' +\n                                        '<div class=\"bs-callout bs-callout-info\">' +\n                                            '<h4>' +\n                                                '{{ ::\"DISPOSITIONS.CALL_BACK_LOCAL_TZ\" | translate:localTimezone }}' +\n                                            '</h4>' +\n                                            '{{ localDts }}' +\n                                        '</div>' +\n                                    '</div>' +\n                                '</div>' +\n                            '</div>' +\n                            '<div class=\"col-md-6 text-right\" ng-class=\"{\\'col-md-offset-6\\': !disposition.isCallback}\">' +\n                                '<button class=\"btn btn-primary btn-sm\" ng-disabled=\"dispForm.$invalid || !model.renderFormValid\" ng-click=\"sendDisp()\">{{ \"DISPOSITIONS.SUBMIT\" | translate}}</button>' +\n                            '</div>' +\n                        '</div>' +\n                    '</form>' +\n                '</div>',\n                defaultOptions: {\n                    data: {\n                        display: {\n                            type: 'select',\n                            isInline: false\n                        }\n                    },\n                    templateOptions: {\n                        placeholder: 'Select...'\n                    },\n                    controller: 'InputType_dispositionCtrl'\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'table',\n                wrapper: [],\n                overwriteOk: true,\n                template: '<table class=\"table table-striped\"><thead></thead><tbody></tbody></table>',\n                defaultOptions: {\n                    controller: function($scope, Render_objectSvc) {\n                        $scope.getTableData = function() {\n                            var result = [];\n                            if($scope.options.data.dataSource) {\n                                try {\n                                    var data = Render_objectSvc.byString($scope, $scope.options.data.dataSource);\n                                    if(data) {\n                                        var parsed = JSON.parse(data);\n                                        result = parsed;\n                                    }\n                                } catch(e) {\n                                    console.error(e);\n                                }\n                            }\n                            return result;\n                        };\n                    },\n                    link: function(scope, element, attrs) {\n                        element.attr('id', (new Date()).getTime());\n\n                        if(!angular.isDefined(scope.model)) {\n                            return;\n                        }\n\n                        var table = element.find('table.table');\n                        var cols = [];\n\n                        _.each(scope.options.data.columns, function(c) {\n                            cols.push({\n                                title: c.title,\n                                data: c.data,\n                                visible: c.visible\n                            });\n                        });\n\n                        if(cols.length > 0) {\n                            table.DataTable({\n                                searching: scope.options.data.searchable,\n                                paging: scope.options.data.paging,\n                                info: scope.options.data.info,\n                                ordering: scope.options.data.ordering,\n                                select: {\n                                    style: scope.options.data.selectable ? 'os' : false\n                                },\n                                language: {\n                                    search: '',\n                                    searchPlaceholder: \"Search...\"\n                                },\n                                data: scope.getTableData(),\n                                columns: cols\n                            })\n                            .on('select', function (e, dt, type, indexes) {\n                                var rowData = dt.rows( indexes ).data().toArray();\n                                _setModel(rowData);\n                            });\n                        }\n\n                        function _setModel(val) {\n                            var key = scope.options.key.replace('model.', '');\n                            scope.model.model[key] = scope.model.model[key] || [];\n                            scope.model.model[key] = val;\n                        }\n                    },\n                    data: {\n                        ignoreModel: true,\n                        dataSource: '',\n                        columns: [],\n                        searchable: true,\n                        paging: true,\n                        info: true,\n                        ordering: true\n                    }\n                }\n            });\n\n            formlyConfig.setType({\n                name: 'knowledgeBase',\n                wrapper: [],\n                overwriteOk: true,\n                template:\n                '<div class=\"knowledge-base-display\">' +\n                    '<div class=\"kb-search\">' +\n                        '<input class=\"form-control\" ng-model=\"kbSearch\" placeholder=\"{{ \\'GENERICS.ACTIONS.SEARCH\\' | translate}}\" ng-change=\"updateKb()\" ng-model-options=\"{ debounce: 200 }\" />' +\n                    '</div>' +\n                    '<div class=\"group-scroll\">' +\n                        '<div class=\"group\" ng-repeat=\"group in filteredKb\">' +\n                            '<span class=\"title\" ng-click=\"toggle(group)\">' +\n                                '{{ ::group.name }}' +\n                                '<i class=\"fa collapse-icon\" ng-class=\"{\\'fa-angle-up\\': !group.collapse, \\'fa-angle-down\\': group.collapse}\"></i>' +\n                            '</span>' +\n                            '<div class=\"category cat_{{($index % 5) + 1}}\" ng-if=\"!group.collapse\" ng-repeat=\"category in group.knowledgeBaseCategories track by $index\">' +\n                                '<span class=\"title\" ng-click=\"toggle(category)\">' +\n                                    '{{ ::category.title }}' +\n                                    '<i class=\"fa collapse-icon\" ng-class=\"{\\'fa-angle-up\\': !category.collapse, \\'fa-angle-down\\': category.collapse}\"></i>' +\n                                '</span>' +\n                                '<div ng-if=\"!category.collapse\">' +\n                                    '<div class=\"article\" ng-class=\"{min: !article.collapse}\" ng-repeat=\"article in category.knowledgeBaseArticles\">' +\n                                        '<span class=\"title\" ng-click=\"toggle(article)\">' +\n                                            '{{ ::article.title }}' +\n                                            '<small>{{ ::article.labels }}</small>' +\n                                            '<a ng-if=\"article.showSend && allowSendArticle\" ng-click=\"send($event, article)\" class=\"btn btn-link pull-right\">' +\n                                                '{{ \\'GENERICS.ACTIONS.SEND\\' | translate }} <i class=\"fa fa-angle-right\"></i>' +\n                                            '</a>' +\n                                        '</span>' +\n                                        '<div class=\"content\" ng-bind-html=\"article.content\"></div>' +\n                                        '<i class=\"fa fa-ellipsis-h article-toggle\" ng-click=\"toggle(article)\" ng-if=\"!category.collapse\"></i>' +\n                                    '</div>' +\n                                '</div>' +\n                            '</div>' +\n                        '</div>' +\n                        '<div class=\"empty-results\" ng-if=\"filteredKb.length === 0\"><h3>{{ \\'GENERICS.MESSAGES.NO_RESULTS\\' | translate }}</h3></div>' +\n                    '</div>' +\n                '</div>',\n                defaultOptions: {\n                    data: {\n                        kbGroups: []\n                    },\n                    controller: function($scope, Render_ScriptSvc) {\n                        $scope.updateKb = updateKb;\n                        $scope.send = send;\n                        $scope.toggle = toggle;\n                        var callbacks = Render_ScriptSvc.getCallbacks();\n                        $scope.allowSendArticle = callbacks.allowSendKbArticle();\n\n                        callbacks.getKnowledgeBaseArticles($scope.options.data.kbGroups).then(function(result) {\n                            _.each(result, function(group) {\n                                group.knowledgeBaseCategories = _.filter(group.knowledgeBaseCategories, 'active');\n                                _.each(group.knowledgeBaseCategories, function(category) {\n                                    category.knowledgeBaseArticles = _.filter(category.knowledgeBaseArticles, 'active');\n                                });\n                            });\n                            $scope.kb = result;\n                            // initiate kb\n                            updateKb();\n                        });\n\n                        function updateKb() {\n                            var cpy = angular.copy($scope.kb),\n                                str = angular.copy($scope.kbSearch);\n                            //var start = (new Date).getTime();\n                            _.each(cpy, function(group) {\n                                _.each(group.knowledgeBaseCategories, function(category) {\n                                    // filter articles\n                                     category.knowledgeBaseArticles = _.filter(category.knowledgeBaseArticles, function(article) {\n                                        return !str || (str && article.labels &&\n                                            article.labels.toLowerCase().indexOf(str.toLowerCase()) > -1);\n                                     });\n                                });\n\n                                // if any are left, add the category\n                                group.knowledgeBaseCategories = _.filter(group.knowledgeBaseCategories, function(category) {\n                                    return category.knowledgeBaseArticles.length > 0;\n                                });\n                            });\n\n                            // if any categories have articles, leave the group\n                            cpy = _.filter(cpy, function(group) {\n                                return group.knowledgeBaseCategories.length > 0;\n                            });\n\n                            // set on model\n                            $scope.filteredKb = cpy;\n                            //var end = (new Date).getTime();\n                            //TODO: debug for filter times\n                            //console.log('filtered', start, end, end-start);\n                        }\n\n                        function send(event, article) {\n                            // TODO: interpolate labels?\n                            event.stopPropagation();\n                            if($scope.allowSendArticle) {\n                                callbacks.sendKbArticle($scope.model.call.uii, article.title, article.content, article.contentPlain);\n                            }\n                        }\n\n                        function toggle(item) {\n                            item.collapse = !item.collapse;\n                        }\n                    },\n                    link: function(scope, element, attrs) {\n\n                    }\n                }\n            });\n\n            formlyConfig.setWrapper([{\n                template: [\n                    '<div class=\"field-wrapper\" ng-style=\"options.data.style.css\">',\n                        '<formly-transclude></formly-transclude>',\n                    '</div>'\n                ].join(' ')\n            }]);\n        }\n\n        // startup the formly types\n        init();\n        return utils;\n    }\n\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('InputType_buttonCtrl', buttonCtrl);\n\n    function buttonCtrl($scope, $parse, NavSvc, Render_ScriptSvc, Render_objectSvc, growl) {\n        $scope.isDisabled = isDisabled;\n        $scope.origLabel = angular.copy($scope.to.label);\n\n        var callbacks = Render_ScriptSvc.getCallbacks(),\n            isNavButton = $scope.options.data.action.type === 'navigation';\n\n        function isDisabled() {\n            var disableInvalid = $scope.options.data.action.disableInvalid && !$scope.model.renderFormValid;\n            var prop = $scope.options.expressionProperties && $scope.options.expressionProperties['templateOptions.disabled'];\n            var isFirstPageBack = isNavButton && angular.isDefined(NavSvc.current()) && NavSvc.current().resolve.isFirstPage && $scope.options.data.action.location === 'prev';\n            return isFirstPageBack || disableInvalid || prop && $parse(prop)($scope);\n        }\n\n        $scope.takeAction = function() {\n            var actionResult;   // used for tracking promises for tests\n            if(isNavButton) {\n                var payload = {\n                    view: $scope.options.data.action.view,\n                    location: $scope.options.data.action.location\n                };\n\n                _navigate(payload);\n            } else if($scope.options.data.action.type === 'call') {\n                switch($scope.options.data.action.callAction) {\n                    case('hold'):\n                        actionResult = callbacks.setHoldState(!$scope.holdState).then(function(result) {\n                            $scope.to.label = result ? $scope.to.label_alt : $scope.origLabel;\n                            $scope.holdState = result;\n                            if(result) {\n                                if(_showGrowl()){\n                                    growl.info('SCRIPTING.TOOLS.PAGE.CONFIG.ACTIONS.CALL_CONTROLS.MESSAGES.HOLD_START');\n                                }\n                            } else {\n                                if(_showGrowl()) {\n                                    growl.success('SCRIPTING.TOOLS.PAGE.CONFIG.ACTIONS.CALL_CONTROLS.MESSAGES.HOLD_END');\n                                }\n                            }\n                        });\n                        break;\n                    case('hangup'):\n                        actionResult = callbacks.requestHangup().then(function() {});\n                        break;\n                    case('warmXfer'):\n                        var xferTo = Render_objectSvc.byString($scope, $scope.options.data.action.transferTo),\n                            callerId = Render_objectSvc.byString($scope, $scope.options.data.action.transferCallerId),\n                            xfer_header = _buildXferHeader();\n\n                        actionResult = callbacks.requestWarmTransfer(xferTo, callerId, xfer_header);\n                        break;\n                    case('coldXfer'):\n                        var xferTo = Render_objectSvc.byString($scope, $scope.options.data.action.transferTo),\n                            callerId = Render_objectSvc.byString($scope, $scope.options.data.action.transferCallerId),\n                            xfer_header = _buildXferHeader();\n\n                        actionResult = callbacks.requestColdTransfer(xferTo, callerId, xfer_header);\n                        break;\n                    case('record'):\n                        actionResult = callbacks.setRecordingState(true).then(function() {\n                            if(_showGrowl()) {\n                                growl.success('SCRIPTING.TOOLS.PAGE.CONFIG.ACTIONS.CALL_CONTROLS.MESSAGES.REC_START');\n                            }\n                        });\n                        break;\n                    case('pauseRecord'):\n                        actionResult = callbacks.setRecordingState(false).then(function() {\n                            if(_showGrowl()) {\n                                growl.info('SCRIPTING.TOOLS.PAGE.CONFIG.ACTIONS.CALL_CONTROLS.MESSAGES.REC_PAUSED');\n                            }\n                        });\n                        break;\n                    case('warmRequeue'):\n                        actionResult = _handleRequeue(true);\n                        break;\n                    case('coldRequeue'):\n                        actionResult = _handleRequeue(false);\n                        break;\n                    case('dispositionCall'):\n                        var disp = Render_objectSvc.byString($scope, $scope.options.data.action.disposition);\n                        // look up dispositions\n                        var disps = $scope.model.call.dispositions;\n                        var disposition = _.find(disps, function(d) {\n                            return d.disposition.toUpperCase() === disp.toUpperCase();\n                        });\n\n                        if(disposition) {\n                            actionResult = callbacks.requestDisposition(\n                                $scope.model.call.uii,\n                                disposition,\n                                Render_objectSvc.byString($scope, $scope.options.data.action.notes),\n                                Render_objectSvc.byString($scope, $scope.options.data.action.callback),\n                                Render_objectSvc.byString($scope, $scope.options.data.action.forwardNum),\n                                Render_objectSvc.byString($scope, $scope.options.data.action.callbackDts));\n                        }\n                        break;\n                    case('changeScript'):\n                        actionResult = callbacks.changeScript($scope.model.call.uii, $scope.options.data.action.newScriptId);\n                        break;\n                    default:\n                        console.warn('call control action was not found, please check button actions configuration');\n                }\n            }\n\n            return actionResult;\n        };\n\n        function _buildXferHeader(){\n            if($scope.options.data.action.xfer_header){\n                _.each($scope.options.data.action.xfer_header, function(header){\n                    header.value = Render_objectSvc.byString($scope, header.value);\n\n                });\n            }\n\n            return $scope.options.data.action.xfer_header;\n        }\n\n        function _handleRequeue(isWarm) {\n            var gateId = $scope.options.data.action.requeueTo;\n            var skillId = $scope.options.data.action.requeueSkill;\n            if(!$scope.options.data.action.requeueToGate) {\n                gateId = Render_objectSvc.byString($scope, gateId);\n            }\n\n            var promise;\n            if(isWarm) {\n                promise = callbacks.requestWarmRequeue(gateId, skillId);\n            } else {\n                promise = callbacks.requestColdRequeue(gateId, skillId);\n            }\n\n            promise.then(function() {\n                if(_showGrowl()) {\n                    growl.success('GENERICS.MESSAGES.SUCCESS');\n                }\n            });\n\n            return promise;\n        }\n\n        function _showGrowl() {\n            return false; // TODO since we don't have translate set up yet, don't show growl\n            //return $scope.options.data.action.showMessages;\n        }\n\n        function _navigate(data) {\n            if(data.location === 'next') {\n                NavSvc.next();\n            } else if(data.location === 'prev') {\n                NavSvc.prev();\n            } else {\n                NavSvc.lookupGoTo(data.location, true);\n            }\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('InputType_dispositionCtrl', dispositionCtrl)\n        .service('InputType_dispositionSvc', dispositionSvc);\n\n    function dispositionCtrl($scope, Render_ScriptSvc, InputType_dispositionSvc) {\n        var callbacks = Render_ScriptSvc.getCallbacks();\n        $scope.sendDisp = sendDisp;\n\n        $scope.localDts = \"\";\n        $scope.disposition = InputType_dispositionSvc.currDisp;\n        $scope.localTimezone = {tz: moment.tz.guess()};\n        $scope.timezones = [\n            {value:\"US/Eastern\", label:\"Eastern\"},\n            {value:\"US/Central\", label:\"Central\"},\n            {value:\"US/Mountain\", label:\"Mountain\"},\n            {value:\"US/Pacific\", label:\"Pacific\"},\n            {value:\"US/Alaska\", label:\"Alaska\"},\n            {value:\"US/Hawaii\", label:\"Hawaii\"}\n        ];\n\n        _init();\n        function _init() {\n            if($scope.disposition && !$scope.disposition.leadTimezone) {\n                $scope.disposition.leadTimezone = $scope.timezones[0].value;\n            }\n\n            if($scope.disposition && !$scope.disposition.leadDate && !$scope.disposition.leadTime) {\n                // default timeout for callback, 120 min.\n                var nowPlusTimeout = moment().add('minutes', 120);\n                $scope.disposition.leadDate = nowPlusTimeout.format();\n                $scope.disposition.leadTime = nowPlusTimeout.format();\n            }\n\n            var dispWatch = $scope.$watch('disposition', function(disp) {\n                if( disp &&\n                    disp.leadTimezone &&\n                    disp.leadDate &&\n                    disp.leadTime) {\n\n                    var date = moment(disp.leadDate);\n                    var time = moment(disp.leadTime);\n                    date.hours(time.hours());\n                    date.minutes(time.minutes());\n                    date.seconds(time.seconds());\n\n                    var leadDts = moment.tz(date.format(\"YYYY-MM-DD HH:mm:ss\"), disp.leadTimezone);\n                    $scope.localDts = moment.tz(leadDts, $scope.localTimezone.tz).format('MMM Do, YYYY hh:mm a');\n                    $scope.disposition.leadDts = leadDts;\n\n                }\n            }, true);\n\n            $scope.$on('$destroy', function() {\n                if(dispWatch) {\n                    dispWatch();\n                    dispWatch = null;\n                }\n            });\n        }\n\n        function sendDisp() {\n            var disp = angular.copy($scope.disposition);\n\n            if(disp && disp.disp && disp.disp.dispositionId) {\n                InputType_dispositionSvc.reset();\n\n                return callbacks.requestDisposition(\n                    $scope.model.call.uii,\n                    disp.disp,\n                    disp.notes,\n                    disp.isCallback,\n                    disp.contactForwardNum,\n                    disp.leadDts\n                );\n            }\n        }\n    }\n\n    // this is only used to hold the state of the disposition\n    function dispositionSvc() {\n        var self = this,\n            defaultDisp = {\n            disp: {},\n            contactForwardNum: '',\n            callback: {},\n            notes: '',\n            isCallback: false\n        };\n\n        self.reset = function() {\n            self.currDisp = angular.copy(defaultDisp);\n        };\n        self.reset();\n\n        return self;\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('externalSourceUrlCtrl', ExternalSourceUrlCtrl);\n\n    function ExternalSourceUrlCtrl($scope, $sce, Render_objectSvc) {\n        var comp = Render_objectSvc.byString($scope, $scope.options.data.url);\n        var fullUrl = $scope.options.data.urlPrefix + comp;\n        $scope.trustedUrl = $sce.trustAsResourceUrl(fullUrl);\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('optionCtrl', OptionCtrl);\n\n    function OptionCtrl($scope, Render_objectSvc) {\n        if( angular.isDefined($scope.model) &&\n            angular.isDefined($scope.options.data) &&\n            angular.isDefined($scope.options.data.dataSource) &&\n            $scope.options.data.dataSource !== '') {\n\n            var opts = Render_objectSvc.byString($scope, $scope.options.data.dataSource),\n                newVal = {};\n\n            var result;\n            try {\n                result = JSON.parse(opts);\n                opts = result;\n            } catch(e) {\n                // not json...\n            }\n\n            $scope.options.templateOptions.options =\n                _.map(opts, function(o) {\n                    newVal = {\n                        name: o[$scope.options.data.name],\n                        value: o[$scope.options.data.value]\n                    };\n\n                    return newVal;\n                });\n        }\n\n        if( angular.isDefined($scope.model) &&\n            angular.isDefined($scope.options.templateOptions) &&\n            angular.isDefined($scope.options.templateOptions.placeholder)) {\n            $scope.options.templateOptions.placeholder = Render_objectSvc.byString($scope, $scope.options.templateOptions.placeholder);\n\n        }\n\n        if(angular.isDefined($scope.model) && angular.isDefined($scope.options.defaultValue)) {\n            var keys = $scope.options.key.split('.'),\n                currentModel = $scope.model[keys[0]][keys[1]],\n                parsedModelVal = Render_objectSvc.byString($scope, $scope.options.defaultValue),\n                bracketRegex = new RegExp('(\\{{2}.*\\}{2})', 'g'),\n                replaceModel = currentModel && angular.isString(currentModel) && currentModel.match(bracketRegex),\n                isNumericInput = $scope.options.type === 'number';\n\n            // check uii here\n            if(parsedModelVal && !isNaN(parsedModelVal) && parsedModelVal.length !== 30) {  // uii length will be 30\n                // this is a number, set that on the model\n                parsedModelVal = Number(parsedModelVal);\n            }\n\n            if(replaceModel) {\n                $scope.model[keys[0]][keys[1]] = parsedModelVal;\n\n            } else if(isNumericInput && !isNaN(currentModel)) {\n                $scope.model[keys[0]][keys[1]] = parsedModelVal;\n\n            }\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('EndScriptCtrl', Controller);\n\n    function Controller($scope, Render_ScriptSvc) {\n        console.log('script end', $scope.model);\n        if($scope.model) {\n            $scope.model.scriptComplete = true;\n            Render_ScriptSvc.setScriptResult($scope.model);\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('JavascriptCtrl', Controller);\n\n    function Controller($scope,\n                        Render_javascriptExecutor,\n                        JavascriptBuilder,\n                        RENDER_TOOL_TYPES) {\n\n        var script = $scope.node.properties && $scope.node.properties.javascript;\n\n        if($scope.node.type === RENDER_TOOL_TYPES.SWITCH.type && !$scope.node.properties.advancedMode) {\n            script = JavascriptBuilder.generateSwitch($scope.node);\n\n        } else if($scope.node.type === RENDER_TOOL_TYPES.DATA_BUILDER.type) {\n            script = JavascriptBuilder.generateDataBuilder($scope.node);\n\n        }\n\n        Render_javascriptExecutor.execute($scope, script);\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('MappingCtrl', Controller);\n\n    function Controller($scope, NavSvc) {\n\n        $scope.model.dataMaps = $scope.model.dataMaps || [];\n        $scope.model.dataMaps.push($scope.node.properties.dataMap);\n        NavSvc.next();\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('PageCtrl', Controller)\n        .directive('cfGridstackLayout', Directive);\n\n    function Controller($scope,\n                        $timeout,\n                        $stateParams,\n                        Render_ScriptSvc,\n                        Render_objectSvc,\n                        SortSvc) {\n\n        $scope.$on('$destroy', function() {\n            if(modelWatch) {\n                modelWatch();\n                modelWatch = null;\n            }\n            if(validWatch) {\n                validWatch();\n                validWatch = null;\n            }\n        });\n\n        $scope.getValue = getValue;\n\n        $scope.uii = $stateParams.uii.toString();\n        $scope.renderForm = {};\n        $scope.fields = $scope.node && $scope.node.properties && $scope.node.properties.pageData || [];\n        // order fields by y, then x asc\n        $scope.fields = $scope.fields && $scope.fields.sort(SortSvc.byLayout) || $scope.fields;\n\n        // need to set this on the field so it can track the model changes\n        _.each($scope.fields, function(f) {\n            f.model = $scope.model;\n        });\n\n        $scope.options = {\n            cellHeight: 5,\n            verticalMargin: 5\n        };\n\n        var modelWatch = $scope.$watch('model.model', function(newVal) {\n            if($scope.model) {\n                Render_ScriptSvc.setScriptResult($scope.model);\n            }\n        }, true);\n\n        var validWatch = $scope.$watch('renderForm.$valid', function() {\n            if(angular.isDefined($scope.renderForm) && angular.isDefined($scope.renderForm.$valid)){\n                $scope.model.renderFormValid = $scope.renderForm.$valid;\n                Render_ScriptSvc.setScriptResult($scope.model);\n            }\n        });\n\n        $timeout(function() {\n            $scope.$digest();\n\n            $timeout(function() {\n                var inputs = jQuery('#scriptView').find(':input:not([type=hidden])');\n                inputs.first().focus();\n                jQuery('.gridRender_' + ($scope.uii || '')).each(function() {\n                    $scope.gridstack = jQuery(this).gridstack($scope.options).data('gridstack');\n                });\n            });\n        });\n\n        function getValue(key) {\n            return Render_objectSvc.byString($scope, key);\n        }\n    }\n\n    function Directive($interpolate) {\n        return {\n            restrict: 'A',\n            controller: function($scope, $element) {\n                $scope.watcher = null;\n                $scope.$on('$destroy', function() {\n                    if($scope.watcher) {\n                        $scope.watcher();\n                        $scope.watcher = null;\n                    }\n\n                    if($scope.parentWatcher) {\n                        $scope.parentWatcher();\n                        $scope.parentWatcher = null;\n                    }\n                });\n\n                $element.on('$destroy', function(){\n                    $scope.$destroy();\n                });\n            },\n            link: function(scope, element, attrs) {\n                scope.field.runExpressions = angular.noop;\n\n                if(scope.field.hideExpression) {\n                    scope.visible = false;\n                    scope.parentWatcher = scope.$watch(function() {\n                        return scope.$parent.gridstack;\n\n                    }, function(newVal, oldVal) {\n                        if(newVal && newVal !== oldVal) {\n                            if(scope.parentWatcher) {\n                                scope.parentWatcher();\n                            }\n                            if(!scope.watcher) {\n                                _initHiddenWatcher();\n                            }\n                        }\n                    });\n                } else {\n                    scope.visible = true;\n                }\n\n                function _initHiddenWatcher() {\n                    scope.watcher = scope.$watch(function() {\n                        return $interpolate('{{' + scope.field.hideExpression + '}}')(scope.$parent);\n                    }, function(newVal, oldVal) {\n                        var grid = scope.$parent.gridstack;\n                        if(newVal === 'false') {\n                            // add to grid\n                            grid.update(element, null, null, null, scope.field.data.layout.h);\n                            scope.visible = true;\n\n                        } else if(newVal === 'true') {\n                            // remove from grid\n                            grid.update(element, null, null, null, 0);\n                            scope.visible = false;\n                        }\n                    });\n                }\n            }\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('StartScriptCtrl', Controller);\n\n    function Controller($scope, NavSvc) {\n        NavSvc.lookupGoTo($scope.node.connections[0].target);\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('RecordingCtrl', Controller);\n\n    function Controller($scope, RENDER_TOOL_TYPES,\n                        NavSvc, Render_ScriptSvc) {\n\n            var callbacks = Render_ScriptSvc.getCallbacks();\n            var startRecording = $scope.node.type === RENDER_TOOL_TYPES.START_REC.type;\n\n            $scope.connecting = true;\n\n            $scope.callbackPromise = callbacks\n                .setRecordingState(startRecording)\n                .then(\n                function(result) {\n                    if($scope.node.type === RENDER_TOOL_TYPES.START_REC.type || $scope.node.type === RENDER_TOOL_TYPES.STOP_REC.type) {\n                        $scope.status = result;\n                        $scope.connecting = false;\n                        NavSvc.next();\n                    }\n                }, function(error) {\n\n                }\n            );\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('WwwCtrl', Controller);\n\n    function Controller($scope,\n                        NavSvc, Render_wwwRequestSvc) {\n\n        var tool = $scope.node;\n\n        Render_wwwRequestSvc\n            .execute(tool.properties, $scope)\n            .then(\n                function(result) {\n                    console.log('www result', result);\n                    $scope.model.model[tool.label] = result;\n                    NavSvc.next();\n                },\n                function(error) {\n                    console.error('error in www', error);\n                    $scope.model.model[tool.label] = error;\n                    NavSvc.next();\n                }\n            );\n    }\n})();\n\n(function() {\n    'use strict';\n    angular\n        .module('scriptingStudio.render')\n        .controller('StartScriptCtrl', Controller);\n\n    function Controller($scope, NavSvc) {\n        NavSvc.lookupGoTo($scope.node.connections[0].target);\n    }\n})();\n"],"file":"render.js"}