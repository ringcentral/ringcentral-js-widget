{"version":3,"sources":["components/ActivityCallLogPanel/utils/EditLogSection.tsx"],"names":["_getReferenceFieldOptions","currentLocale","getNameLabel","item","length","id","name","type","i18n","getString","getRelatedToLabel","Object","keys","onNameChange","currentLog","task","currentSessionId","onUpdateCallLog","relatedTo","whatid","isSaved","whoid","onRelatedToChange","args","getLabel","onChange","metadata","title","placeholder","valueField","currentOptionFinder","matchedEntitiesGetter","nameEntities","otherEntitiesGetter","navigateToEntities","relatedToEntities","EditLogSection","onSaveCallLog","subjectDropdownsTracker","editSectionScrollBy","startAdornmentRender"],"mappings":"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","sourcesContent":["import React from 'react';\nimport CallLogFields, {\n  FieldItemProps,\n} from 'ringcentral-widgets/components/CallLogFields';\nimport { CallLogFieldsProps } from 'ringcentral-widgets/components/CallLogFields/CallLogFields.interface';\nimport { CallLogPanelProps } from 'ringcentral-widgets/components/CallLogPanel';\n\nimport i18n from '../i18n';\n\nconst _getReferenceFieldOptions = (\n  currentLocale,\n): CallLogFieldsProps['referenceFieldOptions'] => {\n  const getNameLabel = (item: any = {}, length) => {\n    const { id, name, type } = item;\n    if (!id) {\n      return length > 1\n        ? `${i18n.getString('multipleNameMatch', currentLocale)} (${length})`\n        : i18n.getString('none', currentLocale);\n    }\n    return name ? `${name}` : `${type}(${id})`;\n  };\n\n  const getRelatedToLabel = (item: any = {}, length) => {\n    const { id, name, type } = item;\n    if (Object.keys(item).length === 0) {\n      return length > 1\n        ? `${i18n.getString(\n            'multipleRelatedToMatch',\n            currentLocale,\n          )} (${length})`\n        : i18n.getString('none', currentLocale);\n    }\n    return name ? `${name}` : `${type}(${id})`;\n  };\n\n  const onNameChange = ({\n    currentLog: { task, currentSessionId },\n    onUpdateCallLog,\n  }: FieldItemProps) => async (item) => {\n    const id = item.id;\n    const relatedTo = task.whatid;\n    await onUpdateCallLog(\n      {\n        isSaved: false,\n        task: {\n          whoid: id || '',\n          whatid: relatedTo || '',\n        },\n      },\n      currentSessionId,\n    );\n  };\n\n  const onRelatedToChange = ({\n    currentLog: { currentSessionId },\n    onUpdateCallLog,\n  }: FieldItemProps) => async (args) => {\n    const id = (typeof args === 'object' ? args.id : args) || null;\n    await onUpdateCallLog(\n      {\n        isSaved: false,\n        task: {\n          whatid: id || '',\n        },\n      },\n      currentSessionId,\n    );\n  };\n\n  return {\n    whoid: {\n      getLabel: getNameLabel,\n      onChange: onNameChange,\n      metadata: {\n        title: i18n.getString('name', currentLocale),\n        placeholder: i18n.getString('namePlaceholder', currentLocale),\n        valueField: 'whoid',\n      },\n      currentOptionFinder: (task) => (item) => item.id === task.whoid,\n      matchedEntitiesGetter: ({ nameEntities }) => nameEntities,\n      otherEntitiesGetter: ({ navigateToEntities: { name } }) => name,\n    },\n    whatid: {\n      getLabel: getRelatedToLabel,\n      onChange: onRelatedToChange,\n      metadata: {\n        title: i18n.getString('relatedTo', currentLocale),\n        placeholder: i18n.getString('relatedToPlaceholder', currentLocale),\n        valueField: 'whatid',\n      },\n      currentOptionFinder: (task) => (item) => item.id === task.whatid,\n      matchedEntitiesGetter: ({ relatedToEntities }) => relatedToEntities,\n      otherEntitiesGetter: ({ navigateToEntities: { relatedTo } }) => relatedTo,\n    },\n  };\n};\n\nexport const EditLogSection: CallLogPanelProps['renderEditLogSection'] = ({\n  onUpdateCallLog,\n  currentLog,\n  currentLocale,\n  onSaveCallLog,\n  subjectDropdownsTracker,\n  editSectionScrollBy,\n  startAdornmentRender,\n}) => {\n  return (\n    <CallLogFields\n      referenceFieldOptions={_getReferenceFieldOptions(currentLocale)}\n      subjectDropdownsTracker={subjectDropdownsTracker}\n      onUpdateCallLog={onUpdateCallLog}\n      onSaveCallLog={onSaveCallLog}\n      currentLog={currentLog}\n      currentLocale={currentLocale}\n      startAdornmentRender={startAdornmentRender}\n      editSectionScrollBy={editSectionScrollBy}\n    />\n  );\n};\n"],"file":"EditLogSection.js"}