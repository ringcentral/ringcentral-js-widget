{"version":3,"sources":["components/ActivityCallLogPanel/utils/EditLogSection.tsx"],"names":["rightIconRender","styles","fillRight","_getReferenceFieldOptions","currentLocale","getNameLabel","item","length","id","name","type","i18n","getString","getRelatedToLabel","CaseNumber","Object","keys","onNameChange","currentLog","task","currentSessionId","onUpdateCallLog","relatedTo","whatid","isSaved","whoid","onRelatedToChange","getLabel","onChange","metadata","title","placeholder","valueField","currentOptionFinder","matchedEntitiesGetter","nameEntities","otherEntitiesGetter","navigateToEntities","backHeaderClassName","backHeader","relatedToEntities","EditLogSection","onSaveCallLog","subjectDropdownsTracker","editSectionScrollBy","startAdornmentRender","scrollTo","rootRef","dispositionIdRef","current","scrollBy","top","offsetTop","behavior","root","dispositionId"],"mappings":"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","sourcesContent":["import React, {\n  FunctionComponent,\n  MutableRefObject,\n  useEffect,\n  useRef,\n} from 'react';\nimport CallLogFields, {\n  FieldItemProps,\n} from 'ringcentral-widgets/components/CallLogFields';\nimport { CallLogFieldsProps } from 'ringcentral-widgets/components/CallLogFields/CallLogFields.interface';\nimport { CallLogPanelProps } from 'ringcentral-widgets/components/CallLogPanel';\n\nimport i18n from '../i18n';\nimport styles from './styles.scss';\n\nconst rightIconRender = () => {\n  return <div className={styles.fillRight} />;\n};\n\nconst _getReferenceFieldOptions = (\n  currentLocale: string,\n): CallLogFieldsProps['referenceFieldOptions'] => {\n  const getNameLabel = (item: any = {}, length: number) => {\n    const { id, name, type } = item;\n    if (!id) {\n      return length > 1\n        ? `${i18n.getString('multipleNameMatch', currentLocale)} (${length})`\n        : i18n.getString('none', currentLocale);\n    }\n    return name ? `${name}` : `${type}(${id})`;\n  };\n\n  const getRelatedToLabel = (item: any = {}, length: number) => {\n    const { CaseNumber, name, type } = item;\n    if (Object.keys(item).length === 0) {\n      return length > 1\n        ? `${i18n.getString(\n            'multipleRelatedToMatch',\n            currentLocale,\n          )} (${length})`\n        : i18n.getString('none', currentLocale);\n    }\n    return name ? `${name}` : `${type}(${CaseNumber})`;\n  };\n\n  const onNameChange = ({\n    currentLog: { task, currentSessionId },\n    onUpdateCallLog,\n  }: FieldItemProps) => async (item: any) => {\n    const id = item.id;\n    const relatedTo = task.whatid;\n    await onUpdateCallLog(\n      {\n        isSaved: false,\n        task: {\n          whoid: id || '',\n          whatid: relatedTo || '',\n        },\n      },\n      currentSessionId,\n    );\n  };\n\n  const onRelatedToChange = ({\n    currentLog: { currentSessionId },\n    onUpdateCallLog,\n  }: FieldItemProps) => async (item: any) => {\n    const id = (typeof item === 'object' ? item.id : item) || null;\n    await onUpdateCallLog(\n      {\n        isSaved: false,\n        task: {\n          whatid: id || '',\n        },\n      },\n      currentSessionId,\n    );\n  };\n\n  return {\n    whoid: {\n      getLabel: getNameLabel,\n      onChange: onNameChange,\n      metadata: {\n        title: i18n.getString('name', currentLocale),\n        placeholder: i18n.getString('namePlaceholder', currentLocale),\n        valueField: 'whoid',\n      },\n      currentOptionFinder: (task) => (item) => item.id === task.whoid,\n      matchedEntitiesGetter: ({ nameEntities }) => nameEntities,\n      otherEntitiesGetter: ({ navigateToEntities: { name } }) => name,\n      rightIconRender,\n      backHeaderClassName: styles.backHeader,\n    },\n    whatid: {\n      getLabel: getRelatedToLabel,\n      onChange: onRelatedToChange,\n      metadata: {\n        title: i18n.getString('relatedTo', currentLocale),\n        placeholder: i18n.getString('relatedToPlaceholder', currentLocale),\n        valueField: 'whatid',\n      },\n      currentOptionFinder: (task) => (item) => item.id === task.whatid,\n      matchedEntitiesGetter: ({ relatedToEntities }) => relatedToEntities,\n      otherEntitiesGetter: ({ navigateToEntities: { relatedTo } }) => relatedTo,\n      rightIconRender,\n      backHeaderClassName: styles.backHeader,\n    },\n  };\n};\n\ntype EditLogSectionProps = {\n  scrollTo: string;\n  rootRef: MutableRefObject<HTMLElement>;\n} & Parameters<CallLogPanelProps['renderEditLogSection']>[0];\n\nexport const EditLogSection: FunctionComponent<EditLogSectionProps> = ({\n  onUpdateCallLog,\n  currentLog,\n  currentLocale,\n  onSaveCallLog,\n  subjectDropdownsTracker,\n  editSectionScrollBy,\n  startAdornmentRender,\n  scrollTo,\n  rootRef,\n}) => {\n  const dispositionIdRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (rootRef?.current && dispositionIdRef.current) {\n      switch (scrollTo) {\n        case 'dispositionId':\n          rootRef.current.scrollBy({\n            top: dispositionIdRef.current.offsetTop,\n            behavior: 'smooth',\n          });\n          break;\n\n        default:\n          break;\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [scrollTo]);\n\n  return (\n    <CallLogFields\n      referenceFieldOptions={_getReferenceFieldOptions(currentLocale)}\n      subjectDropdownsTracker={subjectDropdownsTracker}\n      onUpdateCallLog={onUpdateCallLog}\n      onSaveCallLog={onSaveCallLog}\n      currentLog={currentLog}\n      currentLocale={currentLocale}\n      startAdornmentRender={startAdornmentRender}\n      editSectionScrollBy={editSectionScrollBy}\n      classes={{\n        root: styles.root,\n      }}\n      refs={{\n        dispositionId: dispositionIdRef,\n      }}\n    />\n  );\n};\n"],"file":"EditLogSection.js"}