{"version":3,"sources":["components/CallingSettingsPanel/CallingSettingsPanel.tsx"],"names":["TooltipBaseComp","TooltipBase","isRcBrand","brandCode","getJupiterAppName","brandName","currentLocale","i18n","getString","callingOptions","jupiter","brand","getSoftphoneAppName","softphone","getCallingOptionName","callingOption","Tooltip","callWith","tooltipContainerRef","keys","browser","push","optionName","overlay","map","key","offset","current","styles","infoIcon","CallWithSettings","callWithOptions","disabled","onCallWithChange","optionRenderer","option","select","tooltipContainer","RingoutSettings","availableNumbersWithLabel","locationSearchable","myLocation","onMyLocationChange","onMyLocationTextChange","ringoutPrompt","onRingoutPromptChange","ringoutHint","locationSelect","text","includes","iconField","CallingSettings","defaultRingoutPrompt","onSave","showRingToneSettings","incomingAudio","incomingAudioFile","outgoingAudio","outgoingAudioFile","defaultIncomingAudio","defaultIncomingAudioFile","defaultOutgoingAudio","defaultOutgoingAudioFile","callWithState","setCallWithState","ringoutPromptState","setRingoutPromptState","myLocationState","setMyLocationState","incomingAudioState","setIncomingAudioState","incomingAudioFileState","setIncomingAudioFileState","outgoingAudioState","setOutgoingAudioState","outgoingAudioFileState","setOutgoingAudioFileState","newCallWith","value","target","setIncomingAudio","fileName","dataUrl","resetIncomingAudio","setOutgoingAudio","resetOutgoingAudio","onClick","isCustomLocation","find","item","ringout","CallingSettingsPanel","className","onBackButtonClick","showSpinner","props","content","root"],"mappings":"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","sourcesContent":["/* eslint-disable react/destructuring-assignment */\nimport React, {\n  FunctionComponent,\n  useState,\n  ReactNode,\n  useRef,\n  MutableRefObject,\n  ChangeEvent,\n  useEffect,\n} from 'react';\nimport classnames from 'classnames';\nimport formatMessage from 'format-message';\n\nimport callingOptions from 'ringcentral-integration/modules/CallingSettings/callingOptions';\nimport TooltipBase from 'rc-tooltip';\nimport 'rc-tooltip/assets/bootstrap_white.css';\n\nimport InfoIcon from '../../assets/images/Info.svg';\n\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nimport { SpinnerOverlay } from '../SpinnerOverlay';\nimport BackHeader from '../BackHeader';\nimport Panel from '../Panel';\nimport Switch from '../Switch';\nimport IconField from '../IconField';\nimport InputField from '../InputField';\nimport TextInput from '../TextInput';\nimport DropdownSelect from '../DropdownSelect';\nimport SaveButton from '../SaveButton';\nimport { RingTone } from '../Ringtone';\nimport {\n  CallingSettingsPanelProps,\n  CallingSettingsProps,\n} from './CallingSettingsPenal.interface';\n\nconst TooltipBaseComp =\n  typeof TooltipBase === 'function' ? TooltipBase : TooltipBase.default;\n\nfunction isRcBrand(brandCode: string): boolean {\n  return brandCode === 'rc';\n}\n\nexport function getJupiterAppName(\n  brandCode: string,\n  brandName: string,\n  currentLocale: string,\n): string {\n  return isRcBrand(brandCode)\n    ? `${brandName} App`\n    : formatMessage(i18n.getString(callingOptions.jupiter, currentLocale), {\n        brand: brandName,\n      });\n}\n\nexport function getSoftphoneAppName(\n  brandCode: string,\n  brandName: string,\n  currentLocale: string,\n): string {\n  return isRcBrand(brandCode)\n    ? `${brandName} Phone`\n    : formatMessage(i18n.getString(callingOptions.softphone, currentLocale), {\n        brand: brandName,\n      });\n}\n\nexport function getCallingOptionName(\n  callingOption: string,\n  brandCode: string,\n  brandName: string,\n  currentLocale: string,\n) {\n  if (callingOption === callingOptions.softphone) {\n    return getSoftphoneAppName(brandCode, brandName, currentLocale);\n  }\n  if (callingOption === callingOptions.jupiter) {\n    return getJupiterAppName(brandCode, brandName, currentLocale);\n  }\n  return i18n.getString(callingOption, currentLocale);\n}\n\ninterface CallWithProps {\n  brandCode: string;\n  brandName: string;\n  currentLocale: string;\n  callWithOptions: string[];\n  disabled: boolean;\n  callWith: string;\n  onCallWithChange: (newCallWith: string) => void;\n}\ninterface TooltipProps {\n  brandCode: string;\n  brandName: string;\n  callWith: string;\n  currentLocale: string;\n  tooltipContainerRef: MutableRefObject<ReactNode>;\n}\n\nconst Tooltip: FunctionComponent<TooltipProps> = ({\n  brandCode,\n  brandName,\n  callWith,\n  currentLocale,\n  tooltipContainerRef,\n}) => {\n  const keys = [`${callWith}Tooltip`];\n  if (\n    callWith !== callingOptions.browser &&\n    callWith !== callingOptions.softphone &&\n    callWith !== callingOptions.jupiter\n  ) {\n    keys.push(`${callWith}Tooltip1`);\n  }\n  const optionName = getCallingOptionName(\n    callWith,\n    brandCode,\n    brandName,\n    currentLocale,\n  );\n  const overlay = (\n    <div>\n      {keys.map((key) => (\n        <div key={key}>\n          {formatMessage(i18n.getString(key, currentLocale), {\n            brand: optionName,\n          })}\n        </div>\n      ))}\n    </div>\n  );\n  return (\n    <TooltipBaseComp\n      placement=\"bottom\"\n      trigger=\"click\"\n      overlay={overlay}\n      align={{\n        offset: [0, 47],\n      }}\n      arrowContent={<div className=\"rc-tooltip-arrow-inner\" />}\n      getTooltipContainer={() => tooltipContainerRef.current}\n    >\n      <InfoIcon width={14} height={14} className={styles.infoIcon} />\n    </TooltipBaseComp>\n  );\n};\n\nconst CallWithSettings: FunctionComponent<CallWithProps> = ({\n  brandCode,\n  brandName,\n  callWith,\n  callWithOptions,\n  currentLocale,\n  disabled,\n  onCallWithChange,\n}) => {\n  const tooltipContainerRef = useRef(null);\n\n  const optionRenderer = (option: string) => {\n    const optionName = getCallingOptionName(\n      option,\n      brandCode,\n      brandName,\n      currentLocale,\n    );\n    return optionName;\n  };\n\n  return (\n    <InputField\n      label={\n        <span>\n          {i18n.getString('makeCallsWith', currentLocale)}\n          <Tooltip\n            {...{\n              brandCode,\n              brandName,\n              callWith,\n              currentLocale,\n              tooltipContainerRef,\n            }}\n          />\n        </span>\n      }\n    >\n      <DropdownSelect\n        dataSign=\"callingSetting\"\n        className={styles.select}\n        value={callWith}\n        onChange={onCallWithChange}\n        options={callWithOptions}\n        dropdownAlign=\"left\"\n        renderFunction={optionRenderer}\n        renderValue={optionRenderer}\n        disabled={disabled}\n        titleEnabled\n      />\n      <div className={styles.tooltipContainer} ref={tooltipContainerRef} />\n    </InputField>\n  );\n};\n\n// TODO properly type available numbers\n\ninterface RingoutSettingsProps {\n  currentLocale: string;\n  callWith: string;\n  availableNumbersWithLabel: { label: string; value: string }[];\n  locationSearchable: boolean;\n  myLocation: string;\n  onMyLocationChange: (newMyLocation: string) => void;\n  onMyLocationTextChange: (e: ChangeEvent<HTMLInputElement>) => void;\n  disabled: boolean;\n  ringoutPrompt: boolean;\n  onRingoutPromptChange: (newRingoutPrompt: boolean) => void;\n}\n\nconst RingoutSettings: FunctionComponent<RingoutSettingsProps> = ({\n  currentLocale,\n  callWith,\n  availableNumbersWithLabel,\n  locationSearchable,\n  myLocation,\n  onMyLocationChange,\n  onMyLocationTextChange,\n  disabled,\n  ringoutPrompt,\n  onRingoutPromptChange,\n}) => {\n  if (\n    callWith !== callingOptions.softphone &&\n    callWith !== callingOptions.browser &&\n    callWith !== callingOptions.jupiter\n  ) {\n    return (\n      <div>\n        <div className={styles.ringoutHint}>\n          {i18n.getString('ringoutHint', currentLocale)}\n        </div>\n        <InputField\n          dataSign=\"myLocation\"\n          label={i18n.getString('myLocationLabel', currentLocale)}\n        >\n          {availableNumbersWithLabel ? (\n            <DropdownSelect\n              className={classnames(styles.select, styles.locationSelect)}\n              value={myLocation}\n              onChange={onMyLocationChange}\n              searchOption={\n                locationSearchable\n                  ? (option: string, text: string) => option.includes(text)\n                  : null\n              }\n              options={availableNumbersWithLabel}\n              disabled={disabled}\n              dropdownAlign=\"left\"\n              titleEnabled\n              customInputEnabled\n              optionsWithLabel\n              customInputLimit={30}\n            />\n          ) : (\n            <TextInput\n              dataSign=\"myLocationInput\"\n              value={myLocation}\n              maxLength={30}\n              onChange={onMyLocationTextChange}\n            />\n          )}\n        </InputField>\n        <IconField\n          className={styles.iconField}\n          icon={\n            <Switch\n              dataSign=\"ringoutPromptToggle\"\n              checked={ringoutPrompt}\n              onChange={onRingoutPromptChange}\n            />\n          }\n        >\n          {i18n.getString('press1ToStartCallLabel', currentLocale)}\n        </IconField>\n      </div>\n    );\n  }\n  return null;\n};\n\nconst CallingSettings: FunctionComponent<CallingSettingsProps> = ({\n  brandCode,\n  brandName,\n  availableNumbersWithLabel,\n  callWith,\n  callWithOptions,\n  currentLocale,\n  defaultRingoutPrompt = true,\n  disabled = false,\n  locationSearchable = false,\n  myLocation,\n  onSave,\n  ringoutPrompt,\n  showRingToneSettings = false,\n  incomingAudio,\n  incomingAudioFile,\n  outgoingAudio,\n  outgoingAudioFile,\n  defaultIncomingAudio,\n  defaultIncomingAudioFile,\n  defaultOutgoingAudio,\n  defaultOutgoingAudioFile,\n}) => {\n  const [callWithState, setCallWithState] = useState(callWith);\n  const [ringoutPromptState, setRingoutPromptState] = useState(ringoutPrompt);\n  const [myLocationState, setMyLocationState] = useState(myLocation);\n  const [incomingAudioState, setIncomingAudioState] = useState(incomingAudio);\n  const [incomingAudioFileState, setIncomingAudioFileState] = useState(\n    incomingAudioFile,\n  );\n  const [outgoingAudioState, setOutgoingAudioState] = useState(outgoingAudio);\n  const [outgoingAudioFileState, setOutgoingAudioFileState] = useState(\n    outgoingAudioFile,\n  );\n\n  useEffect(() => {\n    setCallWithState(callWith);\n    setMyLocationState(myLocation);\n    setRingoutPromptState(ringoutPrompt);\n    setIncomingAudioState(incomingAudio);\n    setIncomingAudioFileState(incomingAudioFile);\n    setOutgoingAudioState(outgoingAudio);\n    setOutgoingAudioFileState(outgoingAudioFile);\n  }, [\n    callWith,\n    myLocation,\n    ringoutPrompt,\n    incomingAudio,\n    incomingAudioFile,\n    outgoingAudio,\n    outgoingAudioFile,\n  ]);\n  return (\n    <>\n      <CallWithSettings\n        {...{\n          brandCode,\n          brandName,\n          callWith: callWithState,\n          callWithOptions,\n          currentLocale,\n          disabled,\n          onCallWithChange: (newCallWith: string) => {\n            setCallWithState(newCallWith);\n            if (newCallWith === callWith) {\n              setMyLocationState(myLocation);\n              setRingoutPromptState(ringoutPrompt);\n            } else {\n              setMyLocationState(availableNumbersWithLabel?.[0]?.value || '');\n              setRingoutPromptState(defaultRingoutPrompt);\n            }\n          },\n        }}\n      />\n      <RingoutSettings\n        {...{\n          currentLocale,\n          callWith: callWithState,\n          availableNumbersWithLabel,\n          locationSearchable,\n          myLocation: myLocationState,\n          onMyLocationChange: setMyLocationState,\n          onMyLocationTextChange: ({ target: { value } }) => {\n            setMyLocationState(value);\n          },\n          ringoutPrompt: ringoutPromptState,\n          onRingoutPromptChange: setRingoutPromptState,\n          disabled,\n        }}\n      />\n      <RingTone\n        {...{\n          currentLocale,\n          showRingToneSettings:\n            showRingToneSettings && callWithState === callingOptions.browser,\n          incomingAudio: incomingAudioState,\n          incomingAudioFile: incomingAudioFileState,\n          outgoingAudio: outgoingAudioState,\n          outgoingAudioFile: outgoingAudioFileState,\n          defaultIncomingAudio,\n          defaultIncomingAudioFile,\n          defaultOutgoingAudio,\n          defaultOutgoingAudioFile,\n          setIncomingAudio: ({ fileName, dataUrl }) => {\n            setIncomingAudioState(dataUrl);\n            setIncomingAudioFileState(fileName);\n          },\n          resetIncomingAudio: () => {\n            setIncomingAudioState(defaultIncomingAudio);\n            setIncomingAudioFileState(defaultIncomingAudioFile);\n          },\n          setOutgoingAudio: ({ fileName, dataUrl }) => {\n            setOutgoingAudioState(dataUrl);\n            setOutgoingAudioFileState(fileName);\n          },\n          resetOutgoingAudio: () => {\n            setOutgoingAudioState(defaultOutgoingAudio);\n            setOutgoingAudioFileState(defaultOutgoingAudioFile);\n          },\n        }}\n      />\n      <SaveButton\n        {...{\n          currentLocale,\n          onClick: () => {\n            onSave({\n              callWith: callWithState,\n              myLocation: myLocationState,\n              ringoutPrompt: ringoutPromptState,\n              isCustomLocation: !availableNumbersWithLabel.find(\n                (item) => item.value === myLocationState,\n              ),\n              incomingAudio: incomingAudioState,\n              incomingAudioFile: incomingAudioFileState,\n              outgoingAudio: outgoingAudioState,\n              outgoingAudioFile: outgoingAudioFileState,\n            });\n          },\n          disabled:\n            (callWithState === callWith &&\n              myLocationState === myLocation &&\n              ringoutPromptState === ringoutPrompt &&\n              incomingAudioState === incomingAudio &&\n              incomingAudioFileState === incomingAudioFile &&\n              outgoingAudioState === outgoingAudio &&\n              outgoingAudioFileState === outgoingAudioFile) ||\n            (callWithState === callingOptions.ringout && !myLocationState),\n        }}\n      />\n    </>\n  );\n};\n\nexport const CallingSettingsPanel: FunctionComponent<CallingSettingsPanelProps> = ({\n  className,\n  onBackButtonClick,\n  currentLocale,\n  showSpinner = false,\n  ...props\n}) => {\n  const content = showSpinner ? (\n    <SpinnerOverlay />\n  ) : (\n    <>\n      <CallingSettings {...{ ...props, currentLocale }} />\n    </>\n  );\n  return (\n    <div\n      data-sign=\"callingSettings\"\n      className={classnames(styles.root, className)}\n    >\n      <BackHeader onBackClick={onBackButtonClick}>\n        {i18n.getString('title', currentLocale)}\n      </BackHeader>\n      <Panel className={styles.content}>{content}</Panel>\n    </div>\n  );\n};\n"],"file":"CallingSettingsPanel.js"}