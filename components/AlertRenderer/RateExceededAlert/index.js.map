{"version":3,"sources":["components/AlertRenderer/RateExceededAlert/index.js"],"names":["calculateState","duration","timestamp","ttl","Math","max","floor","Date","now","RequestRateExceededAlert","props","state","timer","setInterval","setState","nextProps","clearInterval","i18n","getString","currentLocale","Component","propTypes","PropTypes","number","isRequired","string","handleMessage","message","errorMessages","rateLimitReached"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAASA,cAAT,CAAwBC,QAAxB,EAAkCC,SAAlC,EAA6C;AAC3C,SAAO;AACLC,IAAAA,GAAG,EAAEC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,KAAL,CAAW,CAACL,QAAQ,IAAIM,IAAI,CAACC,GAAL,KAAaN,SAAjB,CAAT,IAAwC,IAAnD,CAAT,EAAmE,CAAnE;AADA,GAAP;AAGD;;IAEKO,wB;;;;;AACJ,oCAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,kGAAMA,KAAN;AACA,UAAKC,KAAL,GAAaX,cAAc,CAACU,KAAK,CAACT,QAAP,EAAiBS,KAAK,CAACR,SAAvB,CAA3B;AAFiB;AAGlB;;;;wCAEmB;AAAA;;AAClB,WAAKU,KAAL,GAAaC,WAAW,CAAC,YAAM;AAC7B,QAAA,MAAI,CAACC,QAAL,CAAcd,cAAc,CAAC,MAAI,CAACU,KAAL,CAAWT,QAAZ,EAAsB,MAAI,CAACS,KAAL,CAAWR,SAAjC,CAA5B;AACD,OAFuB,EAErB,IAFqB,CAAxB;AAGD;;;8CAEyBa,S,EAAW;AACnC,WAAKD,QAAL,CAAcd,cAAc,CAACe,SAAS,CAACd,QAAX,EAAqBc,SAAS,CAACb,SAA/B,CAA5B;AACD;;;2CAEsB;AACrBc,MAAAA,aAAa,CAAC,KAAKJ,KAAN,CAAb;AACD;;;6BAEQ;AACP,aACE,gCAAC,4BAAD;AACE,QAAA,OAAO,EAAEK,iBAAKC,SAAL,CAAe,cAAf,EAA+B,KAAKR,KAAL,CAAWS,aAA1C,CADX;AAEE,QAAA,MAAM,EAAE;AAAEhB,UAAAA,GAAG,EAAE,KAAKQ,KAAL,CAAWR;AAAlB;AAFV,QADF;AAMD;;;;EA3BoCiB,gB;;AA8BvCX,wBAAwB,CAACY,SAAzB,GAAqC;AACnCnB,EAAAA,SAAS,EAAEoB,sBAAUC,MAAV,CAAiBC,UADO;AAEnCvB,EAAAA,QAAQ,EAAEqB,sBAAUC,MAAV,CAAiBC,UAFQ;AAGnCL,EAAAA,aAAa,EAAEG,sBAAUG,MAAV,CAAiBD;AAHG,CAArC;;AAMAf,wBAAwB,CAACiB,aAAzB,GAAyC;AAAA,MAAGC,OAAH,QAAGA,OAAH;AAAA,SACvCA,OAAO,KAAKC,0BAAcC,gBADa;AAAA,CAAzC;;eAGepB,wB","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport errorMessages from 'ringcentral-integration/modules/RateLimiter/errorMessages';\nimport FormattedMessage from '../../FormattedMessage';\nimport i18n from './i18n';\n\nfunction calculateState(duration, timestamp) {\n  return {\n    ttl: Math.max(Math.floor((duration - (Date.now() - timestamp)) / 1000), 0),\n  };\n}\n\nclass RequestRateExceededAlert extends Component {\n  constructor(props) {\n    super(props);\n    this.state = calculateState(props.duration, props.timestamp);\n  }\n\n  componentDidMount() {\n    this.timer = setInterval(() => {\n      this.setState(calculateState(this.props.duration, this.props.timestamp));\n    }, 1000);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setState(calculateState(nextProps.duration, nextProps.timestamp));\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.timer);\n  }\n\n  render() {\n    return (\n      <FormattedMessage\n        message={i18n.getString('rateExceeded', this.props.currentLocale)}\n        values={{ ttl: this.state.ttl }}\n      />\n    );\n  }\n}\n\nRequestRateExceededAlert.propTypes = {\n  timestamp: PropTypes.number.isRequired,\n  duration: PropTypes.number.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n};\n\nRequestRateExceededAlert.handleMessage = ({ message }) =>\n  message === errorMessages.rateLimitReached;\n\nexport default RequestRateExceededAlert;\n"],"file":"index.js"}