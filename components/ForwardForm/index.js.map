{"version":3,"sources":["components/ForwardForm/index.js"],"names":["cleanRegex","ForwardNumbers","numbers","onSelect","selected","formatPhone","styles","map","number","index","id","active","label","colon","phoneNumber","propTypes","PropTypes","array","isRequired","func","ForwardForm","props","_onCustomValueChange","value","setState","customValue","_clearToNumber","_setRecipient","recipient","_clearRecipient","state","selectedIndex","handling","filter","replace","onChange","getValue","onForward","result","_mounted","onCancel","onSelectCustomNumber","forwardingNumbers","length","setTimeout","customInput","focus","forwardingNumber","className","currentLocale","searchContact","searchContactList","phoneTypeRenderer","phoneSourceNameRenderer","autoFocus","disableButton","root","custromNumber","customLabel","i18n","getString","ref","buttonGroup","cancelButton","forwardButton","disabled","buttonText","Component","string","bool","defaultProps","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport isBlank from 'ringcentral-integration/lib/isBlank';\nimport RecipientsInput from '../RecipientsInput';\n\nimport Button from '../Button';\n\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nconst cleanRegex = /[^\\d+*-\\s]/g;\n\nfunction ForwardNumbers({ numbers, onSelect, selected, formatPhone }) {\n  return (\n    <div className={styles.numbers}>\n      {numbers.map((number, index) => (\n        <div\n          key={number.id}\n          className={classnames(\n            styles.number,\n            index === selected ? styles.active : null,\n          )}\n          onClick={() => onSelect(index)}\n        >\n          <span className={styles.label} title={number.label}>\n            {number.label}\n          </span>\n          <span className={styles.colon}>:</span>\n          <span>{formatPhone(number.phoneNumber)}</span>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nForwardNumbers.propTypes = {\n  numbers: PropTypes.array.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  selected: PropTypes.number.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n};\n\nexport default class ForwardForm extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selectedIndex: 0,\n      customValue: '',\n      handling: false,\n      recipient: null,\n    };\n\n    this.filter = (value) => value.replace(cleanRegex, '');\n\n    this.onSelect = (index) => {\n      this.setState({\n        selectedIndex: index,\n      });\n      if (typeof this.props.onChange === 'function') {\n        this.props.onChange(this.getValue());\n      }\n    };\n\n    this.onForward = async () => {\n      this.setState({\n        handling: true,\n      });\n      const result = await this.props.onForward(this.getValue());\n      if (!this._mounted) {\n        return;\n      }\n      this.setState({\n        handling: false,\n      });\n      if (result) {\n        this.props.onCancel();\n      }\n    };\n\n    this.onSelectCustomNumber = () => {\n      this.onSelect(this.props.forwardingNumbers.length);\n      setTimeout(() => {\n        if (this.customInput) {\n          this.customInput.focus();\n        }\n      }, 100);\n    };\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  getValue() {\n    if (this.state.selectedIndex < this.props.forwardingNumbers.length) {\n      const forwardingNumber = this.props.forwardingNumbers[\n        this.state.selectedIndex\n      ];\n      return forwardingNumber && forwardingNumber.phoneNumber;\n    }\n    if (this.state.recipient) {\n      return this.state.recipient.phoneNumber;\n    }\n    return this.state.customValue;\n  }\n\n  _onCustomValueChange = (value) => {\n    this.setState({\n      customValue: value,\n    });\n  };\n\n  _clearToNumber = () => {\n    this.setState({\n      customValue: '',\n    });\n  };\n\n  _setRecipient = (recipient) => {\n    this.setState({\n      recipient,\n    });\n    this._clearToNumber();\n  };\n\n  _clearRecipient = () => {\n    this.setState({\n      recipient: null,\n    });\n  };\n\n  render() {\n    const {\n      className,\n      onCancel,\n      currentLocale,\n      forwardingNumbers,\n      formatPhone,\n      searchContact,\n      searchContactList,\n      phoneTypeRenderer,\n      phoneSourceNameRenderer,\n      autoFocus,\n    } = this.props;\n    const value = this.getValue();\n    const disableButton = isBlank(value) || this.state.handling;\n    return (\n      <div className={classnames(styles.root, className)}>\n        <ForwardNumbers\n          formatPhone={formatPhone}\n          numbers={forwardingNumbers}\n          onSelect={this.onSelect}\n          selected={this.state.selectedIndex}\n        />\n        <div\n          className={classnames(\n            styles.custromNumber,\n            this.state.selectedIndex === forwardingNumbers.length\n              ? styles.active\n              : null,\n          )}\n          onClick={this.onSelectCustomNumber}\n        >\n          <div className={styles.customLabel}>\n            {i18n.getString('customNumber', currentLocale)}\n          </div>\n          <RecipientsInput\n            label=\"\"\n            placeholder=\"\"\n            inputRef={(ref) => {\n              this.customInput = ref;\n            }}\n            value={this.state.customValue}\n            className={styles.customInput}\n            onChange={this._onCustomValueChange}\n            onClean={this._clearToNumber}\n            recipient={this.state.recipient}\n            addToRecipients={this._setRecipient}\n            removeFromRecipients={this._clearRecipient}\n            searchContact={searchContact}\n            searchContactList={searchContactList}\n            phoneTypeRenderer={phoneTypeRenderer}\n            phoneSourceNameRenderer={phoneSourceNameRenderer}\n            formatContactPhone={formatPhone}\n            currentLocale={currentLocale}\n            titleEnabled\n            autoFocus={autoFocus}\n          />\n        </div>\n        <div className={styles.buttonGroup}>\n          <Button className={styles.cancelButton} onClick={onCancel}>\n            {i18n.getString('cancel', currentLocale)}\n          </Button>\n          <Button\n            className={classnames(\n              styles.forwardButton,\n              disableButton ? styles.disabled : null,\n            )}\n            onClick={this.onForward}\n            disabled={disableButton}\n          >\n            <span className={styles.buttonText}>\n              {i18n.getString('forward', currentLocale)}\n            </span>\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n\nForwardForm.propTypes = {\n  className: PropTypes.string,\n  onCancel: PropTypes.func.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  forwardingNumbers: PropTypes.array.isRequired,\n  formatPhone: PropTypes.func.isRequired,\n  onForward: PropTypes.func.isRequired,\n  onChange: PropTypes.func,\n  searchContactList: PropTypes.array.isRequired,\n  searchContact: PropTypes.func.isRequired,\n  phoneTypeRenderer: PropTypes.func,\n  phoneSourceNameRenderer: PropTypes.func,\n  autoFocus: PropTypes.bool,\n};\n\nForwardForm.defaultProps = {\n  className: null,\n  onChange: undefined,\n  phoneTypeRenderer: undefined,\n  phoneSourceNameRenderer: undefined,\n  autoFocus: true,\n};\n"],"file":"index.js"}