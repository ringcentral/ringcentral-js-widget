{"version":3,"sources":["components/ConversationPanel/index.js"],"names":["ConversationPanel","props","onSend","replyToReceivers","messageText","onInputHeightChange","value","setState","inputHeight","onSelectContact","idx","selected","showContactDisplayPlaceholder","parseInt","_userSelection","autoLog","logConversation","redirect","prefill","getSelectedContact","state","conversation","contactMatches","correspondentMatches","length","bind","getInitialContactIndex","isLogging","loaded","showSpinner","loadConversation","_mounted","nextProps","conversationMatches","prevProps","prevState","messages","readMessages","conversationId","perPage","loadPreviousMessages","unloadConversation","headerHeight","lastMatchedCorrespondentEntity","index","correspondentMatchId","id","findIndex","contact","correspondents","phoneNumber","extensionNumber","undefined","groupNumbers","map","correspondent","name","onLogConversation","correspondentEntity","styles","root","conversationBody","loading","recipients","messageSubjectRenderer","currentLocale","getMessageListHeight","dateTimeFormatter","formatPhone","loadingNextPage","getGroupPhoneNumbers","getPhoneNumber","fallbackName","getFallbackContactName","extraButton","renderExtraButton","logButton","disableLinks","header","brand","contactDisplay","contactDisplaySelect","areaCode","countryCode","enableContactFallback","sourceIcons","phoneTypeRenderer","phoneSourceNameRenderer","showGroupNumberName","goBack","backButton","dynamicsFont","arrow","updateMessageText","sendButtonDisabled","inputExpandable","Component","propTypes","PropTypes","string","isRequired","func","ConversationMessageList","arrayOf","shape","bool","object","number","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\n\nimport SpinnerOverlay from '../SpinnerOverlay';\nimport ConversationMessageList from '../ConversationMessageList';\nimport LogButton from '../LogButton';\nimport ContactDisplay from '../ContactDisplay';\nimport MessageInput from '../MessageInput';\n\nimport styles from './styles.scss';\n\nclass ConversationPanel extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: this.getInitialContactIndex(),\n      isLogging: false,\n      inputHeight: 63,\n      loaded: false,\n    };\n    this._userSelection = false;\n  }\n\n  componentDidMount() {\n    if (!this.props.showSpinner) {\n      this.loadConversation();\n    }\n    this._mounted = true;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (\n      !this._userSelection &&\n      this.props.conversation &&\n      nextProps.conversation &&\n      (nextProps.conversation.conversationMatches !==\n        this.props.conversation.conversationMatches ||\n        nextProps.conversation.correspondentMatches !==\n          this.props.conversation.correspondentMatches)\n    ) {\n      this.setState({\n        selected: this.getInitialContactIndex(nextProps),\n      });\n    }\n    if (!nextProps.showSpinner && this.props.showSpinner) {\n      this.loadConversation();\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.messages !== this.props.messages) {\n      this.props.readMessages(this.props.conversationId);\n    }\n    if (prevState.loaded === false && this.state.loaded === true) {\n      if (this.props.messages.length < this.props.perPage) {\n        this.props.loadPreviousMessages();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n    this.props.unloadConversation();\n  }\n\n  onSend = () => {\n    this.props.replyToReceivers(this.props.messageText);\n  };\n\n  onInputHeightChange = (value) => {\n    this.setState({\n      inputHeight: value,\n    });\n  };\n\n  onSelectContact = (value, idx) => {\n    const selected = this.props.showContactDisplayPlaceholder\n      ? parseInt(idx, 10) - 1\n      : parseInt(idx, 10);\n    this._userSelection = true;\n    this.setState({\n      selected,\n    });\n    if (this.props.autoLog) {\n      this.logConversation({ redirect: false, selected, prefill: false });\n    }\n  };\n\n  getMessageListHeight() {\n    const headerHeight = 41;\n    return `calc(100% - ${this.state.inputHeight + headerHeight}px)`;\n  }\n\n  getSelectedContact = (selected = this.state.selected) => {\n    if (!this.props.conversation) {\n      return null;\n    }\n    const contactMatches = this.props.conversation.correspondentMatches;\n    return (\n      (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null\n    );\n  };\n\n  getInitialContactIndex(nextProps = this.props) {\n    const {\n      correspondentMatches,\n      lastMatchedCorrespondentEntity,\n      conversationMatches,\n    } = nextProps.conversation;\n    let index = null;\n    const correspondentMatchId =\n      (lastMatchedCorrespondentEntity && lastMatchedCorrespondentEntity.id) ||\n      (conversationMatches[0] && conversationMatches[0].id);\n    if (correspondentMatchId) {\n      index = correspondentMatches.findIndex(\n        (contact) => contact.id === correspondentMatchId,\n      );\n      if (index > -1) return index;\n    }\n    return -1;\n  }\n\n  getPhoneNumber() {\n    const { conversation: { correspondents = [] } = {} } = this.props;\n    return (\n      (correspondents.length === 1 &&\n        (correspondents[0].phoneNumber || correspondents[0].extensionNumber)) ||\n      undefined\n    );\n  }\n\n  getGroupPhoneNumbers() {\n    const { conversation: { correspondents = [] } = {} } = this.props;\n    const groupNumbers =\n      correspondents.length > 1\n        ? correspondents.map(\n            (correspondent) =>\n              correspondent.extensionNumber ||\n              correspondent.phoneNumber ||\n              undefined,\n          )\n        : null;\n    return groupNumbers;\n  }\n\n  getFallbackContactName() {\n    const { conversation: { correspondents = [] } = {} } = this.props;\n    return (correspondents.length === 1 && correspondents[0].name) || undefined;\n  }\n\n  loadConversation() {\n    this.props.loadConversation(this.props.conversationId);\n    this.setState({ loaded: true });\n  }\n\n  async logConversation({ redirect = true, selected, prefill = true } = {}) {\n    if (\n      typeof this.props.onLogConversation === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogConversation({\n        correspondentEntity: this.getSelectedContact(selected),\n        conversationId: this.props.conversation.conversationId,\n        redirect,\n        prefill,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  }\n\n  logConversation = this.logConversation.bind(this);\n\n  render() {\n    if (!this.state.loaded) {\n      return (\n        <div className={styles.root}>\n          <SpinnerOverlay />\n        </div>\n      );\n    }\n    let conversationBody = null;\n    const loading = this.props.showSpinner;\n    const { recipients, messageSubjectRenderer } = this.props;\n    if (!loading) {\n      conversationBody = (\n        <ConversationMessageList\n          currentLocale={this.props.currentLocale}\n          height={this.getMessageListHeight()}\n          messages={this.props.messages}\n          className={styles.conversationBody}\n          dateTimeFormatter={this.props.dateTimeFormatter}\n          showSender={recipients && recipients.length > 1}\n          messageSubjectRenderer={messageSubjectRenderer}\n          formatPhone={this.props.formatPhone}\n          loadingNextPage={this.props.loadingNextPage}\n          loadPreviousMessages={this.props.loadPreviousMessages}\n        />\n      );\n    }\n    const {\n      isLogging,\n      conversationMatches,\n      correspondentMatches,\n    } = this.props.conversation;\n    const groupNumbers = this.getGroupPhoneNumbers();\n    const phoneNumber = this.getPhoneNumber();\n    const fallbackName = this.getFallbackContactName();\n    const extraButton = this.props.renderExtraButton\n      ? this.props.renderExtraButton(this.props.conversation, {\n          logConversation: this.logConversation,\n          isLogging: isLogging || this.state.isLogging,\n        })\n      : null;\n    const logButton =\n      this.props.onLogConversation && !this.props.renderExtraButton ? (\n        <LogButton\n          className={styles.logButton}\n          onLog={this.logConversation}\n          disableLinks={this.props.disableLinks}\n          isLogged={conversationMatches.length > 0}\n          isLogging={isLogging || this.state.isLogging}\n          currentLocale={this.props.currentLocale}\n        />\n      ) : null;\n    return (\n      <div className={styles.root}>\n        <div data-sign=\"conversationPanel\" className={styles.header}>\n          <ContactDisplay\n            brand={this.props.brand}\n            className={styles.contactDisplay}\n            selectClassName={styles.contactDisplaySelect}\n            contactMatches={correspondentMatches || []}\n            selected={this.state.selected}\n            onSelectContact={this.onSelectContact}\n            disabled={this.props.disableLinks}\n            isLogging={isLogging || this.state.isLogging}\n            fallBackName={fallbackName}\n            areaCode={this.props.areaCode}\n            countryCode={this.props.countryCode}\n            phoneNumber={phoneNumber}\n            groupNumbers={groupNumbers}\n            showType={false}\n            currentLocale={this.props.currentLocale}\n            enableContactFallback={this.props.enableContactFallback}\n            showPlaceholder={this.props.showContactDisplayPlaceholder}\n            sourceIcons={this.props.sourceIcons}\n            phoneTypeRenderer={this.props.phoneTypeRenderer}\n            phoneSourceNameRenderer={this.props.phoneSourceNameRenderer}\n            showGroupNumberName={this.props.showGroupNumberName}\n          />\n          <a\n            onClick={() => this.props.goBack()}\n            data-sign=\"backButton\"\n            className={styles.backButton}\n          >\n            <span className={dynamicsFont.arrow} />\n          </a>\n          {extraButton && <div className={styles.logButton}>{extraButton}</div>}\n          {logButton}\n        </div>\n        {conversationBody}\n        <MessageInput\n          value={this.props.messageText}\n          onChange={this.props.updateMessageText}\n          disabled={this.props.sendButtonDisabled}\n          currentLocale={this.props.currentLocale}\n          onSend={this.onSend}\n          onHeightChange={this.onInputHeightChange}\n          inputExpandable={this.props.inputExpandable}\n        />\n      </div>\n    );\n  }\n}\n\nConversationPanel.propTypes = {\n  brand: PropTypes.string.isRequired,\n  replyToReceivers: PropTypes.func.isRequired,\n  messages: ConversationMessageList.propTypes.messages,\n  updateMessageText: PropTypes.func,\n  messageText: PropTypes.string,\n  recipients: PropTypes.arrayOf(\n    PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }),\n  ).isRequired,\n  sendButtonDisabled: PropTypes.bool.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  showSpinner: PropTypes.bool.isRequired,\n  disableLinks: PropTypes.bool,\n  conversation: PropTypes.object.isRequired,\n  onLogConversation: PropTypes.func,\n  areaCode: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  autoLog: PropTypes.bool,\n  enableContactFallback: PropTypes.bool,\n  dateTimeFormatter: PropTypes.func.isRequired,\n  goBack: PropTypes.func.isRequired,\n  showContactDisplayPlaceholder: PropTypes.bool,\n  sourceIcons: PropTypes.object,\n  phoneTypeRenderer: PropTypes.func,\n  phoneSourceNameRenderer: PropTypes.func,\n  showGroupNumberName: PropTypes.bool,\n  messageSubjectRenderer: PropTypes.func,\n  formatPhone: PropTypes.func.isRequired,\n  readMessages: PropTypes.func.isRequired,\n  loadPreviousMessages: PropTypes.func.isRequired,\n  unloadConversation: PropTypes.func.isRequired,\n  perPage: PropTypes.number,\n  conversationId: PropTypes.string.isRequired,\n  loadConversation: PropTypes.func,\n  renderExtraButton: PropTypes.func,\n  loadingNextPage: PropTypes.bool,\n  inputExpandable: PropTypes.bool,\n};\nConversationPanel.defaultProps = {\n  disableLinks: false,\n  onLogConversation: undefined,\n  autoLog: false,\n  enableContactFallback: undefined,\n  showContactDisplayPlaceholder: true,\n  sourceIcons: undefined,\n  phoneTypeRenderer: undefined,\n  phoneSourceNameRenderer: undefined,\n  showGroupNumberName: false,\n  messageText: '',\n  updateMessageText: () => null,\n  messageSubjectRenderer: undefined,\n  perPage: undefined,\n  loadConversation: () => null,\n  renderExtraButton: undefined,\n  loadingNextPage: false,\n  inputExpandable: undefined,\n};\n\nexport default ConversationPanel;\n"],"file":"index.js"}